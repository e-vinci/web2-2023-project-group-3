/*! For license information please see bundle.min.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={886:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function _asyncIterator(t){var e,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new AsyncFromSyncIterator(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return AsyncFromSyncIterator=function(t){this.s=t,this.n=t.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new AsyncFromSyncIterator(t)}var REACT_ELEMENT_TYPE;function _jsx(t,e,r,n){REACT_ELEMENT_TYPE||(REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=t&&t.defaultProps,a=arguments.length-3;if(e||0===a||(e={children:void 0}),1===a)e.children=n;else if(a>1){for(var o=new Array(a),s=0;s<a;s++)o[s]=arguments[s+3];e.children=o}if(e&&i)for(var l in i)void 0===e[l]&&(e[l]=i[l]);else e||(e=i||{});return{$$typeof:REACT_ELEMENT_TYPE,type:t,key:void 0===r?null:""+r,ref:null,props:e,_owner:null}}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _wrapRegExp(){_wrapRegExp=function(t,e){return new r(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function r(t,n,i){var a=new RegExp(t,n);return e.set(a,i||e.get(t)),_setPrototypeOf(a,r.prototype)}function n(t,r){var n=e.get(r);return Object.keys(n).reduce((function(e,r){return e[r]=t[n[r]],e}),Object.create(null))}return _inherits(r,RegExp),r.prototype.exec=function(e){var r=t.exec.call(this,e);return r&&(r.groups=n(r,this)),r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var a=e.get(this);return t[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+a[e]})))}if("function"==typeof i){var o=this;return t[Symbol.replace].call(this,r,(function(){var t=arguments;return"object"!=typeof t[t.length-1]&&(t=[].slice.call(t)).push(n(t,o)),i.apply(this,t)}))}return t[Symbol.replace].call(this,r,i)},_wrapRegExp.apply(this,arguments)}function _AwaitValue(t){this.wrapped=t}function _AsyncGenerator(t){var e,r;function n(e,r){try{var a=t[e](r),o=a.value,s=o instanceof _AwaitValue;Promise.resolve(s?o.wrapped:o).then((function(t){s?n("return"===e?"return":"next",t):i(a.done?"return":"normal",t)}),(function(t){n("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,i){return new Promise((function(a,o){var s={key:t,arg:i,resolve:a,reject:o,next:null};r?r=r.next=s:(e=r=s,n(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}function _wrapAsyncGenerator(t){return function(){return new _AsyncGenerator(t.apply(this,arguments))}}function _awaitAsyncGenerator(t){return new _AwaitValue(t)}function _asyncGeneratorDelegate(t,e){var r={},n=!1;function i(r,i){return n=!0,i=new Promise((function(e){e(t[r](i))})),{done:!1,value:e(i)}}return r["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},r.next=function(t){return n?(n=!1,t):i("next",t)},"function"==typeof t.throw&&(r.throw=function(t){if(n)throw n=!1,t;return i("throw",t)}),"function"==typeof t.return&&(r.return=function(t){return n?(n=!1,t):i("return",t)}),r}function asyncGeneratorStep(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){asyncGeneratorStep(a,n,i,o,s,"next",t)}function s(t){asyncGeneratorStep(a,n,i,o,s,"throw",t)}o(void 0)}))}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineEnumerableProperties(t,e){for(var r in e)(a=e[r]).configurable=a.enumerable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,r,a);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),i=0;i<n.length;i++){var a,o=n[i];(a=e[o]).configurable=a.enumerable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,o,a)}return t}function _defaults(t,e){for(var r=Object.getOwnPropertyNames(e),n=0;n<r.length;n++){var i=r[n],a=Object.getOwnPropertyDescriptor(e,i);a&&a.configurable&&void 0===t[i]&&Object.defineProperty(t,i,a)}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _extends(){return _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_extends.apply(this,arguments)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach((function(e){_defineProperty(t,e,r[e])}))}return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_setPrototypeOf(t,e)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _construct(t,e,r){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(i,r.prototype),i},_construct.apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)},_wrapNativeSuper(t)}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(t){return t?r:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=_getRequireWildcardCache(e);if(r&&r.has(t))return r.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var o=i?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=t[a]}return n.default=t,r&&r.set(t,n),n}function _newArrowCheck(t,e){if(t!==e)throw new TypeError("Cannot instantiate an arrow function")}function _objectDestructuringEmpty(t){if(null==t)throw new TypeError("Cannot destructure undefined")}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var r,n,i={},a=Object.keys(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}function _objectWithoutProperties(t,e){if(null==t)return{};var r,n,i=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=_superPropBase(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}},_get.apply(this,arguments)}function set(t,e,r,n){return set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,r,n){var i,a=_superPropBase(t,e);if(a){if((i=Object.getOwnPropertyDescriptor(a,e)).set)return i.set.call(n,r),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(n,e)){if(!i.writable)return!1;i.value=r,Object.defineProperty(n,e,i)}else _defineProperty(n,e,r);return!0},set(t,e,r,n)}function _set(t,e,r,n,i){if(!set(t,e,r,n||t)&&i)throw new Error("failed to set property");return r}function _taggedTemplateLiteral(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function _taggedTemplateLiteralLoose(t,e){return e||(e=t.slice(0)),t.raw=e,t}function _readOnlyError(t){throw new TypeError('"'+t+'" is read-only')}function _writeOnlyError(t){throw new TypeError('"'+t+'" is write-only')}function _classNameTDZError(t){throw new Error('Class "'+t+'" cannot be referenced in computed property keys.')}function _temporalUndefined(){}function _tdz(t){throw new ReferenceError(t+" is not defined - temporal dead zone")}function _temporalRef(t,e){return t===_temporalUndefined?_tdz(e):t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _slicedToArrayLoose(t,e){return _arrayWithHoles(t)||_iterableToArrayLimitLoose(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toArray(t){return _arrayWithHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _maybeArrayLike(t,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var n=e.length;return _arrayLikeToArray(e,void 0!==r&&r<n?r:n)}return t(e,r)}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a=[],o=!0,s=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){s=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(s)throw i}}return a}}function _iterableToArrayLimitLoose(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var n=[];for(r=r.call(t),_step;!(_step=r.next()).done&&(n.push(_step.value),!e||n.length!==e););return n}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function _createForOfIteratorHelperLoose(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _skipFirstGeneratorNext(t){return function(){var e=t.apply(this,arguments);return e.next(),e}}function _toPrimitive(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==typeof e?e:String(e)}function _initializerWarningHelper(t,e){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}function _initializerDefineProperty(t,e,r,n){r&&Object.defineProperty(t,e,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function _applyDecoratedDescriptor(t,e,r,n,i){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce((function(r,n){return n(t,e,r)||r}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}_AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_AsyncGenerator.prototype.next=function(t){return this._invoke("next",t)},_AsyncGenerator.prototype.throw=function(t){return this._invoke("throw",t)},_AsyncGenerator.prototype.return=function(t){return this._invoke("return",t)};var id=0;function _classPrivateFieldLooseKey(t){return"__private_"+id+++"_"+t}function _classPrivateFieldLooseBase(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}function _classPrivateFieldGet(t,e){return _classApplyDescriptorGet(t,_classExtractFieldDescriptor(t,e,"get"))}function _classPrivateFieldSet(t,e,r){return _classApplyDescriptorSet(t,_classExtractFieldDescriptor(t,e,"set"),r),r}function _classPrivateFieldDestructureSet(t,e){return _classApplyDescriptorDestructureSet(t,_classExtractFieldDescriptor(t,e,"set"))}function _classExtractFieldDescriptor(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function _classStaticPrivateFieldSpecGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"get"),_classApplyDescriptorGet(t,r)}function _classStaticPrivateFieldSpecSet(t,e,r,n){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorSet(t,r,n),n}function _classStaticPrivateMethodGet(t,e,r){return _classCheckPrivateStaticAccess(t,e),r}function _classStaticPrivateMethodSet(){throw new TypeError("attempted to set read only static private field")}function _classApplyDescriptorGet(t,e){return e.get?e.get.call(t):e.value}function _classApplyDescriptorSet(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function _classApplyDescriptorDestructureSet(t,e){if(e.set)return"__destrObj"in e||(e.__destrObj={set value(r){e.set.call(t,r)}}),e.__destrObj;if(!e.writable)throw new TypeError("attempted to set read only private field");return e}function _classStaticPrivateFieldDestructureSet(t,e,r){return _classCheckPrivateStaticAccess(t,e),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorDestructureSet(t,r)}function _classCheckPrivateStaticAccess(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(t,e){if(void 0===t)throw new TypeError("attempted to "+e+" private static field before its declaration")}function _decorate(t,e,r,n){var i=_getDecoratorsApi();if(n)for(var a=0;a<n.length;a++)i=n[a](i);var o=e((function(t){i.initializeInstanceElements(t,s.elements)}),r),s=i.decorateClass(_coalesceClassElements(o.d.map(_createElementDescriptor)),t);return i.initializeClassElements(o.F,s.elements),i.runClassFinishers(o.F,s.finishers)}function _getDecoratorsApi(){_getDecoratorsApi=function(){return t};var t={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(t,e){["method","field"].forEach((function(r){e.forEach((function(e){e.kind===r&&"own"===e.placement&&this.defineClassElement(t,e)}),this)}),this)},initializeClassElements:function(t,e){var r=t.prototype;["method","field"].forEach((function(n){e.forEach((function(e){var i=e.placement;if(e.kind===n&&("static"===i||"prototype"===i)){var a="static"===i?t:r;this.defineClassElement(a,e)}}),this)}),this)},defineClassElement:function(t,e){var r=e.descriptor;if("field"===e.kind){var n=e.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(t)}}Object.defineProperty(t,e.key,r)},decorateClass:function(t,e){var r=[],n=[],i={static:[],prototype:[],own:[]};if(t.forEach((function(t){this.addElementPlacement(t,i)}),this),t.forEach((function(t){if(!_hasDecorators(t))return r.push(t);var e=this.decorateElement(t,i);r.push(e.element),r.push.apply(r,e.extras),n.push.apply(n,e.finishers)}),this),!e)return{elements:r,finishers:n};var a=this.decorateConstructor(r,e);return n.push.apply(n,a.finishers),a.finishers=n,a},addElementPlacement:function(t,e,r){var n=e[t.placement];if(!r&&-1!==n.indexOf(t.key))throw new TypeError("Duplicated element ("+t.key+")");n.push(t.key)},decorateElement:function(t,e){for(var r=[],n=[],i=t.decorators,a=i.length-1;a>=0;a--){var o=e[t.placement];o.splice(o.indexOf(t.key),1);var s=this.fromElementDescriptor(t),l=this.toElementFinisherExtras((0,i[a])(s)||s);t=l.element,this.addElementPlacement(t,e),l.finisher&&n.push(l.finisher);var c=l.extras;if(c){for(var h=0;h<c.length;h++)this.addElementPlacement(c[h],e);r.push.apply(r,c)}}return{element:t,finishers:n,extras:r}},decorateConstructor:function(t,e){for(var r=[],n=e.length-1;n>=0;n--){var i=this.fromClassDescriptor(t),a=this.toClassDescriptor((0,e[n])(i)||i);if(void 0!==a.finisher&&r.push(a.finisher),void 0!==a.elements){t=a.elements;for(var o=0;o<t.length-1;o++)for(var s=o+1;s<t.length;s++)if(t[o].key===t[s].key&&t[o].placement===t[s].placement)throw new TypeError("Duplicated element ("+t[o].key+")")}}return{elements:t,finishers:r}},fromElementDescriptor:function(t){var e={kind:t.kind,key:t.key,placement:t.placement,descriptor:t.descriptor};return Object.defineProperty(e,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===t.kind&&(e.initializer=t.initializer),e},toElementDescriptors:function(t){if(void 0!==t)return _toArray(t).map((function(t){var e=this.toElementDescriptor(t);return this.disallowProperty(t,"finisher","An element descriptor"),this.disallowProperty(t,"extras","An element descriptor"),e}),this)},toElementDescriptor:function(t){var e=String(t.kind);if("method"!==e&&"field"!==e)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+e+'"');var r=_toPropertyKey(t.key),n=String(t.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=t.descriptor;this.disallowProperty(t,"elements","An element descriptor");var a={kind:e,key:r,placement:n,descriptor:Object.assign({},i)};return"field"!==e?this.disallowProperty(t,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),a.initializer=t.initializer),a},toElementFinisherExtras:function(t){return{element:this.toElementDescriptor(t),finisher:_optionalCallableProperty(t,"finisher"),extras:this.toElementDescriptors(t.extras)}},fromClassDescriptor:function(t){var e={kind:"class",elements:t.map(this.fromElementDescriptor,this)};return Object.defineProperty(e,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),e},toClassDescriptor:function(t){var e=String(t.kind);if("class"!==e)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+e+'"');this.disallowProperty(t,"key","A class descriptor"),this.disallowProperty(t,"placement","A class descriptor"),this.disallowProperty(t,"descriptor","A class descriptor"),this.disallowProperty(t,"initializer","A class descriptor"),this.disallowProperty(t,"extras","A class descriptor");var r=_optionalCallableProperty(t,"finisher");return{elements:this.toElementDescriptors(t.elements),finisher:r}},runClassFinishers:function(t,e){for(var r=0;r<e.length;r++){var n=(0,e[r])(t);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");t=n}}return t},disallowProperty:function(t,e,r){if(void 0!==t[e])throw new TypeError(r+" can't have a ."+e+" property.")}};return t}function _createElementDescriptor(t){var e,r=_toPropertyKey(t.key);"method"===t.kind?e={value:t.value,writable:!0,configurable:!0,enumerable:!1}:"get"===t.kind?e={get:t.value,configurable:!0,enumerable:!1}:"set"===t.kind?e={set:t.value,configurable:!0,enumerable:!1}:"field"===t.kind&&(e={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===t.kind?"field":"method",key:r,placement:t.static?"static":"field"===t.kind?"own":"prototype",descriptor:e};return t.decorators&&(n.decorators=t.decorators),"field"===t.kind&&(n.initializer=t.value),n}function _coalesceGetterSetter(t,e){void 0!==t.descriptor.get?e.descriptor.get=t.descriptor.get:e.descriptor.set=t.descriptor.set}function _coalesceClassElements(t){for(var e=[],r=function(t){return"method"===t.kind&&t.key===a.key&&t.placement===a.placement},n=0;n<t.length;n++){var i,a=t[n];if("method"===a.kind&&(i=e.find(r)))if(_isDataDescriptor(a.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(a)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+a.key+") can't be decorated.");i.descriptor=a.descriptor}else{if(_hasDecorators(a)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+a.key+").");i.decorators=a.decorators}_coalesceGetterSetter(a,i)}else e.push(a)}return e}function _hasDecorators(t){return t.decorators&&t.decorators.length}function _isDataDescriptor(t){return void 0!==t&&!(void 0===t.value&&void 0===t.writable)}function _optionalCallableProperty(t,e){var r=t[e];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+e+"' to be a function");return r}function _classPrivateMethodGet(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function _checkPrivateRedeclaration(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldInitSpec(t,e,r){_checkPrivateRedeclaration(t,e),e.set(t,r)}function _classPrivateMethodInitSpec(t,e){_checkPrivateRedeclaration(t,e),e.add(t)}function _classPrivateMethodSet(){throw new TypeError("attempted to reassign private method")}var _extendStatics=function(t,e){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},_extendStatics(t,e)};function __extends(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}_extendStatics(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var _assign=function(){return _assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},_assign.apply(this,arguments)};function __rest(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function __decorate(t,e,r,n){var i,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,r,o):i(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o}function __param(t,e){return function(r,n){e(r,n,t)}}function __metadata(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function __awaiter(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))}function __generator(t,e){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var __createBinding=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function __exportStar(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||__createBinding(e,t,r)}function __values(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,a=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function __spread(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t}function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function __spreadArray(t,e,r){if(r||2===arguments.length)for(var n,i=0,a=e.length;i<a;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}function __await(t){return this instanceof __await?(this.v=t,this):new __await(t)}function __asyncGenerator(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){a.push([t,e,r,n])>1||s(t,e)}))})}function s(t,e){try{!function(t){t.value instanceof __await?Promise.resolve(t.value.v).then(l,c):h(a[0][2],t)}(i[t](e))}catch(t){h(a[0][3],t)}}function l(t){s("next",t)}function c(t){s("throw",t)}function h(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function __asyncDelegator(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:__await(t[n](e)),done:"return"===n}:i?i(e):e}:i}}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}}function __makeTemplateObject(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var __setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function __importStar(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e}function __importDefault(t){return t&&t.__esModule?t:{default:t}}function __classPrivateFieldGet(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function __classPrivateFieldSet(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r}var t$3=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,e$8=Symbol(),n$5=new Map;class s$3{constructor(t,e){if(this._$cssResult$=!0,e!==e$8)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){var t=n$5.get(this.cssText);return t$3&&void 0===t&&(n$5.set(this.cssText,t=new CSSStyleSheet),t.replaceSync(this.cssText)),t}toString(){return this.cssText}}var o$5=t=>new s$3("string"==typeof t?t:t+"",e$8),r$3=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=1===t.length?t[0]:r.reduce(((e,r,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+t[n+1]),t[0]);return new s$3(i,e$8)},i$3=(t,e)=>{t$3?t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):e.forEach((e=>{var r=document.createElement("style"),n=window.litNonce;void 0!==n&&r.setAttribute("nonce",n),r.textContent=e.cssText,t.appendChild(r)}))},S$1=t$3?t=>t:t=>t instanceof CSSStyleSheet?(t=>{var e="";for(var r of t.cssRules)e+=r.cssText;return o$5(e)})(t):t,s$2,e$7=window.trustedTypes,r$2=e$7?e$7.emptyScript:"",h$2=window.reactiveElementPolyfillSupport,o$4={toAttribute(t,e){switch(e){case Boolean:t=t?r$2:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){var r=t;switch(e){case Boolean:r=null!==t;break;case Number:r=null===t?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch(t){r=null}}return r}},n$4=(t,e)=>e!==t&&(e==e||t==t),l$3={attribute:!0,type:String,converter:o$4,reflect:!1,hasChanged:n$4},t$2;class a$1 extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(t){var e;null!==(e=this.l)&&void 0!==e||(this.l=[]),this.l.push(t)}static get observedAttributes(){this.finalize();var t=[];return this.elementProperties.forEach(((e,r)=>{var n=this._$Eh(r,e);void 0!==n&&(this._$Eu.set(n,r),t.push(n))})),t}static createProperty(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l$3;if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){var r="symbol"==typeof t?Symbol():"__"+t,n=this.getPropertyDescriptor(t,r,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}}static getPropertyDescriptor(t,e,r){return{get(){return this[e]},set(n){var i=this[t];this[e]=n,this.requestUpdate(t,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||l$3}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;var t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){var e=this.properties,r=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(var n of r)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){var e=[];if(Array.isArray(t)){var r=new Set(t.flat(1/0).reverse());for(var n of r)e.unshift(S$1(n))}else void 0!==t&&e.push(S$1(t));return e}static _$Eh(t,e){var r=e.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof t?t.toLowerCase():void 0}o(){var t;this._$Ep=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(t=this.constructor.l)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,r;(null!==(e=this._$Eg)&&void 0!==e?e:this._$Eg=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(r=t.hostConnected)||void 0===r||r.call(t))}removeController(t){var e;null===(e=this._$Eg)||void 0===e||e.splice(this._$Eg.indexOf(t)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Et.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t,e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return i$3(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,r){this._$AK(t,r)}_$ES(t,e){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l$3,a=this.constructor._$Eh(t,i);if(void 0!==a&&!0===i.reflect){var o=(null!==(n=null===(r=i.converter)||void 0===r?void 0:r.toAttribute)&&void 0!==n?n:o$4.toAttribute)(e,i.type);this._$Ei=t,null==o?this.removeAttribute(a):this.setAttribute(a,o),this._$Ei=null}}_$AK(t,e){var r,n,i,a=this.constructor,o=a._$Eu.get(t);if(void 0!==o&&this._$Ei!==o){var s=a.getPropertyOptions(o),l=s.converter,c=null!==(i=null!==(n=null===(r=l)||void 0===r?void 0:r.fromAttribute)&&void 0!==n?n:"function"==typeof l?l:null)&&void 0!==i?i:o$4.fromAttribute;this._$Ei=o,this[o]=c(e,s.type),this._$Ei=null}}requestUpdate(t,e,r){var n=!0;void 0!==t&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||n$4)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===r.reflect&&this._$Ei!==t&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(t,r))):n=!1),!this.isUpdatePending&&n&&(this._$Ep=this._$EC())}_$EC(){var t=this;return _asyncToGenerator((function*(){t.isUpdatePending=!0;try{yield t._$Ep}catch(e){Promise.reject(e)}var e=t.scheduleUpdate();return null!=e&&(yield e),!t.isUpdatePending}))()}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(this.isUpdatePending){this.hasUpdated,this._$Et&&(this._$Et.forEach(((t,e)=>this[e]=t)),this._$Et=void 0);var e=!1,r=this._$AL;try{(e=this.shouldUpdate(r))?(this.willUpdate(r),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(r)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(r)}}willUpdate(t){}_$AE(t){var e;null===(e=this._$Eg)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(t){return!0}update(t){void 0!==this._$E_&&(this._$E_.forEach(((t,e)=>this._$ES(e,this[e],t))),this._$E_=void 0),this._$EU()}updated(t){}firstUpdated(t){}}a$1.finalized=!0,a$1.elementProperties=new Map,a$1.elementStyles=[],a$1.shadowRootOptions={mode:"open"},null==h$2||h$2({ReactiveElement:a$1}),(null!==(s$2=globalThis.reactiveElementVersions)&&void 0!==s$2?s$2:globalThis.reactiveElementVersions=[]).push("1.2.1");var i$2=globalThis.trustedTypes,s$1=i$2?i$2.createPolicy("lit-html",{createHTML:t=>t}):void 0,e$6="lit$".concat((Math.random()+"").slice(9),"$"),o$3="?"+e$6,n$3="<".concat(o$3,">"),l$2=document,h$1=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l$2.createComment(t)},r$1=t=>null===t||"object"!=typeof t&&"function"!=typeof t,d=Array.isArray,u=t=>{var e;return d(t)||"function"==typeof(null===(e=t)||void 0===e?void 0:e[Symbol.iterator])},c=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,a=/>/g,f=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,_=/'/g,m=/"/g,g=/^(?:script|style|textarea)$/i,p=t=>function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return{_$litType$:t,strings:e,values:n}},$=p(1),y=p(2),b=Symbol.for("lit-noChange"),w=Symbol.for("lit-nothing"),T=new WeakMap,x=(t,e,r)=>{var n,i,a=null!==(n=null==r?void 0:r.renderBefore)&&void 0!==n?n:e,o=a._$litPart$;if(void 0===o){var s=null!==(i=null==r?void 0:r.renderBefore)&&void 0!==i?i:null;a._$litPart$=o=new N(e.insertBefore(h$1(),s),s,void 0,null!=r?r:{})}return o._$AI(t),o},A=l$2.createTreeWalker(l$2,129,null,!1),C=(t,e)=>{for(var r,n=t.length-1,i=[],o=2===e?"<svg>":"",s=c,l=0;l<n;l++){for(var h=t[l],d=void 0,p=void 0,u=-1,b=0;b<h.length&&(s.lastIndex=b,null!==(p=s.exec(h)));)b=s.lastIndex,s===c?"!--"===p[1]?s=v:void 0!==p[1]?s=a:void 0!==p[2]?(g.test(p[2])&&(r=RegExp("</"+p[2],"g")),s=f):void 0!==p[3]&&(s=f):s===f?">"===p[0]?(s=null!=r?r:c,u=-1):void 0===p[1]?u=-2:(u=s.lastIndex-p[2].length,d=p[1],s=void 0===p[3]?f:'"'===p[3]?m:_):s===m||s===_?s=f:s===v||s===a?s=c:(s=f,r=void 0);var y=s===f&&t[l+1].startsWith("/>")?" ":"";o+=s===c?h+n$3:u>=0?(i.push(d),h.slice(0,u)+"$lit$"+h.slice(u)+e$6+y):h+e$6+(-2===u?(i.push(void 0),l):y)}var x=o+(t[n]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==s$1?s$1.createHTML(x):x,i]};class E{constructor(t,e){var r,{strings:n,_$litType$:i}=t;this.parts=[];var a=0,o=0,s=n.length-1,l=this.parts,[c,h]=C(n,i);if(this.el=E.createElement(c,e),A.currentNode=this.el.content,2===i){var d=this.el.content,p=d.firstChild;p.remove(),d.append(...p.childNodes)}for(;null!==(r=A.nextNode())&&l.length<s;){if(1===r.nodeType){if(r.hasAttributes()){var u=[];for(var m of r.getAttributeNames())if(m.endsWith("$lit$")||m.startsWith(e$6)){var f=h[o++];if(u.push(m),void 0!==f){var v=r.getAttribute(f.toLowerCase()+"$lit$").split(e$6),b=/([.?@])?(.*)/.exec(f);l.push({type:1,index:a,name:b[2],strings:v,ctor:"."===b[1]?M:"?"===b[1]?H:"@"===b[1]?I:S})}else l.push({type:6,index:a})}for(var y of u)r.removeAttribute(y)}if(g.test(r.tagName)){var x=r.textContent.split(e$6),_=x.length-1;if(_>0){r.textContent=i$2?i$2.emptyScript:"";for(var w=0;w<_;w++)r.append(x[w],h$1()),A.nextNode(),l.push({type:2,index:++a});r.append(x[_],h$1())}}}else if(8===r.nodeType)if(r.data===o$3)l.push({type:2,index:a});else for(var T=-1;-1!==(T=r.data.indexOf(e$6,T+1));)l.push({type:7,index:a}),T+=e$6.length-1;a++}}static createElement(t,e){var r=l$2.createElement("template");return r.innerHTML=t,r}}function P(t,e){var r,n,i,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,s=arguments.length>3?arguments[3]:void 0;if(e===b)return e;var l=void 0!==s?null===(r=o._$Cl)||void 0===r?void 0:r[s]:o._$Cu,c=r$1(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(n=null==l?void 0:l._$AO)||void 0===n||n.call(l,!1),void 0===c?l=void 0:(l=new c(t))._$AT(t,o,s),void 0!==s?(null!==(i=(a=o)._$Cl)&&void 0!==i?i:a._$Cl=[])[s]=l:o._$Cu=l),void 0!==l&&(e=P(t,l._$AS(t,e.values),l,s)),e}class V{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e,{el:{content:r},parts:n}=this._$AD,i=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:l$2).importNode(r,!0);A.currentNode=i;for(var a=A.nextNode(),o=0,s=0,l=n[0];void 0!==l;){if(o===l.index){var c=void 0;2===l.type?c=new N(a,a.nextSibling,this,t):1===l.type?c=new l.ctor(a,l.name,l.strings,this,t):6===l.type&&(c=new L(a,this,t)),this.v.push(c),l=n[++s]}o!==(null==l?void 0:l.index)&&(a=A.nextNode(),o++)}return i}m(t){var e=0;for(var r of this.v)void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,e),e+=r.strings.length-2):r._$AI(t[e])),e++}}class N{constructor(t,e,r,n){var i;this.type=2,this._$AH=w,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=r,this.options=n,this._$Cg=null===(i=null==n?void 0:n.isConnected)||void 0===i||i}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cg}get parentNode(){var t=this._$AA.parentNode,e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t){t=P(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),r$1(t)?t===w||null==t||""===t?(this._$AH!==w&&this._$AR(),this._$AH=w):t!==this._$AH&&t!==b&&this.$(t):void 0!==t._$litType$?this.T(t):void 0!==t.nodeType?this.S(t):u(t)?this.A(t):this.$(t)}M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._$AB;return this._$AA.parentNode.insertBefore(t,e)}S(t){this._$AH!==t&&(this._$AR(),this._$AH=this.M(t))}$(t){this._$AH!==w&&r$1(this._$AH)?this._$AA.nextSibling.data=t:this.S(l$2.createTextNode(t)),this._$AH=t}T(t){var e,{values:r,_$litType$:n}=t,i="number"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=E.createElement(n.h,this.options)),n);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===i)this._$AH.m(r);else{var a=new V(i,this),o=a.p(this.options);a.m(r),this.S(o),this._$AH=a}}_$AC(t){var e=T.get(t.strings);return void 0===e&&T.set(t.strings,e=new E(t)),e}A(t){d(this._$AH)||(this._$AH=[],this._$AR());var e,r=this._$AH,n=0;for(var i of t)n===r.length?r.push(e=new N(this.M(h$1()),this.M(h$1()),this,this.options)):e=r[n],e._$AI(i),n++;n<r.length&&(this._$AR(e&&e._$AB.nextSibling,n),r.length=n)}_$AR(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,r=arguments.length>1?arguments[1]:void 0;for(null===(t=this._$AP)||void 0===t||t.call(this,!1,!0,r);e&&e!==this._$AB;){var n=e.nextSibling;e.remove(),e=n}}setConnected(t){var e;void 0===this._$AM&&(this._$Cg=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class S{constructor(t,e,r,n,i){this.type=1,this._$AH=w,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=w}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.strings,a=!1;if(void 0===i)t=P(this,t,e,0),(a=!r$1(t)||t!==this._$AH&&t!==b)&&(this._$AH=t);else{var o,s,l=t;for(t=i[0],o=0;o<i.length-1;o++)(s=P(this,l[r+o],e,o))===b&&(s=this._$AH[o]),a||(a=!r$1(s)||s!==this._$AH[o]),s===w?t=w:t!==w&&(t+=(null!=s?s:"")+i[o+1]),this._$AH[o]=s}a&&!n&&this.k(t)}k(t){t===w?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class M extends S{constructor(){super(...arguments),this.type=3}k(t){this.element[this.name]=t===w?void 0:t}}var k=i$2?i$2.emptyScript:"";class H extends S{constructor(){super(...arguments),this.type=4}k(t){t&&t!==w?this.element.setAttribute(this.name,k):this.element.removeAttribute(this.name)}}class I extends S{constructor(t,e,r,n,i){super(t,e,r,n,i),this.type=5}_$AI(t){var e;if((t=null!==(e=P(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==e?e:w)!==b){var r=this._$AH,n=t===w&&r!==w||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,i=t!==w&&(r===w||n);n&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,t),this._$AH=t}}handleEvent(t){var e,r;"function"==typeof this._$AH?this._$AH.call(null!==(r=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==r?r:this.element,t):this._$AH.handleEvent(t)}}class L{constructor(t,e,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){P(this,t)}}var R={P:"$lit$",V:e$6,L:o$3,I:1,N:C,R:V,D:u,j:P,H:N,O:S,F:H,B:I,W:M,Z:L},z=window.litHtmlPolyfillSupport,l$1,o$2;null==z||z(E,N),(null!==(t$2=globalThis.litHtmlVersions)&&void 0!==t$2?t$2:globalThis.litHtmlVersions=[]).push("2.1.2");var r=a$1;class s extends a$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var t,e,r=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=r.firstChild),r}update(t){var e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Dt=x(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!1)}render(){return b}}s.finalized=!0,s._$litElement$=!0,null===(l$1=globalThis.litElementHydrateSupport)||void 0===l$1||l$1.call(globalThis,{LitElement:s});var n$2=globalThis.litElementPolyfillSupport;null==n$2||n$2({LitElement:s});var h={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(null!==(o$2=globalThis.litElementVersions)&&void 0!==o$2?o$2:globalThis.litElementVersions=[]).push("3.1.2");var n$1=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{var{kind:r,elements:n}=e;return{kind:r,elements:n,finisher(e){window.customElements.define(t,e)}}})(t,e),i$1=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?_objectSpread2(_objectSpread2({},e),{},{finisher(r){r.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(r){r.createProperty(e.key,t)}};function e$5(t){return(e,r)=>void 0!==r?((t,e,r)=>{e.constructor.createProperty(r,t)})(t,e,r):i$1(t,e)}function t$1(t){return e$5(_objectSpread2(_objectSpread2({},t),{},{state:!0}))}var e$4=(t,e,r)=>{Object.defineProperty(e,r,t)},t=(t,e)=>({kind:"method",placement:"prototype",key:e.key,descriptor:t}),o$1=t=>{var{finisher:e,descriptor:r}=t;return(t,n)=>{var i;if(void 0===n){var a=null!==(i=t.originalKey)&&void 0!==i?i:t.key,o=null!=r?{kind:"method",placement:"prototype",key:a,descriptor:r(t.key)}:_objectSpread2(_objectSpread2({},t),{},{key:a});return null!=e&&(o.finisher=function(t){e(t,a)}),o}var s=t.constructor;void 0!==r&&Object.defineProperty(t,n,r(n)),null==e||e(s,n)}},n;function e$3(t){return o$1({finisher:(e,r)=>{Object.assign(e.prototype[r],t)}})}function i(t,e){return o$1({descriptor:r=>{var n={get(){var e,r;return null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==r?r:null},enumerable:!0,configurable:!0};if(e){var i="symbol"==typeof r?Symbol():"__"+r;n.get=function(){var e,r;return void 0===this[i]&&(this[i]=null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==r?r:null),this[i]}}return n}})}function e$2(t){return o$1({descriptor:e=>({get(){var e,r;return null!==(r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelectorAll(t))&&void 0!==r?r:[]},enumerable:!0,configurable:!0})})}function e$1(t){return o$1({descriptor:e=>({get(){var e=this;return _asyncToGenerator((function*(){var r;return yield e.updateComplete,null===(r=e.renderRoot)||void 0===r?void 0:r.querySelector(t)}))()},enumerable:!0,configurable:!0})})}var e=null!=(null===(n=window.HTMLSlotElement)||void 0===n?void 0:n.prototype.assignedElements)?(t,e)=>t.assignedElements(e):(t,e)=>t.assignedNodes(e).filter((t=>t.nodeType===Node.ELEMENT_NODE));function l(t){var{slot:r,selector:n}=null!=t?t:{};return o$1({descriptor:i=>({get(){var i,a="slot"+(r?"[name=".concat(r,"]"):":not([name])"),o=null===(i=this.renderRoot)||void 0===i?void 0:i.querySelector(a),s=null!=o?e(o,t):[];return n?s.filter((t=>t.matches(n))):s},enumerable:!0,configurable:!0})})}function o(t,e,r){var n,i=t;return"object"==typeof t?(i=t.slot,n=t):n={flatten:e},r?l({slot:i,flatten:e,selector:r}):o$1({descriptor:t=>({get(){var t,e,r="slot"+(i?"[name=".concat(i,"]"):":not([name])"),a=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(r);return null!==(e=null==a?void 0:a.assignedNodes(n))&&void 0!==e?e:[]},enumerable:!0,configurable:!0})})}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function getDefaultExportFromNamespaceIfPresent(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function getDefaultExportFromNamespaceIfNotNamed(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")&&1===Object.keys(t).length?t.default:t}function getAugmentedNamespace(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}function commonjsRequire(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var lottie$1={exports:{}};(function(module,exports){var factory;"undefined"!=typeof navigator&&(factory=function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(t){_useWebWorker=!!t},getWebWorker=function(){return _useWebWorker},setLocationHref=function(t){locationHref=t},getLocationHref=function(){return locationHref};function createTag(t){return document.createElement(t)}function extendPrototype(t,e){var r,n,i=t.length;for(r=0;r<i;r+=1)for(var a in n=t[r].prototype)Object.prototype.hasOwnProperty.call(n,a)&&(e.prototype[a]=n[a])}function getDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)}function createProxyFunction(t){function e(){}return e.prototype=t,e}var audioControllerFactory=function(){function t(t){this.audios=[],this.audioFactory=t,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(t){this.audios.push(t)},pause:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].pause()},resume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].resume()},setRate:function(t){var e,r=this.audios.length;for(e=0;e<r;e+=1)this.audios[e].setRate(t)},createAudio:function(t){return this.audioFactory?this.audioFactory(t):window.Howl?new window.Howl({src:[t]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(t){this.audioFactory=t},setVolume:function(t){this._volume=t,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),createTypedArray=function(){function t(t,e){var r,n=0,i=[];switch(t){case"int16":case"uint8c":r=1;break;default:r=1.1}for(n=0;n<e;n+=1)i.push(r);return i}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(e,r){return"float32"===e?new Float32Array(r):"int16"===e?new Int16Array(r):"uint8c"===e?new Uint8ClampedArray(r):t(e,r)}:t}();function createSizedArray(t){return Array.apply(null,{length:t})}function _typeof$6(t){return _typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$6(t)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),_shouldRoundValues=!1,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};function ProjectInterface$1(){return{}}!function(){var t,e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],r=e.length;for(t=0;t<r;t+=1)BMMath[e[t]]=Math[e[t]]}(),BMMath.random=Math.random,BMMath.abs=function(t){if("object"===_typeof$6(t)&&t.length){var e,r=createSizedArray(t.length),n=t.length;for(e=0;e<n;e+=1)r[e]=Math.abs(t[e]);return r}return Math.abs(t)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(t){_shouldRoundValues=!!t}function bmRnd(t){return _shouldRoundValues?Math.round(t):t}function styleDiv(t){t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.display="block",t.style.transformOrigin="0 0",t.style.webkitTransformOrigin="0 0",t.style.backfaceVisibility="visible",t.style.webkitBackfaceVisibility="visible",t.style.transformStyle="preserve-3d",t.style.webkitTransformStyle="preserve-3d",t.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(t,e,r,n){this.type=t,this.currentTime=e,this.totalTime=r,this.direction=n<0?-1:1}function BMCompleteEvent(t,e){this.type=t,this.direction=e<0?-1:1}function BMCompleteLoopEvent(t,e,r,n){this.type=t,this.currentLoop=r,this.totalLoops=e,this.direction=n<0?-1:1}function BMSegmentStartEvent(t,e,r){this.type=t,this.firstFrame=e,this.totalFrames=r}function BMDestroyEvent(t,e){this.type=t,this.target=e}function BMRenderFrameErrorEvent(t,e){this.type="renderFrameError",this.nativeError=t,this.currentTime=e}function BMConfigErrorEvent(t){this.type="configError",this.nativeError=t}function BMAnimationConfigErrorEvent(t,e){this.type=t,this.nativeError=e}var createElementID=(_count=0,function(){return idPrefix$1+"__lottie_element_"+(_count+=1)}),_count;function HSVtoRGB(t,e,r){var n,i,a,o,s,l,c,h;switch(l=r*(1-e),c=r*(1-(s=6*t-(o=Math.floor(6*t)))*e),h=r*(1-(1-s)*e),o%6){case 0:n=r,i=h,a=l;break;case 1:n=c,i=r,a=l;break;case 2:n=l,i=r,a=h;break;case 3:n=l,i=c,a=r;break;case 4:n=h,i=l,a=r;break;case 5:n=r,i=l,a=c}return[n,i,a]}function RGBtoHSV(t,e,r){var n,i=Math.max(t,e,r),a=Math.min(t,e,r),o=i-a,s=0===i?0:o/i,l=i/255;switch(i){case a:n=0;break;case t:n=e-r+o*(e<r?6:0),n/=6*o;break;case e:n=r-t+2*o,n/=6*o;break;case r:n=t-e+4*o,n/=6*o}return[n,s,l]}function addSaturationToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[1]+=e,r[1]>1?r[1]=1:r[1]<=0&&(r[1]=0),HSVtoRGB(r[0],r[1],r[2])}function addBrightnessToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[2]+=e,r[2]>1?r[2]=1:r[2]<0&&(r[2]=0),HSVtoRGB(r[0],r[1],r[2])}function addHueToRGB(t,e){var r=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return r[0]+=e/360,r[0]>1?r[0]-=1:r[0]<0&&(r[0]+=1),HSVtoRGB(r[0],r[1],r[2])}var rgbToHex=function(){var t,e,r=[];for(t=0;t<256;t+=1)e=t.toString(16),r[t]=1===e.length?"0"+e:e;return function(t,e,n){return t<0&&(t=0),e<0&&(e=0),n<0&&(n=0),"#"+r[t]+r[e]+r[n]}}(),setSubframeEnabled=function(t){subframeEnabled=!!t},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(t){expressionsPlugin=t},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(t){expressionsInterfaces=t},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(t){defaultCurveSegments=t},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(t){idPrefix$1=t},getIdPrefix=function(){return idPrefix$1};function createNS(t){return document.createElementNS(svgNS,t)}function _typeof$5(t){return _typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$5(t)}var dataManager=function(){var t,e,r=1,n=[],i={onmessage:function(){},postMessage:function(e){t({data:e})}},a={postMessage:function(t){i.onmessage({data:t})}};function o(){e||(e=function(e){if(window.Worker&&window.Blob&&getWebWorker()){var r=new Blob(["var _workerSelf = self; self.onmessage = ",e.toString()],{type:"text/javascript"}),n=URL.createObjectURL(r);return new Worker(n)}return t=e,i}((function(t){if(a.dataManager||(a.dataManager=function(){function t(i,a){var o,s,l,c,h,p,u=i.length;for(s=0;s<u;s+=1)if("ks"in(o=i[s])&&!o.completed){if(o.completed=!0,o.hasMask){var m=o.masksProperties;for(c=m.length,l=0;l<c;l+=1)if(m[l].pt.k.i)n(m[l].pt.k);else for(p=m[l].pt.k.length,h=0;h<p;h+=1)m[l].pt.k[h].s&&n(m[l].pt.k[h].s[0]),m[l].pt.k[h].e&&n(m[l].pt.k[h].e[0])}0===o.ty?(o.layers=e(o.refId,a),t(o.layers,a)):4===o.ty?r(o.shapes):5===o.ty&&d(o)}}function e(t,e){var r=function(t,e){for(var r=0,n=e.length;r<n;){if(e[r].id===t)return e[r];r+=1}return null}(t,e);return r?r.layers.__used?JSON.parse(JSON.stringify(r.layers)):(r.layers.__used=!0,r.layers):null}function r(t){var e,i,a;for(e=t.length-1;e>=0;e-=1)if("sh"===t[e].ty)if(t[e].ks.k.i)n(t[e].ks.k);else for(a=t[e].ks.k.length,i=0;i<a;i+=1)t[e].ks.k[i].s&&n(t[e].ks.k[i].s[0]),t[e].ks.k[i].e&&n(t[e].ks.k[i].e[0]);else"gr"===t[e].ty&&r(t[e].it)}function n(t){var e,r=t.i.length;for(e=0;e<r;e+=1)t.i[e][0]+=t.v[e][0],t.i[e][1]+=t.v[e][1],t.o[e][0]+=t.v[e][0],t.o[e][1]+=t.v[e][1]}function i(t,e){var r=e?e.split("."):[100,100,100];return t[0]>r[0]||!(r[0]>t[0])&&(t[1]>r[1]||!(r[1]>t[1])&&(t[2]>r[2]||!(r[2]>t[2])&&null))}var a,o=function(){var t=[4,4,14];function e(t){var e,r,n,i=t.length;for(e=0;e<i;e+=1)5===t[e].ty&&(void 0,n=(r=t[e]).t.d,r.t.d={k:[{s:n,t:0}]})}return function(r){if(i(t,r.v)&&(e(r.layers),r.assets)){var n,a=r.assets.length;for(n=0;n<a;n+=1)r.assets[n].layers&&e(r.assets[n].layers)}}}(),s=(a=[4,7,99],function(t){if(t.chars&&!i(a,t.v)){var e,n=t.chars.length;for(e=0;e<n;e+=1){var o=t.chars[e];o.data&&o.data.shapes&&(r(o.data.shapes),o.data.ip=0,o.data.op=99999,o.data.st=0,o.data.sr=1,o.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},t.chars[e].t||(o.data.shapes.push({ty:"no"}),o.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}),l=function(){var t=[5,7,15];function e(t){var e,r,n=t.length;for(e=0;e<n;e+=1)5===t[e].ty&&(r=void 0,"number"==typeof(r=t[e].t.p).a&&(r.a={a:0,k:r.a}),"number"==typeof r.p&&(r.p={a:0,k:r.p}),"number"==typeof r.r&&(r.r={a:0,k:r.r}))}return function(r){if(i(t,r.v)&&(e(r.layers),r.assets)){var n,a=r.assets.length;for(n=0;n<a;n+=1)r.assets[n].layers&&e(r.assets[n].layers)}}}(),c=function(){var t=[4,1,9];function e(t){var r,n,i,a=t.length;for(r=0;r<a;r+=1)if("gr"===t[r].ty)e(t[r].it);else if("fl"===t[r].ty||"st"===t[r].ty)if(t[r].c.k&&t[r].c.k[0].i)for(i=t[r].c.k.length,n=0;n<i;n+=1)t[r].c.k[n].s&&(t[r].c.k[n].s[0]/=255,t[r].c.k[n].s[1]/=255,t[r].c.k[n].s[2]/=255,t[r].c.k[n].s[3]/=255),t[r].c.k[n].e&&(t[r].c.k[n].e[0]/=255,t[r].c.k[n].e[1]/=255,t[r].c.k[n].e[2]/=255,t[r].c.k[n].e[3]/=255);else t[r].c.k[0]/=255,t[r].c.k[1]/=255,t[r].c.k[2]/=255,t[r].c.k[3]/=255}function r(t){var r,n=t.length;for(r=0;r<n;r+=1)4===t[r].ty&&e(t[r].shapes)}return function(e){if(i(t,e.v)&&(r(e.layers),e.assets)){var n,a=e.assets.length;for(n=0;n<a;n+=1)e.assets[n].layers&&r(e.assets[n].layers)}}}(),h=function(){var t=[4,4,18];function e(t){var r,n,i;for(r=t.length-1;r>=0;r-=1)if("sh"===t[r].ty)if(t[r].ks.k.i)t[r].ks.k.c=t[r].closed;else for(i=t[r].ks.k.length,n=0;n<i;n+=1)t[r].ks.k[n].s&&(t[r].ks.k[n].s[0].c=t[r].closed),t[r].ks.k[n].e&&(t[r].ks.k[n].e[0].c=t[r].closed);else"gr"===t[r].ty&&e(t[r].it)}function r(t){var r,n,i,a,o,s,l=t.length;for(n=0;n<l;n+=1){if((r=t[n]).hasMask){var c=r.masksProperties;for(a=c.length,i=0;i<a;i+=1)if(c[i].pt.k.i)c[i].pt.k.c=c[i].cl;else for(s=c[i].pt.k.length,o=0;o<s;o+=1)c[i].pt.k[o].s&&(c[i].pt.k[o].s[0].c=c[i].cl),c[i].pt.k[o].e&&(c[i].pt.k[o].e[0].c=c[i].cl)}4===r.ty&&e(r.shapes)}}return function(e){if(i(t,e.v)&&(r(e.layers),e.assets)){var n,a=e.assets.length;for(n=0;n<a;n+=1)e.assets[n].layers&&r(e.assets[n].layers)}}}();function d(t){0===t.t.a.length&&t.t.p}var p={completeData:function(r){r.__complete||(c(r),o(r),s(r),l(r),h(r),t(r.layers,r.assets),function(r,n){if(r){var i=0,a=r.length;for(i=0;i<a;i+=1)1===r[i].t&&(r[i].data.layers=e(r[i].data.refId,n),t(r[i].data.layers,n))}}(r.chars,r.assets),r.__complete=!0)}};return p.checkColors=c,p.checkChars=s,p.checkPathProperties=l,p.checkShapes=h,p.completeLayers=t,p}()),a.assetLoader||(a.assetLoader=function(){function t(t){var e=t.getResponseHeader("content-type");return e&&"json"===t.responseType&&-1!==e.indexOf("json")||t.response&&"object"===_typeof$5(t.response)?t.response:t.response&&"string"==typeof t.response?JSON.parse(t.response):t.responseText?JSON.parse(t.responseText):null}return{load:function(e,r,n,i){var a,o=new XMLHttpRequest;try{o.responseType="json"}catch(t){}o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)a=t(o),n(a);else try{a=t(o),n(a)}catch(t){i&&i(t)}};try{o.open(["G","E","T"].join(""),e,!0)}catch(t){o.open(["G","E","T"].join(""),r+"/"+e,!0)}o.send()}}}()),"loadAnimation"===t.data.type)a.assetLoader.load(t.data.path,t.data.fullPath,(function(e){a.dataManager.completeData(e),a.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){a.postMessage({id:t.data.id,status:"error"})}));else if("complete"===t.data.type){var e=t.data.animation;a.dataManager.completeData(e),a.postMessage({id:t.data.id,payload:e,status:"success"})}else"loadData"===t.data.type&&a.assetLoader.load(t.data.path,t.data.fullPath,(function(e){a.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){a.postMessage({id:t.data.id,status:"error"})}))})),e.onmessage=function(t){var e=t.data,r=e.id,i=n[r];n[r]=null,"success"===e.status?i.onComplete(e.payload):i.onError&&i.onError()})}function s(t,e){var i="processId_"+(r+=1);return n[i]={onComplete:t,onError:e},i}return{loadAnimation:function(t,r,n){o();var i=s(r,n);e.postMessage({type:"loadAnimation",path:t,fullPath:window.location.origin+window.location.pathname,id:i})},loadData:function(t,r,n){o();var i=s(r,n);e.postMessage({type:"loadData",path:t,fullPath:window.location.origin+window.location.pathname,id:i})},completeAnimation:function(t,r,n){o();var i=s(r,n);e.postMessage({type:"complete",animation:t,id:i})}}}(),ImagePreloader=function(){var t=function(){var t=createTag("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),t}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(t,e,r){var n="";if(t.e)n=t.p;else if(e){var i=t.p;-1!==i.indexOf("images/")&&(i=i.split("/")[1]),n=e+i}else n=r,n+=t.u?t.u:"",n+=t.p;return n}function i(t){var e=0,r=setInterval(function(){(t.getBBox().width||e>500)&&(this._imageLoaded(),clearInterval(r)),e+=1}.bind(this),50)}function a(t){var e={assetData:t},r=n(t,this.assetsPath,this.path);return dataManager.loadData(r,function(t){e.img=t,this._footageLoaded()}.bind(this),function(){e.img={},this._footageLoaded()}.bind(this)),e}function o(){this._imageLoaded=e.bind(this),this._footageLoaded=r.bind(this),this.testImageLoaded=i.bind(this),this.createFootageData=a.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return o.prototype={loadAssets:function(t,e){var r;this.imagesLoadedCb=e;var n=t.length;for(r=0;r<n;r+=1)t[r].layers||(t[r].t&&"seq"!==t[r].t?3===t[r].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(t[r]))):(this.totalImages+=1,this.images.push(this._createImageData(t[r]))))},setAssetsPath:function(t){this.assetsPath=t||""},setPath:function(t){this.path=t||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(t){for(var e=0,r=this.images.length;e<r;){if(this.images[e].assetData===t)return this.images[e].img;e+=1}return null},createImgData:function(e){var r=n(e,this.assetsPath,this.path),i=createTag("img");i.crossOrigin="anonymous",i.addEventListener("load",this._imageLoaded,!1),i.addEventListener("error",function(){a.img=t,this._imageLoaded()}.bind(this),!1),i.src=r;var a={img:i,assetData:e};return a},createImageData:function(e){var r=n(e,this.assetsPath,this.path),i=createNS("image");isSafari?this.testImageLoaded(i):i.addEventListener("load",this._imageLoaded,!1),i.addEventListener("error",function(){a.img=t,this._imageLoaded()}.bind(this),!1),i.setAttributeNS("http://www.w3.org/1999/xlink","href",r),this._elementHelper.append?this._elementHelper.append(i):this._elementHelper.appendChild(i);var a={img:i,assetData:e};return a},imageLoaded:e,footageLoaded:r,setCacheType:function(t,e){"svg"===t?(this._elementHelper=e,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},o}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(t,e){if(this._cbs[t])for(var r=this._cbs[t],n=0;n<r.length;n+=1)r[n](e)},addEventListener:function(t,e){return this._cbs[t]||(this._cbs[t]=[]),this._cbs[t].push(e),function(){this.removeEventListener(t,e)}.bind(this)},removeEventListener:function(t,e){if(e){if(this._cbs[t]){for(var r=0,n=this._cbs[t].length;r<n;)this._cbs[t][r]===e&&(this._cbs[t].splice(r,1),r-=1,n-=1),r+=1;this._cbs[t].length||(this._cbs[t]=null)}}else this._cbs[t]=null}};var markerParser=function(){function t(t){for(var e,r=t.split("\r\n"),n={},i=0,a=0;a<r.length;a+=1)2===(e=r[a].split(":")).length&&(n[e[0]]=e[1].trim(),i+=1);if(0===i)throw new Error;return n}return function(e){for(var r=[],n=0;n<e.length;n+=1){var i=e[n],a={time:i.tm,duration:i.dr};try{a.payload=JSON.parse(e[n].cm)}catch(r){try{a.payload=t(e[n].cm)}catch(t){a.payload={name:e[n].cm}}}r.push(a)}return r}}(),ProjectInterface=function(){function t(t){this.compositions.push(t)}return function(){function e(t){for(var e=0,r=this.compositions.length;e<r;){if(this.compositions[e].data&&this.compositions[e].data.nm===t)return this.compositions[e].prepareFrame&&this.compositions[e].data.xt&&this.compositions[e].prepareFrame(this.currentFrame),this.compositions[e].compInterface;e+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),renderers={},registerRenderer=function(t,e){renderers[t]=e};function getRenderer(t){return renderers[t]}function _typeof$4(t){return _typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$4(t)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(t){(t.wrapper||t.container)&&(this.wrapper=t.wrapper||t.container);var e="svg";t.animType?e=t.animType:t.renderer&&(e=t.renderer);var r=getRenderer(e);this.renderer=new r(this,t.rendererSettings),this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,""===t.loop||null===t.loop||void 0===t.loop||!0===t.loop?this.loop=!0:!1===t.loop?this.loop=!1:this.loop=parseInt(t.loop,10),this.autoplay=!("autoplay"in t)||t.autoplay,this.name=t.name?t.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(t,"autoloadSegments")||t.autoloadSegments,this.assetsPath=t.assetsPath,this.initialSegment=t.initialSegment,t.audioFactory&&this.audioController.setAudioFactory(t.audioFactory),t.animationData?this.setupAnimation(t.animationData):t.path&&(-1!==t.path.lastIndexOf("\\")?this.path=t.path.substr(0,t.path.lastIndexOf("\\")+1):this.path=t.path.substr(0,t.path.lastIndexOf("/")+1),this.fileName=t.path.substr(t.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(t.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(t){dataManager.completeAnimation(t,this.configAnimation)},AnimationItem.prototype.setData=function(t,e){e&&"object"!==_typeof$4(e)&&(e=JSON.parse(e));var r={wrapper:t,animationData:e},n=t.attributes;r.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",r.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:"canvas";var i=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";"false"===i?r.loop=!1:"true"===i?r.loop=!0:""!==i&&(r.loop=parseInt(i,10));var a=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:!n.getNamedItem("bm-autoplay")||n.getNamedItem("bm-autoplay").value;r.autoplay="false"!==a,r.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"","false"===(n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"")&&(r.prerender=!1),this.setParams(r)},AnimationItem.prototype.includeLayers=function(t){t.op>this.animationData.op&&(this.animationData.op=t.op,this.totalFrames=Math.floor(t.op-this.animationData.ip));var e,r,n=this.animationData.layers,i=n.length,a=t.layers,o=a.length;for(r=0;r<o;r+=1)for(e=0;e<i;){if(n[e].id===a[r].id){n[e]=a[r];break}e+=1}if((t.chars||t.fonts)&&(this.renderer.globalData.fontManager.addChars(t.chars),this.renderer.globalData.fontManager.addFonts(t.fonts,this.renderer.globalData.defs)),t.assets)for(i=t.assets.length,e=0;e<i;e+=1)this.animationData.assets.push(t.assets[e]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(t){this.animationData=t;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var t=this.animationData.segments;if(!t||0===t.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var e=t.shift();this.timeCompleted=e.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(r,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(t){if(this.renderer)try{this.animationData=t,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(t),t.assets||(t.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(t.assets),this.markers=markerParser(t.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var t=getExpressionsPlugin();t&&t.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(t,e){var r="number"==typeof t?t:void 0,n="number"==typeof e?e:void 0;this.renderer.updateContainerSize(r,n)},AnimationItem.prototype.setSubframe=function(t){this.isSubframeEnabled=!!t},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(t){this.triggerRenderFrameError(t)}},AnimationItem.prototype.play=function(t){t&&this.name!==t||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_pause"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(t){t&&this.name!==t||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_play"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(t){t&&this.name!==t||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(t){t&&this.name!==t||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(t){for(var e,r=0;r<this.markers.length;r+=1)if((e=this.markers[r]).payload&&e.payload.name===t)return e;return null},AnimationItem.prototype.goToAndStop=function(t,e,r){if(!r||this.name===r){var n=Number(t);if(isNaN(n)){var i=this.getMarkerData(t);i&&this.goToAndStop(i.time,!0)}else e?this.setCurrentRawFrameValue(t):this.setCurrentRawFrameValue(t*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(t,e,r){if(!r||this.name===r){var n=Number(t);if(isNaN(n)){var i=this.getMarkerData(t);i&&(i.duration?this.playSegments([i.time,i.time+i.duration],!0):this.goToAndStop(i.time,!0))}else this.goToAndStop(n,e,r);this.play()}},AnimationItem.prototype.advanceTime=function(t){if(!0!==this.isPaused&&!1!==this.isLoaded){var e=this.currentRawFrame+t*this.frameModifier,r=!1;e>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(r=!0,e=this.totalFrames-1):e<0?this.checkSegments(e%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(r=!0,e=0):(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(e),r&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(t,e){this.playCount=0,t[1]<t[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=t[0]-t[1],this.timeCompleted=this.totalFrames,this.firstFrame=t[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):t[1]>t[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=t[1]-t[0],this.timeCompleted=this.totalFrames,this.firstFrame=t[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(t,e){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<t?r=t:this.currentRawFrame+this.firstFrame>e&&(r=e-t)),this.firstFrame=t,this.totalFrames=e-t,this.timeCompleted=this.totalFrames,-1!==r&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(t,e){if(e&&(this.segments.length=0),"object"===_typeof$4(t[0])){var r,n=t.length;for(r=0;r<n;r+=1)this.segments.push(t[r])}else this.segments.push(t);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(t){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),t&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(t){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),t),!0)},AnimationItem.prototype.destroy=function(t){t&&this.name!==t||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(t){this.currentRawFrame=t,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(t){this.playSpeed=t,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(t){this.playDirection=t<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(t,e){e&&this.name!==e||this.audioController.setVolume(t)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(t){t&&this.name!==t||this.audioController.mute()},AnimationItem.prototype.unmute=function(t){t&&this.name!==t||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(t){var e="";if(t.e)e=t.p;else if(this.assetsPath){var r=t.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),e=this.assetsPath+r}else e=this.path,e+=t.u?t.u:"",e+=t.p;return e},AnimationItem.prototype.getAssetData=function(t){for(var e=0,r=this.assets.length;e<r;){if(t===this.assets[e].id)return this.assets[e];e+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(t){return t?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(t,e,r){try{this.renderer.getElementByPath(t).updateDocumentData(e,r)}catch(t){}},AnimationItem.prototype.trigger=function(t){if(this._cbs&&this._cbs[t])switch(t){case"enterFrame":this.triggerEvent(t,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(t,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(t,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(t,new BMCompleteEvent(t,this.frameMult));break;case"segmentStart":this.triggerEvent(t,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(t,new BMDestroyEvent(t,this));break;default:this.triggerEvent(t)}"enterFrame"===t&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===t&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult)),"complete"===t&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(t,this.frameMult)),"segmentStart"===t&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames)),"destroy"===t&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(t,this))},AnimationItem.prototype.triggerRenderFrameError=function(t){var e=new BMRenderFrameErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(t){var e=new BMConfigErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var animationManager=function(){var t={},e=[],r=0,n=0,i=0,a=!0,o=!1;function s(t){for(var r=0,i=t.target;r<n;)e[r].animation===i&&(e.splice(r,1),r-=1,n-=1,i.isPaused||h()),r+=1}function l(t,r){if(!t)return null;for(var i=0;i<n;){if(e[i].elem===t&&null!==e[i].elem)return e[i].animation;i+=1}var a=new AnimationItem;return d(a,t),a.setData(t,r),a}function c(){i+=1,m()}function h(){i-=1}function d(t,r){t.addEventListener("destroy",s),t.addEventListener("_active",c),t.addEventListener("_idle",h),e.push({elem:r,animation:t}),n+=1}function p(t){var s,l=t-r;for(s=0;s<n;s+=1)e[s].animation.advanceTime(l);r=t,i&&!o?window.requestAnimationFrame(p):a=!0}function u(t){r=t,window.requestAnimationFrame(p)}function m(){!o&&i&&a&&(window.requestAnimationFrame(u),a=!1)}return t.registerAnimation=l,t.loadAnimation=function(t){var e=new AnimationItem;return d(e,null),e.setParams(t),e},t.setSpeed=function(t,r){var i;for(i=0;i<n;i+=1)e[i].animation.setSpeed(t,r)},t.setDirection=function(t,r){var i;for(i=0;i<n;i+=1)e[i].animation.setDirection(t,r)},t.play=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.play(t)},t.pause=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.pause(t)},t.stop=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.stop(t)},t.togglePause=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.togglePause(t)},t.searchAnimations=function(t,e,r){var n,i=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),a=i.length;for(n=0;n<a;n+=1)r&&i[n].setAttribute("data-bm-type",r),l(i[n],t);if(e&&0===a){r||(r="svg");var o=document.getElementsByTagName("body")[0];o.innerText="";var s=createTag("div");s.style.width="100%",s.style.height="100%",s.setAttribute("data-bm-type",r),o.appendChild(s),l(s,t)}},t.resize=function(){var t;for(t=0;t<n;t+=1)e[t].animation.resize()},t.goToAndStop=function(t,r,i){var a;for(a=0;a<n;a+=1)e[a].animation.goToAndStop(t,r,i)},t.destroy=function(t){var r;for(r=n-1;r>=0;r-=1)e[r].animation.destroy(t)},t.freeze=function(){o=!0},t.unfreeze=function(){o=!1,m()},t.setVolume=function(t,r){var i;for(i=0;i<n;i+=1)e[i].animation.setVolume(t,r)},t.mute=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.mute(t)},t.unmute=function(t){var r;for(r=0;r<n;r+=1)e[r].animation.unmute(t)},t.getRegisteredAnimations=function(){var t,r=e.length,n=[];for(t=0;t<r;t+=1)n.push(e[t].animation);return n},t}(),BezierFactory=function(){var t={getBezierEasing:function(t,r,n,i,a){var o=a||("bez_"+t+"_"+r+"_"+n+"_"+i).replace(/\./g,"p");if(e[o])return e[o];var s=new c([t,r,n,i]);return e[o]=s,s}},e={},r=.1,n="function"==typeof Float32Array;function i(t,e){return 1-3*e+3*t}function a(t,e){return 3*e-6*t}function o(t){return 3*t}function s(t,e,r){return((i(e,r)*t+a(e,r))*t+o(e))*t}function l(t,e,r){return 3*i(e,r)*t*t+2*a(e,r)*t+o(e)}function c(t){this._p=t,this._mSampleValues=n?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return c.prototype={get:function(t){var e=this._p[0],r=this._p[1],n=this._p[2],i=this._p[3];return this._precomputed||this._precompute(),e===r&&n===i?t:0===t?0:1===t?1:s(this._getTForX(t),r,i)},_precompute:function(){var t=this._p[0],e=this._p[1],r=this._p[2],n=this._p[3];this._precomputed=!0,t===e&&r===n||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],n=0;n<11;++n)this._mSampleValues[n]=s(n*r,t,e)},_getTForX:function(t){for(var e=this._p[0],n=this._p[2],i=this._mSampleValues,a=0,o=1;10!==o&&i[o]<=t;++o)a+=r;var c=a+(t-i[--o])/(i[o+1]-i[o])*r,h=l(c,e,n);return h>=.001?function(t,e,r,n){for(var i=0;i<4;++i){var a=l(e,r,n);if(0===a)return e;e-=(s(e,r,n)-t)/a}return e}(t,c,e,n):0===h?c:function(t,e,r,n,i){var a,o,l=0;do{(a=s(o=e+(r-e)/2,n,i)-t)>0?r=o:e=o}while(Math.abs(a)>1e-7&&++l<10);return o}(t,a,a+r,e,n)}},t}(),pooling={double:function(t){return t.concat(createSizedArray(t.length))}},poolFactory=function(t,e,r){var n=0,i=t,a=createSizedArray(i);return{newElement:function(){return n?a[n-=1]:e()},release:function(t){n===i&&(a=pooling.double(a),i*=2),r&&r(t),a[n]=t,n+=1}}},bezierLengthPool=poolFactory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}})),segmentsLengthPool=poolFactory(8,(function(){return{lengths:[],totalLength:0}}),(function(t){var e,r=t.lengths.length;for(e=0;e<r;e+=1)bezierLengthPool.release(t.lengths[e]);t.lengths.length=0}));function bezFunction(){var t=Math;function e(t,e,r,n,i,a){var o=t*n+e*i+r*a-i*n-a*t-r*e;return o>-.001&&o<.001}var r=function(t,e,r,n){var i,a,o,s,l,c,h=getDefaultCurveSegments(),d=0,p=[],u=[],m=bezierLengthPool.newElement();for(o=r.length,i=0;i<h;i+=1){for(l=i/(h-1),c=0,a=0;a<o;a+=1)s=bmPow(1-l,3)*t[a]+3*bmPow(1-l,2)*l*r[a]+3*(1-l)*bmPow(l,2)*n[a]+bmPow(l,3)*e[a],p[a]=s,null!==u[a]&&(c+=bmPow(p[a]-u[a],2)),u[a]=p[a];c&&(d+=c=bmSqrt(c)),m.percents[i]=l,m.lengths[i]=d}return m.addedLength=d,m};function n(t){this.segmentLength=0,this.points=new Array(t)}function i(t,e){this.partialLength=t,this.point=e}var a,o=(a={},function(t,r,o,s){var l=(t[0]+"_"+t[1]+"_"+r[0]+"_"+r[1]+"_"+o[0]+"_"+o[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!a[l]){var c,h,d,p,u,m,f,g=getDefaultCurveSegments(),v=0,b=null;2===t.length&&(t[0]!==r[0]||t[1]!==r[1])&&e(t[0],t[1],r[0],r[1],t[0]+o[0],t[1]+o[1])&&e(t[0],t[1],r[0],r[1],r[0]+s[0],r[1]+s[1])&&(g=2);var y=new n(g);for(d=o.length,c=0;c<g;c+=1){for(f=createSizedArray(d),u=c/(g-1),m=0,h=0;h<d;h+=1)p=bmPow(1-u,3)*t[h]+3*bmPow(1-u,2)*u*(t[h]+o[h])+3*(1-u)*bmPow(u,2)*(r[h]+s[h])+bmPow(u,3)*r[h],f[h]=p,null!==b&&(m+=bmPow(f[h]-b[h],2));v+=m=bmSqrt(m),y.points[c]=new i(m,f),b=f}y.segmentLength=v,a[l]=y}return a[l]});function s(t,e){var r=e.percents,n=e.lengths,i=r.length,a=bmFloor((i-1)*t),o=t*e.addedLength,s=0;if(a===i-1||0===a||o===n[a])return r[a];for(var l=n[a]>o?-1:1,c=!0;c;)if(n[a]<=o&&n[a+1]>o?(s=(o-n[a])/(n[a+1]-n[a]),c=!1):a+=l,a<0||a>=i-1){if(a===i-1)return r[a];c=!1}return r[a]+(r[a+1]-r[a])*s}var l=createTypedArray("float32",8);return{getSegmentsLength:function(t){var e,n=segmentsLengthPool.newElement(),i=t.c,a=t.v,o=t.o,s=t.i,l=t._length,c=n.lengths,h=0;for(e=0;e<l-1;e+=1)c[e]=r(a[e],a[e+1],o[e],s[e+1]),h+=c[e].addedLength;return i&&l&&(c[e]=r(a[e],a[0],o[e],s[0]),h+=c[e].addedLength),n.totalLength=h,n},getNewSegment:function(e,r,n,i,a,o,c){a<0?a=0:a>1&&(a=1);var h,d=s(a,c),p=s(o=o>1?1:o,c),u=e.length,m=1-d,f=1-p,g=m*m*m,v=d*m*m*3,b=d*d*m*3,y=d*d*d,x=m*m*f,_=d*m*f+m*d*f+m*m*p,w=d*d*f+m*d*p+d*m*p,S=d*d*p,E=m*f*f,M=d*f*f+m*p*f+m*f*p,A=d*p*f+m*p*p+d*f*p,T=d*p*p,P=f*f*f,C=p*f*f+f*p*f+f*f*p,k=p*p*f+f*p*p+p*f*p,D=p*p*p;for(h=0;h<u;h+=1)l[4*h]=t.round(1e3*(g*e[h]+v*n[h]+b*i[h]+y*r[h]))/1e3,l[4*h+1]=t.round(1e3*(x*e[h]+_*n[h]+w*i[h]+S*r[h]))/1e3,l[4*h+2]=t.round(1e3*(E*e[h]+M*n[h]+A*i[h]+T*r[h]))/1e3,l[4*h+3]=t.round(1e3*(P*e[h]+C*n[h]+k*i[h]+D*r[h]))/1e3;return l},getPointInSegment:function(e,r,n,i,a,o){var l=s(a,o),c=1-l;return[t.round(1e3*(c*c*c*e[0]+(l*c*c+c*l*c+c*c*l)*n[0]+(l*l*c+c*l*l+l*c*l)*i[0]+l*l*l*r[0]))/1e3,t.round(1e3*(c*c*c*e[1]+(l*c*c+c*l*c+c*c*l)*n[1]+(l*l*c+c*l*l+l*c*l)*i[1]+l*l*l*r[1]))/1e3]},buildBezierData:o,pointOnLine2D:e,pointOnLine3D:function(r,n,i,a,o,s,l,c,h){if(0===i&&0===s&&0===h)return e(r,n,a,o,l,c);var d,p=t.sqrt(t.pow(a-r,2)+t.pow(o-n,2)+t.pow(s-i,2)),u=t.sqrt(t.pow(l-r,2)+t.pow(c-n,2)+t.pow(h-i,2)),m=t.sqrt(t.pow(l-a,2)+t.pow(c-o,2)+t.pow(h-s,2));return(d=p>u?p>m?p-u-m:m-u-p:m>u?m-u-p:u-p-m)>-1e-4&&d<1e-4}}}var bez=bezFunction(),PropertyFactory=function(){var t=initialDefaultFrame,e=Math.abs;function r(t,e){var r,i=this.offsetTime;"multidimensional"===this.propType&&(r=createTypedArray("float32",this.pv.length));for(var a,o,s,l,c,h,d,p,u,m=e.lastIndex,f=m,g=this.keyframes.length-1,v=!0;v;){if(a=this.keyframes[f],o=this.keyframes[f+1],f===g-1&&t>=o.t-i){a.h&&(a=o),m=0;break}if(o.t-i>t){m=f;break}f<g-1?f+=1:(m=0,v=!1)}s=this.keyframesMetadata[f]||{};var b,y,x,_,w,S,E,M,A,T,P=o.t-i,C=a.t-i;if(a.to){s.bezierData||(s.bezierData=bez.buildBezierData(a.s,o.s||a.e,a.to,a.ti));var k=s.bezierData;if(t>=P||t<C){var D=t>=P?k.points.length-1:0;for(c=k.points[D].point.length,l=0;l<c;l+=1)r[l]=k.points[D].point[l]}else{s.__fnct?u=s.__fnct:(u=BezierFactory.getBezierEasing(a.o.x,a.o.y,a.i.x,a.i.y,a.n).get,s.__fnct=u),h=u((t-C)/(P-C));var L,R=k.segmentLength*h,O=e.lastFrame<t&&e._lastKeyframeIndex===f?e._lastAddedLength:0;for(p=e.lastFrame<t&&e._lastKeyframeIndex===f?e._lastPoint:0,v=!0,d=k.points.length;v;){if(O+=k.points[p].partialLength,0===R||0===h||p===k.points.length-1){for(c=k.points[p].point.length,l=0;l<c;l+=1)r[l]=k.points[p].point[l];break}if(R>=O&&R<O+k.points[p+1].partialLength){for(L=(R-O)/k.points[p+1].partialLength,c=k.points[p].point.length,l=0;l<c;l+=1)r[l]=k.points[p].point[l]+(k.points[p+1].point[l]-k.points[p].point[l])*L;break}p<d-1?p+=1:v=!1}e._lastPoint=p,e._lastAddedLength=O-k.points[p].partialLength,e._lastKeyframeIndex=f}}else{var I,N,z,F,U;if(g=a.s.length,b=o.s||a.e,this.sh&&1!==a.h)if(t>=P)r[0]=b[0],r[1]=b[1],r[2]=b[2];else if(t<=C)r[0]=a.s[0],r[1]=a.s[1],r[2]=a.s[2];else{y=r,x=function(t,e,r){var n,i,a,o,s,l=[],c=t[0],h=t[1],d=t[2],p=t[3],u=e[0],m=e[1],f=e[2],g=e[3];return(i=c*u+h*m+d*f+p*g)<0&&(i=-i,u=-u,m=-m,f=-f,g=-g),1-i>1e-6?(n=Math.acos(i),a=Math.sin(n),o=Math.sin((1-r)*n)/a,s=Math.sin(r*n)/a):(o=1-r,s=r),l[0]=o*c+s*u,l[1]=o*h+s*m,l[2]=o*d+s*f,l[3]=o*p+s*g,l}(n(a.s),n(b),(t-C)/(P-C)),_=x[0],w=x[1],S=x[2],E=x[3],M=Math.atan2(2*w*E-2*_*S,1-2*w*w-2*S*S),A=Math.asin(2*_*w+2*S*E),T=Math.atan2(2*_*E-2*w*S,1-2*_*_-2*S*S),y[0]=M/degToRads,y[1]=A/degToRads,y[2]=T/degToRads}else for(f=0;f<g;f+=1)1!==a.h&&(t>=P?h=1:t<C?h=0:(a.o.x.constructor===Array?(s.__fnct||(s.__fnct=[]),s.__fnct[f]?u=s.__fnct[f]:(I=void 0===a.o.x[f]?a.o.x[0]:a.o.x[f],N=void 0===a.o.y[f]?a.o.y[0]:a.o.y[f],z=void 0===a.i.x[f]?a.i.x[0]:a.i.x[f],F=void 0===a.i.y[f]?a.i.y[0]:a.i.y[f],u=BezierFactory.getBezierEasing(I,N,z,F).get,s.__fnct[f]=u)):s.__fnct?u=s.__fnct:(I=a.o.x,N=a.o.y,z=a.i.x,F=a.i.y,u=BezierFactory.getBezierEasing(I,N,z,F).get,a.keyframeMetadata=u),h=u((t-C)/(P-C)))),b=o.s||a.e,U=1===a.h?a.s[f]:a.s[f]+(b[f]-a.s[f])*h,"multidimensional"===this.propType?r[f]=U:r=U}return e.lastIndex=m,r}function n(t){var e=t[0]*degToRads,r=t[1]*degToRads,n=t[2]*degToRads,i=Math.cos(e/2),a=Math.cos(r/2),o=Math.cos(n/2),s=Math.sin(e/2),l=Math.sin(r/2),c=Math.sin(n/2);return[s*l*o+i*a*c,s*a*o+i*l*c,i*l*o-s*a*c,i*a*o-s*l*c]}function i(){var e=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||this._caching.lastFrame!==t&&(this._caching.lastFrame>=n&&e>=n||this._caching.lastFrame<r&&e<r))){this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var i=this.interpolateValue(e,this._caching);this.pv=i}return this._caching.lastFrame=e,this.pv}function a(t){var r;if("unidimensional"===this.propType)r=t*this.mult,e(this.v-r)>1e-5&&(this.v=r,this._mdf=!0);else for(var n=0,i=this.v.length;n<i;)r=t[n]*this.mult,e(this.v[n]-r)>1e-5&&(this.v[n]=r,this._mdf=!0),n+=1}function o(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t;this.lock=!0,this._mdf=this._isFirstFrame;var e=this.effectsSequence.length,r=this.kf?this.pv:this.data.k;for(t=0;t<e;t+=1)r=this.effectsSequence[t](r);this.setVValue(r),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function s(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function l(t,e,r,n){this.propType="unidimensional",this.mult=r||1,this.data=e,this.v=r?e.k*r:e.k,this.pv=e.k,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=o,this.setVValue=a,this.addEffect=s}function c(t,e,r,n){var i;this.propType="multidimensional",this.mult=r||1,this.data=e,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.frameId=-1;var l=e.k.length;for(this.v=createTypedArray("float32",l),this.pv=createTypedArray("float32",l),this.vel=createTypedArray("float32",l),i=0;i<l;i+=1)this.v[i]=e.k[i]*this.mult,this.pv[i]=e.k[i];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=o,this.setVValue=a,this.addEffect=s}function h(e,n,l,c){this.propType="unidimensional",this.keyframes=n.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:t,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=n,this.mult=l||1,this.elem=e,this.container=c,this.comp=e.comp,this.v=t,this.pv=t,this._isFirstFrame=!0,this.getValue=o,this.setVValue=a,this.interpolateValue=r,this.effectsSequence=[i.bind(this)],this.addEffect=s}function d(e,n,l,c){var h;this.propType="multidimensional";var d,p,u,m,f=n.k.length;for(h=0;h<f-1;h+=1)n.k[h].to&&n.k[h].s&&n.k[h+1]&&n.k[h+1].s&&(d=n.k[h].s,p=n.k[h+1].s,u=n.k[h].to,m=n.k[h].ti,(2===d.length&&(d[0]!==p[0]||d[1]!==p[1])&&bez.pointOnLine2D(d[0],d[1],p[0],p[1],d[0]+u[0],d[1]+u[1])&&bez.pointOnLine2D(d[0],d[1],p[0],p[1],p[0]+m[0],p[1]+m[1])||3===d.length&&(d[0]!==p[0]||d[1]!==p[1]||d[2]!==p[2])&&bez.pointOnLine3D(d[0],d[1],d[2],p[0],p[1],p[2],d[0]+u[0],d[1]+u[1],d[2]+u[2])&&bez.pointOnLine3D(d[0],d[1],d[2],p[0],p[1],p[2],p[0]+m[0],p[1]+m[1],p[2]+m[2]))&&(n.k[h].to=null,n.k[h].ti=null),d[0]===p[0]&&d[1]===p[1]&&0===u[0]&&0===u[1]&&0===m[0]&&0===m[1]&&(2===d.length||d[2]===p[2]&&0===u[2]&&0===m[2])&&(n.k[h].to=null,n.k[h].ti=null));this.effectsSequence=[i.bind(this)],this.data=n,this.keyframes=n.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=l||1,this.elem=e,this.container=c,this.comp=e.comp,this.getValue=o,this.setVValue=a,this.interpolateValue=r,this.frameId=-1;var g=n.k[0].s.length;for(this.v=createTypedArray("float32",g),this.pv=createTypedArray("float32",g),h=0;h<g;h+=1)this.v[h]=t,this.pv[h]=t;this._caching={lastFrame:t,lastIndex:0,value:createTypedArray("float32",g)},this.addEffect=s}var p={getProp:function(t,e,r,n,i){var a;if(e.k.length)if("number"==typeof e.k[0])a=new c(t,e,n,i);else switch(r){case 0:a=new h(t,e,n,i);break;case 1:a=new d(t,e,n,i)}else a=new l(t,e,n,i);return a.effectsSequence.length&&i.addDynamicProperty(a),a}};return p}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&(this.dynamicProperties.push(t),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var t;this._mdf=!1;var e=this.dynamicProperties.length;for(t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(t){this.container=t,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,(function(){return createTypedArray("float32",2)}));function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var r=0;r<e;)this.v[r]=pointPool.newElement(),this.o[r]=pointPool.newElement(),this.i[r]=pointPool.newElement(),r+=1},ShapePath.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(t,e,r,n,i){var a;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":a=this.v;break;case"i":a=this.i;break;case"o":a=this.o;break;default:a=[]}(!a[n]||a[n]&&!i)&&(a[n]=pointPool.newElement()),a[n][0]=t,a[n][1]=e},ShapePath.prototype.setTripleAt=function(t,e,r,n,i,a,o,s){this.setXYAt(t,e,"v",o,s),this.setXYAt(r,n,"o",o,s),this.setXYAt(i,a,"i",o,s)},ShapePath.prototype.reverse=function(){var t=new ShapePath;t.setPathData(this.c,this._length);var e=this.v,r=this.o,n=this.i,i=0;this.c&&(t.setTripleAt(e[0][0],e[0][1],n[0][0],n[0][1],r[0][0],r[0][1],0,!1),i=1);var a,o=this._length-1,s=this._length;for(a=i;a<s;a+=1)t.setTripleAt(e[o][0],e[o][1],n[o][0],n[o][1],r[o][0],r[o][1],a,!1),o-=1;return t},ShapePath.prototype.length=function(){return this._length};var shapePool=(factory=poolFactory(4,(function(){return new ShapePath}),(function(t){var e,r=t._length;for(e=0;e<r;e+=1)pointPool.release(t.v[e]),pointPool.release(t.i[e]),pointPool.release(t.o[e]),t.v[e]=null,t.i[e]=null,t.o[e]=null;t._length=0,t.c=!1})),factory.clone=function(t){var e,r=factory.newElement(),n=void 0===t._length?t.v.length:t._length;for(r.setLength(n),r.c=t.c,e=0;e<n;e+=1)r.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return r},factory),factory;function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(t){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=t,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var t;for(t=0;t<this._length;t+=1)shapePool.release(this.shapes[t]);this._length=0};var shapeCollectionPool=(ob={newShapeCollection:function(){return _length?pool[_length-=1]:new ShapeCollection},release:function(t){var e,r=t._length;for(e=0;e<r;e+=1)shapePool.release(t.shapes[e]);t._length=0,_length===_maxLength&&(pool=pooling.double(pool),_maxLength*=2),pool[_length]=t,_length+=1}},_length=0,_maxLength=4,pool=createSizedArray(_maxLength),ob),ob,_length,_maxLength,pool,ShapePropertyFactory=function(){var t=-999999;function e(t,e,r){var n,i,a,o,s,l,c,h,d,p=r.lastIndex,u=this.keyframes;if(t<u[0].t-this.offsetTime)n=u[0].s[0],a=!0,p=0;else if(t>=u[u.length-1].t-this.offsetTime)n=u[u.length-1].s?u[u.length-1].s[0]:u[u.length-2].e[0],a=!0;else{for(var m,f,g,v=p,b=u.length-1,y=!0;y&&(m=u[v],!((f=u[v+1]).t-this.offsetTime>t));)v<b-1?v+=1:y=!1;if(g=this.keyframesMetadata[v]||{},p=v,!(a=1===m.h)){if(t>=f.t-this.offsetTime)h=1;else if(t<m.t-this.offsetTime)h=0;else{var x;g.__fnct?x=g.__fnct:(x=BezierFactory.getBezierEasing(m.o.x,m.o.y,m.i.x,m.i.y).get,g.__fnct=x),h=x((t-(m.t-this.offsetTime))/(f.t-this.offsetTime-(m.t-this.offsetTime)))}i=f.s?f.s[0]:m.e[0]}n=m.s[0]}for(l=e._length,c=n.i[0].length,r.lastIndex=p,o=0;o<l;o+=1)for(s=0;s<c;s+=1)d=a?n.i[o][s]:n.i[o][s]+(i.i[o][s]-n.i[o][s])*h,e.i[o][s]=d,d=a?n.o[o][s]:n.o[o][s]+(i.o[o][s]-n.o[o][s])*h,e.o[o][s]=d,d=a?n.v[o][s]:n.v[o][s]+(i.v[o][s]-n.v[o][s])*h,e.v[o][s]=d}function r(){var e=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime,i=this._caching.lastFrame;return i!==t&&(i<r&&e<r||i>n&&e>n)||(this._caching.lastIndex=i<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}function n(){this.paths=this.localShapeCollection}function i(t){(function(t,e){if(t._length!==e._length||t.c!==e.c)return!1;var r,n=t._length;for(r=0;r<n;r+=1)if(t.v[r][0]!==e.v[r][0]||t.v[r][1]!==e.v[r][1]||t.o[r][0]!==e.o[r][0]||t.o[r][1]!==e.o[r][1]||t.i[r][0]!==e.i[r][0]||t.i[r][1]!==e.i[r][1])return!1;return!0})(this.v,t)||(this.v=shapePool.clone(t),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function a(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t,e;this.lock=!0,this._mdf=!1,t=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var r=this.effectsSequence.length;for(e=0;e<r;e+=1)t=this.effectsSequence[e](t);this.setVValue(t),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function o(t,e,r){this.propType="shape",this.comp=t.comp,this.container=t,this.elem=t,this.data=e,this.k=!1,this.kf=!1,this._mdf=!1;var i=3===r?e.pt.k:e.ks.k;this.v=shapePool.clone(i),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=n,this.effectsSequence=[]}function s(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function l(e,i,a){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=3===a?i.pt.k:i.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var o=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,o),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=t,this.reset=n,this._caching={lastFrame:t,lastIndex:0},this.effectsSequence=[r.bind(this)]}o.prototype.interpolateShape=e,o.prototype.getValue=a,o.prototype.setVValue=i,o.prototype.addEffect=s,l.prototype.getValue=a,l.prototype.interpolateShape=e,l.prototype.setVValue=i,l.prototype.addEffect=s;var c=function(){var t=roundCorner;function e(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=e.d,this.elem=t,this.comp=t.comp,this.frameId=-1,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],r=this.p.v[1],n=this.s.v[0]/2,i=this.s.v[1]/2,a=3!==this.d,o=this.v;o.v[0][0]=e,o.v[0][1]=r-i,o.v[1][0]=a?e+n:e-n,o.v[1][1]=r,o.v[2][0]=e,o.v[2][1]=r+i,o.v[3][0]=a?e-n:e+n,o.v[3][1]=r,o.i[0][0]=a?e-n*t:e+n*t,o.i[0][1]=r-i,o.i[1][0]=a?e+n:e-n,o.i[1][1]=r-i*t,o.i[2][0]=a?e+n*t:e-n*t,o.i[2][1]=r+i,o.i[3][0]=a?e-n:e+n,o.i[3][1]=r+i*t,o.o[0][0]=a?e+n*t:e-n*t,o.o[0][1]=r-i,o.o[1][0]=a?e+n:e-n,o.o[1][1]=r+i*t,o.o[2][0]=a?e-n*t:e+n*t,o.o[2][1]=r+i,o.o[3][0]=a?e-n:e+n,o.o[3][1]=r-i*t}},extendPrototype([DynamicPropertyContainer],e),e}(),h=function(){function t(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=t,this.comp=t.comp,this.data=e,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),1===e.sy?(this.ir=PropertyFactory.getProp(t,e.ir,0,0,this),this.is=PropertyFactory.getProp(t,e.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(t,e.pt,0,0,this),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,degToRads,this),this.or=PropertyFactory.getProp(t,e.or,0,0,this),this.os=PropertyFactory.getProp(t,e.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return t.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var t,e,r,n,i=2*Math.floor(this.pt.v),a=2*Math.PI/i,o=!0,s=this.or.v,l=this.ir.v,c=this.os.v,h=this.is.v,d=2*Math.PI*s/(2*i),p=2*Math.PI*l/(2*i),u=-Math.PI/2;u+=this.r.v;var m=3===this.data.d?-1:1;for(this.v._length=0,t=0;t<i;t+=1){r=o?c:h,n=o?d:p;var f=(e=o?s:l)*Math.cos(u),g=e*Math.sin(u),v=0===f&&0===g?0:g/Math.sqrt(f*f+g*g),b=0===f&&0===g?0:-f/Math.sqrt(f*f+g*g);f+=+this.p.v[0],g+=+this.p.v[1],this.v.setTripleAt(f,g,f-v*n*r*m,g-b*n*r*m,f+v*n*r*m,g+b*n*r*m,t,!0),o=!o,u+=a*m}},convertPolygonToPath:function(){var t,e=Math.floor(this.pt.v),r=2*Math.PI/e,n=this.or.v,i=this.os.v,a=2*Math.PI*n/(4*e),o=.5*-Math.PI,s=3===this.data.d?-1:1;for(o+=this.r.v,this.v._length=0,t=0;t<e;t+=1){var l=n*Math.cos(o),c=n*Math.sin(o),h=0===l&&0===c?0:c/Math.sqrt(l*l+c*c),d=0===l&&0===c?0:-l/Math.sqrt(l*l+c*c);l+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(l,c,l-h*a*i*s,c-d*a*i*s,l+h*a*i*s,c+d*a*i*s,t,!0),o+=r*s}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],t),t}(),d=function(){function t(t,e){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=t,this.comp=t.comp,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return t.prototype={convertRectToPath:function(){var t=this.p.v[0],e=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,i=bmMin(r,n,this.r.v),a=i*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(t+r,e-n+i,t+r,e-n+i,t+r,e-n+a,0,!0),this.v.setTripleAt(t+r,e+n-i,t+r,e+n-a,t+r,e+n-i,1,!0),0!==i?(this.v.setTripleAt(t+r-i,e+n,t+r-i,e+n,t+r-a,e+n,2,!0),this.v.setTripleAt(t-r+i,e+n,t-r+a,e+n,t-r+i,e+n,3,!0),this.v.setTripleAt(t-r,e+n-i,t-r,e+n-i,t-r,e+n-a,4,!0),this.v.setTripleAt(t-r,e-n+i,t-r,e-n+a,t-r,e-n+i,5,!0),this.v.setTripleAt(t-r+i,e-n,t-r+i,e-n,t-r+a,e-n,6,!0),this.v.setTripleAt(t+r-i,e-n,t+r-a,e-n,t+r-i,e-n,7,!0)):(this.v.setTripleAt(t-r,e+n,t-r+a,e+n,t-r,e+n,2),this.v.setTripleAt(t-r,e-n,t-r,e-n+a,t-r,e-n,3))):(this.v.setTripleAt(t+r,e-n+i,t+r,e-n+a,t+r,e-n+i,0,!0),0!==i?(this.v.setTripleAt(t+r-i,e-n,t+r-i,e-n,t+r-a,e-n,1,!0),this.v.setTripleAt(t-r+i,e-n,t-r+a,e-n,t-r+i,e-n,2,!0),this.v.setTripleAt(t-r,e-n+i,t-r,e-n+i,t-r,e-n+a,3,!0),this.v.setTripleAt(t-r,e+n-i,t-r,e+n-a,t-r,e+n-i,4,!0),this.v.setTripleAt(t-r+i,e+n,t-r+i,e+n,t-r+a,e+n,5,!0),this.v.setTripleAt(t+r-i,e+n,t+r-a,e+n,t+r-i,e+n,6,!0),this.v.setTripleAt(t+r,e+n-i,t+r,e+n-i,t+r,e+n-a,7,!0)):(this.v.setTripleAt(t-r,e-n,t-r+a,e-n,t-r,e-n,1,!0),this.v.setTripleAt(t-r,e+n,t-r,e+n-a,t-r,e+n,2,!0),this.v.setTripleAt(t+r,e+n,t+r-a,e+n,t+r,e+n,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:n},extendPrototype([DynamicPropertyContainer],t),t}(),p={getShapeProp:function(t,e,r){var n;return 3===r||4===r?n=(3===r?e.pt:e.ks).k.length?new l(t,e,r):new o(t,e,r):5===r?n=new d(t,e):6===r?n=new c(t,e):7===r&&(n=new h(t,e)),n.k&&t.addDynamicProperty(n),n},getConstructorFunction:function(){return o},getKeyframedConstructorFunction:function(){return l}};return p}(),Matrix=function(){var t=Math.cos,e=Math.sin,r=Math.tan,n=Math.round;function i(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function a(r){if(0===r)return this;var n=t(r),i=e(r);return this._t(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1)}function o(r){if(0===r)return this;var n=t(r),i=e(r);return this._t(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1)}function s(r){if(0===r)return this;var n=t(r),i=e(r);return this._t(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1)}function l(r){if(0===r)return this;var n=t(r),i=e(r);return this._t(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1)}function c(t,e){return this._t(1,e,t,1,0,0)}function h(t,e){return this.shear(r(t),r(e))}function d(n,i){var a=t(i),o=e(i);return this._t(a,o,0,0,-o,a,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,r(n),1,0,0,0,0,1,0,0,0,0,1)._t(a,-o,0,0,o,a,0,0,0,0,1,0,0,0,0,1)}function p(t,e,r){return r||0===r||(r=1),1===t&&1===e&&1===r?this:this._t(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1)}function u(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f){return this.props[0]=t,this.props[1]=e,this.props[2]=r,this.props[3]=n,this.props[4]=i,this.props[5]=a,this.props[6]=o,this.props[7]=s,this.props[8]=l,this.props[9]=c,this.props[10]=h,this.props[11]=d,this.props[12]=p,this.props[13]=u,this.props[14]=m,this.props[15]=f,this}function m(t,e,r){return r=r||0,0!==t||0!==e||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1):this}function f(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f){var g=this.props;if(1===t&&0===e&&0===r&&0===n&&0===i&&1===a&&0===o&&0===s&&0===l&&0===c&&1===h&&0===d)return g[12]=g[12]*t+g[15]*p,g[13]=g[13]*a+g[15]*u,g[14]=g[14]*h+g[15]*m,g[15]*=f,this._identityCalculated=!1,this;var v=g[0],b=g[1],y=g[2],x=g[3],_=g[4],w=g[5],S=g[6],E=g[7],M=g[8],A=g[9],T=g[10],P=g[11],C=g[12],k=g[13],D=g[14],L=g[15];return g[0]=v*t+b*i+y*l+x*p,g[1]=v*e+b*a+y*c+x*u,g[2]=v*r+b*o+y*h+x*m,g[3]=v*n+b*s+y*d+x*f,g[4]=_*t+w*i+S*l+E*p,g[5]=_*e+w*a+S*c+E*u,g[6]=_*r+w*o+S*h+E*m,g[7]=_*n+w*s+S*d+E*f,g[8]=M*t+A*i+T*l+P*p,g[9]=M*e+A*a+T*c+P*u,g[10]=M*r+A*o+T*h+P*m,g[11]=M*n+A*s+T*d+P*f,g[12]=C*t+k*i+D*l+L*p,g[13]=C*e+k*a+D*c+L*u,g[14]=C*r+k*o+D*h+L*m,g[15]=C*n+k*s+D*d+L*f,this._identityCalculated=!1,this}function g(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function v(t){for(var e=0;e<16;){if(t.props[e]!==this.props[e])return!1;e+=1}return!0}function b(t){var e;for(e=0;e<16;e+=1)t.props[e]=this.props[e];return t}function y(t){var e;for(e=0;e<16;e+=1)this.props[e]=t[e]}function x(t,e,r){return{x:t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12],y:t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13],z:t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]}}function _(t,e,r){return t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12]}function w(t,e,r){return t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13]}function S(t,e,r){return t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]}function E(){var t=this.props[0]*this.props[5]-this.props[1]*this.props[4],e=this.props[5]/t,r=-this.props[1]/t,n=-this.props[4]/t,i=this.props[0]/t,a=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/t,o=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/t,s=new Matrix;return s.props[0]=e,s.props[1]=r,s.props[4]=n,s.props[5]=i,s.props[12]=a,s.props[13]=o,s}function M(t){return this.getInverseMatrix().applyToPointArray(t[0],t[1],t[2]||0)}function A(t){var e,r=t.length,n=[];for(e=0;e<r;e+=1)n[e]=M(t[e]);return n}function T(t,e,r){var n=createTypedArray("float32",6);if(this.isIdentity())n[0]=t[0],n[1]=t[1],n[2]=e[0],n[3]=e[1],n[4]=r[0],n[5]=r[1];else{var i=this.props[0],a=this.props[1],o=this.props[4],s=this.props[5],l=this.props[12],c=this.props[13];n[0]=t[0]*i+t[1]*o+l,n[1]=t[0]*a+t[1]*s+c,n[2]=e[0]*i+e[1]*o+l,n[3]=e[0]*a+e[1]*s+c,n[4]=r[0]*i+r[1]*o+l,n[5]=r[0]*a+r[1]*s+c}return n}function P(t,e,r){return this.isIdentity()?[t,e,r]:[t*this.props[0]+e*this.props[4]+r*this.props[8]+this.props[12],t*this.props[1]+e*this.props[5]+r*this.props[9]+this.props[13],t*this.props[2]+e*this.props[6]+r*this.props[10]+this.props[14]]}function C(t,e){if(this.isIdentity())return t+","+e;var r=this.props;return Math.round(100*(t*r[0]+e*r[4]+r[12]))/100+","+Math.round(100*(t*r[1]+e*r[5]+r[13]))/100}function k(){for(var t=0,e=this.props,r="matrix3d(";t<16;)r+=n(1e4*e[t])/1e4,r+=15===t?")":",",t+=1;return r}function D(t){return t<1e-6&&t>0||t>-1e-6&&t<0?n(1e4*t)/1e4:t}function L(){var t=this.props;return"matrix("+D(t[0])+","+D(t[1])+","+D(t[4])+","+D(t[5])+","+D(t[12])+","+D(t[13])+")"}return function(){this.reset=i,this.rotate=a,this.rotateX=o,this.rotateY=s,this.rotateZ=l,this.skew=h,this.skewFromAxis=d,this.shear=c,this.scale=p,this.setTransform=u,this.translate=m,this.transform=f,this.applyToPoint=x,this.applyToX=_,this.applyToY=w,this.applyToZ=S,this.applyToPointArray=P,this.applyToTriplePoints=T,this.applyToPointStringified=C,this.toCSS=k,this.to2dCSS=L,this.clone=b,this.cloneFromProps=y,this.equals=v,this.inversePoints=A,this.inversePoint=M,this.getInverseMatrix=E,this._t=this.transform,this.isIdentity=g,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(t){return _typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$3(t)}var lottie={},standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="";function setLocation(t){setLocationHref(t)}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(t){setSubframeEnabled(t)}function setPrefix(t){setIdPrefix(t)}function loadAnimation(t){return!0===standalone&&(t.animationData=JSON.parse(animationData)),animationManager.loadAnimation(t)}function setQuality(t){if("string"==typeof t)switch(t){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(t)&&t>1&&setDefaultCurveSegments(t);getDefaultCurveSegments()>=50?roundValues(!1):roundValues(!0)}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(t,e){"expressions"===t&&setExpressionsPlugin(e)}function getFactory(t){switch(t){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(t){for(var e=queryString.split("&"),r=0;r<e.length;r+=1){var n=e[r].split("=");if(decodeURIComponent(n[0])==t)return decodeURIComponent(n[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.10.0";var queryString="";if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",renderer=getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{"object"!==_typeof$3(exports)&&(window.bodymovin=lottie)}catch(t){}var ShapeModifiers=function(){var t={},e={};return t.registerModifier=function(t,r){e[t]||(e[t]=r)},t.getModifier=function(t,r,n){return new e[t](r,n)},t}();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(t){if(!this.closed){t.sh.container.addDynamicProperty(t.sh);var e={shape:t.sh,data:t,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&t.setAsAnimated()}},ShapeModifier.prototype.init=function(t,e){this.shapes=[],this.elem=t,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(t,e){this.s=PropertyFactory.getProp(t,e.s,0,.01,this),this.e=PropertyFactory.getProp(t,e.e,0,.01,this),this.o=PropertyFactory.getProp(t,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(t){t.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(t,e,r,n,i){var a=[];e<=1?a.push({s:t,e}):t>=1?a.push({s:t-1,e:e-1}):(a.push({s:t,e:1}),a.push({s:0,e:e-1}));var o,s,l=[],c=a.length;for(o=0;o<c;o+=1){var h,d;(s=a[o]).e*i<n||s.s*i>n+r||(h=s.s*i<=n?0:(s.s*i-n)/r,d=s.e*i>=n+r?1:(s.e*i-n)/r,l.push([h,d]))}return l.length||l.push([0,0]),l},TrimModifier.prototype.releasePathsData=function(t){var e,r=t.length;for(e=0;e<r;e+=1)segmentsLengthPool.release(t[e]);return t.length=0,t},TrimModifier.prototype.processShapes=function(t){var e,r,n,i;if(this._mdf||t){var a=this.o.v%360/360;if(a<0&&(a+=1),(e=this.s.v>1?1+a:this.s.v<0?0+a:this.s.v+a)>(r=this.e.v>1?1+a:this.e.v<0?0+a:this.e.v+a)){var o=e;e=r,r=o}e=1e-4*Math.round(1e4*e),r=1e-4*Math.round(1e4*r),this.sValue=e,this.eValue=r}else e=this.sValue,r=this.eValue;var s,l,c,h,d,p=this.shapes.length,u=0;if(r===e)for(i=0;i<p;i+=1)this.shapes[i].localShapeCollection.releaseShapes(),this.shapes[i].shape._mdf=!0,this.shapes[i].shape.paths=this.shapes[i].localShapeCollection,this._mdf&&(this.shapes[i].pathsData.length=0);else if(1===r&&0===e||0===r&&1===e){if(this._mdf)for(i=0;i<p;i+=1)this.shapes[i].pathsData.length=0,this.shapes[i].shape._mdf=!0}else{var m,f,g=[];for(i=0;i<p;i+=1)if((m=this.shapes[i]).shape._mdf||this._mdf||t||2===this.m){if(l=(n=m.shape.paths)._length,d=0,!m.shape._mdf&&m.pathsData.length)d=m.totalShapeLength;else{for(c=this.releasePathsData(m.pathsData),s=0;s<l;s+=1)h=bez.getSegmentsLength(n.shapes[s]),c.push(h),d+=h.totalLength;m.totalShapeLength=d,m.pathsData=c}u+=d,m.shape._mdf=!0}else m.shape.paths=m.localShapeCollection;var v,b=e,y=r,x=0;for(i=p-1;i>=0;i-=1)if((m=this.shapes[i]).shape._mdf){for((f=m.localShapeCollection).releaseShapes(),2===this.m&&p>1?(v=this.calculateShapeEdges(e,r,m.totalShapeLength,x,u),x+=m.totalShapeLength):v=[[b,y]],l=v.length,s=0;s<l;s+=1){b=v[s][0],y=v[s][1],g.length=0,y<=1?g.push({s:m.totalShapeLength*b,e:m.totalShapeLength*y}):b>=1?g.push({s:m.totalShapeLength*(b-1),e:m.totalShapeLength*(y-1)}):(g.push({s:m.totalShapeLength*b,e:m.totalShapeLength}),g.push({s:0,e:m.totalShapeLength*(y-1)}));var _=this.addShapes(m,g[0]);if(g[0].s!==g[0].e){if(g.length>1)if(m.shape.paths.shapes[m.shape.paths._length-1].c){var w=_.pop();this.addPaths(_,f),_=this.addShapes(m,g[1],w)}else this.addPaths(_,f),_=this.addShapes(m,g[1]);this.addPaths(_,f)}}m.shape.paths=f}}},TrimModifier.prototype.addPaths=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)e.addShape(t[r])},TrimModifier.prototype.addSegment=function(t,e,r,n,i,a,o){i.setXYAt(e[0],e[1],"o",a),i.setXYAt(r[0],r[1],"i",a+1),o&&i.setXYAt(t[0],t[1],"v",a),i.setXYAt(n[0],n[1],"v",a+1)},TrimModifier.prototype.addSegmentFromArray=function(t,e,r,n){e.setXYAt(t[1],t[5],"o",r),e.setXYAt(t[2],t[6],"i",r+1),n&&e.setXYAt(t[0],t[4],"v",r),e.setXYAt(t[3],t[7],"v",r+1)},TrimModifier.prototype.addShapes=function(t,e,r){var n,i,a,o,s,l,c,h,d=t.pathsData,p=t.shape.paths.shapes,u=t.shape.paths._length,m=0,f=[],g=!0;for(r?(s=r._length,h=r._length):(r=shapePool.newElement(),s=0,h=0),f.push(r),n=0;n<u;n+=1){for(l=d[n].lengths,r.c=p[n].c,a=p[n].c?l.length:l.length+1,i=1;i<a;i+=1)if(m+(o=l[i-1]).addedLength<e.s)m+=o.addedLength,r.c=!1;else{if(m>e.e){r.c=!1;break}e.s<=m&&e.e>=m+o.addedLength?(this.addSegment(p[n].v[i-1],p[n].o[i-1],p[n].i[i],p[n].v[i],r,s,g),g=!1):(c=bez.getNewSegment(p[n].v[i-1],p[n].v[i],p[n].o[i-1],p[n].i[i],(e.s-m)/o.addedLength,(e.e-m)/o.addedLength,l[i-1]),this.addSegmentFromArray(c,r,s,g),g=!1,r.c=!1),m+=o.addedLength,s+=1}if(p[n].c&&l.length){if(o=l[i-1],m<=e.e){var v=l[i-1].addedLength;e.s<=m&&e.e>=m+v?(this.addSegment(p[n].v[i-1],p[n].o[i-1],p[n].i[0],p[n].v[0],r,s,g),g=!1):(c=bez.getNewSegment(p[n].v[i-1],p[n].v[0],p[n].o[i-1],p[n].i[0],(e.s-m)/v,(e.e-m)/v,l[i-1]),this.addSegmentFromArray(c,r,s,g),g=!1,r.c=!1)}else r.c=!1;m+=o.addedLength,s+=1}if(r._length&&(r.setXYAt(r.v[h][0],r.v[h][1],"i",h),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),m>e.e)break;n<u-1&&(r=shapePool.newElement(),g=!0,f.push(r),s=0)}return f},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(t,e){var r=e/100,n=[0,0],i=t._length,a=0;for(a=0;a<i;a+=1)n[0]+=t.v[a][0],n[1]+=t.v[a][1];n[0]/=i,n[1]/=i;var o,s,l,c,h,d,p=shapePool.newElement();for(p.c=t.c,a=0;a<i;a+=1)o=t.v[a][0]+(n[0]-t.v[a][0])*r,s=t.v[a][1]+(n[1]-t.v[a][1])*r,l=t.o[a][0]+(n[0]-t.o[a][0])*-r,c=t.o[a][1]+(n[1]-t.o[a][1])*-r,h=t.i[a][0]+(n[0]-t.i[a][0])*-r,d=t.i[a][1]+(n[1]-t.i[a][1])*-r,p.setTripleAt(o,s,l,c,h,d,a);return p},PuckerAndBloatModifier.prototype.processShapes=function(t){var e,r,n,i,a,o,s=this.shapes.length,l=this.amount.v;if(0!==l)for(r=0;r<s;r+=1){if(o=(a=this.shapes[r]).localShapeCollection,a.shape._mdf||this._mdf||t)for(o.releaseShapes(),a.shape._mdf=!0,e=a.shape.paths.shapes,i=a.shape.paths._length,n=0;n<i;n+=1)o.addShape(this.processPath(e[n],l));a.shape.paths=a.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var t=[0,0];function e(t,e,r){if(this.elem=t,this.frameId=-1,this.propType="transform",this.data=e,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||t),e.p&&e.p.s?(this.px=PropertyFactory.getProp(t,e.p.x,0,0,this),this.py=PropertyFactory.getProp(t,e.p.y,0,0,this),e.p.z&&(this.pz=PropertyFactory.getProp(t,e.p.z,0,0,this))):this.p=PropertyFactory.getProp(t,e.p||{k:[0,0,0]},1,0,this),e.rx){if(this.rx=PropertyFactory.getProp(t,e.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(t,e.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(t,e.rz,0,degToRads,this),e.or.k[0].ti){var n,i=e.or.k.length;for(n=0;n<i;n+=1)e.or.k[n].to=null,e.or.k[n].ti=null}this.or=PropertyFactory.getProp(t,e.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(t,e.r||{k:0},0,degToRads,this);e.sk&&(this.sk=PropertyFactory.getProp(t,e.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(t,e.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(t,e.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(t,e.s||{k:[100,100,100]},1,.01,this),e.o?this.o=PropertyFactory.getProp(t,e.o,0,.01,t):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return e.prototype={applyToMatrix:function(t){var e=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||e,this.a&&t.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&t.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&t.skewFromAxis(-this.sk.v,this.sa.v),this.r?t.rotate(-this.r.v):t.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?t.translate(this.px.v,this.py.v,-this.pz.v):t.translate(this.px.v,this.py.v,0):t.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(e){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||e){var r;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var n,i;if(r=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(n=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/r,0),i=this.p.getValueAtTime(this.p.keyframes[0].t/r,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(n=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/r,0),i=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/r,0)):(n=this.p.pv,i=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/r,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){n=[],i=[];var a=this.px,o=this.py;a._caching.lastFrame+a.offsetTime<=a.keyframes[0].t?(n[0]=a.getValueAtTime((a.keyframes[0].t+.01)/r,0),n[1]=o.getValueAtTime((o.keyframes[0].t+.01)/r,0),i[0]=a.getValueAtTime(a.keyframes[0].t/r,0),i[1]=o.getValueAtTime(o.keyframes[0].t/r,0)):a._caching.lastFrame+a.offsetTime>=a.keyframes[a.keyframes.length-1].t?(n[0]=a.getValueAtTime(a.keyframes[a.keyframes.length-1].t/r,0),n[1]=o.getValueAtTime(o.keyframes[o.keyframes.length-1].t/r,0),i[0]=a.getValueAtTime((a.keyframes[a.keyframes.length-1].t-.01)/r,0),i[1]=o.getValueAtTime((o.keyframes[o.keyframes.length-1].t-.01)/r,0)):(n=[a.pv,o.pv],i[0]=a.getValueAtTime((a._caching.lastFrame+a.offsetTime-.01)/r,a.offsetTime),i[1]=o.getValueAtTime((o._caching.lastFrame+o.offsetTime-.01)/r,o.offsetTime))}else n=i=t;this.v.rotate(-Math.atan2(n[1]-i[1],n[0]-i[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],e),e.prototype.addDynamicProperty=function(t){this._addDynamicProperty(t),this.elem.addDynamicProperty(t),this._isDirty=!0},e.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(t,r,n){return new e(t,r,n)}}}();function RepeaterModifier(){}function RoundCornersModifier(){}function floatEqual(t,e){return 1e5*Math.abs(t-e)<=Math.min(Math.abs(t),Math.abs(e))}function floatZero(t){return Math.abs(t)<=1e-5}function lerp(t,e,r){return t*(1-r)+e*r}function lerpPoint(t,e,r){return[lerp(t[0],e[0],r),lerp(t[1],e[1],r)]}function quadRoots(t,e,r){if(0===t)return[];var n=e*e-4*t*r;if(n<0)return[];var i=-e/(2*t);if(0===n)return[i];var a=Math.sqrt(n)/(2*t);return[i-a,i+a]}function polynomialCoefficients(t,e,r,n){return[3*e-t-3*r+n,3*t-6*e+3*r,-3*t+3*e,t]}function singlePoint(t){return new PolynomialBezier(t,t,t,t,!1)}function PolynomialBezier(t,e,r,n,i){i&&pointEqual(t,e)&&(e=lerpPoint(t,n,1/3)),i&&pointEqual(r,n)&&(r=lerpPoint(t,n,2/3));var a=polynomialCoefficients(t[0],e[0],r[0],n[0]),o=polynomialCoefficients(t[1],e[1],r[1],n[1]);this.a=[a[0],o[0]],this.b=[a[1],o[1]],this.c=[a[2],o[2]],this.d=[a[3],o[3]],this.points=[t,e,r,n]}function extrema(t,e){var r=t.points[0][e],n=t.points[t.points.length-1][e];if(r>n){var i=n;n=r,r=i}for(var a=quadRoots(3*t.a[e],2*t.b[e],t.c[e]),o=0;o<a.length;o+=1)if(a[o]>0&&a[o]<1){var s=t.point(a[o])[e];s<r?r=s:s>n&&(n=s)}return{min:r,max:n}}function intersectData(t,e,r){var n=t.boundingBox();return{cx:n.cx,cy:n.cy,width:n.width,height:n.height,bez:t,t:(e+r)/2,t1:e,t2:r}}function splitData(t){var e=t.bez.split(.5);return[intersectData(e[0],t.t1,t.t),intersectData(e[1],t.t,t.t2)]}function boxIntersect(t,e){return 2*Math.abs(t.cx-e.cx)<t.width+e.width&&2*Math.abs(t.cy-e.cy)<t.height+e.height}function intersectsImpl(t,e,r,n,i,a){if(boxIntersect(t,e))if(r>=a||t.width<=n&&t.height<=n&&e.width<=n&&e.height<=n)i.push([t.t,e.t]);else{var o=splitData(t),s=splitData(e);intersectsImpl(o[0],s[0],r+1,n,i,a),intersectsImpl(o[0],s[1],r+1,n,i,a),intersectsImpl(o[1],s[0],r+1,n,i,a),intersectsImpl(o[1],s[1],r+1,n,i,a)}}function crossProduct(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function lineIntersection(t,e,r,n){var i=[t[0],t[1],1],a=[e[0],e[1],1],o=[r[0],r[1],1],s=[n[0],n[1],1],l=crossProduct(crossProduct(i,a),crossProduct(o,s));return floatZero(l[2])?null:[l[0]/l[2],l[1]/l[2]]}function polarOffset(t,e,r){return[t[0]+Math.cos(e)*r,t[1]-Math.sin(e)*r]}function pointDistance(t,e){return Math.hypot(t[0]-e[0],t[1]-e[1])}function pointEqual(t,e){return floatEqual(t[0],e[0])&&floatEqual(t[1],e[1])}function ZigZagModifier(){}function setPoint(t,e,r,n,i,a,o){var s=r-Math.PI/2,l=r+Math.PI/2,c=e[0]+Math.cos(r)*n*i,h=e[1]-Math.sin(r)*n*i;t.setTripleAt(c,h,c+Math.cos(s)*a,h-Math.sin(s)*a,c+Math.cos(l)*o,h-Math.sin(l)*o,t.length())}function getPerpendicularVector(t,e){var r=[e[0]-t[0],e[1]-t[1]],n=.5*-Math.PI;return[Math.cos(n)*r[0]-Math.sin(n)*r[1],Math.sin(n)*r[0]+Math.cos(n)*r[1]]}function getProjectingAngle(t,e){var r=0===e?t.length()-1:e-1,n=(e+1)%t.length(),i=getPerpendicularVector(t.v[r],t.v[n]);return Math.atan2(0,1)-Math.atan2(i[1],i[0])}function zigZagCorner(t,e,r,n,i,a,o){var s=getProjectingAngle(e,r),l=e.v[r%e._length],c=e.v[0===r?e._length-1:r-1],h=e.v[(r+1)%e._length],d=2===a?Math.sqrt(Math.pow(l[0]-c[0],2)+Math.pow(l[1]-c[1],2)):0,p=2===a?Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)):0;setPoint(t,e.v[r%e._length],s,o,n,p/(2*(i+1)),d/(2*(i+1)),a)}function zigZagSegment(t,e,r,n,i,a){for(var o=0;o<n;o+=1){var s=(o+1)/(n+1),l=2===i?Math.sqrt(Math.pow(e.points[3][0]-e.points[0][0],2)+Math.pow(e.points[3][1]-e.points[0][1],2)):0,c=e.normalAngle(s);setPoint(t,e.point(s),c,a,r,l/(2*(n+1)),l/(2*(n+1)),i),a=-a}return a}function linearOffset(t,e,r){var n=Math.atan2(e[0]-t[0],e[1]-t[1]);return[polarOffset(t,n,r),polarOffset(e,n,r)]}function offsetSegment(t,e){var r,n,i,a,o,s,l;r=(l=linearOffset(t.points[0],t.points[1],e))[0],n=l[1],i=(l=linearOffset(t.points[1],t.points[2],e))[0],a=l[1],o=(l=linearOffset(t.points[2],t.points[3],e))[0],s=l[1];var c=lineIntersection(r,n,i,a);null===c&&(c=n);var h=lineIntersection(o,s,i,a);return null===h&&(h=o),new PolynomialBezier(r,c,h,s)}function joinLines(t,e,r,n,i){var a=e.points[3],o=r.points[0];if(3===n)return a;if(pointEqual(a,o))return a;if(2===n){var s=-e.tangentAngle(1),l=-r.tangentAngle(0)+Math.PI,c=lineIntersection(a,polarOffset(a,s+Math.PI/2,100),o,polarOffset(o,s+Math.PI/2,100)),h=c?pointDistance(c,a):pointDistance(a,o)/2,d=polarOffset(a,s,2*h*roundCorner);return t.setXYAt(d[0],d[1],"o",t.length()-1),d=polarOffset(o,l,2*h*roundCorner),t.setTripleAt(o[0],o[1],o[0],o[1],d[0],d[1],t.length()),o}var p=lineIntersection(pointEqual(a,e.points[2])?e.points[0]:e.points[2],a,o,pointEqual(o,r.points[1])?r.points[3]:r.points[1]);return p&&pointDistance(p,a)<i?(t.setTripleAt(p[0],p[1],p[0],p[1],p[0],p[1],t.length()),p):a}function getIntersection(t,e){var r=t.intersections(e);return r.length&&floatEqual(r[0][0],1)&&r.shift(),r.length?r[0]:null}function pruneSegmentIntersection(t,e){var r=t.slice(),n=e.slice(),i=getIntersection(t[t.length-1],e[0]);return i&&(r[t.length-1]=t[t.length-1].split(i[0])[0],n[0]=e[0].split(i[1])[1]),t.length>1&&e.length>1&&(i=getIntersection(t[0],e[e.length-1]))?[[t[0].split(i[0])[0]],[e[e.length-1].split(i[1])[1]]]:[r,n]}function pruneIntersections(t){for(var e,r=1;r<t.length;r+=1)e=pruneSegmentIntersection(t[r-1],t[r]),t[r-1]=e[0],t[r]=e[1];return t.length>1&&(e=pruneSegmentIntersection(t[t.length-1],t[0]),t[t.length-1]=e[0],t[0]=e[1]),t}function offsetSegmentSplit(t,e){var r,n,i,a,o=t.inflectionPoints();if(0===o.length)return[offsetSegment(t,e)];if(1===o.length||floatEqual(o[1],1))return r=(i=t.split(o[0]))[0],n=i[1],[offsetSegment(r,e),offsetSegment(n,e)];r=(i=t.split(o[0]))[0];var s=(o[1]-o[0])/(1-o[0]);return a=(i=i[1].split(s))[0],n=i[1],[offsetSegment(r,e),offsetSegment(a,e),offsetSegment(n,e)]}function OffsetPathModifier(){}function getFontProperties(t){for(var e=t.fStyle?t.fStyle.split(" "):[],r="normal",n="normal",i=e.length,a=0;a<i;a+=1)switch(e[a].toLowerCase()){case"italic":n="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200"}return{style:n,weight:t.fWeight||r}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(t,e.c,0,null,this),this.o=PropertyFactory.getProp(t,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(t,e.tr,this),this.so=PropertyFactory.getProp(t,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(t,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(t,e,r,n,i,a){var o=a?-1:1,s=n.s.v[0]+(1-n.s.v[0])*(1-i),l=n.s.v[1]+(1-n.s.v[1])*(1-i);t.translate(n.p.v[0]*o*i,n.p.v[1]*o*i,n.p.v[2]),e.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),e.rotate(-n.r.v*o*i),e.translate(n.a.v[0],n.a.v[1],n.a.v[2]),r.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),r.scale(a?1/s:s,a?1/l:l),r.translate(n.a.v[0],n.a.v[1],n.a.v[2])},RepeaterModifier.prototype.init=function(t,e,r,n){for(this.elem=t,this.arr=e,this.pos=r,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e[r]);r>0;)r-=1,this._elements.unshift(e[r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e]._processed=!1,"gr"===t[e].ty&&this.resetElements(t[e].it)},RepeaterModifier.prototype.cloneElements=function(t){var e=JSON.parse(JSON.stringify(t));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)t[r]._render=e,"gr"===t[r].ty&&this.changeGroupRender(t[r].it,e)},RepeaterModifier.prototype.processShapes=function(t){var e,r,n,i,a,o=!1;if(this._mdf||t){var s,l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),o=!0}for(a=0,n=0;n<=this._groups.length-1;n+=1){if(s=a<l,this._groups[n]._render=s,this.changeGroupRender(this._groups[n].it,s),!s){var h=this.elemsData[n].it,d=h[h.length-1];0!==d.transform.op.v?(d.transform.op._mdf=!0,d.transform.op.v=0):d.transform.op._mdf=!1}a+=1}this._currentCopies=l;var p=this.o.v,u=p%1,m=p>0?Math.floor(p):Math.ceil(p),f=this.pMatrix.props,g=this.rMatrix.props,v=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var b,y,x=0;if(p>0){for(;x<m;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),x+=1;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,u,!1),x+=u)}else if(p<0){for(;x>m;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),x-=1;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-u,!0),x-=u)}for(n=1===this.data.m?0:this._currentCopies-1,i=1===this.data.m?1:-1,a=this._currentCopies;a;){if(y=(r=(e=this.elemsData[n].it)[e.length-1].transform.mProps.v.props).length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(n/(this._currentCopies-1)),0!==x){for((0!==n&&1===i||n!==this._currentCopies-1&&-1===i)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]),this.matrix.transform(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]),b=0;b<y;b+=1)r[b]=this.matrix.props[b];this.matrix.reset()}else for(this.matrix.reset(),b=0;b<y;b+=1)r[b]=this.matrix.props[b];x+=1,a-=1,n+=i}}else for(a=this._currentCopies,n=0,i=1;a;)r=(e=this.elemsData[n].it)[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,a-=1,n+=i;return o},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(t,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(t,e){var r,n=shapePool.newElement();n.c=t.c;var i,a,o,s,l,c,h,d,p,u,m,f,g=t._length,v=0;for(r=0;r<g;r+=1)i=t.v[r],o=t.o[r],a=t.i[r],i[0]===o[0]&&i[1]===o[1]&&i[0]===a[0]&&i[1]===a[1]?0!==r&&r!==g-1||t.c?(s=0===r?t.v[g-1]:t.v[r-1],c=(l=Math.sqrt(Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)))?Math.min(l/2,e)/l:0,h=m=i[0]+(s[0]-i[0])*c,d=f=i[1]-(i[1]-s[1])*c,p=h-(h-i[0])*roundCorner,u=d-(d-i[1])*roundCorner,n.setTripleAt(h,d,p,u,m,f,v),v+=1,s=r===g-1?t.v[0]:t.v[r+1],c=(l=Math.sqrt(Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)))?Math.min(l/2,e)/l:0,h=p=i[0]+(s[0]-i[0])*c,d=u=i[1]+(s[1]-i[1])*c,m=h-(h-i[0])*roundCorner,f=d-(d-i[1])*roundCorner,n.setTripleAt(h,d,p,u,m,f,v),v+=1):(n.setTripleAt(i[0],i[1],o[0],o[1],a[0],a[1],v),v+=1):(n.setTripleAt(t.v[r][0],t.v[r][1],t.o[r][0],t.o[r][1],t.i[r][0],t.i[r][1],v),v+=1);return n},RoundCornersModifier.prototype.processShapes=function(t){var e,r,n,i,a,o,s=this.shapes.length,l=this.rd.v;if(0!==l)for(r=0;r<s;r+=1){if(o=(a=this.shapes[r]).localShapeCollection,a.shape._mdf||this._mdf||t)for(o.releaseShapes(),a.shape._mdf=!0,e=a.shape.paths.shapes,i=a.shape.paths._length,n=0;n<i;n+=1)o.addShape(this.processPath(e[n],l));a.shape.paths=a.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},PolynomialBezier.prototype.point=function(t){return[((this.a[0]*t+this.b[0])*t+this.c[0])*t+this.d[0],((this.a[1]*t+this.b[1])*t+this.c[1])*t+this.d[1]]},PolynomialBezier.prototype.derivative=function(t){return[(3*t*this.a[0]+2*this.b[0])*t+this.c[0],(3*t*this.a[1]+2*this.b[1])*t+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(t){var e=this.derivative(t);return Math.atan2(e[1],e[0])},PolynomialBezier.prototype.normalAngle=function(t){var e=this.derivative(t);return Math.atan2(e[0],e[1])},PolynomialBezier.prototype.inflectionPoints=function(){var t=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(t))return[];var e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/t,r=e*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/t;if(r<0)return[];var n=Math.sqrt(r);return floatZero(n)?n>0&&n<1?[e]:[]:[e-n,e+n].filter((function(t){return t>0&&t<1}))},PolynomialBezier.prototype.split=function(t){if(t<=0)return[singlePoint(this.points[0]),this];if(t>=1)return[this,singlePoint(this.points[this.points.length-1])];var e=lerpPoint(this.points[0],this.points[1],t),r=lerpPoint(this.points[1],this.points[2],t),n=lerpPoint(this.points[2],this.points[3],t),i=lerpPoint(e,r,t),a=lerpPoint(r,n,t),o=lerpPoint(i,a,t);return[new PolynomialBezier(this.points[0],e,i,o,!0),new PolynomialBezier(o,a,n,this.points[3],!0)]},PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var t=this.bounds();return{left:t.x.min,right:t.x.max,top:t.y.min,bottom:t.y.max,width:t.x.max-t.x.min,height:t.y.max-t.y.min,cx:(t.x.max+t.x.min)/2,cy:(t.y.max+t.y.min)/2}},PolynomialBezier.prototype.intersections=function(t,e,r){void 0===e&&(e=2),void 0===r&&(r=7);var n=[];return intersectsImpl(intersectData(this,0,1),intersectData(t,0,1),0,e,n,r),n},PolynomialBezier.shapeSegment=function(t,e){var r=(e+1)%t.length();return new PolynomialBezier(t.v[e],t.o[e],t.i[r],t.v[r],!0)},PolynomialBezier.shapeSegmentInverted=function(t,e){var r=(e+1)%t.length();return new PolynomialBezier(t.v[r],t.i[r],t.o[e],t.v[e],!0)},extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(t,e.s,0,null,this),this.frequency=PropertyFactory.getProp(t,e.r,0,null,this),this.pointsType=PropertyFactory.getProp(t,e.pt,0,null,this),this._isAnimated=0!==this.amplitude.effectsSequence.length||0!==this.frequency.effectsSequence.length||0!==this.pointsType.effectsSequence.length},ZigZagModifier.prototype.processPath=function(t,e,r,n){var i=t._length,a=shapePool.newElement();if(a.c=t.c,t.c||(i-=1),0===i)return a;var o=-1,s=PolynomialBezier.shapeSegment(t,0);zigZagCorner(a,t,0,e,r,n,o);for(var l=0;l<i;l+=1)o=zigZagSegment(a,s,e,r,n,-o),s=l!==i-1||t.c?PolynomialBezier.shapeSegment(t,(l+1)%i):null,zigZagCorner(a,t,l+1,e,r,n,o);return a},ZigZagModifier.prototype.processShapes=function(t){var e,r,n,i,a,o,s=this.shapes.length,l=this.amplitude.v,c=Math.max(0,Math.round(this.frequency.v)),h=this.pointsType.v;if(0!==l)for(r=0;r<s;r+=1){if(o=(a=this.shapes[r]).localShapeCollection,a.shape._mdf||this._mdf||t)for(o.releaseShapes(),a.shape._mdf=!0,e=a.shape.paths.shapes,i=a.shape.paths._length,n=0;n<i;n+=1)o.addShape(this.processPath(e[n],l,c,h));a.shape.paths=a.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this.miterLimit=PropertyFactory.getProp(t,e.ml,0,null,this),this.lineJoin=e.lj,this._isAnimated=0!==this.amount.effectsSequence.length},OffsetPathModifier.prototype.processPath=function(t,e,r,n){var i=shapePool.newElement();i.c=t.c;var a,o,s,l=t.length();t.c||(l-=1);var c=[];for(a=0;a<l;a+=1)s=PolynomialBezier.shapeSegment(t,a),c.push(offsetSegmentSplit(s,e));if(!t.c)for(a=l-1;a>=0;a-=1)s=PolynomialBezier.shapeSegmentInverted(t,a),c.push(offsetSegmentSplit(s,e));c=pruneIntersections(c);var h=null,d=null;for(a=0;a<c.length;a+=1){var p=c[a];for(d&&(h=joinLines(i,d,p[0],r,n)),d=p[p.length-1],o=0;o<p.length;o+=1)s=p[o],h&&pointEqual(s.points[0],h)?i.setXYAt(s.points[1][0],s.points[1][1],"o",i.length()-1):i.setTripleAt(s.points[0][0],s.points[0][1],s.points[1][0],s.points[1][1],s.points[0][0],s.points[0][1],i.length()),i.setTripleAt(s.points[3][0],s.points[3][1],s.points[3][0],s.points[3][1],s.points[2][0],s.points[2][1],i.length()),h=s.points[3]}return c.length&&joinLines(i,d,c[0][0],r,n),i},OffsetPathModifier.prototype.processShapes=function(t){var e,r,n,i,a,o,s=this.shapes.length,l=this.amount.v,c=this.miterLimit.v,h=this.lineJoin;if(0!==l)for(r=0;r<s;r+=1){if(o=(a=this.shapes[r]).localShapeCollection,a.shape._mdf||this._mdf||t)for(o.releaseShapes(),a.shape._mdf=!0,e=a.shape.paths.shapes,i=a.shape.paths._length,n=0;n<i;n+=1)o.addShape(this.processPath(e[n],l,h,c));a.shape.paths=a.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=function(){var t={w:0,size:0,shapes:[],data:{shapes:[]}},e=[];e=e.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var r=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],n=[65039,8205];function i(t,e){var r=createTag("span");r.setAttribute("aria-hidden",!0),r.style.fontFamily=e;var n=createTag("span");n.innerText="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(n),document.body.appendChild(r);var i=n.offsetWidth;return n.style.fontFamily=function(t){var e,r=t.split(","),n=r.length,i=[];for(e=0;e<n;e+=1)"sans-serif"!==r[e]&&"monospace"!==r[e]&&i.push(r[e]);return i.join(",")}(t)+", "+e,{node:n,w:i,parent:r}}function a(t,e){var r,n=document.body&&e?"svg":"canvas",i=getFontProperties(t);if("svg"===n){var a=createNS("text");a.style.fontSize="100px",a.setAttribute("font-family",t.fFamily),a.setAttribute("font-style",i.style),a.setAttribute("font-weight",i.weight),a.textContent="1",t.fClass?(a.style.fontFamily="inherit",a.setAttribute("class",t.fClass)):a.style.fontFamily=t.fFamily,e.appendChild(a),r=a}else{var o=new OffscreenCanvas(500,500).getContext("2d");o.font=i.style+" "+i.weight+" 100px "+t.fFamily,r=o}return{measureText:function(t){return"svg"===n?(r.textContent=t,r.getComputedTextLength()):r.measureText(t).width}}}var o=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};o.isModifier=function(t,e){var n=t.toString(16)+e.toString(16);return-1!==r.indexOf(n)},o.isZeroWidthJoiner=function(t,e){return e?t===n[0]&&e===n[1]:t===n[1]},o.isCombinedCharacter=function(t){return-1!==e.indexOf(t)};var s={addChars:function(t){if(t){var e;this.chars||(this.chars=[]);var r,n,i=t.length,a=this.chars.length;for(e=0;e<i;e+=1){for(r=0,n=!1;r<a;)this.chars[r].style===t[e].style&&this.chars[r].fFamily===t[e].fFamily&&this.chars[r].ch===t[e].ch&&(n=!0),r+=1;n||(this.chars.push(t[e]),a+=1)}}},addFonts:function(t,e){if(t){if(this.chars)return this.isLoaded=!0,void(this.fonts=t.list);if(!document.body)return this.isLoaded=!0,t.list.forEach((function(t){t.helper=a(t),t.cache={}})),void(this.fonts=t.list);var r,n=t.list,o=n.length,s=o;for(r=0;r<o;r+=1){var l,c,h=!0;if(n[r].loaded=!1,n[r].monoCase=i(n[r].fFamily,"monospace"),n[r].sansCase=i(n[r].fFamily,"sans-serif"),n[r].fPath){if("p"===n[r].fOrigin||3===n[r].origin){if((l=document.querySelectorAll('style[f-forigin="p"][f-family="'+n[r].fFamily+'"], style[f-origin="3"][f-family="'+n[r].fFamily+'"]')).length>0&&(h=!1),h){var d=createTag("style");d.setAttribute("f-forigin",n[r].fOrigin),d.setAttribute("f-origin",n[r].origin),d.setAttribute("f-family",n[r].fFamily),d.type="text/css",d.innerText="@font-face {font-family: "+n[r].fFamily+"; font-style: normal; src: url('"+n[r].fPath+"');}",e.appendChild(d)}}else if("g"===n[r].fOrigin||1===n[r].origin){for(l=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),c=0;c<l.length;c+=1)-1!==l[c].href.indexOf(n[r].fPath)&&(h=!1);if(h){var p=createTag("link");p.setAttribute("f-forigin",n[r].fOrigin),p.setAttribute("f-origin",n[r].origin),p.type="text/css",p.rel="stylesheet",p.href=n[r].fPath,document.body.appendChild(p)}}else if("t"===n[r].fOrigin||2===n[r].origin){for(l=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),c=0;c<l.length;c+=1)n[r].fPath===l[c].src&&(h=!1);if(h){var u=createTag("link");u.setAttribute("f-forigin",n[r].fOrigin),u.setAttribute("f-origin",n[r].origin),u.setAttribute("rel","stylesheet"),u.setAttribute("href",n[r].fPath),e.appendChild(u)}}}else n[r].loaded=!0,s-=1;n[r].helper=a(n[r],e),n[r].cache={},this.fonts.push(n[r])}0===s?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(e,r,n){for(var i=0,a=this.chars.length;i<a;){if(this.chars[i].ch===e&&this.chars[i].style===r&&this.chars[i].fFamily===n)return this.chars[i];i+=1}return("string"==typeof e&&13!==e.charCodeAt(0)||!e)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",e,r,n)),t},getFontByName:function(t){for(var e=0,r=this.fonts.length;e<r;){if(this.fonts[e].fName===t)return this.fonts[e];e+=1}return this.fonts[0]},measureText:function(t,e,r){var n=this.getFontByName(e),i=t.charCodeAt(0);if(!n.cache[i+1]){var a=n.helper;if(" "===t){var o=a.measureText("|"+t+"|"),s=a.measureText("||");n.cache[i+1]=(o-s)/100}else n.cache[i+1]=a.measureText(t)/100}return n.cache[i+1]*r},checkLoadedFonts:function(){var t,e,r,n=this.fonts.length,i=n;for(t=0;t<n;t+=1)this.fonts[t].loaded?i-=1:"n"===this.fonts[t].fOrigin||0===this.fonts[t].origin?this.fonts[t].loaded=!0:(e=this.fonts[t].monoCase.node,r=this.fonts[t].monoCase.w,e.offsetWidth!==r?(i-=1,this.fonts[t].loaded=!0):(e=this.fonts[t].sansCase.node,r=this.fonts[t].sansCase.w,e.offsetWidth!==r&&(i-=1,this.fonts[t].loaded=!0)),this.fonts[t].loaded&&(this.fonts[t].sansCase.parent.parentNode.removeChild(this.fonts[t].sansCase.parent),this.fonts[t].monoCase.parent.parentNode.removeChild(this.fonts[t].monoCase.parent)));0!==i&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}};return o.prototype=s,o}();function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(t){-1===this.renderableComponents.indexOf(t)&&this.renderableComponents.push(t)},removeRenderableComponent:function(t){-1!==this.renderableComponents.indexOf(t)&&this.renderableComponents.splice(this.renderableComponents.indexOf(t),1)},prepareRenderableFrame:function(t){this.checkLayerLimits(t)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(t){this.data.ip-this.data.st<=t&&this.data.op-this.data.st>t?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var t,e=this.renderableComponents.length;for(t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=(blendModeEnums={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(t){return blendModeEnums[t]||""}),blendModeEnums;function SliderEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function AngleEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function ColorEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function PointEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function LayerIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function MaskIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function CheckboxEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(t,e){var r,n=t.ef||[];this.effectElements=[];var i,a=n.length;for(r=0;r<a;r+=1)i=new GroupEffect(n[r],e),this.effectElements.push(i)}function GroupEffect(t,e){this.init(t,e)}function BaseElement(){}function FrameElement(){}function FootageElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(t,e,r)}function AudioElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.initBaseData(t,e,r),this._isPlaying=!1,this._canPlay=!1;var n=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(n),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,t.au&&t.au.lv?t.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}function TransformElement(){}function MaskElement(t,e,r){this.data=t,this.element=e,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var n,i,a=this.globalData.defs,o=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(o),this.solidPath="";var s,l,c,h,d,p,u=this.masksProperties,m=0,f=[],g=createElementID(),v="clipPath",b="clip-path";for(n=0;n<o;n+=1)if(("a"!==u[n].mode&&"n"!==u[n].mode||u[n].inv||100!==u[n].o.k||u[n].o.x)&&(v="mask",b="mask"),"s"!==u[n].mode&&"i"!==u[n].mode||0!==m?c=null:((c=createNS("rect")).setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),f.push(c)),i=createNS("path"),"n"===u[n].mode)this.viewData[n]={op:PropertyFactory.getProp(this.element,u[n].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,u[n],3),elem:i,lastPath:""},a.appendChild(i);else{var y;if(m+=1,i.setAttribute("fill","s"===u[n].mode?"#000000":"#ffffff"),i.setAttribute("clip-rule","nonzero"),0!==u[n].x.k?(v="mask",b="mask",p=PropertyFactory.getProp(this.element,u[n].x,0,null,this.element),y=createElementID(),(h=createNS("filter")).setAttribute("id",y),(d=createNS("feMorphology")).setAttribute("operator","erode"),d.setAttribute("in","SourceGraphic"),d.setAttribute("radius","0"),h.appendChild(d),a.appendChild(h),i.setAttribute("stroke","s"===u[n].mode?"#000000":"#ffffff")):(d=null,p=null),this.storedData[n]={elem:i,x:p,expan:d,lastPath:"",lastOperator:"",filterId:y,lastRadius:0},"i"===u[n].mode){l=f.length;var x=createNS("g");for(s=0;s<l;s+=1)x.appendChild(f[s]);var _=createNS("mask");_.setAttribute("mask-type","alpha"),_.setAttribute("id",g+"_"+m),_.appendChild(i),a.appendChild(_),x.setAttribute("mask","url("+getLocationHref()+"#"+g+"_"+m+")"),f.length=0,f.push(x)}else f.push(i);u[n].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[n]={elem:i,lastPath:"",op:PropertyFactory.getProp(this.element,u[n].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,u[n],3),invRect:c},this.viewData[n].prop.k||this.drawPath(u[n],this.viewData[n].prop.v,this.viewData[n])}for(this.maskElement=createNS(v),o=f.length,n=0;n<o;n+=1)this.maskElement.appendChild(f[n]);m>0&&(this.maskElement.setAttribute("id",g),this.element.maskedElement.setAttribute(b,"url("+getLocationHref()+"#"+g+")"),a.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(t,e){var r;this.data=t,this.effectElements=[],this.initDynamicPropertyContainer(e);var n,i=this.data.ef.length,a=this.data.ef;for(r=0;r<i;r+=1){switch(n=null,a[r].ty){case 0:n=new SliderEffect(a[r],e,this);break;case 1:n=new AngleEffect(a[r],e,this);break;case 2:n=new ColorEffect(a[r],e,this);break;case 3:n=new PointEffect(a[r],e,this);break;case 4:case 7:n=new CheckboxEffect(a[r],e,this);break;case 10:n=new LayerIndexEffect(a[r],e,this);break;case 11:n=new MaskIndexEffect(a[r],e,this);break;case 5:n=new EffectsManager(a[r],e,this);break;default:n=new NoValueEffect(a[r],e,this)}n&&this.effectElements.push(n)}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var t=0,e=this.data.masksProperties.length;t<e;){if("n"!==this.data.masksProperties[t].mode&&!1!==this.data.masksProperties[t].cl)return!0;t+=1}return!1},initExpressions:function(){var t=getExpressionInterfaces();if(t){var e=t("layer"),r=t("effects"),n=t("shape"),i=t("text"),a=t("comp");this.layerInterface=e(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var o=r.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(o),0===this.data.ty||this.data.xt?this.compInterface=a(this):4===this.data.ty?(this.layerInterface.shapeInterface=n(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=i(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var t=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=t},initBaseData:function(t,e,r){this.globalData=e,this.comp=r,this.data=t,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(t,e){var r,n=this.dynamicProperties.length;for(r=0;r<n;r+=1)(e||this._isParent&&"transform"===this.dynamicProperties[r].propType)&&(this.dynamicProperties[r].getValue(),this.dynamicProperties[r]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&this.dynamicProperties.push(t)}},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var t=getExpressionInterfaces();if(t){var e=t("footage");this.layerInterface=e(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(t){if(this.prepareRenderableFrame(t,!0),this.prepareProperties(t,!0),this.tm._placeholder)this._currentTime=t/this.data.sr;else{var e=this.tm.v;this._currentTime=e}this._volume=this.lv.v[0];var r=this._volume*this._volumeMultiplier;this._previousVolume!==r&&(this._previousVolume=r,this.audio.volume(r))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(t){this.audio.rate(t)},AudioElement.prototype.volume=function(t){this._volumeMultiplier=t,this._previousVolume=t*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(t){var e,r,n=this.layers.length;for(this.completeLayers=!0,e=n-1;e>=0;e-=1)this.elements[e]||(r=this.layers[e]).ip-r.st<=t-this.layers[e].st&&r.op-r.st>t-this.layers[e].st&&this.buildItem(e),this.completeLayers=!!this.elements[e]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(t){switch(t.ty){case 2:return this.createImage(t);case 0:return this.createComp(t);case 1:return this.createSolid(t);case 3:default:return this.createNull(t);case 4:return this.createShape(t);case 5:return this.createText(t);case 6:return this.createAudio(t);case 13:return this.createCamera(t);case 15:return this.createFootage(t)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(t){return new AudioElement(t,this.globalData,this)},BaseRenderer.prototype.createFootage=function(t){return new FootageElement(t,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(t){var e;this.completeLayers=!1;var r,n=t.length,i=this.layers.length;for(e=0;e<n;e+=1)for(r=0;r<i;){if(this.layers[r].id===t[e].id){this.layers[r]=t[e];break}r+=1}},BaseRenderer.prototype.setProjectInterface=function(t){this.globalData.projectInterface=t},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(t,e,r){for(var n=this.elements,i=this.layers,a=0,o=i.length;a<o;)i[a].ind==e&&(n[a]&&!0!==n[a]?(r.push(n[a]),n[a].setAsParent(),void 0!==i[a].parent?this.buildElementParenting(t,i[a].parent,r):t.setHierarchy(r)):(this.buildItem(a),this.addPendingElement(t))),a+=1},BaseRenderer.prototype.addPendingElement=function(t){this.pendingElements.push(t)},BaseRenderer.prototype.searchExtraCompositions=function(t){var e,r=t.length;for(e=0;e<r;e+=1)if(t[e].xt){var n=this.createComp(t[e]);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},BaseRenderer.prototype.getElementByPath=function(t){var e,r=t.shift();if("number"==typeof r)e=this.elements[r];else{var n,i=this.elements.length;for(n=0;n<i;n+=1)if(this.elements[n].data.nm===r){e=this.elements[n];break}}return 0===t.length?e:e.getElementByPath(t)},BaseRenderer.prototype.setupGlobalData=function(t,e){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(t.chars),this.globalData.fontManager.addFonts(t.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=t.fr,this.globalData.nm=t.nm,this.globalData.compSize={w:t.w,h:t.h}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var t,e=this.finalTransform.mat,r=0,n=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<n;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(t=this.finalTransform.mProp.v.props,e.cloneFromProps(t),r=0;r<n;r+=1)t=this.hierarchy[r].finalTransform.mProp.v.props,e.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},globalToLocal:function(t){var e=[];e.push(this.finalTransform);for(var r,n=!0,i=this.comp;n;)i.finalTransform?(i.data.hasMask&&e.splice(0,0,i.finalTransform),i=i.comp):n=!1;var a,o=e.length;for(r=0;r<o;r+=1)a=e[r].mat.applyToPointArray(0,0,0),t=[t[0]-a[0],t[1]-a[1],0];return t},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(t){return this.viewData[t].prop},MaskElement.prototype.renderFrame=function(t){var e,r=this.element.finalTransform.mat,n=this.masksProperties.length;for(e=0;e<n;e+=1)if((this.viewData[e].prop._mdf||t)&&this.drawPath(this.masksProperties[e],this.viewData[e].prop.v,this.viewData[e]),(this.viewData[e].op._mdf||t)&&this.viewData[e].elem.setAttribute("fill-opacity",this.viewData[e].op.v),"n"!==this.masksProperties[e].mode&&(this.viewData[e].invRect&&(this.element.finalTransform.mProp._mdf||t)&&this.viewData[e].invRect.setAttribute("transform",r.getInverseMatrix().to2dCSS()),this.storedData[e].x&&(this.storedData[e].x._mdf||t))){var i=this.storedData[e].expan;this.storedData[e].x.v<0?("erode"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="erode",this.storedData[e].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[e].filterId+")")),i.setAttribute("radius",-this.storedData[e].x.v)):("dilate"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="dilate",this.storedData[e].elem.setAttribute("filter",null)),this.storedData[e].elem.setAttribute("stroke-width",2*this.storedData[e].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var t="M0,0 ";return t+=" h"+this.globalData.compSize.w,t+=" v"+this.globalData.compSize.h,(t+=" h-"+this.globalData.compSize.w)+" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(t,e,r){var n,i,a=" M"+e.v[0][0]+","+e.v[0][1];for(i=e._length,n=1;n<i;n+=1)a+=" C"+e.o[n-1][0]+","+e.o[n-1][1]+" "+e.i[n][0]+","+e.i[n][1]+" "+e.v[n][0]+","+e.v[n][1];if(e.c&&i>1&&(a+=" C"+e.o[n-1][0]+","+e.o[n-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),r.lastPath!==a){var o="";r.elem&&(e.c&&(o=t.inv?this.solidPath+a:a),r.elem.setAttribute("d",o)),r.lastPath=a}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var t={createFilter:function(t,e){var r=createNS("filter");return r.setAttribute("id",t),!0!==e&&(r.setAttribute("filterUnits","objectBoundingBox"),r.setAttribute("x","0%"),r.setAttribute("y","0%"),r.setAttribute("width","100%"),r.setAttribute("height","100%")),r},createAlphaToLuminanceFilter:function(){var t=createNS("feColorMatrix");return t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),t}};return t}(),featureSupport=function(){var t={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.maskType=!1),t}(),registeredEffects={},idPrefix="filter_result_";function SVGEffects(t){var e,r,n="SourceGraphic",i=t.data.ef?t.data.ef.length:0,a=createElementID(),o=filtersFactory.createFilter(a,!0),s=0;for(this.filters=[],e=0;e<i;e+=1){r=null;var l=t.data.ef[e].ty;registeredEffects[l]&&(r=new(0,registeredEffects[l].effect)(o,t.effectsManager.effectElements[e],t,idPrefix+s,n),n=idPrefix+s,registeredEffects[l].countsAsEffect&&(s+=1)),r&&this.filters.push(r)}s&&(t.globalData.defs.appendChild(o),t.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+a+")")),this.filters.length&&t.addRenderableComponent(this)}function registerEffect(t,e,r){registeredEffects[t]={effect:e,countsAsEffect:r}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(t,e){this.elem=t,this.pos=e}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(t){var e,r=this.filters.length;for(e=0;e<r;e+=1)this.filters[e].renderFrame(t)},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var t=null;if(this.data.td){this.matteMasks={};var e=createNS("symbol");e.setAttribute("id",this.layerId);var r=createNS("g");r.appendChild(this.layerElement),e.appendChild(r),t=r,this.globalData.defs.appendChild(e)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),t=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var n=createNS("clipPath"),i=createNS("path");i.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var a=createElementID();if(n.setAttribute("id",a),n.appendChild(i),this.globalData.defs.appendChild(n),this.checkMasks()){var o=createNS("g");o.setAttribute("clip-path","url("+getLocationHref()+"#"+a+")"),o.appendChild(this.layerElement),this.transformedElement=o,t?t.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+a+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},getMatte:function(t){if(!this.matteMasks[t]){var e,r,n,i,a=this.layerId+"_"+t;if(1===t||3===t){var o=createNS("mask");o.setAttribute("id",a),o.setAttribute("mask-type",3===t?"luminance":"alpha"),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),o.appendChild(n),this.globalData.defs.appendChild(o),featureSupport.maskType||1!==t||(o.setAttribute("mask-type","luminance"),e=createElementID(),r=filtersFactory.createFilter(e),this.globalData.defs.appendChild(r),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(i=createNS("g")).appendChild(n),o.appendChild(i),i.setAttribute("filter","url("+getLocationHref()+"#"+e+")"))}else if(2===t){var s=createNS("mask");s.setAttribute("id",a),s.setAttribute("mask-type","alpha");var l=createNS("g");s.appendChild(l),e=createElementID(),r=filtersFactory.createFilter(e);var c=createNS("feComponentTransfer");c.setAttribute("in","SourceGraphic"),r.appendChild(c);var h=createNS("feFuncA");h.setAttribute("type","table"),h.setAttribute("tableValues","1.0 0.0"),c.appendChild(h),this.globalData.defs.appendChild(r);var d=createNS("rect");d.setAttribute("width",this.comp.data.w),d.setAttribute("height",this.comp.data.h),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("fill","#ffffff"),d.setAttribute("opacity","0"),l.setAttribute("filter","url("+getLocationHref()+"#"+e+")"),l.appendChild(d),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(n),featureSupport.maskType||(s.setAttribute("mask-type","luminance"),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),i=createNS("g"),l.appendChild(d),i.appendChild(this.layerElement),l.appendChild(i)),this.globalData.defs.appendChild(s)}this.matteMasks[t]=a}return this.matteMasks[t]},setMatte:function(t){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+t+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(t){this.hierarchy=t},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initTransform(t,e,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(t){var e,r=this.shapeModifiers.length;for(e=0;e<r;e+=1)this.shapeModifiers[e].addShape(t)},isShapeInAnimatedModifiers:function(t){for(var e=this.shapeModifiers.length;0<e;)if(this.shapeModifiers[0].isAnimatedWithShape(t))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var t,e=this.shapes.length;for(t=0;t<e;t+=1)this.shapes[t].sh.reset();for(t=(e=this.shapeModifiers.length)-1;t>=0&&!this.shapeModifiers[t].processShapes(this._isFirstFrame);t-=1);}},searchProcessedElement:function(t){for(var e=this.processedElements,r=0,n=e.length;r<n;){if(e[r].elem===t)return e[r].pos;r+=1}return 0},addProcessedElement:function(t,e){for(var r=this.processedElements,n=r.length;n;)if(r[n-=1].elem===t)return void(r[n].pos=e);r.push(new ProcessedElement(t,e))},prepareFrame:function(t){this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(t,e,r){this.caches=[],this.styles=[],this.transformers=t,this.lStr="",this.sh=r,this.lvl=e,this._isAnimated=!!r.k;for(var n=0,i=t.length;n<i;){if(t[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}function SVGStyleData(t,e){this.data=t,this.type=t.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=!0===t.hd,this.pElem=createNS("path"),this.msElem=null}function DashProperty(t,e,r,n){var i;this.elem=t,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(n);var a,o=e.length||0;for(i=0;i<o;i+=1)a=PropertyFactory.getProp(t,e[i].v,0,0,this),this.k=a.k||this.k,this.dataProps[i]={n:e[i].n,p:a};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r}function SVGNoStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.style=r}function GradientProperty(t,e,r){this.data=e,this.c=createTypedArray("uint8c",4*e.p);var n=e.k.k[0].s?e.k.k[0].s.length-4*e.p:e.k.k.length-4*e.p;this.o=createTypedArray("float32",n),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=n,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(t,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.initGradientData(t,e,r)}function SVGGradientStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.initGradientData(t,e,r),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(t,e,r){this.transform={mProps:t,op:e,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(t){if((this.elem.globalData.frameId!==this.frameId||t)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||t,this._mdf)){var e=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),e=0;e<r;e+=1)"o"!==this.dataProps[e].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(t,e){for(var r=0,n=this.o.length/2;r<n;){if(Math.abs(t[4*r]-t[4*e+2*r])>.01)return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var t=0,e=this.data.k.k.length;t<e;){if(!this.comparePoints(this.data.k.k[t].s,this.data.p))return!1;t+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(t){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||t){var e,r,n,i=4*this.data.p;for(e=0;e<i;e+=1)r=e%4==0?100:255,n=Math.round(this.prop.v[e]*r),this.c[e]!==n&&(this.c[e]=n,this._cmdf=!t);if(this.o.length)for(i=this.prop.v.length,e=4*this.data.p;e<i;e+=1)r=e%2==0?100:1,n=e%2==0?Math.round(100*this.prop.v[e]):this.prop.v[e],this.o[e-4*this.data.p]!==n&&(this.o[e-4*this.data.p]=n,this._omdf=!t);this._mdf=!t}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(t,e,r){this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.s=PropertyFactory.getProp(t,e.s,1,null,this),this.e=PropertyFactory.getProp(t,e.e,1,null,this),this.h=PropertyFactory.getProp(t,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(t,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(t,e.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,e),this.setGradientOpacity(e,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(t,e){var r=createElementID(),n=createNS(1===e.t?"linearGradient":"radialGradient");n.setAttribute("id",r),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");var i,a,o,s=[];for(o=4*e.g.p,a=0;a<o;a+=4)i=createNS("stop"),n.appendChild(i),s.push(i);t.setAttribute("gf"===e.ty?"fill":"stroke","url("+getLocationHref()+"#"+r+")"),this.gf=n,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(t,e){if(this.g._hasOpacity&&!this.g._collapsable){var r,n,i,a=createNS("mask"),o=createNS("path");a.appendChild(o);var s=createElementID(),l=createElementID();a.setAttribute("id",l);var c=createNS(1===t.t?"linearGradient":"radialGradient");c.setAttribute("id",s),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),i=t.g.k.k[0].s?t.g.k.k[0].s.length:t.g.k.k.length;var h=this.stops;for(n=4*t.g.p;n<i;n+=2)(r=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),h.push(r);o.setAttribute("gf"===t.ty?"fill":"stroke","url("+getLocationHref()+"#"+s+")"),"gs"===t.ty&&(o.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),o.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),1===t.lj&&o.setAttribute("stroke-miterlimit",t.ml)),this.of=c,this.ms=a,this.ost=h,this.maskId=l,e.msElem=o}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(t,e,r,n){if(0===e)return"";var i,a=t.o,o=t.i,s=t.v,l=" M"+n.applyToPointStringified(s[0][0],s[0][1]);for(i=1;i<e;i+=1)l+=" C"+n.applyToPointStringified(a[i-1][0],a[i-1][1])+" "+n.applyToPointStringified(o[i][0],o[i][1])+" "+n.applyToPointStringified(s[i][0],s[i][1]);return r&&e&&(l+=" C"+n.applyToPointStringified(a[i-1][0],a[i-1][1])+" "+n.applyToPointStringified(o[0][0],o[0][1])+" "+n.applyToPointStringified(s[0][0],s[0][1]),l+="z"),l},SVGElementsRenderer=function(){var t=new Matrix,e=new Matrix;function r(t,e,r){(r||e.transform.op._mdf)&&e.transform.container.setAttribute("opacity",e.transform.op.v),(r||e.transform.mProps._mdf)&&e.transform.container.setAttribute("transform",e.transform.mProps.v.to2dCSS())}function n(){}function i(r,n,i){var a,o,s,l,c,h,d,p,u,m,f,g=n.styles.length,v=n.lvl;for(h=0;h<g;h+=1){if(l=n.sh._mdf||i,n.styles[h].lvl<v){for(p=e.reset(),m=v-n.styles[h].lvl,f=n.transformers.length-1;!l&&m>0;)l=n.transformers[f].mProps._mdf||l,m-=1,f-=1;if(l)for(m=v-n.styles[h].lvl,f=n.transformers.length-1;m>0;)u=n.transformers[f].mProps.v.props,p.transform(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15]),m-=1,f-=1}else p=t;if(o=(d=n.sh.paths)._length,l){for(s="",a=0;a<o;a+=1)(c=d.shapes[a])&&c._length&&(s+=buildShapeString(c,c._length,c.c,p));n.caches[h]=s}else s=n.caches[h];n.styles[h].d+=!0===r.hd?"":s,n.styles[h]._mdf=l||n.styles[h]._mdf}}function a(t,e,r){var n=e.style;(e.c._mdf||r)&&n.pElem.setAttribute("fill","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r)&&n.pElem.setAttribute("fill-opacity",e.o.v)}function o(t,e,r){s(t,e,r),l(0,e,r)}function s(t,e,r){var n,i,a,o,s,l=e.gf,c=e.g._hasOpacity,h=e.s.v,d=e.e.v;if(e.o._mdf||r){var p="gf"===t.ty?"fill-opacity":"stroke-opacity";e.style.pElem.setAttribute(p,e.o.v)}if(e.s._mdf||r){var u=1===t.t?"x1":"cx",m="x1"===u?"y1":"cy";l.setAttribute(u,h[0]),l.setAttribute(m,h[1]),c&&!e.g._collapsable&&(e.of.setAttribute(u,h[0]),e.of.setAttribute(m,h[1]))}if(e.g._cmdf||r){n=e.cst;var f=e.g.c;for(a=n.length,i=0;i<a;i+=1)(o=n[i]).setAttribute("offset",f[4*i]+"%"),o.setAttribute("stop-color","rgb("+f[4*i+1]+","+f[4*i+2]+","+f[4*i+3]+")")}if(c&&(e.g._omdf||r)){var g=e.g.o;for(a=(n=e.g._collapsable?e.cst:e.ost).length,i=0;i<a;i+=1)o=n[i],e.g._collapsable||o.setAttribute("offset",g[2*i]+"%"),o.setAttribute("stop-opacity",g[2*i+1])}if(1===t.t)(e.e._mdf||r)&&(l.setAttribute("x2",d[0]),l.setAttribute("y2",d[1]),c&&!e.g._collapsable&&(e.of.setAttribute("x2",d[0]),e.of.setAttribute("y2",d[1])));else if((e.s._mdf||e.e._mdf||r)&&(s=Math.sqrt(Math.pow(h[0]-d[0],2)+Math.pow(h[1]-d[1],2)),l.setAttribute("r",s),c&&!e.g._collapsable&&e.of.setAttribute("r",s)),e.e._mdf||e.h._mdf||e.a._mdf||r){s||(s=Math.sqrt(Math.pow(h[0]-d[0],2)+Math.pow(h[1]-d[1],2)));var v=Math.atan2(d[1]-h[1],d[0]-h[0]),b=e.h.v;b>=1?b=.99:b<=-1&&(b=-.99);var y=s*b,x=Math.cos(v+e.a.v)*y+h[0],_=Math.sin(v+e.a.v)*y+h[1];l.setAttribute("fx",x),l.setAttribute("fy",_),c&&!e.g._collapsable&&(e.of.setAttribute("fx",x),e.of.setAttribute("fy",_))}}function l(t,e,r){var n=e.style,i=e.d;i&&(i._mdf||r)&&i.dashStr&&(n.pElem.setAttribute("stroke-dasharray",i.dashStr),n.pElem.setAttribute("stroke-dashoffset",i.dashoffset[0])),e.c&&(e.c._mdf||r)&&n.pElem.setAttribute("stroke","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r)&&n.pElem.setAttribute("stroke-opacity",e.o.v),(e.w._mdf||r)&&(n.pElem.setAttribute("stroke-width",e.w.v),n.msElem&&n.msElem.setAttribute("stroke-width",e.w.v))}return{createRenderFunction:function(t){switch(t.ty){case"fl":return a;case"gf":return s;case"gs":return o;case"st":return l;case"sh":case"el":case"rc":case"sr":return i;case"tr":return r;case"no":return n;default:return null}}}}();function SVGShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(t,e,r),this.prevViewData=[]}function LetterProps(t,e,r,n,i,a){this.o=t,this.sw=e,this.sc=r,this.fc=n,this.m=i,this.p=a,this._mdf={o:!0,sw:!!e,sc:!!r,fc:!!n,m:!0,p:!0}}function TextProperty(t,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=e,this.elem=t,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var t,e,r,n,i=this.shapes.length,a=this.stylesList.length,o=[],s=!1;for(r=0;r<a;r+=1){for(n=this.stylesList[r],s=!1,o.length=0,t=0;t<i;t+=1)-1!==(e=this.shapes[t]).styles.indexOf(n)&&(o.push(e),s=e._isAnimated||s);o.length>1&&s&&this.setShapesAsAnimated(o)}},SVGShapeElement.prototype.setShapesAsAnimated=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(t,e){var r,n=new SVGStyleData(t,e),i=n.pElem;return"st"===t.ty?r=new SVGStrokeStyleData(this,t,n):"fl"===t.ty?r=new SVGFillStyleData(this,t,n):"gf"===t.ty||"gs"===t.ty?(r=new("gf"===t.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,t,n),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),i.setAttribute("mask","url("+getLocationHref()+"#"+r.maskId+")"))):"no"===t.ty&&(r=new SVGNoStyleData(this,t,n)),"st"!==t.ty&&"gs"!==t.ty||(i.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),i.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),i.setAttribute("fill-opacity","0"),1===t.lj&&i.setAttribute("stroke-miterlimit",t.ml)),2===t.r&&i.setAttribute("fill-rule","evenodd"),t.ln&&i.setAttribute("id",t.ln),t.cl&&i.setAttribute("class",t.cl),t.bm&&(i.style["mix-blend-mode"]=getBlendMode(t.bm)),this.stylesList.push(n),this.addToAnimatedContents(t,r),r},SVGShapeElement.prototype.createGroupElement=function(t){var e=new ShapeGroupData;return t.ln&&e.gr.setAttribute("id",t.ln),t.cl&&e.gr.setAttribute("class",t.cl),t.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(t.bm)),e},SVGShapeElement.prototype.createTransformElement=function(t,e){var r=TransformPropertyFactory.getTransformProperty(this,t,this),n=new SVGTransformData(r,r.o,e);return this.addToAnimatedContents(t,n),n},SVGShapeElement.prototype.createShapeElement=function(t,e,r){var n=4;"rc"===t.ty?n=5:"el"===t.ty?n=6:"sr"===t.ty&&(n=7);var i=new SVGShapeData(e,r,ShapePropertyFactory.getShapeProp(this,t,n,this));return this.shapes.push(i),this.addShapeToModifiers(i),this.addToAnimatedContents(t,i),i},SVGShapeElement.prototype.addToAnimatedContents=function(t,e){for(var r=0,n=this.animatedContents.length;r<n;){if(this.animatedContents[r].element===e)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(t),element:e,data:t})},SVGShapeElement.prototype.setElementStyles=function(t){var e,r=t.styles,n=this.stylesList.length;for(e=0;e<n;e+=1)this.stylesList[e].closed||r.push(this.stylesList[e])},SVGShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(t,e,r,n,i,a,o){var s,l,c,h,d,p,u=[].concat(a),m=t.length-1,f=[],g=[];for(s=m;s>=0;s-=1){if((p=this.searchProcessedElement(t[s]))?e[s]=r[p-1]:t[s]._render=o,"fl"===t[s].ty||"st"===t[s].ty||"gf"===t[s].ty||"gs"===t[s].ty||"no"===t[s].ty)p?e[s].style.closed=!1:e[s]=this.createStyleElement(t[s],i),t[s]._render&&e[s].style.pElem.parentNode!==n&&n.appendChild(e[s].style.pElem),f.push(e[s].style);else if("gr"===t[s].ty){if(p)for(c=e[s].it.length,l=0;l<c;l+=1)e[s].prevViewData[l]=e[s].it[l];else e[s]=this.createGroupElement(t[s]);this.searchShapes(t[s].it,e[s].it,e[s].prevViewData,e[s].gr,i+1,u,o),t[s]._render&&e[s].gr.parentNode!==n&&n.appendChild(e[s].gr)}else"tr"===t[s].ty?(p||(e[s]=this.createTransformElement(t[s],n)),h=e[s].transform,u.push(h)):"sh"===t[s].ty||"rc"===t[s].ty||"el"===t[s].ty||"sr"===t[s].ty?(p||(e[s]=this.createShapeElement(t[s],u,i)),this.setElementStyles(e[s])):"tm"===t[s].ty||"rd"===t[s].ty||"ms"===t[s].ty||"pb"===t[s].ty||"zz"===t[s].ty||"op"===t[s].ty?(p?(d=e[s]).closed=!1:((d=ShapeModifiers.getModifier(t[s].ty)).init(this,t[s]),e[s]=d,this.shapeModifiers.push(d)),g.push(d)):"rp"===t[s].ty&&(p?(d=e[s]).closed=!0:(d=ShapeModifiers.getModifier(t[s].ty),e[s]=d,d.init(this,t,s,e),this.shapeModifiers.push(d),o=!1),g.push(d));this.addProcessedElement(t[s],s+1)}for(m=f.length,s=0;s<m;s+=1)f[s].closed=!0;for(m=g.length,s=0;s<m;s+=1)g[s].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var t;this.renderModifiers();var e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var t,e,r=this.animatedContents.length;for(t=0;t<r;t+=1)e=this.animatedContents[t],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(t,e,r,n,i,a){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var o=!1;return this.o!==t&&(this.o=t,this._mdf.o=!0,o=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,o=!0),this.sc!==r&&(this.sc=r,this._mdf.sc=!0,o=!0),this.fc!==n&&(this.fc=n,this._mdf.fc=!0,o=!0),this.m!==i&&(this.m=i,this._mdf.m=!0,o=!0),!a.length||this.p[0]===a[0]&&this.p[1]===a[1]&&this.p[4]===a[4]&&this.p[5]===a[5]&&this.p[12]===a[12]&&this.p[13]===a[13]||(this.p=a,this._mdf.p=!0,o=!0),o},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},TextProperty.prototype.setCurrentData=function(t){t.__complete||this.completeTextData(t),this.currentData=t,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(t){this.effectsSequence.push(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(t){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||t){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var n;this.lock=!0,this._mdf=!1;var i=this.effectsSequence.length,a=t||this.data.d.k[this.keysIndex].s;for(n=0;n<i;n+=1)a=r!==this.keysIndex?this.effectsSequence[n](a,a.t):this.effectsSequence[n](this.currentData,a.t);e!==a&&this.setCurrentData(a),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var t=this.data.d.k,e=this.elem.comp.renderedFrame,r=0,n=t.length;r<=n-1&&!(r===n-1||t[r+1].t>e);)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(t){for(var e,r,n=[],i=0,a=t.length,o=!1;i<a;)e=t.charCodeAt(i),FontManager.isCombinedCharacter(e)?n[n.length-1]+=t.charAt(i):e>=55296&&e<=56319?(r=t.charCodeAt(i+1))>=56320&&r<=57343?(o||FontManager.isModifier(e,r)?(n[n.length-1]+=t.substr(i,2),o=!1):n.push(t.substr(i,2)),i+=1):n.push(t.charAt(i)):e>56319?(r=t.charCodeAt(i+1),FontManager.isZeroWidthJoiner(e,r)?(o=!0,n[n.length-1]+=t.substr(i,2),i+=1):n.push(t.charAt(i))):FontManager.isZeroWidthJoiner(e)?(n[n.length-1]+=t.charAt(i),o=!0):n.push(t.charAt(i)),i+=1;return n},TextProperty.prototype.completeTextData=function(t){t.__complete=!0;var e,r,n,i,a,o,s,l=this.elem.globalData.fontManager,c=this.data,h=[],d=0,p=c.m.g,u=0,m=0,f=0,g=[],v=0,b=0,y=l.getFontByName(t.f),x=0,_=getFontProperties(y);t.fWeight=_.weight,t.fStyle=_.style,t.finalSize=t.s,t.finalText=this.buildFinalText(t.t),r=t.finalText.length,t.finalLineHeight=t.lh;var w,S=t.tr/1e3*t.finalSize;if(t.sz)for(var E,M,A=!0,T=t.sz[0],P=t.sz[1];A;){E=0,v=0,r=(M=this.buildFinalText(t.t)).length,S=t.tr/1e3*t.finalSize;var C=-1;for(e=0;e<r;e+=1)w=M[e].charCodeAt(0),n=!1," "===M[e]?C=e:13!==w&&3!==w||(v=0,n=!0,E+=t.finalLineHeight||1.2*t.finalSize),l.chars?(s=l.getCharData(M[e],y.fStyle,y.fFamily),x=n?0:s.w*t.finalSize/100):x=l.measureText(M[e],t.f,t.finalSize),v+x>T&&" "!==M[e]?(-1===C?r+=1:e=C,E+=t.finalLineHeight||1.2*t.finalSize,M.splice(e,C===e?1:0,"\r"),C=-1,v=0):(v+=x,v+=S);E+=y.ascent*t.finalSize/100,this.canResize&&t.finalSize>this.minimumFontSize&&P<E?(t.finalSize-=1,t.finalLineHeight=t.finalSize*t.lh/t.s):(t.finalText=M,r=t.finalText.length,A=!1)}v=-S,x=0;var k,D=0;for(e=0;e<r;e+=1)if(n=!1,13===(w=(k=t.finalText[e]).charCodeAt(0))||3===w?(D=0,g.push(v),b=v>b?v:b,v=-2*S,i="",n=!0,f+=1):i=k,l.chars?(s=l.getCharData(k,y.fStyle,l.getFontByName(t.f).fFamily),x=n?0:s.w*t.finalSize/100):x=l.measureText(i,t.f,t.finalSize)," "===k?D+=x+S:(v+=x+S+D,D=0),h.push({l:x,an:x,add:u,n,anIndexes:[],val:i,line:f,animatorJustifyOffset:0}),2==p){if(u+=x,""===i||" "===i||e===r-1){for(""!==i&&" "!==i||(u-=x);m<=e;)h[m].an=u,h[m].ind=d,h[m].extra=x,m+=1;d+=1,u=0}}else if(3==p){if(u+=x,""===i||e===r-1){for(""===i&&(u-=x);m<=e;)h[m].an=u,h[m].ind=d,h[m].extra=x,m+=1;u=0,d+=1}}else h[d].ind=d,h[d].extra=0,d+=1;if(t.l=h,b=v>b?v:b,g.push(v),t.sz)t.boxWidth=t.sz[0],t.justifyOffset=0;else switch(t.boxWidth=b,t.j){case 1:t.justifyOffset=-t.boxWidth;break;case 2:t.justifyOffset=-t.boxWidth/2;break;default:t.justifyOffset=0}t.lineWidths=g;var L,R,O,I,N=c.a;o=N.length;var z=[];for(a=0;a<o;a+=1){for((L=N[a]).a.sc&&(t.strokeColorAnim=!0),L.a.sw&&(t.strokeWidthAnim=!0),(L.a.fc||L.a.fh||L.a.fs||L.a.fb)&&(t.fillColorAnim=!0),I=0,O=L.s.b,e=0;e<r;e+=1)(R=h[e]).anIndexes[a]=I,(1==O&&""!==R.val||2==O&&""!==R.val&&" "!==R.val||3==O&&(R.n||" "==R.val||e==r-1)||4==O&&(R.n||e==r-1))&&(1===L.s.rn&&z.push(I),I+=1);c.a[a].s.totalChars=I;var F,U=-1;if(1===L.s.rn)for(e=0;e<r;e+=1)U!=(R=h[e]).anIndexes[a]&&(U=R.anIndexes[a],F=z.splice(Math.floor(Math.random()*z.length),1)[0]),R.anIndexes[a]=F}t.yOffset=t.finalLineHeight||1.2*t.finalSize,t.ls=t.ls||0,t.ascent=y.ascent*t.finalSize/100},TextProperty.prototype.updateDocumentData=function(t,e){e=void 0===e?this.keysIndex:e;var r=this.copyData({},this.data.d.k[e].s);r=this.copyData(r,t),this.data.d.k[e].s=r,this.recalculate(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(t){var e=this.data.d.k[t].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(t){this.canResize=t,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(t){this.minimumFontSize=Math.floor(t)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var t=Math.max,e=Math.min,r=Math.floor;function n(t,e){this._currentTextLength=-1,this.k=!1,this.data=e,this.elem=t,this.comp=t.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(t),this.s=PropertyFactory.getProp(t,e.s||{k:0},0,0,this),this.e="e"in e?PropertyFactory.getProp(t,e.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(t,e.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(t,e.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(t,e.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(t,e.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(t,e.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return n.prototype={getMult:function(n){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var i=0,a=0,o=1,s=1;this.ne.v>0?i=this.ne.v/100:a=-this.ne.v/100,this.xe.v>0?o=1-this.xe.v/100:s=1+this.xe.v/100;var l=BezierFactory.getBezierEasing(i,a,o,s).get,c=0,h=this.finalS,d=this.finalE,p=this.data.sh;if(2===p)c=l(c=d===h?n>=d?1:0:t(0,e(.5/(d-h)+(n-h)/(d-h),1)));else if(3===p)c=l(c=d===h?n>=d?0:1:1-t(0,e(.5/(d-h)+(n-h)/(d-h),1)));else if(4===p)d===h?c=0:(c=t(0,e(.5/(d-h)+(n-h)/(d-h),1)))<.5?c*=2:c=1-2*(c-.5),c=l(c);else if(5===p){if(d===h)c=0;else{var u=d-h,m=-u/2+(n=e(t(0,n+.5-h),d-h)),f=u/2;c=Math.sqrt(1-m*m/(f*f))}c=l(c)}else 6===p?(d===h?c=0:(n=e(t(0,n+.5-h),d-h),c=(1+Math.cos(Math.PI+2*Math.PI*n/(d-h)))/2),c=l(c)):(n>=r(h)&&(c=t(0,e(n-h<0?e(d,1)-(h-n):d-n,1))),c=l(c));if(100!==this.sm.v){var g=.01*this.sm.v;0===g&&(g=1e-8);var v=.5-.5*g;c<v?c=0:(c=(c-v)/g)>1&&(c=1)}return c*this.a.v},getValue:function(t){this.iterateDynamicProperties(),this._mdf=t||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,t&&2===this.data.r&&(this.e.v=this._currentTextLength);var e=2===this.data.r?1:100/this.data.totalChars,r=this.o.v/e,n=this.s.v/e+r,i=this.e.v/e+r;if(n>i){var a=n;n=i,i=a}this.finalS=n,this.finalE=i}},extendPrototype([DynamicPropertyContainer],n),{getTextSelectorProp:function(t,e,r){return new n(t,e,r)}}}();function TextAnimatorDataProperty(t,e,r){var n={propType:!1},i=PropertyFactory.getProp,a=e.a;this.a={r:a.r?i(t,a.r,0,degToRads,r):n,rx:a.rx?i(t,a.rx,0,degToRads,r):n,ry:a.ry?i(t,a.ry,0,degToRads,r):n,sk:a.sk?i(t,a.sk,0,degToRads,r):n,sa:a.sa?i(t,a.sa,0,degToRads,r):n,s:a.s?i(t,a.s,1,.01,r):n,a:a.a?i(t,a.a,1,0,r):n,o:a.o?i(t,a.o,0,.01,r):n,p:a.p?i(t,a.p,1,0,r):n,sw:a.sw?i(t,a.sw,0,0,r):n,sc:a.sc?i(t,a.sc,1,0,r):n,fc:a.fc?i(t,a.fc,1,0,r):n,fh:a.fh?i(t,a.fh,0,0,r):n,fs:a.fs?i(t,a.fs,0,.01,r):n,fb:a.fb?i(t,a.fb,0,.01,r):n,t:a.t?i(t,a.t,0,0,r):n},this.s=TextSelectorProp.getTextSelectorProp(t,e.s,r),this.s.t=e.s.t}function TextAnimatorProperty(t,e,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=t,this._renderType=e,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){var t,e,r=this._textData.a.length,n=PropertyFactory.getProp;for(t=0;t<r;t+=1)e=this._textData.a[t],this._animatorsData[t]=new TextAnimatorDataProperty(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:n(this._elem,this._textData.p.a,0,0,this),f:n(this._elem,this._textData.p.f,0,0,this),l:n(this._elem,this._textData.p.l,0,0,this),r:n(this._elem,this._textData.p.r,0,0,this),p:n(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=n(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(t,e){if(this.lettersChangedFlag=e,this._mdf||this._isFirstFrame||e||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var r,n,i,a,o,s,l,c,h,d,p,u,m,f,g,v,b,y,x,_=this._moreOptions.alignment.v,w=this._animatorsData,S=this._textData,E=this.mHelper,M=this._renderType,A=this.renderedLetters.length,T=t.l;if(this._hasMaskedPath){if(x=this._pathData.m,!this._pathData.n||this._pathData._mdf){var P,C=x.v;for(this._pathData.r.v&&(C=C.reverse()),o={tLength:0,segments:[]},a=C._length-1,v=0,i=0;i<a;i+=1)P=bez.buildBezierData(C.v[i],C.v[i+1],[C.o[i][0]-C.v[i][0],C.o[i][1]-C.v[i][1]],[C.i[i+1][0]-C.v[i+1][0],C.i[i+1][1]-C.v[i+1][1]]),o.tLength+=P.segmentLength,o.segments.push(P),v+=P.segmentLength;i=a,x.v.c&&(P=bez.buildBezierData(C.v[i],C.v[0],[C.o[i][0]-C.v[i][0],C.o[i][1]-C.v[i][1]],[C.i[0][0]-C.v[0][0],C.i[0][1]-C.v[0][1]]),o.tLength+=P.segmentLength,o.segments.push(P),v+=P.segmentLength),this._pathData.pi=o}if(o=this._pathData.pi,s=this._pathData.f.v,p=0,d=1,c=0,h=!0,f=o.segments,s<0&&x.v.c)for(o.tLength<Math.abs(s)&&(s=-Math.abs(s)%o.tLength),d=(m=f[p=f.length-1].points).length-1;s<0;)s+=m[d].partialLength,(d-=1)<0&&(d=(m=f[p-=1].points).length-1);u=(m=f[p].points)[d-1],g=(l=m[d]).partialLength}a=T.length,r=0,n=0;var k,D,L,R,O,I=1.2*t.finalSize*.714,N=!0;L=w.length;var z,F,U,B,V,j,G,H,W,q,$,X,Y=-1,Z=s,K=p,J=d,Q=-1,tt="",et=this.defaultPropsArray;if(2===t.j||1===t.j){var rt=0,nt=0,it=2===t.j?-.5:-1,at=0,ot=!0;for(i=0;i<a;i+=1)if(T[i].n){for(rt&&(rt+=nt);at<i;)T[at].animatorJustifyOffset=rt,at+=1;rt=0,ot=!0}else{for(D=0;D<L;D+=1)(k=w[D].a).t.propType&&(ot&&2===t.j&&(nt+=k.t.v*it),(O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars)).length?rt+=k.t.v*O[0]*it:rt+=k.t.v*O*it);ot=!1}for(rt&&(rt+=nt);at<i;)T[at].animatorJustifyOffset=rt,at+=1}for(i=0;i<a;i+=1){if(E.reset(),B=1,T[i].n)r=0,n+=t.yOffset,n+=N?1:0,s=Z,N=!1,this._hasMaskedPath&&(d=J,u=(m=f[p=K].points)[d-1],g=(l=m[d]).partialLength,c=0),tt="",$="",W="",X="",et=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Q!==T[i].line){switch(t.j){case 1:s+=v-t.lineWidths[T[i].line];break;case 2:s+=(v-t.lineWidths[T[i].line])/2}Q=T[i].line}Y!==T[i].ind&&(T[Y]&&(s+=T[Y].extra),s+=T[i].an/2,Y=T[i].ind),s+=_[0]*T[i].an*.005;var st=0;for(D=0;D<L;D+=1)(k=w[D].a).p.propType&&((O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars)).length?st+=k.p.v[0]*O[0]:st+=k.p.v[0]*O),k.a.propType&&((O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars)).length?st+=k.a.v[0]*O[0]:st+=k.a.v[0]*O);for(h=!0,this._pathData.a.v&&(s=.5*T[0].an+(v-this._pathData.f.v-.5*T[0].an-.5*T[T.length-1].an)*Y/(a-1),s+=this._pathData.f.v);h;)c+g>=s+st||!m?(b=(s+st-c)/l.partialLength,F=u.point[0]+(l.point[0]-u.point[0])*b,U=u.point[1]+(l.point[1]-u.point[1])*b,E.translate(-_[0]*T[i].an*.005,-_[1]*I*.01),h=!1):m&&(c+=l.partialLength,(d+=1)>=m.length&&(d=0,f[p+=1]?m=f[p].points:x.v.c?(d=0,m=f[p=0].points):(c-=l.partialLength,m=null)),m&&(u=l,g=(l=m[d]).partialLength));z=T[i].an/2-T[i].add,E.translate(-z,0,0)}else z=T[i].an/2-T[i].add,E.translate(-z,0,0),E.translate(-_[0]*T[i].an*.005,-_[1]*I*.01,0);for(D=0;D<L;D+=1)(k=w[D].a).t.propType&&(O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars),0===r&&0===t.j||(this._hasMaskedPath?O.length?s+=k.t.v*O[0]:s+=k.t.v*O:O.length?r+=k.t.v*O[0]:r+=k.t.v*O));for(t.strokeWidthAnim&&(j=t.sw||0),t.strokeColorAnim&&(V=t.sc?[t.sc[0],t.sc[1],t.sc[2]]:[0,0,0]),t.fillColorAnim&&t.fc&&(G=[t.fc[0],t.fc[1],t.fc[2]]),D=0;D<L;D+=1)(k=w[D].a).a.propType&&((O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars)).length?E.translate(-k.a.v[0]*O[0],-k.a.v[1]*O[1],k.a.v[2]*O[2]):E.translate(-k.a.v[0]*O,-k.a.v[1]*O,k.a.v[2]*O));for(D=0;D<L;D+=1)(k=w[D].a).s.propType&&((O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars)).length?E.scale(1+(k.s.v[0]-1)*O[0],1+(k.s.v[1]-1)*O[1],1):E.scale(1+(k.s.v[0]-1)*O,1+(k.s.v[1]-1)*O,1));for(D=0;D<L;D+=1){if(k=w[D].a,O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars),k.sk.propType&&(O.length?E.skewFromAxis(-k.sk.v*O[0],k.sa.v*O[1]):E.skewFromAxis(-k.sk.v*O,k.sa.v*O)),k.r.propType&&(O.length?E.rotateZ(-k.r.v*O[2]):E.rotateZ(-k.r.v*O)),k.ry.propType&&(O.length?E.rotateY(k.ry.v*O[1]):E.rotateY(k.ry.v*O)),k.rx.propType&&(O.length?E.rotateX(k.rx.v*O[0]):E.rotateX(k.rx.v*O)),k.o.propType&&(O.length?B+=(k.o.v*O[0]-B)*O[0]:B+=(k.o.v*O-B)*O),t.strokeWidthAnim&&k.sw.propType&&(O.length?j+=k.sw.v*O[0]:j+=k.sw.v*O),t.strokeColorAnim&&k.sc.propType)for(H=0;H<3;H+=1)O.length?V[H]+=(k.sc.v[H]-V[H])*O[0]:V[H]+=(k.sc.v[H]-V[H])*O;if(t.fillColorAnim&&t.fc){if(k.fc.propType)for(H=0;H<3;H+=1)O.length?G[H]+=(k.fc.v[H]-G[H])*O[0]:G[H]+=(k.fc.v[H]-G[H])*O;k.fh.propType&&(G=O.length?addHueToRGB(G,k.fh.v*O[0]):addHueToRGB(G,k.fh.v*O)),k.fs.propType&&(G=O.length?addSaturationToRGB(G,k.fs.v*O[0]):addSaturationToRGB(G,k.fs.v*O)),k.fb.propType&&(G=O.length?addBrightnessToRGB(G,k.fb.v*O[0]):addBrightnessToRGB(G,k.fb.v*O))}}for(D=0;D<L;D+=1)(k=w[D].a).p.propType&&(O=w[D].s.getMult(T[i].anIndexes[D],S.a[D].s.totalChars),this._hasMaskedPath?O.length?E.translate(0,k.p.v[1]*O[0],-k.p.v[2]*O[1]):E.translate(0,k.p.v[1]*O,-k.p.v[2]*O):O.length?E.translate(k.p.v[0]*O[0],k.p.v[1]*O[1],-k.p.v[2]*O[2]):E.translate(k.p.v[0]*O,k.p.v[1]*O,-k.p.v[2]*O));if(t.strokeWidthAnim&&(W=j<0?0:j),t.strokeColorAnim&&(q="rgb("+Math.round(255*V[0])+","+Math.round(255*V[1])+","+Math.round(255*V[2])+")"),t.fillColorAnim&&t.fc&&($="rgb("+Math.round(255*G[0])+","+Math.round(255*G[1])+","+Math.round(255*G[2])+")"),this._hasMaskedPath){if(E.translate(0,-t.ls),E.translate(0,_[1]*I*.01+n,0),this._pathData.p.v){y=(l.point[1]-u.point[1])/(l.point[0]-u.point[0]);var lt=180*Math.atan(y)/Math.PI;l.point[0]<u.point[0]&&(lt+=180),E.rotate(-lt*Math.PI/180)}E.translate(F,U,0),s-=_[0]*T[i].an*.005,T[i+1]&&Y!==T[i+1].ind&&(s+=T[i].an/2,s+=.001*t.tr*t.finalSize)}else{switch(E.translate(r,n,0),t.ps&&E.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:E.translate(T[i].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[T[i].line]),0,0);break;case 2:E.translate(T[i].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[T[i].line])/2,0,0)}E.translate(0,-t.ls),E.translate(z,0,0),E.translate(_[0]*T[i].an*.005,_[1]*I*.01,0),r+=T[i].l+.001*t.tr*t.finalSize}"html"===M?tt=E.toCSS():"svg"===M?tt=E.to2dCSS():et=[E.props[0],E.props[1],E.props[2],E.props[3],E.props[4],E.props[5],E.props[6],E.props[7],E.props[8],E.props[9],E.props[10],E.props[11],E.props[12],E.props[13],E.props[14],E.props[15]],X=B}A<=i?(R=new LetterProps(X,W,q,$,tt,et),this.renderedLetters.push(R),A+=1,this.lettersChangedFlag=!0):(R=this.renderedLetters[i],this.lettersChangedFlag=R.update(X,W,q,$,tt,et)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(t,e,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(t,e,r),this.textProperty=new TextProperty(this,t.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(t.t,this.renderType,this),this.initTransform(t,e,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(t,e){var r,n,i=e.length,a="";for(r=0;r<i;r+=1)"sh"===e[r].ty&&(n=e[r].ks.k,a+=buildShapeString(n,n.i.length,!0,t));return a},ITextElement.prototype.updateDocumentData=function(t,e){this.textProperty.updateDocumentData(t,e)},ITextElement.prototype.canResizeFont=function(t){this.textProperty.canResizeFont(t)},ITextElement.prototype.setMinimumFontSize=function(t){this.textProperty.setMinimumFontSize(t)},ITextElement.prototype.applyTextPropertiesToMatrix=function(t,e,r,n,i){switch(t.ps&&e.translate(t.ps[0],t.ps[1]+t.ascent,0),e.translate(0,-t.ls,0),t.j){case 1:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r]),0,0);break;case 2:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r])/2,0,0)}e.translate(n,i,0)},ITextElement.prototype.buildColor=function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){};var emptyShapeData={shapes:[]};function SVGTextLottieElement(t,e,r){this.textSpans=[],this.renderType="svg",this.initElement(t,e,r)}function ISolidElement(t,e,r){this.initElement(t,e,r)}function NullElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initFrame(),this.initTransform(t,e,r),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(t,e,r){this.layers=t.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function SVGRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var r="";if(e&&e.title){var n=createNS("title"),i=createElementID();n.setAttribute("id",i),n.textContent=e.title,this.svgElement.appendChild(n),r+=i}if(e&&e.description){var a=createNS("desc"),o=createElementID();a.setAttribute("id",o),a.textContent=e.description,this.svgElement.appendChild(a),r+=" "+o}r&&this.svgElement.setAttribute("aria-labelledby",r);var s=createNS("defs");this.svgElement.appendChild(s);var l=createNS("g");this.svgElement.appendChild(l),this.layerElement=l,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&!1===e.hideOnTransparent),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"},width:e&&e.width,height:e&&e.height,runExpressions:!e||void 0===e.runExpressions||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:s,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CVContextData(){var t;for(this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1,this.savedOp=createTypedArray("float32",15),t=0;t<15;t+=1)this.saved[t]=createTypedArray("float32",16);this._length=15}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function CVEffects(){}function CVMaskElement(t,e){var r;this.data=t,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var n=this.masksProperties.length,i=!1;for(r=0;r<n;r+=1)"n"!==this.masksProperties[r].mode&&(i=!0),this.viewData[r]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[r],3);this.hasMasks=i,i&&this.element.addRenderableComponent(this)}function CVBaseElement(){}function CVShapeData(t,e,r,n){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var i,a=4;"rc"===e.ty?a=5:"el"===e.ty?a=6:"sr"===e.ty&&(a=7),this.sh=ShapePropertyFactory.getShapeProp(t,e,a,t);var o,s=r.length;for(i=0;i<s;i+=1)r[i].closed||(o={transforms:n.addTransformSequence(r[i].transforms),trNodes:[]},this.styledShapes.push(o),r[i].elements.push(o))}function CVShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(t,e,r)}function CVTextElement(t,e,r){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(t,e,r)}function CVImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(t,e,r)}function CVSolidElement(t,e,r){this.initElement(t,e,r)}function CanvasRendererBase(t,e){this.animationItem=t,this.renderConfig={clearCanvas:!e||void 0===e.clearCanvas||e.clearCanvas,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||""},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function CVCompElement(t,e,r){this.completeLayers=!1,this.layers=t.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function CanvasRenderer(t,e){this.animationItem=t,this.renderConfig={clearCanvas:!e||void 0===e.clearCanvas||e.clearCanvas,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||"",runExpressions:!e||void 0===e.runExpressions||e.runExpressions},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HBaseElement(){}function HSolidElement(t,e,r){this.initElement(t,e,r)}function HShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(t,e,r),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(t,e,r){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(t,e,r)}function HCameraElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initHierarchy();var n=PropertyFactory.getProp;if(this.pe=n(this,t.pe,0,0,this),t.ks.p.s?(this.px=n(this,t.ks.p.x,1,0,this),this.py=n(this,t.ks.p.y,1,0,this),this.pz=n(this,t.ks.p.z,1,0,this)):this.p=n(this,t.ks.p,1,0,this),t.ks.a&&(this.a=n(this,t.ks.a,1,0,this)),t.ks.or.k.length&&t.ks.or.k[0].to){var i,a=t.ks.or.k.length;for(i=0;i<a;i+=1)t.ks.or.k[i].to=null,t.ks.or.k[i].ti=null}this.or=n(this,t.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=n(this,t.ks.rx,0,degToRads,this),this.ry=n(this,t.ks.ry,0,degToRads,this),this.rz=n(this,t.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,r)}function HybridRendererBase(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&!1===e.hideOnTransparent),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(t,e,r){this.layers=t.layers,this.supports3d=!t.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function HybridRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&!1===e.hideOnTransparent),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"},runExpressions:!e||void 0===e.runExpressions||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(t){for(var e=0,r=t.length,n=[],i="";e<r;)t[e]===String.fromCharCode(13)||t[e]===String.fromCharCode(3)?(n.push(i),i=""):i+=t[e],e+=1;return n.push(i),n},SVGTextLottieElement.prototype.buildShapeData=function(t,e){if(t.shapes&&t.shapes.length){var r=t.shapes[0];if(r.it){var n=r.it[r.it.length-1];n.s&&(n.s.k[0]=e,n.s.k[1]=e)}}return t},SVGTextLottieElement.prototype.buildNewText=function(){var t,e;this.addDynamicProperty(this);var r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize);var n=this.globalData.fontManager.getFontByName(r.f);if(n.fClass)this.layerElement.setAttribute("class",n.fClass);else{this.layerElement.setAttribute("font-family",n.fFamily);var i=r.fWeight,a=r.fStyle;this.layerElement.setAttribute("font-style",a),this.layerElement.setAttribute("font-weight",i)}this.layerElement.setAttribute("aria-label",r.t);var o,s=r.l||[],l=!!this.globalData.fontManager.chars;e=s.length;var c=this.mHelper,h=this.data.singleShape,d=0,p=0,u=!0,m=.001*r.tr*r.finalSize;if(!h||l||r.sz){var f,g=this.textSpans.length;for(t=0;t<e;t+=1){if(this.textSpans[t]||(this.textSpans[t]={span:null,childSpan:null,glyph:null}),!l||!h||0===t){if(o=g>t?this.textSpans[t].span:createNS(l?"g":"text"),g<=t){if(o.setAttribute("stroke-linecap","butt"),o.setAttribute("stroke-linejoin","round"),o.setAttribute("stroke-miterlimit","4"),this.textSpans[t].span=o,l){var v=createNS("g");o.appendChild(v),this.textSpans[t].childSpan=v}this.textSpans[t].span=o,this.layerElement.appendChild(o)}o.style.display="inherit"}if(c.reset(),h&&(s[t].n&&(d=-m,p+=r.yOffset,p+=u?1:0,u=!1),this.applyTextPropertiesToMatrix(r,c,s[t].line,d,p),d+=s[t].l||0,d+=m),l){var b;if(1===(f=this.globalData.fontManager.getCharData(r.finalText[t],n.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily)).t)b=new SVGCompElement(f.data,this.globalData,this);else{var y=emptyShapeData;f.data&&f.data.shapes&&(y=this.buildShapeData(f.data,r.finalSize)),b=new SVGShapeElement(y,this.globalData,this)}if(this.textSpans[t].glyph){var x=this.textSpans[t].glyph;this.textSpans[t].childSpan.removeChild(x.layerElement),x.destroy()}this.textSpans[t].glyph=b,b._debug=!0,b.prepareFrame(0),b.renderFrame(),this.textSpans[t].childSpan.appendChild(b.layerElement),1===f.t&&this.textSpans[t].childSpan.setAttribute("transform","scale("+r.finalSize/100+","+r.finalSize/100+")")}else h&&o.setAttribute("transform","translate("+c.props[12]+","+c.props[13]+")"),o.textContent=s[t].val,o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}h&&o&&o.setAttribute("d","")}else{var _=this.textContainer,w="start";switch(r.j){case 1:w="end";break;case 2:w="middle";break;default:w="start"}_.setAttribute("text-anchor",w),_.setAttribute("letter-spacing",m);var S=this.buildTextContents(r.finalText);for(e=S.length,p=r.ps?r.ps[1]+r.ascent:0,t=0;t<e;t+=1)(o=this.textSpans[t].span||createNS("tspan")).textContent=S[t],o.setAttribute("x",0),o.setAttribute("y",p),o.style.display="inherit",_.appendChild(o),this.textSpans[t]||(this.textSpans[t]={span:null,glyph:null}),this.textSpans[t].span=o,p+=r.finalLineHeight;this.layerElement.appendChild(_)}for(;t<this.textSpans.length;)this.textSpans[t].span.style.display="none",t+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var t,e,r=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,t=0;t<r;t+=1)(e=this.textSpans[t].glyph)&&(e.prepareFrame(this.comp.renderedFrame-this.data.st),e._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if((!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var t,e;this._sizeChanged=!0;var r,n,i,a=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;for(e=o.length,t=0;t<e;t+=1)o[t].n||(r=a[t],n=this.textSpans[t].span,(i=this.textSpans[t].glyph)&&i.renderFrame(),r._mdf.m&&n.setAttribute("transform",r.m),r._mdf.o&&n.setAttribute("opacity",r.o),r._mdf.sw&&n.setAttribute("stroke-width",r.sw),r._mdf.sc&&n.setAttribute("stroke",r.sc),r._mdf.fc&&n.setAttribute("fill",r.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var t=createNS("rect");t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.layerElement.appendChild(t)},NullElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(t){return new NullElement(t,this.globalData,this)},SVGRendererBase.prototype.createShape=function(t){return new SVGShapeElement(t,this.globalData,this)},SVGRendererBase.prototype.createText=function(t){return new SVGTextLottieElement(t,this.globalData,this)},SVGRendererBase.prototype.createImage=function(t){return new IImageElement(t,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(t){return new ISolidElement(t,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(t){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+t.w+" "+t.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",t.w),this.svgElement.setAttribute("height",t.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(t,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=t;var r=createNS("clipPath"),n=createNS("rect");n.setAttribute("width",t.w),n.setAttribute("height",t.h),n.setAttribute("x",0),n.setAttribute("y",0);var i=createElementID();r.setAttribute("id",i),r.appendChild(n),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+i+")"),e.appendChild(r),this.layers=t.layers,this.elements=createSizedArray(t.layers.length)},SVGRendererBase.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(t){var e=0,r=this.layers.length;for(e=0;e<r;e+=1)if(this.layers[e].ind===t)return e;return-1},SVGRendererBase.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){e[t]=!0;var r=this.createItem(this.layers[t]);if(e[t]=r,getExpressionsPlugin()&&(0===this.layers[t].ty&&this.globalData.projectInterface.registerComposition(r),r.initExpressions()),this.appendElementInPos(r,t),this.layers[t].tt){var n="tp"in this.layers[t]?this.findIndexByInd(this.layers[t].tp):t-1;if(-1===n)return;if(this.elements[n]&&!0!==this.elements[n]){var i=e[n].getMatte(this.layers[t].tt);r.setMatte(i)}else this.buildItem(n),this.addPendingElement(r)}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();if(t.checkParenting(),t.data.tt)for(var e=0,r=this.elements.length;e<r;){if(this.elements[e]===t){var n="tp"in t.data?this.findIndexByInd(t.data.tp):e-1,i=this.elements[n].getMatte(this.layers[e].tt);t.setMatte(i);break}e+=1}}},SVGRendererBase.prototype.renderFrame=function(t){if(this.renderedFrame!==t&&!this.destroyed){var e;null===t?t=this.renderedFrame:this.renderedFrame=t,this.globalData.frameNum=t,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=t,this.globalData._mdf=!1;var r=this.layers.length;for(this.completeLayers||this.checkLayers(t),e=r-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(t-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<r;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){for(var n,i=0;i<e;)this.elements[i]&&!0!==this.elements[i]&&this.elements[i].getBaseElement()&&(n=this.elements[i].getBaseElement()),i+=1;n?this.layerElement.insertBefore(r,n):this.layerElement.appendChild(r)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initTransform(t,e,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&e.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(t){if(this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=t/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var r,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(t){this.elements=t},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)},CVContextData.prototype.duplicate=function(){var t=2*this._length,e=this.savedOp;this.savedOp=createTypedArray("float32",t),this.savedOp.set(e);var r=0;for(r=this._length;r<t;r+=1)this.saved[r]=createTypedArray("float32",16);this._length=t},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},ShapeTransformManager.prototype={addTransformSequence:function(t){var e,r=t.length,n="_";for(e=0;e<r;e+=1)n+=t[e].transform.key+"_";var i=this.sequences[n];return i||(i={transforms:[].concat(t),finalTransform:new Matrix,_mdf:!1},this.sequences[n]=i,this.sequenceList.push(i)),i},processSequence:function(t,e){for(var r,n=0,i=t.transforms.length,a=e;n<i&&!e;){if(t.transforms[n].transform.mProps._mdf){a=!0;break}n+=1}if(a)for(t.finalTransform.reset(),n=i-1;n>=0;n-=1)r=t.transforms[n].transform.mProps.v.props,t.finalTransform.transform(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]);t._mdf=a},processSequences:function(t){var e,r=this.sequenceList.length;for(e=0;e<r;e+=1)this.processSequence(this.sequenceList[e],t)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}},CVEffects.prototype.renderFrame=function(){},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var t,e,r,n,i=this.element.finalTransform.mat,a=this.element.canvasContext,o=this.masksProperties.length;for(a.beginPath(),t=0;t<o;t+=1)if("n"!==this.masksProperties[t].mode){var s;this.masksProperties[t].inv&&(a.moveTo(0,0),a.lineTo(this.element.globalData.compSize.w,0),a.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),a.lineTo(0,this.element.globalData.compSize.h),a.lineTo(0,0)),n=this.viewData[t].v,e=i.applyToPointArray(n.v[0][0],n.v[0][1],0),a.moveTo(e[0],e[1]);var l=n._length;for(s=1;s<l;s+=1)r=i.applyToTriplePoints(n.o[s-1],n.i[s],n.v[s]),a.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);r=i.applyToTriplePoints(n.o[s-1],n.i[0],n.v[0]),a.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])}this.element.globalData.renderer.save(!0),a.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null},CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects(this)},createContent:function(){},setBlendMode:function(){var t=this.globalData;if(t.blendMode!==this.data.bm){t.blendMode=this.data.bm;var e=getBlendMode(this.data.bm);t.canvasContext.globalCompositeOperation=e}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!this.hidden&&!this.data.hd){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var t=0===this.data.ty;this.globalData.renderer.save(t),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(t),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(t,e){var r={data:t,type:t.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:!0===t.hd},n={};if("fl"===t.ty||"st"===t.ty?(n.c=PropertyFactory.getProp(this,t.c,1,255,this),n.c.k||(r.co="rgb("+bmFloor(n.c.v[0])+","+bmFloor(n.c.v[1])+","+bmFloor(n.c.v[2])+")")):"gf"!==t.ty&&"gs"!==t.ty||(n.s=PropertyFactory.getProp(this,t.s,1,null,this),n.e=PropertyFactory.getProp(this,t.e,1,null,this),n.h=PropertyFactory.getProp(this,t.h||{k:0},0,.01,this),n.a=PropertyFactory.getProp(this,t.a||{k:0},0,degToRads,this),n.g=new GradientProperty(this,t.g,this)),n.o=PropertyFactory.getProp(this,t.o,0,.01,this),"st"===t.ty||"gs"===t.ty){if(r.lc=lineCapEnum[t.lc||2],r.lj=lineJoinEnum[t.lj||2],1==t.lj&&(r.ml=t.ml),n.w=PropertyFactory.getProp(this,t.w,0,null,this),n.w.k||(r.wi=n.w.v),t.d){var i=new DashProperty(this,t.d,"canvas",this);n.d=i,n.d.k||(r.da=n.d.dashArray,r.do=n.d.dashoffset[0])}}else r.r=2===t.r?"evenodd":"nonzero";return this.stylesList.push(r),n.style=r,n},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(t){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,t.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,t,this)}}},CVShapeElement.prototype.createShapeElement=function(t){var e=new CVShapeData(this,t,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(t){var e,r=this.stylesList.length;for(e=0;e<r;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(t)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var t,e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.pop()},CVShapeElement.prototype.closeStyles=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].closed=!0},CVShapeElement.prototype.searchShapes=function(t,e,r,n,i){var a,o,s,l,c,h,d=t.length-1,p=[],u=[],m=[].concat(i);for(a=d;a>=0;a-=1){if((l=this.searchProcessedElement(t[a]))?e[a]=r[l-1]:t[a]._shouldRender=n,"fl"===t[a].ty||"st"===t[a].ty||"gf"===t[a].ty||"gs"===t[a].ty)l?e[a].style.closed=!1:e[a]=this.createStyleElement(t[a],m),p.push(e[a].style);else if("gr"===t[a].ty){if(l)for(s=e[a].it.length,o=0;o<s;o+=1)e[a].prevViewData[o]=e[a].it[o];else e[a]=this.createGroupElement(t[a]);this.searchShapes(t[a].it,e[a].it,e[a].prevViewData,n,m)}else"tr"===t[a].ty?(l||(h=this.createTransformElement(t[a]),e[a]=h),m.push(e[a]),this.addTransformToStyleList(e[a])):"sh"===t[a].ty||"rc"===t[a].ty||"el"===t[a].ty||"sr"===t[a].ty?l||(e[a]=this.createShapeElement(t[a])):"tm"===t[a].ty||"rd"===t[a].ty||"pb"===t[a].ty||"zz"===t[a].ty||"op"===t[a].ty?(l?(c=e[a]).closed=!1:((c=ShapeModifiers.getModifier(t[a].ty)).init(this,t[a]),e[a]=c,this.shapeModifiers.push(c)),u.push(c)):"rp"===t[a].ty&&(l?(c=e[a]).closed=!0:(c=ShapeModifiers.getModifier(t[a].ty),e[a]=c,c.init(this,t,a,e),this.shapeModifiers.push(c),n=!1),u.push(c));this.addProcessedElement(t[a],a+1)}for(this.removeTransformFromStyleList(),this.closeStyles(p),d=u.length,a=0;a<d;a+=1)u[a].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(t,e){(t._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=t.opacity,e.opacity*=e.op.v,e._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var t,e,r,n,i,a,o,s,l,c=this.stylesList.length,h=this.globalData.renderer,d=this.globalData.canvasContext;for(t=0;t<c;t+=1)if(("st"!==(s=(l=this.stylesList[t]).type)&&"gs"!==s||0!==l.wi)&&l.data._shouldRender&&0!==l.coOp&&0!==this.globalData.currentGlobalAlpha){for(h.save(),a=l.elements,"st"===s||"gs"===s?(d.strokeStyle="st"===s?l.co:l.grd,d.lineWidth=l.wi,d.lineCap=l.lc,d.lineJoin=l.lj,d.miterLimit=l.ml||0):d.fillStyle="fl"===s?l.co:l.grd,h.ctxOpacity(l.coOp),"st"!==s&&"gs"!==s&&d.beginPath(),h.ctxTransform(l.preTransforms.finalTransform.props),r=a.length,e=0;e<r;e+=1){for("st"!==s&&"gs"!==s||(d.beginPath(),l.da&&(d.setLineDash(l.da),d.lineDashOffset=l.do)),i=(o=a[e].trNodes).length,n=0;n<i;n+=1)"m"===o[n].t?d.moveTo(o[n].p[0],o[n].p[1]):"c"===o[n].t?d.bezierCurveTo(o[n].pts[0],o[n].pts[1],o[n].pts[2],o[n].pts[3],o[n].pts[4],o[n].pts[5]):d.closePath();"st"!==s&&"gs"!==s||(d.stroke(),l.da&&d.setLineDash(this.dashResetter))}"st"!==s&&"gs"!==s&&d.fill(l.r),h.restore()}},CVShapeElement.prototype.renderShape=function(t,e,r,n){var i,a;for(a=t,i=e.length-1;i>=0;i-=1)"tr"===e[i].ty?(a=r[i].transform,this.renderShapeTransform(t,a)):"sh"===e[i].ty||"el"===e[i].ty||"rc"===e[i].ty||"sr"===e[i].ty?this.renderPath(e[i],r[i]):"fl"===e[i].ty?this.renderFill(e[i],r[i],a):"st"===e[i].ty?this.renderStroke(e[i],r[i],a):"gf"===e[i].ty||"gs"===e[i].ty?this.renderGradientFill(e[i],r[i],a):"gr"===e[i].ty?this.renderShape(a,e[i].it,r[i].it):e[i].ty;n&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(t,e){if(this._isFirstFrame||e._mdf||t.transforms._mdf){var r,n,i,a=t.trNodes,o=e.paths,s=o._length;a.length=0;var l=t.transforms.finalTransform;for(i=0;i<s;i+=1){var c=o.shapes[i];if(c&&c.v){for(n=c._length,r=1;r<n;r+=1)1===r&&a.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),a.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[r],c.v[r])});1===n&&a.push({t:"m",p:l.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&n&&(a.push({t:"c",pts:l.applyToTriplePoints(c.o[r-1],c.i[0],c.v[0])}),a.push({t:"z"}))}}t.trNodes=a}},CVShapeElement.prototype.renderPath=function(t,e){if(!0!==t.hd&&t._shouldRender){var r,n=e.styledShapes.length;for(r=0;r<n;r+=1)this.renderStyledShape(e.styledShapes[r],e.sh)}},CVShapeElement.prototype.renderFill=function(t,e,r){var n=e.style;(e.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=e.o.v*r.opacity)},CVShapeElement.prototype.renderGradientFill=function(t,e,r){var n,i=e.style;if(!i.grd||e.g._mdf||e.s._mdf||e.e._mdf||1!==t.t&&(e.h._mdf||e.a._mdf)){var a,o=this.globalData.canvasContext,s=e.s.v,l=e.e.v;if(1===t.t)n=o.createLinearGradient(s[0],s[1],l[0],l[1]);else{var c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2)),h=Math.atan2(l[1]-s[1],l[0]-s[0]),d=e.h.v;d>=1?d=.99:d<=-1&&(d=-.99);var p=c*d,u=Math.cos(h+e.a.v)*p+s[0],m=Math.sin(h+e.a.v)*p+s[1];n=o.createRadialGradient(u,m,0,s[0],s[1],c)}var f=t.g.p,g=e.g.c,v=1;for(a=0;a<f;a+=1)e.g._hasOpacity&&e.g._collapsable&&(v=e.g.o[2*a+1]),n.addColorStop(g[4*a]/100,"rgba("+g[4*a+1]+","+g[4*a+2]+","+g[4*a+3]+","+v+")");i.grd=n}i.coOp=e.o.v*r.opacity},CVShapeElement.prototype.renderStroke=function(t,e,r){var n=e.style,i=e.d;i&&(i._mdf||this._isFirstFrame)&&(n.da=i.dashArray,n.do=i.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=e.o.v*r.opacity),(e.w._mdf||this._isFirstFrame)&&(n.wi=e.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=!1;t.fc?(e=!0,this.values.fill=this.buildColor(t.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var r=!1;t.sc&&(r=!0,this.values.stroke=this.buildColor(t.sc),this.values.sWidth=t.sw);var n,i,a,o,s,l,c,h,d,p,u,m,f=this.globalData.fontManager.getFontByName(t.f),g=t.l,v=this.mHelper;this.stroke=r,this.values.fValue=t.finalSize+"px "+this.globalData.fontManager.getFontByName(t.f).fFamily,i=t.finalText.length;var b=this.data.singleShape,y=.001*t.tr*t.finalSize,x=0,_=0,w=!0,S=0;for(n=0;n<i;n+=1){o=(a=this.globalData.fontManager.getCharData(t.finalText[n],f.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily))&&a.data||{},v.reset(),b&&g[n].n&&(x=-y,_+=t.yOffset,_+=w?1:0,w=!1),d=(c=o.shapes?o.shapes[0].it:[]).length,v.scale(t.finalSize/100,t.finalSize/100),b&&this.applyTextPropertiesToMatrix(t,v,g[n].line,x,_),u=createSizedArray(d-1);var E=0;for(h=0;h<d;h+=1)if("sh"===c[h].ty){for(l=c[h].ks.k.i.length,p=c[h].ks.k,m=[],s=1;s<l;s+=1)1===s&&m.push(v.applyToX(p.v[0][0],p.v[0][1],0),v.applyToY(p.v[0][0],p.v[0][1],0)),m.push(v.applyToX(p.o[s-1][0],p.o[s-1][1],0),v.applyToY(p.o[s-1][0],p.o[s-1][1],0),v.applyToX(p.i[s][0],p.i[s][1],0),v.applyToY(p.i[s][0],p.i[s][1],0),v.applyToX(p.v[s][0],p.v[s][1],0),v.applyToY(p.v[s][0],p.v[s][1],0));m.push(v.applyToX(p.o[s-1][0],p.o[s-1][1],0),v.applyToY(p.o[s-1][0],p.o[s-1][1],0),v.applyToX(p.i[0][0],p.i[0][1],0),v.applyToY(p.i[0][0],p.i[0][1],0),v.applyToX(p.v[0][0],p.v[0][1],0),v.applyToY(p.v[0][0],p.v[0][1],0)),u[E]=m,E+=1}b&&(x+=g[n].l,x+=y),this.textSpans[S]?this.textSpans[S].elem=u:this.textSpans[S]={elem:u},S+=1}},CVTextElement.prototype.renderInnerContent=function(){var t,e,r,n,i,a,o=this.canvasContext;o.font=this.values.fValue,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var s,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;e=c.length;var h,d,p=null,u=null,m=null;for(t=0;t<e;t+=1)if(!c[t].n){if((s=l[t])&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(s.p),this.globalData.renderer.ctxOpacity(s.o)),this.fill){for(s&&s.fc?p!==s.fc&&(p=s.fc,o.fillStyle=s.fc):p!==this.values.fill&&(p=this.values.fill,o.fillStyle=this.values.fill),n=(h=this.textSpans[t].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<n;r+=1)for(a=(d=h[r]).length,this.globalData.canvasContext.moveTo(d[0],d[1]),i=2;i<a;i+=6)this.globalData.canvasContext.bezierCurveTo(d[i],d[i+1],d[i+2],d[i+3],d[i+4],d[i+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(s&&s.sw?m!==s.sw&&(m=s.sw,o.lineWidth=s.sw):m!==this.values.sWidth&&(m=this.values.sWidth,o.lineWidth=this.values.sWidth),s&&s.sc?u!==s.sc&&(u=s.sc,o.strokeStyle=s.sc):u!==this.values.stroke&&(u=this.values.stroke,o.strokeStyle=this.values.stroke),n=(h=this.textSpans[t].elem).length,this.globalData.canvasContext.beginPath(),r=0;r<n;r+=1)for(a=(d=h[r]).length,this.globalData.canvasContext.moveTo(d[0],d[1]),i=2;i<a;i+=6)this.globalData.canvasContext.bezierCurveTo(d[i],d[i+1],d[i+2],d[i+3],d[i+4],d[i+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}s&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var t=createTag("canvas");t.width=this.assetData.w,t.height=this.assetData.h;var e,r,n=t.getContext("2d"),i=this.img.width,a=this.img.height,o=i/a,s=this.assetData.w/this.assetData.h,l=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;o>s&&"xMidYMid slice"===l||o<s&&"xMidYMid slice"!==l?e=(r=a)*s:r=(e=i)/s,n.drawImage(this.img,(i-e)/2,(a-r)/2,e,r,0,0,this.assetData.w,this.assetData.h),this.img=t}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var t=this.canvasContext;t.fillStyle=this.data.sc,t.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(t){return new CVShapeElement(t,this.globalData,this)},CanvasRendererBase.prototype.createText=function(t){return new CVTextElement(t,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(t){return new CVImageElement(t,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(t){return new CVSolidElement(t,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(t){if(1!==t[0]||0!==t[1]||0!==t[4]||1!==t[5]||0!==t[12]||0!==t[13])if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(t);var e=this.contextData.cTr.props;this.transformMat.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var r=this.contextData.cTr.props;this.canvasContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13])}else this.canvasContext.transform(t[0],t[1],t[4],t[5],t[12],t[13])},CanvasRendererBase.prototype.ctxOpacity=function(t){if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=t<0?0:t,void(this.globalData.currentGlobalAlpha=this.contextData.cO);this.contextData.cO*=t<0?0:t,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(t){if(this.renderConfig.clearCanvas){t&&this.canvasContext.save();var e,r=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var n=this.contextData.saved[this.contextData.cArrPos];for(e=0;e<16;e+=1)n[e]=r[e];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1}else this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(t){if(this.renderConfig.clearCanvas){t&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var e,r=this.contextData.saved[this.contextData.cArrPos],n=this.contextData.cTr.props;for(e=0;e<16;e+=1)n[e]=r[e];this.canvasContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13]),r=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=r,this.globalData.currentGlobalAlpha!==r&&(this.canvasContext.globalAlpha=r,this.globalData.currentGlobalAlpha=r)}else this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(t){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var r="0px 0px 0px";e.transformOrigin=r,e.mozTransformOrigin=r,e.webkitTransformOrigin=r,e["-webkit-transform"]=r,e.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=t,this.layers=t.layers,this.transformCanvas={w:t.w,h:t.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(t,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(t.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(t,e){var r,n,i,a;if(this.reset(),t?(r=t,n=e,this.canvasContext.canvas.width=r,this.canvasContext.canvas.height=n):(this.animationItem.wrapper&&this.animationItem.container?(r=this.animationItem.wrapper.offsetWidth,n=this.animationItem.wrapper.offsetHeight):(r=this.canvasContext.canvas.width,n=this.canvasContext.canvas.height),this.canvasContext.canvas.width=r*this.renderConfig.dpr,this.canvasContext.canvas.height=n*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var o=this.renderConfig.preserveAspectRatio.split(" "),s=o[1]||"meet",l=o[0]||"xMidYMid",c=l.substr(0,4),h=l.substr(4);i=r/n,(a=this.transformCanvas.w/this.transformCanvas.h)>i&&"meet"===s||a<i&&"slice"===s?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===c&&(a<i&&"meet"===s||a>i&&"slice"===s)?(r-this.transformCanvas.w*(n/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===c&&(a<i&&"meet"===s||a>i&&"slice"===s)?(r-this.transformCanvas.w*(n/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===h&&(a>i&&"meet"===s||a<i&&"slice"===s)?(n-this.transformCanvas.h*(r/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===h&&(a>i&&"meet"===s||a<i&&"slice"===s)?(n-this.transformCanvas.h*(r/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){var t;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),t=(this.layers?this.layers.length:0)-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(t,e){if((this.renderedFrame!==t||!0!==this.renderConfig.clearCanvas||e)&&!this.destroyed&&-1!==t){var r;this.renderedFrame=t,this.globalData.frameNum=t-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=t;var n=this.layers.length;for(this.completeLayers||this.checkLayers(t),r=0;r<n;r+=1)(this.completeLayers||this.elements[r])&&this.elements[r].prepareFrame(t-this.layers[r].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){var r=this.createItem(this.layers[t],this,this.globalData);e[t]=r,r.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var t,e=this.canvasContext;for(e.beginPath(),e.moveTo(0,0),e.lineTo(this.data.w,0),e.lineTo(this.data.w,this.data.h),e.lineTo(0,this.data.h),e.lineTo(0,0),e.clip(),t=this.layers.length-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},CVCompElement.prototype.destroy=function(){var t;for(t=this.layers.length-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var t=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var e=this.finalTransform.mat.toCSS();t.transform=e,t.webkitTransform=e}this.finalTransform._opMdf&&(t.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var t;this.data.hasMask?((t=createNS("rect")).setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((t=createTag("div")).style.width=this.data.sw+"px",t.style.height=this.data.sh+"px",t.style.backgroundColor=this.data.sc),this.layerElement.appendChild(t)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var t;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),t=this.svgElement;else{t=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;t.setAttribute("width",e.w),t.setAttribute("height",e.h),t.appendChild(this.shapesContainer),this.layerElement.appendChild(t)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=t},HShapeElement.prototype.getTransformedPoint=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)e=t[r].mProps.v.applyToPointArray(e[0],e[1],0);return e},HShapeElement.prototype.calculateShapeBoundingBox=function(t,e){var r,n,i,a,o,s=t.sh.v,l=t.transformers,c=s._length;if(!(c<=1)){for(r=0;r<c-1;r+=1)n=this.getTransformedPoint(l,s.v[r]),i=this.getTransformedPoint(l,s.o[r]),a=this.getTransformedPoint(l,s.i[r+1]),o=this.getTransformedPoint(l,s.v[r+1]),this.checkBounds(n,i,a,o,e);s.c&&(n=this.getTransformedPoint(l,s.v[r]),i=this.getTransformedPoint(l,s.o[r]),a=this.getTransformedPoint(l,s.i[0]),o=this.getTransformedPoint(l,s.v[0]),this.checkBounds(n,i,a,o,e))}},HShapeElement.prototype.checkBounds=function(t,e,r,n,i){this.getBoundsOfCurve(t,e,r,n);var a=this.shapeBoundingBox;i.x=bmMin(a.left,i.x),i.xMax=bmMax(a.right,i.xMax),i.y=bmMin(a.top,i.y),i.yMax=bmMax(a.bottom,i.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(t,e,r,n){for(var i,a,o,s,l,c,h,d=[[t[0],n[0]],[t[1],n[1]]],p=0;p<2;++p)a=6*t[p]-12*e[p]+6*r[p],i=-3*t[p]+9*e[p]-9*r[p]+3*n[p],o=3*e[p]-3*t[p],a|=0,o|=0,0==(i|=0)&&0===a||(0===i?(s=-o/a)>0&&s<1&&d[p].push(this.calculateF(s,t,e,r,n,p)):(l=a*a-4*o*i)>=0&&((c=(-a+bmSqrt(l))/(2*i))>0&&c<1&&d[p].push(this.calculateF(c,t,e,r,n,p)),(h=(-a-bmSqrt(l))/(2*i))>0&&h<1&&d[p].push(this.calculateF(h,t,e,r,n,p))));this.shapeBoundingBox.left=bmMin.apply(null,d[0]),this.shapeBoundingBox.top=bmMin.apply(null,d[1]),this.shapeBoundingBox.right=bmMax.apply(null,d[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,d[1])},HShapeElement.prototype.calculateF=function(t,e,r,n,i,a){return bmPow(1-t,3)*e[a]+3*bmPow(1-t,2)*t*r[a]+3*(1-t)*bmPow(t,2)*n[a]+bmPow(t,3)*i[a]},HShapeElement.prototype.calculateBoundingBox=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)t[r]&&t[r].sh?this.calculateShapeBoundingBox(t[r],e):t[r]&&t[r].it?this.calculateBoundingBox(t[r].it,e):t[r]&&t[r].style&&t[r].w&&this.expandStrokeBoundingBox(t[r].w,e)},HShapeElement.prototype.expandStrokeBoundingBox=function(t,e){var r=0;if(t.keyframes){for(var n=0;n<t.keyframes.length;n+=1){var i=t.keyframes[n].s;i>r&&(r=i)}r*=t.mult}else r=t.v*t.mult;e.x-=r,e.xMax+=r,e.y-=r,e.yMax+=r},HShapeElement.prototype.currentBoxContains=function(t){return this.currentBBox.x<=t.x&&this.currentBBox.y<=t.y&&this.currentBBox.width+this.currentBBox.x>=t.x+t.width&&this.currentBBox.height+this.currentBBox.y>=t.y+t.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var t=this.tempBoundingBox,e=999999;if(t.x=e,t.xMax=-e,t.y=e,t.yMax=-e,this.calculateBoundingBox(this.itemsData,t),t.width=t.xMax<t.x?0:t.xMax-t.x,t.height=t.yMax<t.y?0:t.yMax-t.y,this.currentBoxContains(t))return;var r=!1;if(this.currentBBox.w!==t.width&&(this.currentBBox.w=t.width,this.shapeCont.setAttribute("width",t.width),r=!0),this.currentBBox.h!==t.height&&(this.currentBBox.h=t.height,this.shapeCont.setAttribute("height",t.height),r=!0),r||this.currentBBox.x!==t.x||this.currentBBox.y!==t.y){this.currentBBox.w=t.width,this.currentBBox.h=t.height,this.currentBBox.x=t.x,this.currentBBox.y=t.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var n=this.shapeCont.style,i="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";n.transform=i,n.webkitTransform=i}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var t=createNS("g");this.maskedElement.appendChild(t),this.innerElem=t}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=this.innerElem.style,r=t.fc?this.buildColor(t.fc):"rgba(0,0,0,0)";e.fill=r,e.color=r,t.sc&&(e.stroke=this.buildColor(t.sc),e.strokeWidth=t.sw+"px");var n,i,a=this.globalData.fontManager.getFontByName(t.f);if(!this.globalData.fontManager.chars)if(e.fontSize=t.finalSize+"px",e.lineHeight=t.finalSize+"px",a.fClass)this.innerElem.className=a.fClass;else{e.fontFamily=a.fFamily;var o=t.fWeight,s=t.fStyle;e.fontStyle=s,e.fontWeight=o}var l,c,h,d=t.l;i=d.length;var p,u=this.mHelper,m="",f=0;for(n=0;n<i;n+=1){if(this.globalData.fontManager.chars?(this.textPaths[f]?l=this.textPaths[f]:((l=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),l.setAttribute("stroke-linejoin",lineJoinEnum[2]),l.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[f]?h=(c=this.textSpans[f]).children[0]:((c=createTag("div")).style.lineHeight=0,(h=createNS("svg")).appendChild(l),styleDiv(c)))):this.isMasked?l=this.textPaths[f]?this.textPaths[f]:createNS("text"):this.textSpans[f]?(c=this.textSpans[f],l=this.textPaths[f]):(styleDiv(c=createTag("span")),styleDiv(l=createTag("span")),c.appendChild(l)),this.globalData.fontManager.chars){var g,v=this.globalData.fontManager.getCharData(t.finalText[n],a.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily);if(g=v?v.data:null,u.reset(),g&&g.shapes&&g.shapes.length&&(p=g.shapes[0].it,u.scale(t.finalSize/100,t.finalSize/100),m=this.createPathShape(u,p),l.setAttribute("d",m)),this.isMasked)this.innerElem.appendChild(l);else{if(this.innerElem.appendChild(c),g&&g.shapes){document.body.appendChild(h);var b=h.getBBox();h.setAttribute("width",b.width+2),h.setAttribute("height",b.height+2),h.setAttribute("viewBox",b.x-1+" "+(b.y-1)+" "+(b.width+2)+" "+(b.height+2));var y=h.style,x="translate("+(b.x-1)+"px,"+(b.y-1)+"px)";y.transform=x,y.webkitTransform=x,d[n].yOffset=b.y-1}else h.setAttribute("width",1),h.setAttribute("height",1);c.appendChild(h)}}else if(l.textContent=d[n].val,l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(l);else{this.innerElem.appendChild(c);var _=l.style,w="translate3d(0,"+-t.finalSize/1.2+"px,0)";_.transform=w,_.webkitTransform=w}this.isMasked?this.textSpans[f]=l:this.textSpans[f]=c,this.textSpans[f].style.display="block",this.textPaths[f]=l,f+=1}for(;f<this.textSpans.length;)this.textSpans[f].style.display="none",f+=1},HTextElement.prototype.renderInnerContent=function(){var t;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),t=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";t.transform=e,t.webkitTransform=e}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var r,n,i,a,o,s=0,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;for(n=c.length,r=0;r<n;r+=1)c[r].n?s+=1:(a=this.textSpans[r],o=this.textPaths[r],i=l[s],s+=1,i._mdf.m&&(this.isMasked?a.setAttribute("transform",i.m):(a.style.webkitTransform=i.m,a.style.transform=i.m)),a.style.opacity=i.o,i.sw&&i._mdf.sw&&o.setAttribute("stroke-width",i.sw),i.sc&&i._mdf.sc&&o.setAttribute("stroke",i.sc),i.fc&&i._mdf.fc&&(o.setAttribute("fill",i.fc),o.style.color=i.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var h=this.innerElem.getBBox();if(this.currentBBox.w!==h.width&&(this.currentBBox.w=h.width,this.svgElement.setAttribute("width",h.width)),this.currentBBox.h!==h.height&&(this.currentBBox.h=h.height,this.svgElement.setAttribute("height",h.height)),this.currentBBox.w!==h.width+2||this.currentBBox.h!==h.height+2||this.currentBBox.x!==h.x-1||this.currentBBox.y!==h.y-1){this.currentBBox.w=h.width+2,this.currentBBox.h=h.height+2,this.currentBBox.x=h.x-1,this.currentBBox.y=h.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),t=this.svgElement.style;var d="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";t.transform=d,t.webkitTransform=d}}}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var t,e,r,n,i=this.comp.threeDElements.length;for(t=0;t<i;t+=1)if("3d"===(e=this.comp.threeDElements[t]).type){r=e.perspectiveElem.style,n=e.container.style;var a=this.pe.v+"px",o="0px 0px 0px",s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.perspective=a,r.webkitPerspective=a,n.transformOrigin=o,n.mozTransformOrigin=o,n.webkitTransformOrigin=o,r.transform=s,r.webkitTransform=s}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var t,e,r=this._isFirstFrame;if(this.hierarchy)for(e=this.hierarchy.length,t=0;t<e;t+=1)r=this.hierarchy[t].finalTransform.mProp._mdf||r;if(r||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(t=e=this.hierarchy.length-1;t>=0;t-=1){var n=this.hierarchy[t].finalTransform.mProp;this.mat.translate(-n.p.v[0],-n.p.v[1],n.p.v[2]),this.mat.rotateX(-n.or.v[0]).rotateY(-n.or.v[1]).rotateZ(n.or.v[2]),this.mat.rotateX(-n.rx.v).rotateY(-n.ry.v).rotateZ(n.rz.v),this.mat.scale(1/n.s.v[0],1/n.s.v[1],1/n.s.v[2]),this.mat.translate(n.a.v[0],n.a.v[1],n.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var i;i=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var a=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)),o=[i[0]/a,i[1]/a,i[2]/a],s=Math.sqrt(o[2]*o[2]+o[0]*o[0]),l=Math.atan2(o[1],s),c=Math.atan2(o[0],-o[2]);this.mat.rotateY(c).rotateX(-l)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var h=!this._prevMat.equals(this.mat);if((h||this.pe._mdf)&&this.comp.threeDElements){var d,p,u;for(e=this.comp.threeDElements.length,t=0;t<e;t+=1)if("3d"===(d=this.comp.threeDElements[t]).type){if(h){var m=this.mat.toCSS();(u=d.container.style).transform=m,u.webkitTransform=m}this.pe._mdf&&((p=d.perspectiveElem.style).perspective=this.pe.v+"px",p.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData),e=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=t,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){var n=this.layers[e];if(n.ddd&&this.supports3d)this.addTo3dContainer(r,e);else if(this.threeDElements)this.addTo3dContainer(r,e);else{for(var i,a,o=0;o<e;)this.elements[o]&&!0!==this.elements[o]&&this.elements[o].getBaseElement&&(a=this.elements[o],i=(this.layers[o].ddd?this.getThreeDContainerByPos(o):a.getBaseElement())||i),o+=1;i?n.ddd&&this.supports3d||this.layerElement.insertBefore(r,i):n.ddd&&this.supports3d||this.layerElement.appendChild(r)}}},HybridRendererBase.prototype.createShape=function(t){return this.supports3d?new HShapeElement(t,this.globalData,this):new SVGShapeElement(t,this.globalData,this)},HybridRendererBase.prototype.createText=function(t){return this.supports3d?new HTextElement(t,this.globalData,this):new SVGTextLottieElement(t,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(t){return this.camera=new HCameraElement(t,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(t){return this.supports3d?new HImageElement(t,this.globalData,this):new IImageElement(t,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(t){return this.supports3d?new HSolidElement(t,this.globalData,this):new ISolidElement(t,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(t){for(var e=0,r=this.threeDElements.length;e<r;){if(this.threeDElements[e].startPos<=t&&this.threeDElements[e].endPos>=t)return this.threeDElements[e].perspectiveElem;e+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(t,e){var r,n,i=createTag("div");styleDiv(i);var a=createTag("div");if(styleDiv(a),"3d"===e){(r=i.style).width=this.globalData.compSize.w+"px",r.height=this.globalData.compSize.h+"px";var o="50% 50%";r.webkitTransformOrigin=o,r.mozTransformOrigin=o,r.transformOrigin=o;var s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(n=a.style).transform=s,n.webkitTransform=s}i.appendChild(a);var l={container:a,perspectiveElem:i,startPos:t,endPos:t,type:e};return this.threeDElements.push(l),l},HybridRendererBase.prototype.build3dContainers=function(){var t,e,r=this.layers.length,n="";for(t=0;t<r;t+=1)this.layers[t].ddd&&3!==this.layers[t].ty?("3d"!==n&&(n="3d",e=this.createThreeDContainer(t,"3d")),e.endPos=Math.max(e.endPos,t)):("2d"!==n&&(n="2d",e=this.createThreeDContainer(t,"2d")),e.endPos=Math.max(e.endPos,t));for(t=(r=this.threeDElements.length)-1;t>=0;t-=1)this.resizerElem.appendChild(this.threeDElements[t].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(t,e){for(var r=0,n=this.threeDElements.length;r<n;){if(e<=this.threeDElements[r].endPos){for(var i,a=this.threeDElements[r].startPos;a<e;)this.elements[a]&&this.elements[a].getBaseElement&&(i=this.elements[a].getBaseElement()),a+=1;i?this.threeDElements[r].container.insertBefore(t,i):this.threeDElements[r].container.appendChild(t);break}r+=1}},HybridRendererBase.prototype.configAnimation=function(t){var e=createTag("div"),r=this.animationItem.wrapper,n=e.style;n.width=t.w+"px",n.height=t.h+"px",this.resizerElem=e,styleDiv(e),n.transformStyle="flat",n.mozTransformStyle="flat",n.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),r.appendChild(e),n.overflow="hidden";var i=createNS("svg");i.setAttribute("width","1"),i.setAttribute("height","1"),styleDiv(i),this.resizerElem.appendChild(i);var a=createNS("defs");i.appendChild(a),this.data=t,this.setupGlobalData(t,i),this.globalData.defs=a,this.layers=t.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var t,e,r,n,i=this.animationItem.wrapper.offsetWidth,a=this.animationItem.wrapper.offsetHeight,o=i/a;this.globalData.compSize.w/this.globalData.compSize.h>o?(t=i/this.globalData.compSize.w,e=i/this.globalData.compSize.w,r=0,n=(a-this.globalData.compSize.h*(i/this.globalData.compSize.w))/2):(t=a/this.globalData.compSize.h,e=a/this.globalData.compSize.h,r=(i-this.globalData.compSize.w*(a/this.globalData.compSize.h))/2,n=0);var s=this.resizerElem.style;s.webkitTransform="matrix3d("+t+",0,0,0,0,"+e+",0,0,0,0,1,0,"+r+","+n+",0,1)",s.transform=s.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var t,e=this.globalData.compSize.w,r=this.globalData.compSize.h,n=this.threeDElements.length;for(t=0;t<n;t+=1){var i=this.threeDElements[t].perspectiveElem.style;i.webkitPerspective=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))+"px",i.perspective=i.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(t){var e,r=t.length,n=createTag("div");for(e=0;e<r;e+=1)if(t[e].xt){var i=this.createComp(t[e],n,this.globalData.comp,null);i.initExpressions(),this.globalData.projectInterface.registerComposition(i)}},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(t,e){for(var r,n=0;n<e;)this.elements[n]&&this.elements[n].getBaseElement&&(r=this.elements[n].getBaseElement()),n+=1;r?this.layerElement.insertBefore(t,r):this.layerElement.appendChild(t)},HCompElement.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)};var CompExpressionInterface=function(t){function e(e){for(var r=0,n=t.layers.length;r<n;){if(t.layers[r].nm===e||t.layers[r].ind===e)return t.elements[r].layerInterface;r+=1}return null}return Object.defineProperty(e,"_name",{value:t.data.nm}),e.layer=e,e.pixelAspect=1,e.height=t.data.h||t.globalData.compSize.h,e.width=t.data.w||t.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/t.globalData.frameRate,e.displayStartTime=0,e.numLayers=t.layers.length,e},Expressions=function(){var t={initExpressions:function(t){var e=0,r=[];t.renderer.compInterface=CompExpressionInterface(t.renderer),t.renderer.globalData.projectInterface.registerComposition(t.renderer),t.renderer.globalData.pushExpression=function(){e+=1},t.renderer.globalData.popExpression=function(){0==(e-=1)&&function(){var t,e=r.length;for(t=0;t<e;t+=1)r[t].release();r.length=0}()},t.renderer.globalData.registerExpressionProperty=function(t){-1===r.indexOf(t)&&r.push(t)}}};return t}(),MaskManagerInterface=function(){function t(t,e){this._mask=t,this._data=e}return Object.defineProperty(t.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(t.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(e){var r,n=createSizedArray(e.viewData.length),i=e.viewData.length;for(r=0;r<i;r+=1)n[r]=new t(e.viewData[r],e.masksProperties[r]);return function(t){for(r=0;r<i;){if(e.masksProperties[r].nm===t)return n[r];r+=1}return null}}}(),ExpressionPropertyInterface=function(){var t={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function r(t,e,r){Object.defineProperty(t,"velocity",{get:function(){return e.getVelocityAtTime(e.comp.currentFrame)}}),t.numKeys=e.keyframes?e.keyframes.length:0,t.key=function(n){if(!t.numKeys)return 0;var i;i="s"in e.keyframes[n-1]?e.keyframes[n-1].s:"e"in e.keyframes[n-2]?e.keyframes[n-2].e:e.keyframes[n-2].s;var a="unidimensional"===r?new Number(i):Object.assign({},i);return a.time=e.keyframes[n-1].t/e.elem.comp.globalData.frameRate,a.value="unidimensional"===r?i[0]:i,a},t.valueAtTime=e.getValueAtTime,t.speedAtTime=e.getSpeedAtTime,t.velocityAtTime=e.getVelocityAtTime,t.propertyGroup=e.propertyGroup}function n(){return t}return function(i){return i?"unidimensional"===i.propType?function(e){e&&"pv"in e||(e=t);var n=1/e.mult,i=e.pv*n,a=new Number(i);return a.value=i,r(a,e,"unidimensional"),function(){return e.k&&e.getValue(),i=e.v*n,a.value!==i&&((a=new Number(i)).value=i,r(a,e,"unidimensional")),a}}(i):function(t){t&&"pv"in t||(t=e);var n=1/t.mult,i=t.data&&t.data.l||t.pv.length,a=createTypedArray("float32",i),o=createTypedArray("float32",i);return a.value=o,r(a,t,"multidimensional"),function(){t.k&&t.getValue();for(var e=0;e<i;e+=1)o[e]=t.v[e]*n,a[e]=o[e];return a}}(i):n}}(),TransformExpressionInterface=function(t){function e(t){switch(t){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}var r,n,i,a;return Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(t.r||t.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(t.rz||t.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(t.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(t.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(t.s)}),t.p?a=ExpressionPropertyInterface(t.p):(r=ExpressionPropertyInterface(t.px),n=ExpressionPropertyInterface(t.py),t.pz&&(i=ExpressionPropertyInterface(t.pz))),Object.defineProperty(e,"position",{get:function(){return t.p?a():[r(),n(),i?i():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(t.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(t.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(t.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(t.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(t.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(t.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(t.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(t.or)}),e},LayerExpressionInterface=function(){function t(t){var e=new Matrix;return void 0!==t?this._elem.finalTransform.mProp.getValueAtTime(t).clone(e):this._elem.finalTransform.mProp.applyToMatrix(e),e}function e(t,e){var r=this.getMatrix(e);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.applyPoint(r,t)}function r(t,e){var r=this.getMatrix(e);return this.applyPoint(r,t)}function n(t,e){var r=this.getMatrix(e);return r.props[12]=0,r.props[13]=0,r.props[14]=0,this.invertPoint(r,t)}function i(t,e){var r=this.getMatrix(e);return this.invertPoint(r,t)}function a(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(t)}return t.applyToPointArray(e[0],e[1],e[2]||0)}function o(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(t)}return t.inversePoint(e)}function s(t){var e=new Matrix;if(e.reset(),this._elem.finalTransform.mProp.applyToMatrix(e),this._elem.hierarchy&&this._elem.hierarchy.length){var r,n=this._elem.hierarchy.length;for(r=0;r<n;r+=1)this._elem.hierarchy[r].finalTransform.mProp.applyToMatrix(e);return e.inversePoint(t)}return e.inversePoint(t)}function l(){return[1,1,1,1]}return function(c){var h;function d(t){switch(t){case"ADBE Root Vectors Group":case"Contents":case 2:return d.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return h;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return d.effect;case"ADBE Text Properties":return d.textInterface;default:return null}}d.getMatrix=t,d.invertPoint=o,d.applyPoint=a,d.toWorld=r,d.toWorldVec=e,d.fromWorld=i,d.fromWorldVec=n,d.toComp=r,d.fromComp=s,d.sampleImage=l,d.sourceRectAtTime=c.sourceRectAtTime.bind(c),d._elem=c;var p=getDescriptor(h=TransformExpressionInterface(c.finalTransform.mProp),"anchorPoint");return Object.defineProperties(d,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(h,"rotation"),scale:getDescriptor(h,"scale"),position:getDescriptor(h,"position"),opacity:getDescriptor(h,"opacity"),anchorPoint:p,anchor_point:p,transform:{get:function(){return h}},active:{get:function(){return c.isInRange}}}),d.startTime=c.data.st,d.index=c.data.ind,d.source=c.data.refId,d.height=0===c.data.ty?c.data.h:100,d.width=0===c.data.ty?c.data.w:100,d.inPoint=c.data.ip/c.comp.globalData.frameRate,d.outPoint=c.data.op/c.comp.globalData.frameRate,d._name=c.data.nm,d.registerMaskInterface=function(t){d.mask=new MaskManagerInterface(t,c)},d.registerEffectsInterface=function(t){d.effect=t},d}}(),propertyGroupFactory=function(t,e){return function(r){return(r=void 0===r?1:r)<=0?t:e(r-1)}},PropertyInterface=function(t,e){var r={_name:t};return function(t){return(t=void 0===t?1:t)<=0?r:e(t-1)}},EffectsExpressionInterface=function(){var t={createEffectsInterface:function(t,r){if(t.effectsManager){var n,i=[],a=t.data.ef,o=t.effectsManager.effectElements.length;for(n=0;n<o;n+=1)i.push(e(a[n],t.effectsManager.effectElements[n],r,t));var s=t.data.ef||[],l=function(t){for(n=0,o=s.length;n<o;){if(t===s[n].nm||t===s[n].mn||t===s[n].ix)return i[n];n+=1}return null};return Object.defineProperty(l,"numProperties",{get:function(){return s.length}}),l}return null}};function e(t,n,i,a){function o(e){for(var r=t.ef,n=0,i=r.length;n<i;){if(e===r[n].nm||e===r[n].mn||e===r[n].ix)return 5===r[n].ty?c[n]:c[n]();n+=1}throw new Error}var s,l=propertyGroupFactory(o,i),c=[],h=t.ef.length;for(s=0;s<h;s+=1)5===t.ef[s].ty?c.push(e(t.ef[s],n.effectElements[s],n.effectElements[s].propertyGroup,a)):c.push(r(n.effectElements[s],t.ef[s].ty,a,l));return"ADBE Color Control"===t.mn&&Object.defineProperty(o,"color",{get:function(){return c[0]()}}),Object.defineProperties(o,{numProperties:{get:function(){return t.np}},_name:{value:t.nm},propertyGroup:{value:l}}),o.enabled=0!==t.en,o.active=o.enabled,o}function r(t,e,r,n){var i=ExpressionPropertyInterface(t.p);return t.p.setGroupProperty&&t.p.setGroupProperty(PropertyInterface("",n)),function(){return 10===e?r.comp.compInterface(t.p.v):i()}}return t}(),ShapePathInterface=function(t,e,r){var n=e.sh;function i(t){return"Shape"===t||"shape"===t||"Path"===t||"path"===t||"ADBE Vector Shape"===t||2===t?i.path:null}var a=propertyGroupFactory(i,r);return n.setGroupProperty(PropertyInterface("Path",a)),Object.defineProperties(i,{path:{get:function(){return n.k&&n.getValue(),n}},shape:{get:function(){return n.k&&n.getValue(),n}},_name:{value:t.nm},ix:{value:t.ix},propertyIndex:{value:t.ix},mn:{value:t.mn},propertyGroup:{value:r}}),i},ShapeExpressionInterface=function(){function t(t,o,p){var u,m=[],f=t?t.length:0;for(u=0;u<f;u+=1)"gr"===t[u].ty?m.push(e(t[u],o[u],p)):"fl"===t[u].ty?m.push(r(t[u],o[u],p)):"st"===t[u].ty?m.push(i(t[u],o[u],p)):"tm"===t[u].ty?m.push(a(t[u],o[u],p)):"tr"===t[u].ty||("el"===t[u].ty?m.push(s(t[u],o[u],p)):"sr"===t[u].ty?m.push(l(t[u],o[u],p)):"sh"===t[u].ty?m.push(ShapePathInterface(t[u],o[u],p)):"rc"===t[u].ty?m.push(c(t[u],o[u],p)):"rd"===t[u].ty?m.push(h(t[u],o[u],p)):"rp"===t[u].ty?m.push(d(t[u],o[u],p)):"gf"===t[u].ty?m.push(n(t[u],o[u],p)):m.push((t[u],o[u],function(){return null})));return m}function e(e,r,n){var i=function(t){switch(t){case"ADBE Vectors Group":case"Contents":case 2:return i.content;default:return i.transform}};i.propertyGroup=propertyGroupFactory(i,n);var a=function(e,r,n){var i,a=function(t){for(var e=0,r=i.length;e<r;){if(i[e]._name===t||i[e].mn===t||i[e].propertyIndex===t||i[e].ix===t||i[e].ind===t)return i[e];e+=1}return"number"==typeof t?i[t-1]:null};a.propertyGroup=propertyGroupFactory(a,n),i=t(e.it,r.it,a.propertyGroup),a.numProperties=i.length;var s=o(e.it[e.it.length-1],r.it[r.it.length-1],a.propertyGroup);return a.transform=s,a.propertyIndex=e.cix,a._name=e.nm,a}(e,r,i.propertyGroup),s=o(e.it[e.it.length-1],r.it[r.it.length-1],i.propertyGroup);return i.content=a,i.transform=s,Object.defineProperty(i,"_name",{get:function(){return e.nm}}),i.numProperties=e.np,i.propertyIndex=e.ix,i.nm=e.nm,i.mn=e.mn,i}function r(t,e,r){function n(t){return"Color"===t||"color"===t?n.color:"Opacity"===t||"opacity"===t?n.opacity:null}return Object.defineProperties(n,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",r)),e.o.setGroupProperty(PropertyInterface("Opacity",r)),n}function n(t,e,r){function n(t){return"Start Point"===t||"start point"===t?n.startPoint:"End Point"===t||"end point"===t?n.endPoint:"Opacity"===t||"opacity"===t?n.opacity:null}return Object.defineProperties(n,{startPoint:{get:ExpressionPropertyInterface(e.s)},endPoint:{get:ExpressionPropertyInterface(e.e)},opacity:{get:ExpressionPropertyInterface(e.o)},type:{get:function(){return"a"}},_name:{value:t.nm},mn:{value:t.mn}}),e.s.setGroupProperty(PropertyInterface("Start Point",r)),e.e.setGroupProperty(PropertyInterface("End Point",r)),e.o.setGroupProperty(PropertyInterface("Opacity",r)),n}function i(t,e,r){var n,i=propertyGroupFactory(c,r),a=propertyGroupFactory(l,i);function o(r){Object.defineProperty(l,t.d[r].nm,{get:ExpressionPropertyInterface(e.d.dataProps[r].p)})}var s=t.d?t.d.length:0,l={};for(n=0;n<s;n+=1)o(n),e.d.dataProps[n].p.setGroupProperty(a);function c(t){return"Color"===t||"color"===t?c.color:"Opacity"===t||"opacity"===t?c.opacity:"Stroke Width"===t||"stroke width"===t?c.strokeWidth:null}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},strokeWidth:{get:ExpressionPropertyInterface(e.w)},dash:{get:function(){return l}},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",i)),e.o.setGroupProperty(PropertyInterface("Opacity",i)),e.w.setGroupProperty(PropertyInterface("Stroke Width",i)),c}function a(t,e,r){function n(e){return e===t.e.ix||"End"===e||"end"===e?n.end:e===t.s.ix?n.start:e===t.o.ix?n.offset:null}var i=propertyGroupFactory(n,r);return n.propertyIndex=t.ix,e.s.setGroupProperty(PropertyInterface("Start",i)),e.e.setGroupProperty(PropertyInterface("End",i)),e.o.setGroupProperty(PropertyInterface("Offset",i)),n.propertyIndex=t.ix,n.propertyGroup=r,Object.defineProperties(n,{start:{get:ExpressionPropertyInterface(e.s)},end:{get:ExpressionPropertyInterface(e.e)},offset:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm}}),n.mn=t.mn,n}function o(t,e,r){function n(e){return t.a.ix===e||"Anchor Point"===e?n.anchorPoint:t.o.ix===e||"Opacity"===e?n.opacity:t.p.ix===e||"Position"===e?n.position:t.r.ix===e||"Rotation"===e||"ADBE Vector Rotation"===e?n.rotation:t.s.ix===e||"Scale"===e?n.scale:t.sk&&t.sk.ix===e||"Skew"===e?n.skew:t.sa&&t.sa.ix===e||"Skew Axis"===e?n.skewAxis:null}var i=propertyGroupFactory(n,r);return e.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",i)),e.transform.mProps.p.setGroupProperty(PropertyInterface("Position",i)),e.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",i)),e.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",i)),e.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",i)),e.transform.mProps.sk&&(e.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",i)),e.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",i))),e.transform.op.setGroupProperty(PropertyInterface("Opacity",i)),Object.defineProperties(n,{opacity:{get:ExpressionPropertyInterface(e.transform.mProps.o)},position:{get:ExpressionPropertyInterface(e.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(e.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(e.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(e.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(e.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(e.transform.mProps.sa)},_name:{value:t.nm}}),n.ty="tr",n.mn=t.mn,n.propertyGroup=r,n}function s(t,e,r){function n(e){return t.p.ix===e?n.position:t.s.ix===e?n.size:null}var i=propertyGroupFactory(n,r);n.propertyIndex=t.ix;var a="tm"===e.sh.ty?e.sh.prop:e.sh;return a.s.setGroupProperty(PropertyInterface("Size",i)),a.p.setGroupProperty(PropertyInterface("Position",i)),Object.defineProperties(n,{size:{get:ExpressionPropertyInterface(a.s)},position:{get:ExpressionPropertyInterface(a.p)},_name:{value:t.nm}}),n.mn=t.mn,n}function l(t,e,r){function n(e){return t.p.ix===e?n.position:t.r.ix===e?n.rotation:t.pt.ix===e?n.points:t.or.ix===e||"ADBE Vector Star Outer Radius"===e?n.outerRadius:t.os.ix===e?n.outerRoundness:!t.ir||t.ir.ix!==e&&"ADBE Vector Star Inner Radius"!==e?t.is&&t.is.ix===e?n.innerRoundness:null:n.innerRadius}var i=propertyGroupFactory(n,r),a="tm"===e.sh.ty?e.sh.prop:e.sh;return n.propertyIndex=t.ix,a.or.setGroupProperty(PropertyInterface("Outer Radius",i)),a.os.setGroupProperty(PropertyInterface("Outer Roundness",i)),a.pt.setGroupProperty(PropertyInterface("Points",i)),a.p.setGroupProperty(PropertyInterface("Position",i)),a.r.setGroupProperty(PropertyInterface("Rotation",i)),t.ir&&(a.ir.setGroupProperty(PropertyInterface("Inner Radius",i)),a.is.setGroupProperty(PropertyInterface("Inner Roundness",i))),Object.defineProperties(n,{position:{get:ExpressionPropertyInterface(a.p)},rotation:{get:ExpressionPropertyInterface(a.r)},points:{get:ExpressionPropertyInterface(a.pt)},outerRadius:{get:ExpressionPropertyInterface(a.or)},outerRoundness:{get:ExpressionPropertyInterface(a.os)},innerRadius:{get:ExpressionPropertyInterface(a.ir)},innerRoundness:{get:ExpressionPropertyInterface(a.is)},_name:{value:t.nm}}),n.mn=t.mn,n}function c(t,e,r){function n(e){return t.p.ix===e?n.position:t.r.ix===e?n.roundness:t.s.ix===e||"Size"===e||"ADBE Vector Rect Size"===e?n.size:null}var i=propertyGroupFactory(n,r),a="tm"===e.sh.ty?e.sh.prop:e.sh;return n.propertyIndex=t.ix,a.p.setGroupProperty(PropertyInterface("Position",i)),a.s.setGroupProperty(PropertyInterface("Size",i)),a.r.setGroupProperty(PropertyInterface("Rotation",i)),Object.defineProperties(n,{position:{get:ExpressionPropertyInterface(a.p)},roundness:{get:ExpressionPropertyInterface(a.r)},size:{get:ExpressionPropertyInterface(a.s)},_name:{value:t.nm}}),n.mn=t.mn,n}function h(t,e,r){function n(e){return t.r.ix===e||"Round Corners 1"===e?n.radius:null}var i=propertyGroupFactory(n,r),a=e;return n.propertyIndex=t.ix,a.rd.setGroupProperty(PropertyInterface("Radius",i)),Object.defineProperties(n,{radius:{get:ExpressionPropertyInterface(a.rd)},_name:{value:t.nm}}),n.mn=t.mn,n}function d(t,e,r){function n(e){return t.c.ix===e||"Copies"===e?n.copies:t.o.ix===e||"Offset"===e?n.offset:null}var i=propertyGroupFactory(n,r),a=e;return n.propertyIndex=t.ix,a.c.setGroupProperty(PropertyInterface("Copies",i)),a.o.setGroupProperty(PropertyInterface("Offset",i)),Object.defineProperties(n,{copies:{get:ExpressionPropertyInterface(a.c)},offset:{get:ExpressionPropertyInterface(a.o)},_name:{value:t.nm}}),n.mn=t.mn,n}return function(e,r,n){var i;function a(t){if("number"==typeof t)return 0===(t=void 0===t?1:t)?n:i[t-1];for(var e=0,r=i.length;e<r;){if(i[e]._name===t)return i[e];e+=1}return null}return a.propertyGroup=propertyGroupFactory(a,(function(){return n})),i=t(e,r,a.propertyGroup),a.numProperties=i.length,a._name="Contents",a}}(),TextExpressionInterface=function(t){var e,r;function n(t){return"ADBE Text Document"===t?n.sourceText:null}return Object.defineProperty(n,"sourceText",{get:function(){t.textProperty.getValue();var n=t.textProperty.currentData.t;return n!==e&&(t.textProperty.currentData.t=e,(r=new String(n)).value=n||new String(n)),r}}),n};function _typeof$2(t){return _typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2(t)}var FootageInterface=(dataInterfaceFactory=function(t){function e(t){return"Outline"===t?e.outlineInterface():null}return e._name="Outline",e.outlineInterface=function(t){var e="",r=t.getFootageData();function n(t){if(r[t])return e=t,"object"===_typeof$2(r=r[t])?n:r;var i=t.indexOf(e);if(-1!==i){var a=parseInt(t.substr(i+e.length),10);return"object"===_typeof$2(r=r[a])?n:r}return""}return function(){return e="",r=t.getFootageData(),n}}(t),e},function(t){function e(t){return"Data"===t?e.dataInterface:null}return e._name="Data",e.dataInterface=dataInterfaceFactory(t),e}),dataInterfaceFactory,interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(t){return interfaces[t]||null}function _typeof$1(t){return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1(t)}function seedRandom(t,e){var r=this,n=256,i=e.pow(n,6),a=e.pow(2,52),o=2*a,s=255;function l(t){var e,r=t.length,i=this,a=0,o=i.i=i.j=0,l=i.S=[];for(r||(t=[r++]);a<n;)l[a]=a++;for(a=0;a<n;a++)l[a]=l[o=s&o+t[a%r]+(e=l[a])],l[o]=e;i.g=function(t){for(var e,r=0,a=i.i,o=i.j,l=i.S;t--;)e=l[a=s&a+1],r=r*n+l[s&(l[a]=l[o=s&o+e])+(l[o]=e)];return i.i=a,i.j=o,r}}function c(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function h(t,e){var r,n=[],i=_typeof$1(t);if(e&&"object"==i)for(r in t)try{n.push(h(t[r],e-1))}catch(t){}return n.length?n:"string"==i?t:t+"\0"}function d(t,e){for(var r,n=t+"",i=0;i<n.length;)e[s&i]=s&(r^=19*e[s&i])+n.charCodeAt(i++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}e.seedrandom=function(s,u,m){var f=[],g=d(h((u=!0===u?{entropy:!0}:u||{}).entropy?[s,p(t)]:null===s?function(){try{var e=new Uint8Array(n);return(r.crypto||r.msCrypto).getRandomValues(e),p(e)}catch(e){var i=r.navigator,a=i&&i.plugins;return[+new Date,r,a,r.screen,p(t)]}}():s,3),f),v=new l(f),b=function(){for(var t=v.g(6),e=i,r=0;t<a;)t=(t+r)*n,e*=n,r=v.g(1);for(;t>=o;)t/=2,e/=2,r>>>=1;return(t+r)/e};return b.int32=function(){return 0|v.g(4)},b.quick=function(){return v.g(4)/4294967296},b.double=b,d(p(v.S),t),(u.pass||m||function(t,r,n,i){return i&&(i.S&&c(i,v),t.state=function(){return c(v,{})}),n?(e.random=t,r):t})(b,g,"global"in u?u.global:this==e,u.state)},d(e.random(),t)}function initialize$2(t){seedRandom([],t)}var propTypes={SHAPE:"shape"};function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;function $bm_isInstanceOfArray(t){return t.constructor===Array||t.constructor===Float32Array}function isNumerable(t,e){return"number"===t||"boolean"===t||"string"===t||e instanceof Number}function $bm_neg(t){var e=_typeof(t);if("number"===e||"boolean"===e||t instanceof Number)return-t;if($bm_isInstanceOfArray(t)){var r,n=t.length,i=[];for(r=0;r<n;r+=1)i[r]=-t[r];return i}return t.propType?t.v:-t}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(t,e){var r=_typeof(t),n=_typeof(e);if("string"===r||"string"===n)return t+e;if(isNumerable(r,t)&&isNumerable(n,e))return t+e;if($bm_isInstanceOfArray(t)&&isNumerable(n,e))return(t=t.slice(0))[0]+=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return(e=e.slice(0))[0]=t+e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var i=0,a=t.length,o=e.length,s=[];i<a||i<o;)("number"==typeof t[i]||t[i]instanceof Number)&&("number"==typeof e[i]||e[i]instanceof Number)?s[i]=t[i]+e[i]:s[i]=void 0===e[i]?t[i]:t[i]||e[i],i+=1;return s}return 0}var add=sum;function sub(t,e){var r=_typeof(t),n=_typeof(e);if(isNumerable(r,t)&&isNumerable(n,e))return"string"===r&&(t=parseInt(t,10)),"string"===n&&(e=parseInt(e,10)),t-e;if($bm_isInstanceOfArray(t)&&isNumerable(n,e))return(t=t.slice(0))[0]-=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return(e=e.slice(0))[0]=t-e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var i=0,a=t.length,o=e.length,s=[];i<a||i<o;)("number"==typeof t[i]||t[i]instanceof Number)&&("number"==typeof e[i]||e[i]instanceof Number)?s[i]=t[i]-e[i]:s[i]=void 0===e[i]?t[i]:t[i]||e[i],i+=1;return s}return 0}function mul(t,e){var r,n,i,a=_typeof(t),o=_typeof(e);if(isNumerable(a,t)&&isNumerable(o,e))return t*e;if($bm_isInstanceOfArray(t)&&isNumerable(o,e)){for(i=t.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=t[n]*e;return r}if(isNumerable(a,t)&&$bm_isInstanceOfArray(e)){for(i=e.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=t*e[n];return r}return 0}function div(t,e){var r,n,i,a=_typeof(t),o=_typeof(e);if(isNumerable(a,t)&&isNumerable(o,e))return t/e;if($bm_isInstanceOfArray(t)&&isNumerable(o,e)){for(i=t.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=t[n]/e;return r}if(isNumerable(a,t)&&$bm_isInstanceOfArray(e)){for(i=e.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=t/e[n];return r}return 0}function mod(t,e){return"string"==typeof t&&(t=parseInt(t,10)),"string"==typeof e&&(e=parseInt(e,10)),t%e}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(t,e,r){if(e>r){var n=r;r=e,e=n}return Math.min(Math.max(t,e),r)}function radiansToDegrees(t){return t/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(t){return t*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(t,e){if("number"==typeof t||t instanceof Number)return e=e||0,Math.abs(t-e);var r;e||(e=helperLengthArray);var n=Math.min(t.length,e.length),i=0;for(r=0;r<n;r+=1)i+=Math.pow(e[r]-t[r],2);return Math.sqrt(i)}function normalize(t){return div(t,length(t))}function rgbToHsl(t){var e,r,n=t[0],i=t[1],a=t[2],o=Math.max(n,i,a),s=Math.min(n,i,a),l=(o+s)/2;if(o===s)e=0,r=0;else{var c=o-s;switch(r=l>.5?c/(2-o-s):c/(o+s),o){case n:e=(i-a)/c+(i<a?6:0);break;case i:e=(a-n)/c+2;break;case a:e=(n-i)/c+4}e/=6}return[e,r,l,t[3]]}function hue2rgb(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hslToRgb(t){var e,r,n,i=t[0],a=t[1],o=t[2];if(0===a)e=o,n=o,r=o;else{var s=o<.5?o*(1+a):o+a-o*a,l=2*o-s;e=hue2rgb(l,s,i+1/3),r=hue2rgb(l,s,i),n=hue2rgb(l,s,i-1/3)}return[e,r,n,t[3]]}function linear(t,e,r,n,i){if(void 0!==n&&void 0!==i||(n=e,i=r,e=0,r=1),r<e){var a=r;r=e,e=a}if(t<=e)return n;if(t>=r)return i;var o,s=r===e?0:(t-e)/(r-e);if(!n.length)return n+(i-n)*s;var l=n.length,c=createTypedArray("float32",l);for(o=0;o<l;o+=1)c[o]=n[o]+(i[o]-n[o])*s;return c}function random(t,e){if(void 0===e&&(void 0===t?(t=0,e=1):(e=t,t=void 0)),e.length){var r,n=e.length;t||(t=createTypedArray("float32",n));var i=createTypedArray("float32",n),a=BMMath.random();for(r=0;r<n;r+=1)i[r]=t[r]+a*(e[r]-t[r]);return i}return void 0===t&&(t=0),t+BMMath.random()*(e-t)}function createPath(t,e,r,n){var i,a=t.length,o=shapePool.newElement();o.setPathData(!!n,a);var s,l,c=[0,0];for(i=0;i<a;i+=1)s=e&&e[i]?e[i]:c,l=r&&r[i]?r[i]:c,o.setTripleAt(t[i][0],t[i][1],l[0]+t[i][0],l[1]+t[i][1],s[0]+t[i][0],s[1]+t[i][1],i,!0);return o}function initiateExpression(elem,data,property){function noOp(t){return t}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(t,e){var r,n,i=this.pv.length?this.pv.length:1,a=createTypedArray("float32",i),o=Math.floor(5*time);for(r=0,n=0;r<o;){for(n=0;n<i;n+=1)a[n]+=-e+2*e*BMMath.random();r+=1}var s=5*time,l=s-Math.floor(s),c=createTypedArray("float32",i);if(i>1){for(n=0;n<i;n+=1)c[n]=this.pv[n]+a[n]+(-e+2*e*BMMath.random())*l;return c}return this.pv+a[0]+(-e+2*e*BMMath.random())*l}.bind(this);function loopInDuration(t,e){return loopIn(t,e,!0)}function loopOutDuration(t,e){return loopOut(t,e,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(t,e){var r=[e[0]-t[0],e[1]-t[1],e[2]-t[2]],n=Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2]))/degToRads;return[-Math.atan2(r[1],r[2])/degToRads,n,0]}function easeOut(t,e,r,n,i){return applyEase(easeOutBez,t,e,r,n,i)}function easeIn(t,e,r,n,i){return applyEase(easeInBez,t,e,r,n,i)}function ease(t,e,r,n,i){return applyEase(easeInOutBez,t,e,r,n,i)}function applyEase(t,e,r,n,i,a){void 0===i?(i=r,a=n):e=(e-r)/(n-r),e>1?e=1:e<0&&(e=0);var o=t(e);if($bm_isInstanceOfArray(i)){var s,l=i.length,c=createTypedArray("float32",l);for(s=0;s<l;s+=1)c[s]=(a[s]-i[s])*o+i[s];return c}return(a-i)*o+i}function nearestKey(t){var e,r,n,i=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(r=-1,(t*=elem.comp.globalData.frameRate)<data.k[0].t)r=1,n=data.k[0].t;else{for(e=0;e<i-1;e+=1){if(t===data.k[e].t){r=e+1,n=data.k[e].t;break}if(t>data.k[e].t&&t<data.k[e+1].t){t-data.k[e].t>data.k[e+1].t-t?(r=e+2,n=data.k[e+1].t):(r=e+1,n=data.k[e].t);break}}-1===r&&(r=e+1,n=data.k[e].t)}else r=0,n=0;var a={};return a.index=r,a.time=n/elem.comp.globalData.frameRate,a}function key(t){var e,r,n;if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+t);t-=1,e={time:data.k[t].t/elem.comp.globalData.frameRate,value:[]};var i=Object.prototype.hasOwnProperty.call(data.k[t],"s")?data.k[t].s:data.k[t-1].e;for(n=i.length,r=0;r<n;r+=1)e[r]=i[r],e.value[r]=i[r];return e}function framesToTime(t,e){return e||(e=elem.comp.globalData.frameRate),t/e}function timeToFrames(t,e){return t||0===t||(t=time),e||(e=elem.comp.globalData.frameRate),t*e}function seedRandom(t){BMMath.seedrandom(randSeed+t)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(t,e){return"string"==typeof value?void 0===e?value.substring(t):value.substring(t,e):""}function substr(t,e){return"string"==typeof value?void 0===e?value.substr(t):value.substr(t,e):""}function posterizeTime(t){time=0===t?0:Math.floor(time*t)/t,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(t){return value=t,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath],ob}(),expressionHelpers={searchExpressions:function(t,e,r){e.x&&(r.k=!0,r.x=!0,r.initiateExpression=ExpressionManager.initiateExpression,r.effectsSequence.push(r.initiateExpression(t,e,r).bind(r)))},getSpeedAtTime:function(t){var e=this.getValueAtTime(t),r=this.getValueAtTime(t+-.01),n=0;if(e.length){var i;for(i=0;i<e.length;i+=1)n+=Math.pow(r[i]-e[i],2);n=100*Math.sqrt(n)}else n=0;return n},getVelocityAtTime:function(t){if(void 0!==this.vel)return this.vel;var e,r,n=-.001,i=this.getValueAtTime(t),a=this.getValueAtTime(t+n);if(i.length)for(e=createTypedArray("float32",i.length),r=0;r<i.length;r+=1)e[r]=(a[r]-i[r])/n;else e=(a-i)/n;return e},getValueAtTime:function(t){return t*=this.elem.globalData.frameRate,(t-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<t?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(t,this._cachingAtTime),this._cachingAtTime.lastFrame=t),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(t){this.propertyGroup=t}};function addPropertyDecorator(){function t(t,e,r){if(!this.k||!this.keyframes)return this.pv;t=t?t.toLowerCase():"";var n,i,a,o,s,l=this.comp.renderedFrame,c=this.keyframes,h=c[c.length-1].t;if(l<=h)return this.pv;if(r?i=h-(n=e?Math.abs(h-this.elem.comp.globalData.frameRate*e):Math.max(0,h-this.elem.data.ip)):((!e||e>c.length-1)&&(e=c.length-1),n=h-(i=c[c.length-1-e].t)),"pingpong"===t){if(Math.floor((l-i)/n)%2!=0)return this.getValueAtTime((n-(l-i)%n+i)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var d=this.getValueAtTime(i/this.comp.globalData.frameRate,0),p=this.getValueAtTime(h/this.comp.globalData.frameRate,0),u=this.getValueAtTime(((l-i)%n+i)/this.comp.globalData.frameRate,0),m=Math.floor((l-i)/n);if(this.pv.length){for(o=(s=new Array(d.length)).length,a=0;a<o;a+=1)s[a]=(p[a]-d[a])*m+u[a];return s}return(p-d)*m+u}if("continue"===t){var f=this.getValueAtTime(h/this.comp.globalData.frameRate,0),g=this.getValueAtTime((h-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(o=(s=new Array(f.length)).length,a=0;a<o;a+=1)s[a]=f[a]+(f[a]-g[a])*((l-h)/this.comp.globalData.frameRate)/5e-4;return s}return f+(l-h)/.001*(f-g)}}return this.getValueAtTime(((l-i)%n+i)/this.comp.globalData.frameRate,0)}function e(t,e,r){if(!this.k)return this.pv;t=t?t.toLowerCase():"";var n,i,a,o,s,l=this.comp.renderedFrame,c=this.keyframes,h=c[0].t;if(l>=h)return this.pv;if(r?i=h+(n=e?Math.abs(this.elem.comp.globalData.frameRate*e):Math.max(0,this.elem.data.op-h)):((!e||e>c.length-1)&&(e=c.length-1),n=(i=c[e].t)-h),"pingpong"===t){if(Math.floor((h-l)/n)%2==0)return this.getValueAtTime(((h-l)%n+h)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var d=this.getValueAtTime(h/this.comp.globalData.frameRate,0),p=this.getValueAtTime(i/this.comp.globalData.frameRate,0),u=this.getValueAtTime((n-(h-l)%n+h)/this.comp.globalData.frameRate,0),m=Math.floor((h-l)/n)+1;if(this.pv.length){for(o=(s=new Array(d.length)).length,a=0;a<o;a+=1)s[a]=u[a]-(p[a]-d[a])*m;return s}return u-(p-d)*m}if("continue"===t){var f=this.getValueAtTime(h/this.comp.globalData.frameRate,0),g=this.getValueAtTime((h+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(o=(s=new Array(f.length)).length,a=0;a<o;a+=1)s[a]=f[a]+(f[a]-g[a])*(h-l)/.001;return s}return f+(f-g)*(h-l)/.001}}return this.getValueAtTime((n-((h-l)%n+h))/this.comp.globalData.frameRate,0)}function r(t,e){if(!this.k)return this.pv;if(t=.5*(t||.4),(e=Math.floor(e||5))<=1)return this.pv;var r,n,i=this.comp.renderedFrame/this.comp.globalData.frameRate,a=i-t,o=e>1?(i+t-a)/(e-1):1,s=0,l=0;for(r=this.pv.length?createTypedArray("float32",this.pv.length):0;s<e;){if(n=this.getValueAtTime(a+s*o),this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]+=n[l];else r+=n;s+=1}if(this.pv.length)for(l=0;l<this.pv.length;l+=1)r[l]/=e;else r/=e;return r}function n(t){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var e=this._transformCachingAtTime.v;if(e.cloneFromProps(this.pre.props),this.appliedTransformations<1){var r=this.a.getValueAtTime(t);e.translate(-r[0]*this.a.mult,-r[1]*this.a.mult,r[2]*this.a.mult)}if(this.appliedTransformations<2){var n=this.s.getValueAtTime(t);e.scale(n[0]*this.s.mult,n[1]*this.s.mult,n[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var i=this.sk.getValueAtTime(t),a=this.sa.getValueAtTime(t);e.skewFromAxis(-i*this.sk.mult,a*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var o=this.r.getValueAtTime(t);e.rotate(-o*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var s=this.rz.getValueAtTime(t),l=this.ry.getValueAtTime(t),c=this.rx.getValueAtTime(t),h=this.or.getValueAtTime(t);e.rotateZ(-s*this.rz.mult).rotateY(l*this.ry.mult).rotateX(c*this.rx.mult).rotateZ(-h[2]*this.or.mult).rotateY(h[1]*this.or.mult).rotateX(h[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var d=this.px.getValueAtTime(t),p=this.py.getValueAtTime(t);if(this.data.p.z){var u=this.pz.getValueAtTime(t);e.translate(d*this.px.mult,p*this.py.mult,-u*this.pz.mult)}else e.translate(d*this.px.mult,p*this.py.mult,0)}else{var m=this.p.getValueAtTime(t);e.translate(m[0]*this.p.mult,m[1]*this.p.mult,-m[2]*this.p.mult)}return e}function i(){return this.v.clone(new Matrix)}var a=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(t,e,r){var o=a(t,e,r);return o.dynamicProperties.length?o.getValueAtTime=n.bind(o):o.getValueAtTime=i.bind(o),o.setGroupProperty=expressionHelpers.setGroupProperty,o};var o=PropertyFactory.getProp;PropertyFactory.getProp=function(n,i,a,s,l){var c=o(n,i,a,s,l);c.kf?c.getValueAtTime=expressionHelpers.getValueAtTime.bind(c):c.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(c),c.setGroupProperty=expressionHelpers.setGroupProperty,c.loopOut=t,c.loopIn=e,c.smooth=r,c.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(c),c.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(c),c.numKeys=1===i.a?i.k.length:0,c.propertyIndex=i.ix;var h=0;return 0!==a&&(h=createTypedArray("float32",1===i.a?i.k[0].s.length:i.k.length)),c._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:h},expressionHelpers.searchExpressions(n,i,c),c.k&&l.addDynamicProperty(c),c};var s=ShapePropertyFactory.getConstructorFunction(),l=ShapePropertyFactory.getKeyframedConstructorFunction();function c(){}c.prototype={vertices:function(t,e){this.k&&this.getValue();var r,n=this.v;void 0!==e&&(n=this.getValueAtTime(e,0));var i=n._length,a=n[t],o=n.v,s=createSizedArray(i);for(r=0;r<i;r+=1)s[r]="i"===t||"o"===t?[a[r][0]-o[r][0],a[r][1]-o[r][1]]:[a[r][0],a[r][1]];return s},points:function(t){return this.vertices("v",t)},inTangents:function(t){return this.vertices("i",t)},outTangents:function(t){return this.vertices("o",t)},isClosed:function(){return this.v.c},pointOnPath:function(t,e){var r=this.v;void 0!==e&&(r=this.getValueAtTime(e,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(r));for(var n,i=this._segmentsLength,a=i.lengths,o=i.totalLength*t,s=0,l=a.length,c=0;s<l;){if(c+a[s].addedLength>o){var h=s,d=r.c&&s===l-1?0:s+1,p=(o-c)/a[s].addedLength;n=bez.getPointInSegment(r.v[h],r.v[d],r.o[h],r.i[d],p,a[s]);break}c+=a[s].addedLength,s+=1}return n||(n=r.c?[r.v[0][0],r.v[0][1]]:[r.v[r._length-1][0],r.v[r._length-1][1]]),n},vectorOnPath:function(t,e,r){1==t?t=this.v.c:0==t&&(t=.999);var n=this.pointOnPath(t,e),i=this.pointOnPath(t+.001,e),a=i[0]-n[0],o=i[1]-n[1],s=Math.sqrt(Math.pow(a,2)+Math.pow(o,2));return 0===s?[0,0]:"tangent"===r?[a/s,o/s]:[-o/s,a/s]},tangentOnPath:function(t,e){return this.vectorOnPath(t,e,"tangent")},normalOnPath:function(t,e){return this.vectorOnPath(t,e,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([c],s),extendPrototype([c],l),l.prototype.getValueAtTime=function(t){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),t*=this.elem.globalData.frameRate,(t-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<t?this._caching.lastIndex:0,this._cachingAtTime.lastTime=t,this.interpolateShape(t,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},l.prototype.initiateExpression=ExpressionManager.initiateExpression;var h=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(t,e,r,n,i){var a=h(t,e,r,n,i);return a.propertyIndex=e.ix,a.lock=!1,3===r?expressionHelpers.searchExpressions(t,e.pt,a):4===r&&expressionHelpers.searchExpressions(t,e.ks,a),a.k&&t.addDynamicProperty(a),a}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(t,e){var r=this.calculateExpression(e);if(t.t!==r){var n={};return this.copyData(n,t),n.t=r.toString(),n.__complete=!1,n}return t},TextProperty.prototype.searchProperty=function(){var t=this.searchKeyframes(),e=this.searchExpressions();return this.kf=t||e,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}function SVGTintFilter(t,e,r,n,i){this.filterManager=e;var a=createNS("feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","linearRGB"),a.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),a.setAttribute("result",n+"_tint_1"),t.appendChild(a),(a=createNS("feColorMatrix")).setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),a.setAttribute("result",n+"_tint_2"),t.appendChild(a),this.matrixFilter=a;var o=this.createMergeNode(n,[i,n+"_tint_1",n+"_tint_2"]);t.appendChild(o)}function SVGFillFilter(t,e,r,n){this.filterManager=e;var i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),i.setAttribute("result",n),t.appendChild(i),this.matrixFilter=i}function SVGStrokeEffect(t,e,r){this.initialized=!1,this.filterManager=e,this.elem=r,this.paths=[]}function SVGTritoneFilter(t,e,r,n){this.filterManager=e;var i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","linearRGB"),i.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),t.appendChild(i);var a=createNS("feComponentTransfer");a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("result",n),this.matrixFilter=a;var o=createNS("feFuncR");o.setAttribute("type","table"),a.appendChild(o),this.feFuncR=o;var s=createNS("feFuncG");s.setAttribute("type","table"),a.appendChild(s),this.feFuncG=s;var l=createNS("feFuncB");l.setAttribute("type","table"),a.appendChild(l),this.feFuncB=l,t.appendChild(a)}function SVGProLevelsFilter(t,e,r,n){this.filterManager=e;var i=this.filterManager.effectElements,a=createNS("feComponentTransfer");(i[10].p.k||0!==i[10].p.v||i[11].p.k||1!==i[11].p.v||i[12].p.k||1!==i[12].p.v||i[13].p.k||0!==i[13].p.v||i[14].p.k||1!==i[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",a)),(i[17].p.k||0!==i[17].p.v||i[18].p.k||1!==i[18].p.v||i[19].p.k||1!==i[19].p.v||i[20].p.k||0!==i[20].p.v||i[21].p.k||1!==i[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",a)),(i[24].p.k||0!==i[24].p.v||i[25].p.k||1!==i[25].p.v||i[26].p.k||1!==i[26].p.v||i[27].p.k||0!==i[27].p.v||i[28].p.k||1!==i[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",a)),(i[31].p.k||0!==i[31].p.v||i[32].p.k||1!==i[32].p.v||i[33].p.k||1!==i[33].p.v||i[34].p.k||0!==i[34].p.v||i[35].p.k||1!==i[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",a)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(a.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(a)),(i[3].p.k||0!==i[3].p.v||i[4].p.k||1!==i[4].p.v||i[5].p.k||1!==i[5].p.v||i[6].p.k||0!==i[6].p.v||i[7].p.k||1!==i[7].p.v)&&((a=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("result",n),t.appendChild(a),this.feFuncRComposed=this.createFeFunc("feFuncR",a),this.feFuncGComposed=this.createFeFunc("feFuncG",a),this.feFuncBComposed=this.createFeFunc("feFuncB",a))}function SVGDropShadowEffect(t,e,r,n,i){var a=e.container.globalData.renderConfig.filterSize,o=e.data.fs||a;t.setAttribute("x",o.x||a.x),t.setAttribute("y",o.y||a.y),t.setAttribute("width",o.width||a.width),t.setAttribute("height",o.height||a.height),this.filterManager=e;var s=createNS("feGaussianBlur");s.setAttribute("in","SourceAlpha"),s.setAttribute("result",n+"_drop_shadow_1"),s.setAttribute("stdDeviation","0"),this.feGaussianBlur=s,t.appendChild(s);var l=createNS("feOffset");l.setAttribute("dx","25"),l.setAttribute("dy","0"),l.setAttribute("in",n+"_drop_shadow_1"),l.setAttribute("result",n+"_drop_shadow_2"),this.feOffset=l,t.appendChild(l);var c=createNS("feFlood");c.setAttribute("flood-color","#00ff00"),c.setAttribute("flood-opacity","1"),c.setAttribute("result",n+"_drop_shadow_3"),this.feFlood=c,t.appendChild(c);var h=createNS("feComposite");h.setAttribute("in",n+"_drop_shadow_3"),h.setAttribute("in2",n+"_drop_shadow_2"),h.setAttribute("operator","in"),h.setAttribute("result",n+"_drop_shadow_4"),t.appendChild(h);var d=this.createMergeNode(n,[n+"_drop_shadow_4",i]);t.appendChild(d)}SVGComposableEffect.prototype={createMergeNode:function(t,e){var r,n,i=createNS("feMerge");for(i.setAttribute("result",t),n=0;n<e.length;n+=1)(r=createNS("feMergeNode")).setAttribute("in",e[n]),i.appendChild(r),i.appendChild(r);return i}},extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",r[0]-e[0]+" 0 0 0 "+e[0]+" "+(r[1]-e[1])+" 0 0 0 "+e[1]+" "+(r[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 "+n+" 0")}},SVGFillFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+r+" 0")}},SVGStrokeEffect.prototype.initialize=function(){var t,e,r,n,i=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(n=this.elem.maskManager.masksProperties.length,r=0):n=1+(r=this.filterManager.effectElements[0].p.v-1),(e=createNS("g")).setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-dashoffset",1);r<n;r+=1)t=createNS("path"),e.appendChild(t),this.paths.push({p:t,m:r});if(3===this.filterManager.effectElements[10].p.v){var a=createNS("mask"),o=createElementID();a.setAttribute("id",o),a.setAttribute("mask-type","alpha"),a.appendChild(e),this.elem.globalData.defs.appendChild(a);var s=createNS("g");for(s.setAttribute("mask","url("+getLocationHref()+"#"+o+")");i[0];)s.appendChild(i[0]);this.elem.layerElement.appendChild(s),this.masker=a,e.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(i=this.elem.layerElement.children||this.elem.layerElement.childNodes;i.length;)this.elem.layerElement.removeChild(i[0]);this.elem.layerElement.appendChild(e),this.elem.layerElement.removeAttribute("mask"),e.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=e},SVGStrokeEffect.prototype.renderFrame=function(t){var e;this.initialized||this.initialize();var r,n,i=this.paths.length;for(e=0;e<i;e+=1)if(-1!==this.paths[e].m&&(r=this.elem.maskManager.viewData[this.paths[e].m],n=this.paths[e].p,(t||this.filterManager._mdf||r.prop._mdf)&&n.setAttribute("d",r.lastPath),t||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||r.prop._mdf)){var a;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var o=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),s=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),l=n.getTotalLength();a="0 0 0 "+l*o+" ";var c,h=l*(s-o),d=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,p=Math.floor(h/d);for(c=0;c<p;c+=1)a+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";a+="0 "+10*l+" 0 0"}else a="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;n.setAttribute("stroke-dasharray",a)}if((t||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(t||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(t||this.filterManager.effectElements[3].p._mdf)){var u=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*u[0])+","+bmFloor(255*u[1])+","+bmFloor(255*u[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v,i=n[0]+" "+r[0]+" "+e[0],a=n[1]+" "+r[1]+" "+e[1],o=n[2]+" "+r[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",i),this.feFuncG.setAttribute("tableValues",a),this.feFuncB.setAttribute("tableValues",o)}},SVGProLevelsFilter.prototype.createFeFunc=function(t,e){var r=createNS(t);return r.setAttribute("type","table"),e.appendChild(r),r},SVGProLevelsFilter.prototype.getTableValue=function(t,e,r,n,i){for(var a,o,s=0,l=Math.min(t,e),c=Math.max(t,e),h=Array.call(null,{length:256}),d=0,p=i-n,u=e-t;s<=256;)o=(a=s/256)<=l?u<0?i:n:a>=c?u<0?n:i:n+p*Math.pow((a-t)/u,1/r),h[d]=o,d+=1,s+=256/255;return h.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e,r=this.filterManager.effectElements;this.feFuncRComposed&&(t||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(e=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(t||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(e=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(t||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(e=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(t||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(e=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(t||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(e=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",e))}},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){if((t||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),t||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])))}if((t||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),t||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var r=this.filterManager.effectElements[3].p.v,n=(this.filterManager.effectElements[2].p.v-90)*degToRads,i=r*Math.cos(n),a=r*Math.sin(n);this.feOffset.setAttribute("dx",i),this.feOffset.setAttribute("dy",a)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(t,e,r){this.initialized=!1,this.filterManager=e,this.filterElem=t,this.elem=r,r.matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function SVGGaussianBlurEffect(t,e,r,n){t.setAttribute("x","-100%"),t.setAttribute("y","-100%"),t.setAttribute("width","300%"),t.setAttribute("height","300%"),this.filterManager=e;var i=createNS("feGaussianBlur");i.setAttribute("result",n),t.appendChild(i),this.feGaussianBlur=i}return SVGMatte3Effect.prototype.findSymbol=function(t){for(var e=0,r=_svgMatteSymbols.length;e<r;){if(_svgMatteSymbols[e]===t)return _svgMatteSymbols[e];e+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(t,e){var r=t.layerElement.parentNode;if(r){for(var n,i=r.children,a=0,o=i.length;a<o&&i[a]!==t.layerElement;)a+=1;a<=o-2&&(n=i[a+1]);var s=createNS("use");s.setAttribute("href","#"+e),n?r.insertBefore(s,n):r.appendChild(s)}},SVGMatte3Effect.prototype.setElementAsMask=function(t,e){if(!this.findSymbol(e)){var r=createElementID(),n=createNS("mask");n.setAttribute("id",e.layerId),n.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var i=t.globalData.defs;i.appendChild(n);var a=createNS("symbol");a.setAttribute("id",r),this.replaceInParent(e,r),a.appendChild(e.layerElement),i.appendChild(a);var o=createNS("use");o.setAttribute("href","#"+r),n.appendChild(o),e.data.hd=!1,e.show()}t.setMatte(e.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var t=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,r=0,n=e.length;r<n;)e[r]&&e[r].data.ind===t&&this.setElementAsMask(this.elem,e[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=.3*this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=3==r?0:e,i=2==r?0:e;this.feGaussianBlur.setAttribute("stdDeviation",n+" "+i);var a=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",a)}},registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect(20,SVGTintFilter,!0),registerEffect(21,SVGFillFilter,!0),registerEffect(22,SVGStrokeEffect,!1),registerEffect(23,SVGTritoneFilter,!0),registerEffect(24,SVGProLevelsFilter,!0),registerEffect(25,SVGDropShadowEffect,!0),registerEffect(28,SVGMatte3Effect,!1),registerEffect(29,SVGGaussianBlurEffect,!0),lottie},module.exports=factory())})(lottie$1,lottie$1.exports);var lottie=lottie$1.exports,_templateObject$1,styles=r$3(_templateObject$1||(_templateObject$1=_taggedTemplateLiteral(["\n  * {\n    box-sizing: border-box;\n  }\n\n  :host {\n    --lottie-player-toolbar-height: 35px;\n    --lottie-player-toolbar-background-color: transparent;\n    --lottie-player-toolbar-icon-color: #999;\n    --lottie-player-toolbar-icon-hover-color: #222;\n    --lottie-player-toolbar-icon-active-color: #555;\n    --lottie-player-seeker-track-color: #ccc;\n    --lottie-player-seeker-thumb-color: rgba(0, 107, 120, 0.8);\n    --lottie-player-seeker-display: block;\n\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n\n  .main {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n  }\n\n  .animation {\n    width: 100%;\n    height: 100%;\n    display: flex;\n  }\n  .animation.controls {\n    height: calc(100% - 35px);\n  }\n\n  .toolbar {\n    display: flex;\n    align-items: center;\n    justify-items: center;\n    background-color: var(--lottie-player-toolbar-background-color);\n    margin: 0 5px;\n    height: 35px;\n  }\n\n  .toolbar button {\n    cursor: pointer;\n    fill: var(--lottie-player-toolbar-icon-color);\n    display: flex;\n    background: none;\n    border: 0;\n    padding: 0;\n    outline: none;\n    height: 100%;\n  }\n\n  .toolbar button:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button.active {\n    fill: var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button.active:hover {\n    fill: var(--lottie-player-toolbar-icon-hover-color);\n  }\n\n  .toolbar button:focus {\n    outline: 1px dotted var(--lottie-player-toolbar-icon-active-color);\n  }\n\n  .toolbar button svg {\n  }\n\n  .toolbar button.disabled svg {\n    display: none;\n  }\n\n  .seeker {\n    -webkit-appearance: none;\n    width: 95%;\n    outline: none;\n    background-color: var(--lottie-player-toolbar-background-color);\n    display: var(--lottie-player-seeker-display);\n  }\n\n  .seeker::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-webkit-slider-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n    -webkit-appearance: none;\n    margin-top: -5px;\n  }\n  .seeker:focus::-webkit-slider-runnable-track {\n    background: #999;\n  }\n  .seeker::-moz-range-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-moz-range-thumb {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker::-ms-track {\n    width: 100%;\n    height: 5px;\n    cursor: pointer;\n    background: transparent;\n    border-color: transparent;\n    color: transparent;\n  }\n  .seeker::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n    border-radius: 3px;\n  }\n  .seeker::-ms-thumb {\n    border: 0;\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    background: var(--lottie-player-seeker-thumb-color);\n    cursor: pointer;\n  }\n  .seeker:focus::-ms-fill-lower {\n    background: var(--lottie-player-seeker-track-color);\n  }\n  .seeker:focus::-ms-fill-upper {\n    background: var(--lottie-player-seeker-track-color);\n  }\n\n  .error {\n    display: flex;\n    justify-content: center;\n    height: 100%;\n    align-items: center;\n  }\n"]))),LOTTIE_PLAYER_VERSION="2.0.2",LOTTIE_WEB_VERSION="^5.10.0",_templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,PlayerState,PlayMode,PlayerEvents;function parseSrc(t){if("object"==typeof t)return t;try{return JSON.parse(t)}catch(e){return new URL(t,window.location.href).toString()}}function isLottie(t){return["v","ip","op","layers","fr","w","h"].every((e=>Object.prototype.hasOwnProperty.call(t,e)))}function fromURL(t){return _fromURL.apply(this,arguments)}function _fromURL(){return(_fromURL=_asyncToGenerator((function*(t){if("string"!=typeof t)throw new Error("The url value must be a string");var e;try{var r=new URL(t),n=yield fetch(r.toString());e=yield n.json()}catch(t){throw new Error("An error occurred while trying to load the Lottie file from URL")}return e}))).apply(this,arguments)}!function(t){t.Destroyed="destroyed",t.Error="error",t.Frozen="frozen",t.Loading="loading",t.Paused="paused",t.Playing="playing",t.Stopped="stopped"}(PlayerState||(PlayerState={})),function(t){t.Bounce="bounce",t.Normal="normal"}(PlayMode||(PlayMode={})),function(t){t.Complete="complete",t.Destroyed="destroyed",t.Error="error",t.Frame="frame",t.Freeze="freeze",t.Load="load",t.Loop="loop",t.Pause="pause",t.Play="play",t.Ready="ready",t.Rendered="rendered",t.Stop="stop"}(PlayerEvents||(PlayerEvents={}));var LottiePlayer=class extends s{constructor(){super(...arguments),this.autoplay=!1,this.background="transparent",this.controls=!1,this.currentState=PlayerState.Loading,this.description="Lottie animation",this.direction=1,this.disableCheck=!1,this.disableShadowDOM=!1,this.hover=!1,this.intermission=1,this.loop=!1,this.mode=PlayMode.Normal,this.preserveAspectRatio="xMidYMid meet",this.renderer="svg",this.speed=1,this._io=void 0,this._counter=1}load(t){var e=this;return _asyncToGenerator((function*(){var r={container:e.container,loop:!1,autoplay:!1,renderer:e.renderer,rendererSettings:Object.assign({preserveAspectRatio:e.preserveAspectRatio,clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0},e.viewBoxSize&&{viewBoxSize:e.viewBoxSize})};try{var n=parseSrc(t),i={},a="string"==typeof n?"path":"animationData";e._lottie&&e._lottie.destroy(),e.webworkers&&lottie$1.exports.useWebWorker(!0),e._lottie=lottie$1.exports.loadAnimation(Object.assign(Object.assign({},r),{[a]:n})),e._attachEventListeners(),e.disableCheck||("path"===a?(i=yield fromURL(n),a="animationData"):i=n,isLottie(i)||(e.currentState=PlayerState.Error,e.dispatchEvent(new CustomEvent(PlayerEvents.Error))))}catch(t){e.currentState=PlayerState.Error,e.dispatchEvent(new CustomEvent(PlayerEvents.Error))}}))()}getLottie(){return this._lottie}getVersions(){return{lottieWebVersion:LOTTIE_WEB_VERSION,lottiePlayerVersion:LOTTIE_PLAYER_VERSION}}play(){this._lottie&&(this._lottie.play(),this.currentState=PlayerState.Playing,this.dispatchEvent(new CustomEvent(PlayerEvents.Play)))}pause(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Paused,this.dispatchEvent(new CustomEvent(PlayerEvents.Pause)))}stop(){this._lottie&&(this._counter=1,this._lottie.stop(),this.currentState=PlayerState.Stopped,this.dispatchEvent(new CustomEvent(PlayerEvents.Stop)))}destroy(){this._lottie&&(this._lottie.destroy(),this._lottie=null,this.currentState=PlayerState.Destroyed,this.dispatchEvent(new CustomEvent(PlayerEvents.Destroyed)),this.remove())}seek(t){if(this._lottie){var e=/^(\d+)(%?)$/.exec(t.toString());if(e){var r="%"===e[2]?this._lottie.totalFrames*Number(e[1])/100:Number(e[1]);this.seeker=r,this.currentState===PlayerState.Playing?this._lottie.goToAndPlay(r,!0):(this._lottie.goToAndStop(r,!0),this._lottie.pause())}}}snapshot(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shadowRoot){var e=this.shadowRoot.querySelector(".animation svg"),r=(new XMLSerializer).serializeToString(e);if(t){var n=document.createElement("a");n.href="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(r)),n.download="download_".concat(this.seeker,".svg"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}return r}}setSpeed(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._lottie&&this._lottie.setSpeed(t)}setDirection(t){this._lottie&&this._lottie.setDirection(t)}setLooping(t){this._lottie&&(this.loop=t,this._lottie.loop=t)}togglePlay(){return this.currentState===PlayerState.Playing?this.pause():this.play()}toggleLooping(){this.setLooping(!this.loop)}resize(){this._lottie&&this._lottie.resize()}static get styles(){return styles}disconnectedCallback(){this.isConnected||(this._io&&(this._io.disconnect(),this._io=void 0),document.removeEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.destroy())}render(){var t=this.controls?"main controls":"main",e=this.controls?"animation controls":"animation";return $(_templateObject||(_templateObject=_taggedTemplateLiteral([' <div\n      id="animation-container"\n      class=','\n      lang="en"\n      aria-label=','\n      role="img"\n    >\n      <div\n        id="animation"\n        class=','\n        style="background:',';"\n      >\n        ',"\n      </div>\n      ","\n    </div>"])),t,this.description,e,this.background,this.currentState===PlayerState.Error?$(_templateObject2||(_templateObject2=_taggedTemplateLiteral(['<div class="error"></div>']))):void 0,this.controls&&!this.disableShadowDOM?this.renderControls():void 0)}createRenderRoot(){return this.disableShadowDOM&&(this.style.display="block"),this.disableShadowDOM?this:super.createRenderRoot()}firstUpdated(){"IntersectionObserver"in window&&(this._io=new IntersectionObserver((t=>{t[0].isIntersecting?this.currentState===PlayerState.Frozen&&this.play():this.currentState===PlayerState.Playing&&this.freeze()})),this._io.observe(this.container)),void 0!==document.hidden&&document.addEventListener("visibilitychange",(()=>this._onVisibilityChange())),this.src&&this.load(this.src),this.dispatchEvent(new CustomEvent(PlayerEvents.Rendered))}renderControls(){var t=this.currentState===PlayerState.Playing,e=this.currentState===PlayerState.Paused,r=this.currentState===PlayerState.Stopped;return $(_templateObject3||(_templateObject3=_taggedTemplateLiteral(['\n      <div\n        id="lottie-controls"\n        aria-label="lottie-animation-controls"\n        class="toolbar"\n      >\n        <button\n          id="lottie-play-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="play-pause"\n        >\n          ','\n        </button>\n        <button\n          id="lottie-stop-button"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="stop"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path d="M6 6h12v12H6V6z" />\n          </svg>\n        </button>\n        <input\n          id="lottie-seeker-input"\n          class="seeker"\n          type="range"\n          min="0"\n          step="1"\n          max="100"\n          .value=',"\n          @input=","\n          @mousedown=","\n          @mouseup=",'\n          aria-valuemin="1"\n          aria-valuemax="100"\n          role="slider"\n          aria-valuenow=','\n          tabindex="0"\n          aria-label="lottie-seek-input"\n        />\n        <button\n          id="lottie-loop-toggle"\n          @click=',"\n          class=",'\n          style="align-items:center;"\n          tabindex="0"\n          aria-label="loop-toggle"\n        >\n          <svg width="24" height="24" aria-hidden="true" focusable="false">\n            <path\n              d="M17.016 17.016v-4.031h1.969v6h-12v3l-3.984-3.984 3.984-3.984v3h10.031zM6.984 6.984v4.031H5.015v-6h12v-3l3.984 3.984-3.984 3.984v-3H6.984z"\n            />\n          </svg>\n        </button>\n      </div>\n    '])),this.togglePlay,t||e?"active":"",$(t?_templateObject4||(_templateObject4=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path\n                  d="M14.016 5.016H18v13.969h-3.984V5.016zM6 18.984V5.015h3.984v13.969H6z"\n                />\n              </svg>'])):_templateObject5||(_templateObject5=_taggedTemplateLiteral(['<svg\n                width="24"\n                height="24"\n                aria-hidden="true"\n                focusable="false"\n              >\n                <path d="M8.016 5.016L18.985 12 8.016 18.984V5.015z" />\n              </svg>']))),this.stop,r?"active":"",this.seeker,this._handleSeekChange,(()=>{this._prevState=this.currentState,this.freeze()}),(()=>{this._prevState===PlayerState.Playing&&this.play()}),this.seeker,this.toggleLooping,this.loop?"active":"")}_onVisibilityChange(){!0===document.hidden&&this.currentState===PlayerState.Playing?this.freeze():this.currentState===PlayerState.Frozen&&this.play()}_handleSeekChange(t){if(this._lottie&&!isNaN(t.target.value)){var e=t.target.value/100*this._lottie.totalFrames;this.seek(e)}}_attachEventListeners(){this._lottie.addEventListener("enterFrame",(()=>{this.seeker=this._lottie.currentFrame/this._lottie.totalFrames*100,this.dispatchEvent(new CustomEvent(PlayerEvents.Frame,{detail:{frame:this._lottie.currentFrame,seeker:this.seeker}}))})),this._lottie.addEventListener("complete",(()=>{if(this.currentState===PlayerState.Playing){if(!this.loop||this.count&&this._counter>=this.count){if(this.dispatchEvent(new CustomEvent(PlayerEvents.Complete)),this.mode!==PlayMode.Bounce)return;if(0===this._lottie.currentFrame)return}this.mode===PlayMode.Bounce?(this.count&&(this._counter+=.5),setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(this._lottie.setDirection(-1*this._lottie.playDirection),this._lottie.play())}),this.intermission)):(this.count&&(this._counter+=1),window.setTimeout((()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Loop)),this.currentState===PlayerState.Playing&&(-1===this.direction?(this.seek("99%"),this.play()):(this._lottie.stop(),this._lottie.play()))}),this.intermission))}else this.dispatchEvent(new CustomEvent(PlayerEvents.Complete))})),this._lottie.addEventListener("DOMLoaded",(()=>{this.setSpeed(this.speed),this.setDirection(this.direction),this.autoplay&&(-1===this.direction&&this.seek("100%"),this.play()),this.dispatchEvent(new CustomEvent(PlayerEvents.Ready))})),this._lottie.addEventListener("data_ready",(()=>{this.dispatchEvent(new CustomEvent(PlayerEvents.Load))})),this._lottie.addEventListener("data_failed",(()=>{this.currentState=PlayerState.Error,this.dispatchEvent(new CustomEvent(PlayerEvents.Error))})),this.container.addEventListener("mouseenter",(()=>{this.hover&&this.currentState!==PlayerState.Playing&&this.play()})),this.container.addEventListener("mouseleave",(()=>{this.hover&&this.currentState===PlayerState.Playing&&this.stop()}))}freeze(){this._lottie&&(this._lottie.pause(),this.currentState=PlayerState.Frozen,this.dispatchEvent(new CustomEvent(PlayerEvents.Freeze)))}};__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"autoplay",void 0),__decorate([e$5({type:String,reflect:!0})],LottiePlayer.prototype,"background",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"controls",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"count",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"currentState",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"description",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"direction",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"disableCheck",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"disableShadowDOM",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"hover",void 0),__decorate([e$5()],LottiePlayer.prototype,"intermission",void 0),__decorate([e$5({type:Boolean,reflect:!0})],LottiePlayer.prototype,"loop",void 0),__decorate([e$5()],LottiePlayer.prototype,"mode",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"preserveAspectRatio",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"renderer",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"viewBoxSize",void 0),__decorate([e$5()],LottiePlayer.prototype,"seeker",void 0),__decorate([e$5({type:Number})],LottiePlayer.prototype,"speed",void 0),__decorate([e$5({type:String})],LottiePlayer.prototype,"src",void 0),__decorate([e$5({type:Boolean})],LottiePlayer.prototype,"webworkers",void 0),__decorate([i(".animation")],LottiePlayer.prototype,"container",void 0),LottiePlayer=__decorate([n$1("lottie-player")],LottiePlayer)},666:(t,e,r)=>{r.d(e,{Z:()=>a});var n=r(645),i=r.n(n)()((function(t){return t[1]}));i.push([t.id,"@charset \"UTF-8\";/*!\n * Bootstrap  v5.3.2 (https://getbootstrap.com/)\n * Copyright 2011-2023 The Bootstrap Authors\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n */:root,[data-bs-theme=light]{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-primary-text-emphasis:#052c65;--bs-secondary-text-emphasis:#2b2f32;--bs-success-text-emphasis:#0a3622;--bs-info-text-emphasis:#055160;--bs-warning-text-emphasis:#664d03;--bs-danger-text-emphasis:#58151c;--bs-light-text-emphasis:#495057;--bs-dark-text-emphasis:#495057;--bs-primary-bg-subtle:#cfe2ff;--bs-secondary-bg-subtle:#e2e3e5;--bs-success-bg-subtle:#d1e7dd;--bs-info-bg-subtle:#cff4fc;--bs-warning-bg-subtle:#fff3cd;--bs-danger-bg-subtle:#f8d7da;--bs-light-bg-subtle:#fcfcfd;--bs-dark-bg-subtle:#ced4da;--bs-primary-border-subtle:#9ec5fe;--bs-secondary-border-subtle:#c4c8cb;--bs-success-border-subtle:#a3cfbb;--bs-info-border-subtle:#9eeaf9;--bs-warning-border-subtle:#ffe69c;--bs-danger-border-subtle:#f1aeb5;--bs-light-border-subtle:#e9ecef;--bs-dark-border-subtle:#adb5bd;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-font-sans-serif:system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",\"Liberation Sans\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-color-rgb:33,37,41;--bs-body-bg:#fff;--bs-body-bg-rgb:255,255,255;--bs-emphasis-color:#000;--bs-emphasis-color-rgb:0,0,0;--bs-secondary-color:rgba(33, 37, 41, 0.75);--bs-secondary-color-rgb:33,37,41;--bs-secondary-bg:#e9ecef;--bs-secondary-bg-rgb:233,236,239;--bs-tertiary-color:rgba(33, 37, 41, 0.5);--bs-tertiary-color-rgb:33,37,41;--bs-tertiary-bg:#f8f9fa;--bs-tertiary-bg-rgb:248,249,250;--bs-heading-color:inherit;--bs-link-color:#0d6efd;--bs-link-color-rgb:13,110,253;--bs-link-decoration:underline;--bs-link-hover-color:#0a58ca;--bs-link-hover-color-rgb:10,88,202;--bs-code-color:#d63384;--bs-highlight-color:#212529;--bs-highlight-bg:#fff3cd;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0, 0, 0, 0.175);--bs-border-radius:0.375rem;--bs-border-radius-sm:0.25rem;--bs-border-radius-lg:0.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-xxl:2rem;--bs-border-radius-2xl:var(--bs-border-radius-xxl);--bs-border-radius-pill:50rem;--bs-box-shadow:0 0.5rem 1rem rgba(0, 0, 0, 0.15);--bs-box-shadow-sm:0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);--bs-box-shadow-lg:0 1rem 3rem rgba(0, 0, 0, 0.175);--bs-box-shadow-inset:inset 0 1px 2px rgba(0, 0, 0, 0.075);--bs-focus-ring-width:0.25rem;--bs-focus-ring-opacity:0.25;--bs-focus-ring-color:rgba(13, 110, 253, 0.25);--bs-form-valid-color:#198754;--bs-form-valid-border-color:#198754;--bs-form-invalid-color:#dc3545;--bs-form-invalid-border-color:#dc3545}[data-bs-theme=dark]{color-scheme:dark;--bs-body-color:#dee2e6;--bs-body-color-rgb:222,226,230;--bs-body-bg:#212529;--bs-body-bg-rgb:33,37,41;--bs-emphasis-color:#fff;--bs-emphasis-color-rgb:255,255,255;--bs-secondary-color:rgba(222, 226, 230, 0.75);--bs-secondary-color-rgb:222,226,230;--bs-secondary-bg:#343a40;--bs-secondary-bg-rgb:52,58,64;--bs-tertiary-color:rgba(222, 226, 230, 0.5);--bs-tertiary-color-rgb:222,226,230;--bs-tertiary-bg:#2b3035;--bs-tertiary-bg-rgb:43,48,53;--bs-primary-text-emphasis:#6ea8fe;--bs-secondary-text-emphasis:#a7acb1;--bs-success-text-emphasis:#75b798;--bs-info-text-emphasis:#6edff6;--bs-warning-text-emphasis:#ffda6a;--bs-danger-text-emphasis:#ea868f;--bs-light-text-emphasis:#f8f9fa;--bs-dark-text-emphasis:#dee2e6;--bs-primary-bg-subtle:#031633;--bs-secondary-bg-subtle:#161719;--bs-success-bg-subtle:#051b11;--bs-info-bg-subtle:#032830;--bs-warning-bg-subtle:#332701;--bs-danger-bg-subtle:#2c0b0e;--bs-light-bg-subtle:#343a40;--bs-dark-bg-subtle:#1a1d20;--bs-primary-border-subtle:#084298;--bs-secondary-border-subtle:#41464b;--bs-success-border-subtle:#0f5132;--bs-info-border-subtle:#087990;--bs-warning-border-subtle:#997404;--bs-danger-border-subtle:#842029;--bs-light-border-subtle:#495057;--bs-dark-border-subtle:#343a40;--bs-heading-color:inherit;--bs-link-color:#6ea8fe;--bs-link-hover-color:#8bb9fe;--bs-link-color-rgb:110,168,254;--bs-link-hover-color-rgb:139,185,254;--bs-code-color:#e685b5;--bs-highlight-color:#dee2e6;--bs-highlight-bg:#664d03;--bs-border-color:#495057;--bs-border-color-translucent:rgba(255, 255, 255, 0.15);--bs-form-valid-color:#75b798;--bs-form-valid-border-color:#75b798;--bs-form-invalid-color:#ea868f;--bs-form-invalid-border-color:#ea868f}*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;border:0;border-top:var(--bs-border-width) solid;opacity:.25}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2;color:var(--bs-heading-color)}.h1,h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){.h1,h1{font-size:2.5rem}}.h2,h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){.h2,h2{font-size:2rem}}.h3,h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){.h3,h3{font-size:1.75rem}}.h4,h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){.h4,h4{font-size:1.5rem}}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}.small,small{font-size:.875em}.mark,mark{padding:.1875em;color:var(--bs-highlight-color);background-color:var(--bs-highlight-bg)}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,1));text-decoration:underline}a:hover{--bs-link-color-rgb:var(--bs-link-hover-color-rgb)}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:var(--bs-font-monospace);font-size:1em}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:var(--bs-code-color);word-wrap:break-word}a>code{color:inherit}kbd{padding:.1875rem .375rem;font-size:.875em;color:var(--bs-body-bg);background-color:var(--bs-body-color);border-radius:.25rem}kbd kbd{padding:0;font-size:1em}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-secondary-color);text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]:not([type=date]):not([type=datetime-local]):not([type=month]):not([type=week]):not([type=time])::-webkit-calendar-picker-indicator{display:none!important}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}::file-selector-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:calc(1.625rem + 4.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-1{font-size:5rem}}.display-2{font-size:calc(1.575rem + 3.9vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-2{font-size:4.5rem}}.display-3{font-size:calc(1.525rem + 3.3vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-3{font-size:4rem}}.display-4{font-size:calc(1.475rem + 2.7vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-4{font-size:3.5rem}}.display-5{font-size:calc(1.425rem + 2.1vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-5{font-size:3rem}}.display-6{font-size:calc(1.375rem + 1.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-6{font-size:2.5rem}}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none}.list-inline-item{display:inline-block}.list-inline-item:not(:last-child){margin-right:.5rem}.initialism{font-size:.875em;text-transform:uppercase}.blockquote{margin-bottom:1rem;font-size:1.25rem}.blockquote>:last-child{margin-bottom:0}.blockquote-footer{margin-top:-1rem;margin-bottom:1rem;font-size:.875em;color:#6c757d}.blockquote-footer::before{content:\"\"}.img-fluid{max-width:100%;height:auto}.img-thumbnail{padding:.25rem;background-color:var(--bs-body-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);max-width:100%;height:auto}.figure{display:inline-block}.figure-img{margin-bottom:.5rem;line-height:1}.figure-caption{font-size:.875em;color:var(--bs-secondary-color)}.container,.container-fluid,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{--bs-gutter-x:1.5rem;--bs-gutter-y:0;width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-right:auto;margin-left:auto}@media (min-width:576px){.container,.container-sm{max-width:540px}}@media (min-width:768px){.container,.container-md,.container-sm{max-width:720px}}@media (min-width:992px){.container,.container-lg,.container-md,.container-sm{max-width:960px}}@media (min-width:1200px){.container,.container-lg,.container-md,.container-sm,.container-xl{max-width:1140px}}@media (min-width:1400px){.container,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{max-width:1320px}}:root{--bs-breakpoint-xs:0;--bs-breakpoint-sm:576px;--bs-breakpoint-md:768px;--bs-breakpoint-lg:992px;--bs-breakpoint-xl:1200px;--bs-breakpoint-xxl:1400px}.row{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1 * var(--bs-gutter-y));margin-right:calc(-.5 * var(--bs-gutter-x));margin-left:calc(-.5 * var(--bs-gutter-x))}.row>*{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-top:var(--bs-gutter-y)}.col{flex:1 0 0%}.row-cols-auto>*{flex:0 0 auto;width:auto}.row-cols-1>*{flex:0 0 auto;width:100%}.row-cols-2>*{flex:0 0 auto;width:50%}.row-cols-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-4>*{flex:0 0 auto;width:25%}.row-cols-5>*{flex:0 0 auto;width:20%}.row-cols-6>*{flex:0 0 auto;width:16.66666667%}.col-auto{flex:0 0 auto;width:auto}.col-1{flex:0 0 auto;width:8.33333333%}.col-2{flex:0 0 auto;width:16.66666667%}.col-3{flex:0 0 auto;width:25%}.col-4{flex:0 0 auto;width:33.33333333%}.col-5{flex:0 0 auto;width:41.66666667%}.col-6{flex:0 0 auto;width:50%}.col-7{flex:0 0 auto;width:58.33333333%}.col-8{flex:0 0 auto;width:66.66666667%}.col-9{flex:0 0 auto;width:75%}.col-10{flex:0 0 auto;width:83.33333333%}.col-11{flex:0 0 auto;width:91.66666667%}.col-12{flex:0 0 auto;width:100%}.offset-1{margin-left:8.33333333%}.offset-2{margin-left:16.66666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.33333333%}.offset-5{margin-left:41.66666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.33333333%}.offset-8{margin-left:66.66666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.33333333%}.offset-11{margin-left:91.66666667%}.g-0,.gx-0{--bs-gutter-x:0}.g-0,.gy-0{--bs-gutter-y:0}.g-1,.gx-1{--bs-gutter-x:0.25rem}.g-1,.gy-1{--bs-gutter-y:0.25rem}.g-2,.gx-2{--bs-gutter-x:0.5rem}.g-2,.gy-2{--bs-gutter-y:0.5rem}.g-3,.gx-3{--bs-gutter-x:1rem}.g-3,.gy-3{--bs-gutter-y:1rem}.g-4,.gx-4{--bs-gutter-x:1.5rem}.g-4,.gy-4{--bs-gutter-y:1.5rem}.g-5,.gx-5{--bs-gutter-x:3rem}.g-5,.gy-5{--bs-gutter-y:3rem}@media (min-width:576px){.col-sm{flex:1 0 0%}.row-cols-sm-auto>*{flex:0 0 auto;width:auto}.row-cols-sm-1>*{flex:0 0 auto;width:100%}.row-cols-sm-2>*{flex:0 0 auto;width:50%}.row-cols-sm-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-sm-4>*{flex:0 0 auto;width:25%}.row-cols-sm-5>*{flex:0 0 auto;width:20%}.row-cols-sm-6>*{flex:0 0 auto;width:16.66666667%}.col-sm-auto{flex:0 0 auto;width:auto}.col-sm-1{flex:0 0 auto;width:8.33333333%}.col-sm-2{flex:0 0 auto;width:16.66666667%}.col-sm-3{flex:0 0 auto;width:25%}.col-sm-4{flex:0 0 auto;width:33.33333333%}.col-sm-5{flex:0 0 auto;width:41.66666667%}.col-sm-6{flex:0 0 auto;width:50%}.col-sm-7{flex:0 0 auto;width:58.33333333%}.col-sm-8{flex:0 0 auto;width:66.66666667%}.col-sm-9{flex:0 0 auto;width:75%}.col-sm-10{flex:0 0 auto;width:83.33333333%}.col-sm-11{flex:0 0 auto;width:91.66666667%}.col-sm-12{flex:0 0 auto;width:100%}.offset-sm-0{margin-left:0}.offset-sm-1{margin-left:8.33333333%}.offset-sm-2{margin-left:16.66666667%}.offset-sm-3{margin-left:25%}.offset-sm-4{margin-left:33.33333333%}.offset-sm-5{margin-left:41.66666667%}.offset-sm-6{margin-left:50%}.offset-sm-7{margin-left:58.33333333%}.offset-sm-8{margin-left:66.66666667%}.offset-sm-9{margin-left:75%}.offset-sm-10{margin-left:83.33333333%}.offset-sm-11{margin-left:91.66666667%}.g-sm-0,.gx-sm-0{--bs-gutter-x:0}.g-sm-0,.gy-sm-0{--bs-gutter-y:0}.g-sm-1,.gx-sm-1{--bs-gutter-x:0.25rem}.g-sm-1,.gy-sm-1{--bs-gutter-y:0.25rem}.g-sm-2,.gx-sm-2{--bs-gutter-x:0.5rem}.g-sm-2,.gy-sm-2{--bs-gutter-y:0.5rem}.g-sm-3,.gx-sm-3{--bs-gutter-x:1rem}.g-sm-3,.gy-sm-3{--bs-gutter-y:1rem}.g-sm-4,.gx-sm-4{--bs-gutter-x:1.5rem}.g-sm-4,.gy-sm-4{--bs-gutter-y:1.5rem}.g-sm-5,.gx-sm-5{--bs-gutter-x:3rem}.g-sm-5,.gy-sm-5{--bs-gutter-y:3rem}}@media (min-width:768px){.col-md{flex:1 0 0%}.row-cols-md-auto>*{flex:0 0 auto;width:auto}.row-cols-md-1>*{flex:0 0 auto;width:100%}.row-cols-md-2>*{flex:0 0 auto;width:50%}.row-cols-md-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-md-4>*{flex:0 0 auto;width:25%}.row-cols-md-5>*{flex:0 0 auto;width:20%}.row-cols-md-6>*{flex:0 0 auto;width:16.66666667%}.col-md-auto{flex:0 0 auto;width:auto}.col-md-1{flex:0 0 auto;width:8.33333333%}.col-md-2{flex:0 0 auto;width:16.66666667%}.col-md-3{flex:0 0 auto;width:25%}.col-md-4{flex:0 0 auto;width:33.33333333%}.col-md-5{flex:0 0 auto;width:41.66666667%}.col-md-6{flex:0 0 auto;width:50%}.col-md-7{flex:0 0 auto;width:58.33333333%}.col-md-8{flex:0 0 auto;width:66.66666667%}.col-md-9{flex:0 0 auto;width:75%}.col-md-10{flex:0 0 auto;width:83.33333333%}.col-md-11{flex:0 0 auto;width:91.66666667%}.col-md-12{flex:0 0 auto;width:100%}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.33333333%}.offset-md-2{margin-left:16.66666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.33333333%}.offset-md-5{margin-left:41.66666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.33333333%}.offset-md-8{margin-left:66.66666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.33333333%}.offset-md-11{margin-left:91.66666667%}.g-md-0,.gx-md-0{--bs-gutter-x:0}.g-md-0,.gy-md-0{--bs-gutter-y:0}.g-md-1,.gx-md-1{--bs-gutter-x:0.25rem}.g-md-1,.gy-md-1{--bs-gutter-y:0.25rem}.g-md-2,.gx-md-2{--bs-gutter-x:0.5rem}.g-md-2,.gy-md-2{--bs-gutter-y:0.5rem}.g-md-3,.gx-md-3{--bs-gutter-x:1rem}.g-md-3,.gy-md-3{--bs-gutter-y:1rem}.g-md-4,.gx-md-4{--bs-gutter-x:1.5rem}.g-md-4,.gy-md-4{--bs-gutter-y:1.5rem}.g-md-5,.gx-md-5{--bs-gutter-x:3rem}.g-md-5,.gy-md-5{--bs-gutter-y:3rem}}@media (min-width:992px){.col-lg{flex:1 0 0%}.row-cols-lg-auto>*{flex:0 0 auto;width:auto}.row-cols-lg-1>*{flex:0 0 auto;width:100%}.row-cols-lg-2>*{flex:0 0 auto;width:50%}.row-cols-lg-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-lg-4>*{flex:0 0 auto;width:25%}.row-cols-lg-5>*{flex:0 0 auto;width:20%}.row-cols-lg-6>*{flex:0 0 auto;width:16.66666667%}.col-lg-auto{flex:0 0 auto;width:auto}.col-lg-1{flex:0 0 auto;width:8.33333333%}.col-lg-2{flex:0 0 auto;width:16.66666667%}.col-lg-3{flex:0 0 auto;width:25%}.col-lg-4{flex:0 0 auto;width:33.33333333%}.col-lg-5{flex:0 0 auto;width:41.66666667%}.col-lg-6{flex:0 0 auto;width:50%}.col-lg-7{flex:0 0 auto;width:58.33333333%}.col-lg-8{flex:0 0 auto;width:66.66666667%}.col-lg-9{flex:0 0 auto;width:75%}.col-lg-10{flex:0 0 auto;width:83.33333333%}.col-lg-11{flex:0 0 auto;width:91.66666667%}.col-lg-12{flex:0 0 auto;width:100%}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.33333333%}.offset-lg-2{margin-left:16.66666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.33333333%}.offset-lg-5{margin-left:41.66666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.33333333%}.offset-lg-8{margin-left:66.66666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.33333333%}.offset-lg-11{margin-left:91.66666667%}.g-lg-0,.gx-lg-0{--bs-gutter-x:0}.g-lg-0,.gy-lg-0{--bs-gutter-y:0}.g-lg-1,.gx-lg-1{--bs-gutter-x:0.25rem}.g-lg-1,.gy-lg-1{--bs-gutter-y:0.25rem}.g-lg-2,.gx-lg-2{--bs-gutter-x:0.5rem}.g-lg-2,.gy-lg-2{--bs-gutter-y:0.5rem}.g-lg-3,.gx-lg-3{--bs-gutter-x:1rem}.g-lg-3,.gy-lg-3{--bs-gutter-y:1rem}.g-lg-4,.gx-lg-4{--bs-gutter-x:1.5rem}.g-lg-4,.gy-lg-4{--bs-gutter-y:1.5rem}.g-lg-5,.gx-lg-5{--bs-gutter-x:3rem}.g-lg-5,.gy-lg-5{--bs-gutter-y:3rem}}@media (min-width:1200px){.col-xl{flex:1 0 0%}.row-cols-xl-auto>*{flex:0 0 auto;width:auto}.row-cols-xl-1>*{flex:0 0 auto;width:100%}.row-cols-xl-2>*{flex:0 0 auto;width:50%}.row-cols-xl-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-xl-4>*{flex:0 0 auto;width:25%}.row-cols-xl-5>*{flex:0 0 auto;width:20%}.row-cols-xl-6>*{flex:0 0 auto;width:16.66666667%}.col-xl-auto{flex:0 0 auto;width:auto}.col-xl-1{flex:0 0 auto;width:8.33333333%}.col-xl-2{flex:0 0 auto;width:16.66666667%}.col-xl-3{flex:0 0 auto;width:25%}.col-xl-4{flex:0 0 auto;width:33.33333333%}.col-xl-5{flex:0 0 auto;width:41.66666667%}.col-xl-6{flex:0 0 auto;width:50%}.col-xl-7{flex:0 0 auto;width:58.33333333%}.col-xl-8{flex:0 0 auto;width:66.66666667%}.col-xl-9{flex:0 0 auto;width:75%}.col-xl-10{flex:0 0 auto;width:83.33333333%}.col-xl-11{flex:0 0 auto;width:91.66666667%}.col-xl-12{flex:0 0 auto;width:100%}.offset-xl-0{margin-left:0}.offset-xl-1{margin-left:8.33333333%}.offset-xl-2{margin-left:16.66666667%}.offset-xl-3{margin-left:25%}.offset-xl-4{margin-left:33.33333333%}.offset-xl-5{margin-left:41.66666667%}.offset-xl-6{margin-left:50%}.offset-xl-7{margin-left:58.33333333%}.offset-xl-8{margin-left:66.66666667%}.offset-xl-9{margin-left:75%}.offset-xl-10{margin-left:83.33333333%}.offset-xl-11{margin-left:91.66666667%}.g-xl-0,.gx-xl-0{--bs-gutter-x:0}.g-xl-0,.gy-xl-0{--bs-gutter-y:0}.g-xl-1,.gx-xl-1{--bs-gutter-x:0.25rem}.g-xl-1,.gy-xl-1{--bs-gutter-y:0.25rem}.g-xl-2,.gx-xl-2{--bs-gutter-x:0.5rem}.g-xl-2,.gy-xl-2{--bs-gutter-y:0.5rem}.g-xl-3,.gx-xl-3{--bs-gutter-x:1rem}.g-xl-3,.gy-xl-3{--bs-gutter-y:1rem}.g-xl-4,.gx-xl-4{--bs-gutter-x:1.5rem}.g-xl-4,.gy-xl-4{--bs-gutter-y:1.5rem}.g-xl-5,.gx-xl-5{--bs-gutter-x:3rem}.g-xl-5,.gy-xl-5{--bs-gutter-y:3rem}}@media (min-width:1400px){.col-xxl{flex:1 0 0%}.row-cols-xxl-auto>*{flex:0 0 auto;width:auto}.row-cols-xxl-1>*{flex:0 0 auto;width:100%}.row-cols-xxl-2>*{flex:0 0 auto;width:50%}.row-cols-xxl-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-xxl-4>*{flex:0 0 auto;width:25%}.row-cols-xxl-5>*{flex:0 0 auto;width:20%}.row-cols-xxl-6>*{flex:0 0 auto;width:16.66666667%}.col-xxl-auto{flex:0 0 auto;width:auto}.col-xxl-1{flex:0 0 auto;width:8.33333333%}.col-xxl-2{flex:0 0 auto;width:16.66666667%}.col-xxl-3{flex:0 0 auto;width:25%}.col-xxl-4{flex:0 0 auto;width:33.33333333%}.col-xxl-5{flex:0 0 auto;width:41.66666667%}.col-xxl-6{flex:0 0 auto;width:50%}.col-xxl-7{flex:0 0 auto;width:58.33333333%}.col-xxl-8{flex:0 0 auto;width:66.66666667%}.col-xxl-9{flex:0 0 auto;width:75%}.col-xxl-10{flex:0 0 auto;width:83.33333333%}.col-xxl-11{flex:0 0 auto;width:91.66666667%}.col-xxl-12{flex:0 0 auto;width:100%}.offset-xxl-0{margin-left:0}.offset-xxl-1{margin-left:8.33333333%}.offset-xxl-2{margin-left:16.66666667%}.offset-xxl-3{margin-left:25%}.offset-xxl-4{margin-left:33.33333333%}.offset-xxl-5{margin-left:41.66666667%}.offset-xxl-6{margin-left:50%}.offset-xxl-7{margin-left:58.33333333%}.offset-xxl-8{margin-left:66.66666667%}.offset-xxl-9{margin-left:75%}.offset-xxl-10{margin-left:83.33333333%}.offset-xxl-11{margin-left:91.66666667%}.g-xxl-0,.gx-xxl-0{--bs-gutter-x:0}.g-xxl-0,.gy-xxl-0{--bs-gutter-y:0}.g-xxl-1,.gx-xxl-1{--bs-gutter-x:0.25rem}.g-xxl-1,.gy-xxl-1{--bs-gutter-y:0.25rem}.g-xxl-2,.gx-xxl-2{--bs-gutter-x:0.5rem}.g-xxl-2,.gy-xxl-2{--bs-gutter-y:0.5rem}.g-xxl-3,.gx-xxl-3{--bs-gutter-x:1rem}.g-xxl-3,.gy-xxl-3{--bs-gutter-y:1rem}.g-xxl-4,.gx-xxl-4{--bs-gutter-x:1.5rem}.g-xxl-4,.gy-xxl-4{--bs-gutter-y:1.5rem}.g-xxl-5,.gx-xxl-5{--bs-gutter-x:3rem}.g-xxl-5,.gy-xxl-5{--bs-gutter-y:3rem}}.table{--bs-table-color-type:initial;--bs-table-bg-type:initial;--bs-table-color-state:initial;--bs-table-bg-state:initial;--bs-table-color:var(--bs-emphasis-color);--bs-table-bg:var(--bs-body-bg);--bs-table-border-color:var(--bs-border-color);--bs-table-accent-bg:transparent;--bs-table-striped-color:var(--bs-emphasis-color);--bs-table-striped-bg:rgba(var(--bs-emphasis-color-rgb), 0.05);--bs-table-active-color:var(--bs-emphasis-color);--bs-table-active-bg:rgba(var(--bs-emphasis-color-rgb), 0.1);--bs-table-hover-color:var(--bs-emphasis-color);--bs-table-hover-bg:rgba(var(--bs-emphasis-color-rgb), 0.075);width:100%;margin-bottom:1rem;vertical-align:top;border-color:var(--bs-table-border-color)}.table>:not(caption)>*>*{padding:.5rem .5rem;color:var(--bs-table-color-state,var(--bs-table-color-type,var(--bs-table-color)));background-color:var(--bs-table-bg);border-bottom-width:var(--bs-border-width);box-shadow:inset 0 0 0 9999px var(--bs-table-bg-state,var(--bs-table-bg-type,var(--bs-table-accent-bg)))}.table>tbody{vertical-align:inherit}.table>thead{vertical-align:bottom}.table-group-divider{border-top:calc(var(--bs-border-width) * 2) solid currentcolor}.caption-top{caption-side:top}.table-sm>:not(caption)>*>*{padding:.25rem .25rem}.table-bordered>:not(caption)>*{border-width:var(--bs-border-width) 0}.table-bordered>:not(caption)>*>*{border-width:0 var(--bs-border-width)}.table-borderless>:not(caption)>*>*{border-bottom-width:0}.table-borderless>:not(:first-child){border-top-width:0}.table-striped>tbody>tr:nth-of-type(odd)>*{--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-striped-columns>:not(caption)>tr>:nth-child(2n){--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-active{--bs-table-color-state:var(--bs-table-active-color);--bs-table-bg-state:var(--bs-table-active-bg)}.table-hover>tbody>tr:hover>*{--bs-table-color-state:var(--bs-table-hover-color);--bs-table-bg-state:var(--bs-table-hover-bg)}.table-primary{--bs-table-color:#000;--bs-table-bg:#cfe2ff;--bs-table-border-color:#a6b5cc;--bs-table-striped-bg:#c5d7f2;--bs-table-striped-color:#000;--bs-table-active-bg:#bacbe6;--bs-table-active-color:#000;--bs-table-hover-bg:#bfd1ec;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-secondary{--bs-table-color:#000;--bs-table-bg:#e2e3e5;--bs-table-border-color:#b5b6b7;--bs-table-striped-bg:#d7d8da;--bs-table-striped-color:#000;--bs-table-active-bg:#cbccce;--bs-table-active-color:#000;--bs-table-hover-bg:#d1d2d4;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-success{--bs-table-color:#000;--bs-table-bg:#d1e7dd;--bs-table-border-color:#a7b9b1;--bs-table-striped-bg:#c7dbd2;--bs-table-striped-color:#000;--bs-table-active-bg:#bcd0c7;--bs-table-active-color:#000;--bs-table-hover-bg:#c1d6cc;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-info{--bs-table-color:#000;--bs-table-bg:#cff4fc;--bs-table-border-color:#a6c3ca;--bs-table-striped-bg:#c5e8ef;--bs-table-striped-color:#000;--bs-table-active-bg:#badce3;--bs-table-active-color:#000;--bs-table-hover-bg:#bfe2e9;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-warning{--bs-table-color:#000;--bs-table-bg:#fff3cd;--bs-table-border-color:#ccc2a4;--bs-table-striped-bg:#f2e7c3;--bs-table-striped-color:#000;--bs-table-active-bg:#e6dbb9;--bs-table-active-color:#000;--bs-table-hover-bg:#ece1be;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-danger{--bs-table-color:#000;--bs-table-bg:#f8d7da;--bs-table-border-color:#c6acae;--bs-table-striped-bg:#eccccf;--bs-table-striped-color:#000;--bs-table-active-bg:#dfc2c4;--bs-table-active-color:#000;--bs-table-hover-bg:#e5c7ca;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-light{--bs-table-color:#000;--bs-table-bg:#f8f9fa;--bs-table-border-color:#c6c7c8;--bs-table-striped-bg:#ecedee;--bs-table-striped-color:#000;--bs-table-active-bg:#dfe0e1;--bs-table-active-color:#000;--bs-table-hover-bg:#e5e6e7;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-dark{--bs-table-color:#fff;--bs-table-bg:#212529;--bs-table-border-color:#4d5154;--bs-table-striped-bg:#2c3034;--bs-table-striped-color:#fff;--bs-table-active-bg:#373b3e;--bs-table-active-color:#fff;--bs-table-hover-bg:#323539;--bs-table-hover-color:#fff;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-responsive{overflow-x:auto;-webkit-overflow-scrolling:touch}@media (max-width:575.98px){.table-responsive-sm{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:767.98px){.table-responsive-md{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:991.98px){.table-responsive-lg{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1199.98px){.table-responsive-xl{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1399.98px){.table-responsive-xxl{overflow-x:auto;-webkit-overflow-scrolling:touch}}.form-label{margin-bottom:.5rem}.col-form-label{padding-top:calc(.375rem + var(--bs-border-width));padding-bottom:calc(.375rem + var(--bs-border-width));margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg{padding-top:calc(.5rem + var(--bs-border-width));padding-bottom:calc(.5rem + var(--bs-border-width));font-size:1.25rem}.col-form-label-sm{padding-top:calc(.25rem + var(--bs-border-width));padding-bottom:calc(.25rem + var(--bs-border-width));font-size:.875rem}.form-text{margin-top:.25rem;font-size:.875em;color:var(--bs-secondary-color)}.form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-body-bg);background-clip:padding-box;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control[type=file]{overflow:hidden}.form-control[type=file]:not(:disabled):not([readonly]){cursor:pointer}.form-control:focus{color:var(--bs-body-color);background-color:var(--bs-body-bg);border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-control::-webkit-date-and-time-value{min-width:85px;height:1.5em;margin:0}.form-control::-webkit-datetime-edit{display:block;padding:0}.form-control::-moz-placeholder{color:var(--bs-secondary-color);opacity:1}.form-control::placeholder{color:var(--bs-secondary-color);opacity:1}.form-control:disabled{background-color:var(--bs-secondary-bg);opacity:1}.form-control::-webkit-file-upload-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control::file-selector-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control::-webkit-file-upload-button{-webkit-transition:none;transition:none}.form-control::file-selector-button{transition:none}}.form-control:hover:not(:disabled):not([readonly])::-webkit-file-upload-button{background-color:var(--bs-secondary-bg)}.form-control:hover:not(:disabled):not([readonly])::file-selector-button{background-color:var(--bs-secondary-bg)}.form-control-plaintext{display:block;width:100%;padding:.375rem 0;margin-bottom:0;line-height:1.5;color:var(--bs-body-color);background-color:transparent;border:solid transparent;border-width:var(--bs-border-width) 0}.form-control-plaintext:focus{outline:0}.form-control-plaintext.form-control-lg,.form-control-plaintext.form-control-sm{padding-right:0;padding-left:0}.form-control-sm{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2));padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-control-sm::-webkit-file-upload-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-sm::file-selector-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-lg{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2));padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.form-control-lg::-webkit-file-upload-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}.form-control-lg::file-selector-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}textarea.form-control{min-height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2))}textarea.form-control-sm{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}textarea.form-control-lg{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-control-color{width:3rem;height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2));padding:.375rem}.form-control-color:not(:disabled):not([readonly]){cursor:pointer}.form-control-color::-moz-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color::-webkit-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color.form-control-sm{height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}.form-control-color.form-control-lg{height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-select{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\");display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-body-bg);background-image:var(--bs-form-select-bg-img),var(--bs-form-select-bg-icon,none);background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-select{transition:none}}.form-select:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-select[multiple],.form-select[size]:not([size=\"1\"]){padding-right:.75rem;background-image:none}.form-select:disabled{background-color:var(--bs-secondary-bg)}.form-select:-moz-focusring{color:transparent;text-shadow:0 0 0 var(--bs-body-color)}.form-select-sm{padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-select-lg{padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}[data-bs-theme=dark] .form-select{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23dee2e6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\")}.form-check{display:block;min-height:1.5rem;padding-left:1.5em;margin-bottom:.125rem}.form-check .form-check-input{float:left;margin-left:-1.5em}.form-check-reverse{padding-right:1.5em;padding-left:0;text-align:right}.form-check-reverse .form-check-input{float:right;margin-right:-1.5em;margin-left:0}.form-check-input{--bs-form-check-bg:var(--bs-body-bg);flex-shrink:0;width:1em;height:1em;margin-top:.25em;vertical-align:top;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-form-check-bg);background-image:var(--bs-form-check-bg-image);background-repeat:no-repeat;background-position:center;background-size:contain;border:var(--bs-border-width) solid var(--bs-border-color);-webkit-print-color-adjust:exact;color-adjust:exact;print-color-adjust:exact}.form-check-input[type=checkbox]{border-radius:.25em}.form-check-input[type=radio]{border-radius:50%}.form-check-input:active{filter:brightness(90%)}.form-check-input:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-check-input:checked{background-color:#0d6efd;border-color:#0d6efd}.form-check-input:checked[type=checkbox]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='m6 10 3 3 6-6'/%3e%3c/svg%3e\")}.form-check-input:checked[type=radio]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e\")}.form-check-input[type=checkbox]:indeterminate{background-color:#0d6efd;border-color:#0d6efd;--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10h8'/%3e%3c/svg%3e\")}.form-check-input:disabled{pointer-events:none;filter:none;opacity:.5}.form-check-input:disabled~.form-check-label,.form-check-input[disabled]~.form-check-label{cursor:default;opacity:.5}.form-switch{padding-left:2.5em}.form-switch .form-check-input{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%280, 0, 0, 0.25%29'/%3e%3c/svg%3e\");width:2em;margin-left:-2.5em;background-image:var(--bs-form-switch-bg);background-position:left center;border-radius:2em;transition:background-position .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-switch .form-check-input{transition:none}}.form-switch .form-check-input:focus{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%2386b7fe'/%3e%3c/svg%3e\")}.form-switch .form-check-input:checked{background-position:right center;--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e\")}.form-switch.form-check-reverse{padding-right:2.5em;padding-left:0}.form-switch.form-check-reverse .form-check-input{margin-right:-2.5em;margin-left:0}.form-check-inline{display:inline-block;margin-right:1rem}.btn-check{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.btn-check:disabled+.btn,.btn-check[disabled]+.btn{pointer-events:none;filter:none;opacity:.65}[data-bs-theme=dark] .form-switch .form-check-input:not(:checked):not(:focus){--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%28255, 255, 255, 0.25%29'/%3e%3c/svg%3e\")}.form-range{width:100%;height:1.5rem;padding:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent}.form-range:focus{outline:0}.form-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range::-moz-focus-outer{border:0}.form-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;-webkit-appearance:none;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.form-range::-webkit-slider-thumb:active{background-color:#b6d4fe}.form-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range::-moz-range-thumb{width:1rem;height:1rem;-moz-appearance:none;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range::-moz-range-thumb{-moz-transition:none;transition:none}}.form-range::-moz-range-thumb:active{background-color:#b6d4fe}.form-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range:disabled{pointer-events:none}.form-range:disabled::-webkit-slider-thumb{background-color:var(--bs-secondary-color)}.form-range:disabled::-moz-range-thumb{background-color:var(--bs-secondary-color)}.form-floating{position:relative}.form-floating>.form-control,.form-floating>.form-control-plaintext,.form-floating>.form-select{height:calc(3.5rem + calc(var(--bs-border-width) * 2));min-height:calc(3.5rem + calc(var(--bs-border-width) * 2));line-height:1.25}.form-floating>label{position:absolute;top:0;left:0;z-index:2;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:var(--bs-border-width) solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out}@media (prefers-reduced-motion:reduce){.form-floating>label{transition:none}}.form-floating>.form-control,.form-floating>.form-control-plaintext{padding:1rem .75rem}.form-floating>.form-control-plaintext::-moz-placeholder,.form-floating>.form-control::-moz-placeholder{color:transparent}.form-floating>.form-control-plaintext::placeholder,.form-floating>.form-control::placeholder{color:transparent}.form-floating>.form-control-plaintext:not(:-moz-placeholder-shown),.form-floating>.form-control:not(:-moz-placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control-plaintext:focus,.form-floating>.form-control-plaintext:not(:placeholder-shown),.form-floating>.form-control:focus,.form-floating>.form-control:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control-plaintext:-webkit-autofill,.form-floating>.form-control:-webkit-autofill{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-select{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control:not(:-moz-placeholder-shown)~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control-plaintext~label,.form-floating>.form-control:focus~label,.form-floating>.form-control:not(:placeholder-shown)~label,.form-floating>.form-select~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control:not(:-moz-placeholder-shown)~label::after{position:absolute;inset:1rem 0.375rem;z-index:-1;height:1.5em;content:\"\";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating>.form-control-plaintext~label::after,.form-floating>.form-control:focus~label::after,.form-floating>.form-control:not(:placeholder-shown)~label::after,.form-floating>.form-select~label::after{position:absolute;inset:1rem 0.375rem;z-index:-1;height:1.5em;content:\"\";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating>.form-control:-webkit-autofill~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control-plaintext~label{border-width:var(--bs-border-width) 0}.form-floating>.form-control:disabled~label,.form-floating>:disabled~label{color:#6c757d}.form-floating>.form-control:disabled~label::after,.form-floating>:disabled~label::after{background-color:var(--bs-secondary-bg)}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.form-control,.input-group>.form-floating,.input-group>.form-select{position:relative;flex:1 1 auto;width:1%;min-width:0}.input-group>.form-control:focus,.input-group>.form-floating:focus-within,.input-group>.form-select:focus{z-index:5}.input-group .btn{position:relative;z-index:2}.input-group .btn:focus{z-index:5}.input-group-text{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);text-align:center;white-space:nowrap;background-color:var(--bs-tertiary-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius)}.input-group-lg>.btn,.input-group-lg>.form-control,.input-group-lg>.form-select,.input-group-lg>.input-group-text{padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.input-group-sm>.btn,.input-group-sm>.form-control,.input-group-sm>.form-select,.input-group-sm>.input-group-text{padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.input-group-lg>.form-select,.input-group-sm>.form-select{padding-right:3rem}.input-group:not(.has-validation)>.dropdown-toggle:nth-last-child(n+3),.input-group:not(.has-validation)>.form-floating:not(:last-child)>.form-control,.input-group:not(.has-validation)>.form-floating:not(:last-child)>.form-select,.input-group:not(.has-validation)>:not(:last-child):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group.has-validation>.dropdown-toggle:nth-last-child(n+4),.input-group.has-validation>.form-floating:nth-last-child(n+3)>.form-control,.input-group.has-validation>.form-floating:nth-last-child(n+3)>.form-select,.input-group.has-validation>:nth-last-child(n+3):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>:not(:first-child):not(.dropdown-menu):not(.valid-tooltip):not(.valid-feedback):not(.invalid-tooltip):not(.invalid-feedback){margin-left:calc(var(--bs-border-width) * -1);border-top-left-radius:0;border-bottom-left-radius:0}.input-group>.form-floating:not(:first-child)>.form-control,.input-group>.form-floating:not(:first-child)>.form-select{border-top-left-radius:0;border-bottom-left-radius:0}.valid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-valid-color)}.valid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-success);border-radius:var(--bs-border-radius)}.is-valid~.valid-feedback,.is-valid~.valid-tooltip,.was-validated :valid~.valid-feedback,.was-validated :valid~.valid-tooltip{display:block}.form-control.is-valid,.was-validated .form-control:valid{border-color:var(--bs-form-valid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-valid:focus,.was-validated .form-control:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.was-validated textarea.form-control:valid,textarea.form-control.is-valid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-valid,.was-validated .form-select:valid{border-color:var(--bs-form-valid-border-color)}.form-select.is-valid:not([multiple]):not([size]),.form-select.is-valid:not([multiple])[size=\"1\"],.was-validated .form-select:valid:not([multiple]):not([size]),.was-validated .form-select:valid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-valid:focus,.was-validated .form-select:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-control-color.is-valid,.was-validated .form-control-color:valid{width:calc(3rem + calc(1.5em + .75rem))}.form-check-input.is-valid,.was-validated .form-check-input:valid{border-color:var(--bs-form-valid-border-color)}.form-check-input.is-valid:checked,.was-validated .form-check-input:valid:checked{background-color:var(--bs-form-valid-color)}.form-check-input.is-valid:focus,.was-validated .form-check-input:valid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-check-input.is-valid~.form-check-label,.was-validated .form-check-input:valid~.form-check-label{color:var(--bs-form-valid-color)}.form-check-inline .form-check-input~.valid-feedback{margin-left:.5em}.input-group>.form-control:not(:focus).is-valid,.input-group>.form-floating:not(:focus-within).is-valid,.input-group>.form-select:not(:focus).is-valid,.was-validated .input-group>.form-control:not(:focus):valid,.was-validated .input-group>.form-floating:not(:focus-within):valid,.was-validated .input-group>.form-select:not(:focus):valid{z-index:3}.invalid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}.invalid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-danger);border-radius:var(--bs-border-radius)}.is-invalid~.invalid-feedback,.is-invalid~.invalid-tooltip,.was-validated :invalid~.invalid-feedback,.was-validated :invalid~.invalid-tooltip{display:block}.form-control.is-invalid,.was-validated .form-control:invalid{border-color:var(--bs-form-invalid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-invalid:focus,.was-validated .form-control:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.was-validated textarea.form-control:invalid,textarea.form-control.is-invalid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-invalid,.was-validated .form-select:invalid{border-color:var(--bs-form-invalid-border-color)}.form-select.is-invalid:not([multiple]):not([size]),.form-select.is-invalid:not([multiple])[size=\"1\"],.was-validated .form-select:invalid:not([multiple]):not([size]),.was-validated .form-select:invalid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-invalid:focus,.was-validated .form-select:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-control-color.is-invalid,.was-validated .form-control-color:invalid{width:calc(3rem + calc(1.5em + .75rem))}.form-check-input.is-invalid,.was-validated .form-check-input:invalid{border-color:var(--bs-form-invalid-border-color)}.form-check-input.is-invalid:checked,.was-validated .form-check-input:invalid:checked{background-color:var(--bs-form-invalid-color)}.form-check-input.is-invalid:focus,.was-validated .form-check-input:invalid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-check-input.is-invalid~.form-check-label,.was-validated .form-check-input:invalid~.form-check-label{color:var(--bs-form-invalid-color)}.form-check-inline .form-check-input~.invalid-feedback{margin-left:.5em}.input-group>.form-control:not(:focus).is-invalid,.input-group>.form-floating:not(:focus-within).is-invalid,.input-group>.form-select:not(:focus).is-invalid,.was-validated .input-group>.form-control:not(:focus):invalid,.was-validated .input-group>.form-floating:not(:focus-within):invalid,.was-validated .input-group>.form-select:not(:focus):invalid{z-index:4}.btn{--bs-btn-padding-x:0.75rem;--bs-btn-padding-y:0.375rem;--bs-btn-font-family: ;--bs-btn-font-size:1rem;--bs-btn-font-weight:400;--bs-btn-line-height:1.5;--bs-btn-color:var(--bs-body-color);--bs-btn-bg:transparent;--bs-btn-border-width:var(--bs-border-width);--bs-btn-border-color:transparent;--bs-btn-border-radius:var(--bs-border-radius);--bs-btn-hover-border-color:transparent;--bs-btn-box-shadow:inset 0 1px 0 rgba(255, 255, 255, 0.15),0 1px 1px rgba(0, 0, 0, 0.075);--bs-btn-disabled-opacity:0.65;--bs-btn-focus-box-shadow:0 0 0 0.25rem rgba(var(--bs-btn-focus-shadow-rgb), .5);display:inline-block;padding:var(--bs-btn-padding-y) var(--bs-btn-padding-x);font-family:var(--bs-btn-font-family);font-size:var(--bs-btn-font-size);font-weight:var(--bs-btn-font-weight);line-height:var(--bs-btn-line-height);color:var(--bs-btn-color);text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;border:var(--bs-btn-border-width) solid var(--bs-btn-border-color);border-radius:var(--bs-btn-border-radius);background-color:var(--bs-btn-bg);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color)}.btn-check+.btn:hover{color:var(--bs-btn-color);background-color:var(--bs-btn-bg);border-color:var(--bs-btn-border-color)}.btn:focus-visible{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check:focus-visible+.btn{border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check:checked+.btn,.btn.active,.btn.show,.btn:first-child:active,:not(.btn-check)+.btn:active{color:var(--bs-btn-active-color);background-color:var(--bs-btn-active-bg);border-color:var(--bs-btn-active-border-color)}.btn-check:checked+.btn:focus-visible,.btn.active:focus-visible,.btn.show:focus-visible,.btn:first-child:active:focus-visible,:not(.btn-check)+.btn:active:focus-visible{box-shadow:var(--bs-btn-focus-box-shadow)}.btn.disabled,.btn:disabled,fieldset:disabled .btn{color:var(--bs-btn-disabled-color);pointer-events:none;background-color:var(--bs-btn-disabled-bg);border-color:var(--bs-btn-disabled-border-color);opacity:var(--bs-btn-disabled-opacity)}.btn-primary{--bs-btn-color:#fff;--bs-btn-bg:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0b5ed7;--bs-btn-hover-border-color:#0a58ca;--bs-btn-focus-shadow-rgb:49,132,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0a58ca;--bs-btn-active-border-color:#0a53be;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#0d6efd;--bs-btn-disabled-border-color:#0d6efd}.btn-secondary{--bs-btn-color:#fff;--bs-btn-bg:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#5c636a;--bs-btn-hover-border-color:#565e64;--bs-btn-focus-shadow-rgb:130,138,145;--bs-btn-active-color:#fff;--bs-btn-active-bg:#565e64;--bs-btn-active-border-color:#51585e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#6c757d;--bs-btn-disabled-border-color:#6c757d}.btn-success{--bs-btn-color:#fff;--bs-btn-bg:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#157347;--bs-btn-hover-border-color:#146c43;--bs-btn-focus-shadow-rgb:60,153,110;--bs-btn-active-color:#fff;--bs-btn-active-bg:#146c43;--bs-btn-active-border-color:#13653f;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#198754;--bs-btn-disabled-border-color:#198754}.btn-info{--bs-btn-color:#000;--bs-btn-bg:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#31d2f2;--bs-btn-hover-border-color:#25cff2;--bs-btn-focus-shadow-rgb:11,172,204;--bs-btn-active-color:#000;--bs-btn-active-bg:#3dd5f3;--bs-btn-active-border-color:#25cff2;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#0dcaf0;--bs-btn-disabled-border-color:#0dcaf0}.btn-warning{--bs-btn-color:#000;--bs-btn-bg:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffca2c;--bs-btn-hover-border-color:#ffc720;--bs-btn-focus-shadow-rgb:217,164,6;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffcd39;--bs-btn-active-border-color:#ffc720;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#ffc107;--bs-btn-disabled-border-color:#ffc107}.btn-danger{--bs-btn-color:#fff;--bs-btn-bg:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#bb2d3b;--bs-btn-hover-border-color:#b02a37;--bs-btn-focus-shadow-rgb:225,83,97;--bs-btn-active-color:#fff;--bs-btn-active-bg:#b02a37;--bs-btn-active-border-color:#a52834;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#dc3545;--bs-btn-disabled-border-color:#dc3545}.btn-light{--bs-btn-color:#000;--bs-btn-bg:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#d3d4d5;--bs-btn-hover-border-color:#c6c7c8;--bs-btn-focus-shadow-rgb:211,212,213;--bs-btn-active-color:#000;--bs-btn-active-bg:#c6c7c8;--bs-btn-active-border-color:#babbbc;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#f8f9fa;--bs-btn-disabled-border-color:#f8f9fa}.btn-dark{--bs-btn-color:#fff;--bs-btn-bg:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#424649;--bs-btn-hover-border-color:#373b3e;--bs-btn-focus-shadow-rgb:66,70,73;--bs-btn-active-color:#fff;--bs-btn-active-bg:#4d5154;--bs-btn-active-border-color:#373b3e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#212529;--bs-btn-disabled-border-color:#212529}.btn-outline-primary{--bs-btn-color:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0d6efd;--bs-btn-hover-border-color:#0d6efd;--bs-btn-focus-shadow-rgb:13,110,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0d6efd;--bs-btn-active-border-color:#0d6efd;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#0d6efd;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0d6efd;--bs-gradient:none}.btn-outline-secondary{--bs-btn-color:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#6c757d;--bs-btn-hover-border-color:#6c757d;--bs-btn-focus-shadow-rgb:108,117,125;--bs-btn-active-color:#fff;--bs-btn-active-bg:#6c757d;--bs-btn-active-border-color:#6c757d;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#6c757d;--bs-gradient:none}.btn-outline-success{--bs-btn-color:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#198754;--bs-btn-hover-border-color:#198754;--bs-btn-focus-shadow-rgb:25,135,84;--bs-btn-active-color:#fff;--bs-btn-active-bg:#198754;--bs-btn-active-border-color:#198754;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#198754;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#198754;--bs-gradient:none}.btn-outline-info{--bs-btn-color:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#0dcaf0;--bs-btn-hover-border-color:#0dcaf0;--bs-btn-focus-shadow-rgb:13,202,240;--bs-btn-active-color:#000;--bs-btn-active-bg:#0dcaf0;--bs-btn-active-border-color:#0dcaf0;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#0dcaf0;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0dcaf0;--bs-gradient:none}.btn-outline-warning{--bs-btn-color:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffc107;--bs-btn-hover-border-color:#ffc107;--bs-btn-focus-shadow-rgb:255,193,7;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffc107;--bs-btn-active-border-color:#ffc107;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#ffc107;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#ffc107;--bs-gradient:none}.btn-outline-danger{--bs-btn-color:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#dc3545;--bs-btn-hover-border-color:#dc3545;--bs-btn-focus-shadow-rgb:220,53,69;--bs-btn-active-color:#fff;--bs-btn-active-bg:#dc3545;--bs-btn-active-border-color:#dc3545;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#dc3545;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#dc3545;--bs-gradient:none}.btn-outline-light{--bs-btn-color:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#f8f9fa;--bs-btn-hover-border-color:#f8f9fa;--bs-btn-focus-shadow-rgb:248,249,250;--bs-btn-active-color:#000;--bs-btn-active-bg:#f8f9fa;--bs-btn-active-border-color:#f8f9fa;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#f8f9fa;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#f8f9fa;--bs-gradient:none}.btn-outline-dark{--bs-btn-color:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#212529;--bs-btn-hover-border-color:#212529;--bs-btn-focus-shadow-rgb:33,37,41;--bs-btn-active-color:#fff;--bs-btn-active-bg:#212529;--bs-btn-active-border-color:#212529;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#212529;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#212529;--bs-gradient:none}.btn-link{--bs-btn-font-weight:400;--bs-btn-color:var(--bs-link-color);--bs-btn-bg:transparent;--bs-btn-border-color:transparent;--bs-btn-hover-color:var(--bs-link-hover-color);--bs-btn-hover-border-color:transparent;--bs-btn-active-color:var(--bs-link-hover-color);--bs-btn-active-border-color:transparent;--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-border-color:transparent;--bs-btn-box-shadow:0 0 0 #000;--bs-btn-focus-shadow-rgb:49,132,253;text-decoration:underline}.btn-link:focus-visible{color:var(--bs-btn-color)}.btn-link:hover{color:var(--bs-btn-hover-color)}.btn-group-lg>.btn,.btn-lg{--bs-btn-padding-y:0.5rem;--bs-btn-padding-x:1rem;--bs-btn-font-size:1.25rem;--bs-btn-border-radius:var(--bs-border-radius-lg)}.btn-group-sm>.btn,.btn-sm{--bs-btn-padding-y:0.25rem;--bs-btn-padding-x:0.5rem;--bs-btn-font-size:0.875rem;--bs-btn-border-radius:var(--bs-border-radius-sm)}.fade{transition:opacity .15s linear}@media (prefers-reduced-motion:reduce){.fade{transition:none}}.fade:not(.show){opacity:0}.collapse:not(.show){display:none}.collapsing{height:0;overflow:hidden;transition:height .35s ease}@media (prefers-reduced-motion:reduce){.collapsing{transition:none}}.collapsing.collapse-horizontal{width:0;height:auto;transition:width .35s ease}@media (prefers-reduced-motion:reduce){.collapsing.collapse-horizontal{transition:none}}.dropdown,.dropdown-center,.dropend,.dropstart,.dropup,.dropup-center{position:relative}.dropdown-toggle{white-space:nowrap}.dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle:empty::after{margin-left:0}.dropdown-menu{--bs-dropdown-zindex:1000;--bs-dropdown-min-width:10rem;--bs-dropdown-padding-x:0;--bs-dropdown-padding-y:0.5rem;--bs-dropdown-spacer:0.125rem;--bs-dropdown-font-size:1rem;--bs-dropdown-color:var(--bs-body-color);--bs-dropdown-bg:var(--bs-body-bg);--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-border-radius:var(--bs-border-radius);--bs-dropdown-border-width:var(--bs-border-width);--bs-dropdown-inner-border-radius:calc(var(--bs-border-radius) - var(--bs-border-width));--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-divider-margin-y:0.5rem;--bs-dropdown-box-shadow:var(--bs-box-shadow);--bs-dropdown-link-color:var(--bs-body-color);--bs-dropdown-link-hover-color:var(--bs-body-color);--bs-dropdown-link-hover-bg:var(--bs-tertiary-bg);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:var(--bs-tertiary-color);--bs-dropdown-item-padding-x:1rem;--bs-dropdown-item-padding-y:0.25rem;--bs-dropdown-header-color:#6c757d;--bs-dropdown-header-padding-x:1rem;--bs-dropdown-header-padding-y:0.5rem;position:absolute;z-index:var(--bs-dropdown-zindex);display:none;min-width:var(--bs-dropdown-min-width);padding:var(--bs-dropdown-padding-y) var(--bs-dropdown-padding-x);margin:0;font-size:var(--bs-dropdown-font-size);color:var(--bs-dropdown-color);text-align:left;list-style:none;background-color:var(--bs-dropdown-bg);background-clip:padding-box;border:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color);border-radius:var(--bs-dropdown-border-radius)}.dropdown-menu[data-bs-popper]{top:100%;left:0;margin-top:var(--bs-dropdown-spacer)}.dropdown-menu-start{--bs-position:start}.dropdown-menu-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-end{--bs-position:end}.dropdown-menu-end[data-bs-popper]{right:0;left:auto}@media (min-width:576px){.dropdown-menu-sm-start{--bs-position:start}.dropdown-menu-sm-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-sm-end{--bs-position:end}.dropdown-menu-sm-end[data-bs-popper]{right:0;left:auto}}@media (min-width:768px){.dropdown-menu-md-start{--bs-position:start}.dropdown-menu-md-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-md-end{--bs-position:end}.dropdown-menu-md-end[data-bs-popper]{right:0;left:auto}}@media (min-width:992px){.dropdown-menu-lg-start{--bs-position:start}.dropdown-menu-lg-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-lg-end{--bs-position:end}.dropdown-menu-lg-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1200px){.dropdown-menu-xl-start{--bs-position:start}.dropdown-menu-xl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xl-end{--bs-position:end}.dropdown-menu-xl-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1400px){.dropdown-menu-xxl-start{--bs-position:start}.dropdown-menu-xxl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xxl-end{--bs-position:end}.dropdown-menu-xxl-end[data-bs-popper]{right:0;left:auto}}.dropup .dropdown-menu[data-bs-popper]{top:auto;bottom:100%;margin-top:0;margin-bottom:var(--bs-dropdown-spacer)}.dropup .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-menu[data-bs-popper]{top:0;right:auto;left:100%;margin-top:0;margin-left:var(--bs-dropdown-spacer)}.dropend .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropend .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-toggle::after{vertical-align:0}.dropstart .dropdown-menu[data-bs-popper]{top:0;right:100%;left:auto;margin-top:0;margin-right:var(--bs-dropdown-spacer)}.dropstart .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\"}.dropstart .dropdown-toggle::after{display:none}.dropstart .dropdown-toggle::before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropstart .dropdown-toggle:empty::after{margin-left:0}.dropstart .dropdown-toggle::before{vertical-align:0}.dropdown-divider{height:0;margin:var(--bs-dropdown-divider-margin-y) 0;overflow:hidden;border-top:1px solid var(--bs-dropdown-divider-bg);opacity:1}.dropdown-item{display:block;width:100%;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);clear:both;font-weight:400;color:var(--bs-dropdown-link-color);text-align:inherit;text-decoration:none;white-space:nowrap;background-color:transparent;border:0;border-radius:var(--bs-dropdown-item-border-radius,0)}.dropdown-item:focus,.dropdown-item:hover{color:var(--bs-dropdown-link-hover-color);background-color:var(--bs-dropdown-link-hover-bg)}.dropdown-item.active,.dropdown-item:active{color:var(--bs-dropdown-link-active-color);text-decoration:none;background-color:var(--bs-dropdown-link-active-bg)}.dropdown-item.disabled,.dropdown-item:disabled{color:var(--bs-dropdown-link-disabled-color);pointer-events:none;background-color:transparent}.dropdown-menu.show{display:block}.dropdown-header{display:block;padding:var(--bs-dropdown-header-padding-y) var(--bs-dropdown-header-padding-x);margin-bottom:0;font-size:.875rem;color:var(--bs-dropdown-header-color);white-space:nowrap}.dropdown-item-text{display:block;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);color:var(--bs-dropdown-link-color)}.dropdown-menu-dark{--bs-dropdown-color:#dee2e6;--bs-dropdown-bg:#343a40;--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-box-shadow: ;--bs-dropdown-link-color:#dee2e6;--bs-dropdown-link-hover-color:#fff;--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-link-hover-bg:rgba(255, 255, 255, 0.15);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:#adb5bd;--bs-dropdown-header-color:#adb5bd}.btn-group,.btn-group-vertical{position:relative;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group-vertical>.btn-check:checked+.btn,.btn-group-vertical>.btn-check:focus+.btn,.btn-group-vertical>.btn.active,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:hover,.btn-group>.btn-check:checked+.btn,.btn-group>.btn-check:focus+.btn,.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-toolbar{display:flex;flex-wrap:wrap;justify-content:flex-start}.btn-toolbar .input-group{width:auto}.btn-group{border-radius:var(--bs-border-radius)}.btn-group>.btn-group:not(:first-child),.btn-group>:not(.btn-check:first-child)+.btn{margin-left:calc(var(--bs-border-width) * -1)}.btn-group>.btn-group:not(:last-child)>.btn,.btn-group>.btn.dropdown-toggle-split:first-child,.btn-group>.btn:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:nth-child(n+3),.btn-group>:not(.btn-check)+.btn{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split::after,.dropend .dropdown-toggle-split::after,.dropup .dropdown-toggle-split::after{margin-left:0}.dropstart .dropdown-toggle-split::before{margin-right:0}.btn-group-sm>.btn+.dropdown-toggle-split,.btn-sm+.dropdown-toggle-split{padding-right:.375rem;padding-left:.375rem}.btn-group-lg>.btn+.dropdown-toggle-split,.btn-lg+.dropdown-toggle-split{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical{flex-direction:column;align-items:flex-start;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:calc(var(--bs-border-width) * -1)}.btn-group-vertical>.btn-group:not(:last-child)>.btn,.btn-group-vertical>.btn:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn~.btn{border-top-left-radius:0;border-top-right-radius:0}.nav{--bs-nav-link-padding-x:1rem;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-link-color);--bs-nav-link-hover-color:var(--bs-link-hover-color);--bs-nav-link-disabled-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:var(--bs-nav-link-padding-y) var(--bs-nav-link-padding-x);font-size:var(--bs-nav-link-font-size);font-weight:var(--bs-nav-link-font-weight);color:var(--bs-nav-link-color);text-decoration:none;background:0 0;border:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}@media (prefers-reduced-motion:reduce){.nav-link{transition:none}}.nav-link:focus,.nav-link:hover{color:var(--bs-nav-link-hover-color)}.nav-link:focus-visible{outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.nav-link.disabled,.nav-link:disabled{color:var(--bs-nav-link-disabled-color);pointer-events:none;cursor:default}.nav-tabs{--bs-nav-tabs-border-width:var(--bs-border-width);--bs-nav-tabs-border-color:var(--bs-border-color);--bs-nav-tabs-border-radius:var(--bs-border-radius);--bs-nav-tabs-link-hover-border-color:var(--bs-secondary-bg) var(--bs-secondary-bg) var(--bs-border-color);--bs-nav-tabs-link-active-color:var(--bs-emphasis-color);--bs-nav-tabs-link-active-bg:var(--bs-body-bg);--bs-nav-tabs-link-active-border-color:var(--bs-border-color) var(--bs-border-color) var(--bs-body-bg);border-bottom:var(--bs-nav-tabs-border-width) solid var(--bs-nav-tabs-border-color)}.nav-tabs .nav-link{margin-bottom:calc(-1 * var(--bs-nav-tabs-border-width));border:var(--bs-nav-tabs-border-width) solid transparent;border-top-left-radius:var(--bs-nav-tabs-border-radius);border-top-right-radius:var(--bs-nav-tabs-border-radius)}.nav-tabs .nav-link:focus,.nav-tabs .nav-link:hover{isolation:isolate;border-color:var(--bs-nav-tabs-link-hover-border-color)}.nav-tabs .nav-item.show .nav-link,.nav-tabs .nav-link.active{color:var(--bs-nav-tabs-link-active-color);background-color:var(--bs-nav-tabs-link-active-bg);border-color:var(--bs-nav-tabs-link-active-border-color)}.nav-tabs .dropdown-menu{margin-top:calc(-1 * var(--bs-nav-tabs-border-width));border-top-left-radius:0;border-top-right-radius:0}.nav-pills{--bs-nav-pills-border-radius:var(--bs-border-radius);--bs-nav-pills-link-active-color:#fff;--bs-nav-pills-link-active-bg:#0d6efd}.nav-pills .nav-link{border-radius:var(--bs-nav-pills-border-radius)}.nav-pills .nav-link.active,.nav-pills .show>.nav-link{color:var(--bs-nav-pills-link-active-color);background-color:var(--bs-nav-pills-link-active-bg)}.nav-underline{--bs-nav-underline-gap:1rem;--bs-nav-underline-border-width:0.125rem;--bs-nav-underline-link-active-color:var(--bs-emphasis-color);gap:var(--bs-nav-underline-gap)}.nav-underline .nav-link{padding-right:0;padding-left:0;border-bottom:var(--bs-nav-underline-border-width) solid transparent}.nav-underline .nav-link:focus,.nav-underline .nav-link:hover{border-bottom-color:currentcolor}.nav-underline .nav-link.active,.nav-underline .show>.nav-link{font-weight:700;color:var(--bs-nav-underline-link-active-color);border-bottom-color:currentcolor}.nav-fill .nav-item,.nav-fill>.nav-link{flex:1 1 auto;text-align:center}.nav-justified .nav-item,.nav-justified>.nav-link{flex-basis:0;flex-grow:1;text-align:center}.nav-fill .nav-item .nav-link,.nav-justified .nav-item .nav-link{width:100%}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.navbar{--bs-navbar-padding-x:0;--bs-navbar-padding-y:0.5rem;--bs-navbar-color:rgba(var(--bs-emphasis-color-rgb), 0.65);--bs-navbar-hover-color:rgba(var(--bs-emphasis-color-rgb), 0.8);--bs-navbar-disabled-color:rgba(var(--bs-emphasis-color-rgb), 0.3);--bs-navbar-active-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-padding-y:0.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-hover-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-nav-link-padding-x:0.5rem;--bs-navbar-toggler-padding-y:0.25rem;--bs-navbar-toggler-padding-x:0.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\");--bs-navbar-toggler-border-color:rgba(var(--bs-emphasis-color-rgb), 0.15);--bs-navbar-toggler-border-radius:var(--bs-border-radius);--bs-navbar-toggler-focus-width:0.25rem;--bs-navbar-toggler-transition:box-shadow 0.15s ease-in-out;position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x)}.navbar>.container,.navbar>.container-fluid,.navbar>.container-lg,.navbar>.container-md,.navbar>.container-sm,.navbar>.container-xl,.navbar>.container-xxl{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand{padding-top:var(--bs-navbar-brand-padding-y);padding-bottom:var(--bs-navbar-brand-padding-y);margin-right:var(--bs-navbar-brand-margin-end);font-size:var(--bs-navbar-brand-font-size);color:var(--bs-navbar-brand-color);text-decoration:none;white-space:nowrap}.navbar-brand:focus,.navbar-brand:hover{color:var(--bs-navbar-brand-hover-color)}.navbar-nav{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav .nav-link.active,.navbar-nav .nav-link.show{color:var(--bs-navbar-active-color)}.navbar-nav .dropdown-menu{position:static}.navbar-text{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-navbar-color)}.navbar-text a,.navbar-text a:focus,.navbar-text a:hover{color:var(--bs-navbar-active-color)}.navbar-collapse{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler{padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);font-size:var(--bs-navbar-toggler-font-size);line-height:1;color:var(--bs-navbar-color);background-color:transparent;border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius);transition:var(--bs-navbar-toggler-transition)}@media (prefers-reduced-motion:reduce){.navbar-toggler{transition:none}}.navbar-toggler:hover{text-decoration:none}.navbar-toggler:focus{text-decoration:none;outline:0;box-shadow:0 0 0 var(--bs-navbar-toggler-focus-width)}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-image:var(--bs-navbar-toggler-icon-bg);background-repeat:no-repeat;background-position:center;background-size:100%}.navbar-nav-scroll{max-height:var(--bs-scroll-height,75vh);overflow-y:auto}@media (min-width:576px){.navbar-expand-sm{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-sm .navbar-nav{flex-direction:row}.navbar-expand-sm .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-sm .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-sm .navbar-nav-scroll{overflow:visible}.navbar-expand-sm .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-sm .navbar-toggler{display:none}.navbar-expand-sm .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-sm .offcanvas .offcanvas-header{display:none}.navbar-expand-sm .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:768px){.navbar-expand-md{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md .navbar-nav{flex-direction:row}.navbar-expand-md .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-md .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-md .navbar-nav-scroll{overflow:visible}.navbar-expand-md .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-md .navbar-toggler{display:none}.navbar-expand-md .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-md .offcanvas .offcanvas-header{display:none}.navbar-expand-md .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:992px){.navbar-expand-lg{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg .navbar-nav{flex-direction:row}.navbar-expand-lg .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-lg .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-lg .navbar-nav-scroll{overflow:visible}.navbar-expand-lg .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-lg .navbar-toggler{display:none}.navbar-expand-lg .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-lg .offcanvas .offcanvas-header{display:none}.navbar-expand-lg .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1200px){.navbar-expand-xl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xl .navbar-nav{flex-direction:row}.navbar-expand-xl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xl .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xl .navbar-nav-scroll{overflow:visible}.navbar-expand-xl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xl .navbar-toggler{display:none}.navbar-expand-xl .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xl .offcanvas .offcanvas-header{display:none}.navbar-expand-xl .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1400px){.navbar-expand-xxl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xxl .navbar-nav{flex-direction:row}.navbar-expand-xxl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xxl .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xxl .navbar-nav-scroll{overflow:visible}.navbar-expand-xxl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xxl .navbar-toggler{display:none}.navbar-expand-xxl .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xxl .offcanvas .offcanvas-header{display:none}.navbar-expand-xxl .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}.navbar-expand{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand .navbar-nav{flex-direction:row}.navbar-expand .navbar-nav .dropdown-menu{position:absolute}.navbar-expand .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand .navbar-nav-scroll{overflow:visible}.navbar-expand .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand .navbar-toggler{display:none}.navbar-expand .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand .offcanvas .offcanvas-header{display:none}.navbar-expand .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}.navbar-dark,.navbar[data-bs-theme=dark]{--bs-navbar-color:rgba(255, 255, 255, 0.55);--bs-navbar-hover-color:rgba(255, 255, 255, 0.75);--bs-navbar-disabled-color:rgba(255, 255, 255, 0.25);--bs-navbar-active-color:#fff;--bs-navbar-brand-color:#fff;--bs-navbar-brand-hover-color:#fff;--bs-navbar-toggler-border-color:rgba(255, 255, 255, 0.1);--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}[data-bs-theme=dark] .navbar-toggler-icon{--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}.card{--bs-card-spacer-y:1rem;--bs-card-spacer-x:1rem;--bs-card-title-spacer-y:0.5rem;--bs-card-title-color: ;--bs-card-subtitle-color: ;--bs-card-border-width:var(--bs-border-width);--bs-card-border-color:var(--bs-border-color-translucent);--bs-card-border-radius:var(--bs-border-radius);--bs-card-box-shadow: ;--bs-card-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-card-cap-padding-y:0.5rem;--bs-card-cap-padding-x:1rem;--bs-card-cap-bg:rgba(var(--bs-body-color-rgb), 0.03);--bs-card-cap-color: ;--bs-card-height: ;--bs-card-color: ;--bs-card-bg:var(--bs-body-bg);--bs-card-img-overlay-padding:1rem;--bs-card-group-margin:0.75rem;position:relative;display:flex;flex-direction:column;min-width:0;height:var(--bs-card-height);color:var(--bs-body-color);word-wrap:break-word;background-color:var(--bs-card-bg);background-clip:border-box;border:var(--bs-card-border-width) solid var(--bs-card-border-color);border-radius:var(--bs-card-border-radius)}.card>hr{margin-right:0;margin-left:0}.card>.list-group{border-top:inherit;border-bottom:inherit}.card>.list-group:first-child{border-top-width:0;border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card>.list-group:last-child{border-bottom-width:0;border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card>.card-header+.list-group,.card>.list-group+.card-footer{border-top:0}.card-body{flex:1 1 auto;padding:var(--bs-card-spacer-y) var(--bs-card-spacer-x);color:var(--bs-card-color)}.card-title{margin-bottom:var(--bs-card-title-spacer-y);color:var(--bs-card-title-color)}.card-subtitle{margin-top:calc(-.5 * var(--bs-card-title-spacer-y));margin-bottom:0;color:var(--bs-card-subtitle-color)}.card-text:last-child{margin-bottom:0}.card-link+.card-link{margin-left:var(--bs-card-spacer-x)}.card-header{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);margin-bottom:0;color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-header:first-child{border-radius:var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius) 0 0}.card-footer{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-top:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-footer:last-child{border-radius:0 0 var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius)}.card-header-tabs{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-bottom:calc(-1 * var(--bs-card-cap-padding-y));margin-left:calc(-.5 * var(--bs-card-cap-padding-x));border-bottom:0}.card-header-tabs .nav-link.active{background-color:var(--bs-card-bg);border-bottom-color:var(--bs-card-bg)}.card-header-pills{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-left:calc(-.5 * var(--bs-card-cap-padding-x))}.card-img-overlay{position:absolute;top:0;right:0;bottom:0;left:0;padding:var(--bs-card-img-overlay-padding);border-radius:var(--bs-card-inner-border-radius)}.card-img,.card-img-bottom,.card-img-top{width:100%}.card-img,.card-img-top{border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card-img,.card-img-bottom{border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card-group>.card{margin-bottom:var(--bs-card-group-margin)}@media (min-width:576px){.card-group{display:flex;flex-flow:row wrap}.card-group>.card{flex:1 0 0%;margin-bottom:0}.card-group>.card+.card{margin-left:0;border-left:0}.card-group>.card:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group>.card:not(:last-child) .card-header,.card-group>.card:not(:last-child) .card-img-top{border-top-right-radius:0}.card-group>.card:not(:last-child) .card-footer,.card-group>.card:not(:last-child) .card-img-bottom{border-bottom-right-radius:0}.card-group>.card:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group>.card:not(:first-child) .card-header,.card-group>.card:not(:first-child) .card-img-top{border-top-left-radius:0}.card-group>.card:not(:first-child) .card-footer,.card-group>.card:not(:first-child) .card-img-bottom{border-bottom-left-radius:0}}.accordion{--bs-accordion-color:var(--bs-body-color);--bs-accordion-bg:var(--bs-body-bg);--bs-accordion-transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out,border-radius 0.15s ease;--bs-accordion-border-color:var(--bs-border-color);--bs-accordion-border-width:var(--bs-border-width);--bs-accordion-border-radius:var(--bs-border-radius);--bs-accordion-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-accordion-btn-padding-x:1.25rem;--bs-accordion-btn-padding-y:1rem;--bs-accordion-btn-color:var(--bs-body-color);--bs-accordion-btn-bg:var(--bs-accordion-bg);--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23212529'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\");--bs-accordion-btn-icon-width:1.25rem;--bs-accordion-btn-icon-transform:rotate(-180deg);--bs-accordion-btn-icon-transition:transform 0.2s ease-in-out;--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23052c65'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\");--bs-accordion-btn-focus-border-color:#86b7fe;--bs-accordion-btn-focus-box-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-accordion-body-padding-x:1.25rem;--bs-accordion-body-padding-y:1rem;--bs-accordion-active-color:var(--bs-primary-text-emphasis);--bs-accordion-active-bg:var(--bs-primary-bg-subtle)}.accordion-button{position:relative;display:flex;align-items:center;width:100%;padding:var(--bs-accordion-btn-padding-y) var(--bs-accordion-btn-padding-x);font-size:1rem;color:var(--bs-accordion-btn-color);text-align:left;background-color:var(--bs-accordion-btn-bg);border:0;border-radius:0;overflow-anchor:none;transition:var(--bs-accordion-transition)}@media (prefers-reduced-motion:reduce){.accordion-button{transition:none}}.accordion-button:not(.collapsed){color:var(--bs-accordion-active-color);background-color:var(--bs-accordion-active-bg);box-shadow:inset 0 calc(-1 * var(--bs-accordion-border-width)) 0 var(--bs-accordion-border-color)}.accordion-button:not(.collapsed)::after{background-image:var(--bs-accordion-btn-active-icon);transform:var(--bs-accordion-btn-icon-transform)}.accordion-button::after{flex-shrink:0;width:var(--bs-accordion-btn-icon-width);height:var(--bs-accordion-btn-icon-width);margin-left:auto;content:\"\";background-image:var(--bs-accordion-btn-icon);background-repeat:no-repeat;background-size:var(--bs-accordion-btn-icon-width);transition:var(--bs-accordion-btn-icon-transition)}@media (prefers-reduced-motion:reduce){.accordion-button::after{transition:none}}.accordion-button:hover{z-index:2}.accordion-button:focus{z-index:3;border-color:var(--bs-accordion-btn-focus-border-color);outline:0;box-shadow:var(--bs-accordion-btn-focus-box-shadow)}.accordion-header{margin-bottom:0}.accordion-item{color:var(--bs-accordion-color);background-color:var(--bs-accordion-bg);border:var(--bs-accordion-border-width) solid var(--bs-accordion-border-color)}.accordion-item:first-of-type{border-top-left-radius:var(--bs-accordion-border-radius);border-top-right-radius:var(--bs-accordion-border-radius)}.accordion-item:first-of-type .accordion-button{border-top-left-radius:var(--bs-accordion-inner-border-radius);border-top-right-radius:var(--bs-accordion-inner-border-radius)}.accordion-item:not(:first-of-type){border-top:0}.accordion-item:last-of-type{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-item:last-of-type .accordion-button.collapsed{border-bottom-right-radius:var(--bs-accordion-inner-border-radius);border-bottom-left-radius:var(--bs-accordion-inner-border-radius)}.accordion-item:last-of-type .accordion-collapse{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-body{padding:var(--bs-accordion-body-padding-y) var(--bs-accordion-body-padding-x)}.accordion-flush .accordion-collapse{border-width:0}.accordion-flush .accordion-item{border-right:0;border-left:0;border-radius:0}.accordion-flush .accordion-item:first-child{border-top:0}.accordion-flush .accordion-item:last-child{border-bottom:0}.accordion-flush .accordion-item .accordion-button,.accordion-flush .accordion-item .accordion-button.collapsed{border-radius:0}[data-bs-theme=dark] .accordion-button::after{--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\");--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.breadcrumb{--bs-breadcrumb-padding-x:0;--bs-breadcrumb-padding-y:0;--bs-breadcrumb-margin-bottom:1rem;--bs-breadcrumb-bg: ;--bs-breadcrumb-border-radius: ;--bs-breadcrumb-divider-color:var(--bs-secondary-color);--bs-breadcrumb-item-padding-x:0.5rem;--bs-breadcrumb-item-active-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding:var(--bs-breadcrumb-padding-y) var(--bs-breadcrumb-padding-x);margin-bottom:var(--bs-breadcrumb-margin-bottom);font-size:var(--bs-breadcrumb-font-size);list-style:none;background-color:var(--bs-breadcrumb-bg);border-radius:var(--bs-breadcrumb-border-radius)}.breadcrumb-item+.breadcrumb-item{padding-left:var(--bs-breadcrumb-item-padding-x)}.breadcrumb-item+.breadcrumb-item::before{float:left;padding-right:var(--bs-breadcrumb-item-padding-x);color:var(--bs-breadcrumb-divider-color);content:var(--bs-breadcrumb-divider, \"/\")}.breadcrumb-item.active{color:var(--bs-breadcrumb-item-active-color)}.pagination{--bs-pagination-padding-x:0.75rem;--bs-pagination-padding-y:0.375rem;--bs-pagination-font-size:1rem;--bs-pagination-color:var(--bs-link-color);--bs-pagination-bg:var(--bs-body-bg);--bs-pagination-border-width:var(--bs-border-width);--bs-pagination-border-color:var(--bs-border-color);--bs-pagination-border-radius:var(--bs-border-radius);--bs-pagination-hover-color:var(--bs-link-hover-color);--bs-pagination-hover-bg:var(--bs-tertiary-bg);--bs-pagination-hover-border-color:var(--bs-border-color);--bs-pagination-focus-color:var(--bs-link-hover-color);--bs-pagination-focus-bg:var(--bs-secondary-bg);--bs-pagination-focus-box-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-pagination-active-color:#fff;--bs-pagination-active-bg:#0d6efd;--bs-pagination-active-border-color:#0d6efd;--bs-pagination-disabled-color:var(--bs-secondary-color);--bs-pagination-disabled-bg:var(--bs-secondary-bg);--bs-pagination-disabled-border-color:var(--bs-border-color);display:flex;padding-left:0;list-style:none}.page-link{position:relative;display:block;padding:var(--bs-pagination-padding-y) var(--bs-pagination-padding-x);font-size:var(--bs-pagination-font-size);color:var(--bs-pagination-color);text-decoration:none;background-color:var(--bs-pagination-bg);border:var(--bs-pagination-border-width) solid var(--bs-pagination-border-color);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.page-link{transition:none}}.page-link:hover{z-index:2;color:var(--bs-pagination-hover-color);background-color:var(--bs-pagination-hover-bg);border-color:var(--bs-pagination-hover-border-color)}.page-link:focus{z-index:3;color:var(--bs-pagination-focus-color);background-color:var(--bs-pagination-focus-bg);outline:0;box-shadow:var(--bs-pagination-focus-box-shadow)}.active>.page-link,.page-link.active{z-index:3;color:var(--bs-pagination-active-color);background-color:var(--bs-pagination-active-bg);border-color:var(--bs-pagination-active-border-color)}.disabled>.page-link,.page-link.disabled{color:var(--bs-pagination-disabled-color);pointer-events:none;background-color:var(--bs-pagination-disabled-bg);border-color:var(--bs-pagination-disabled-border-color)}.page-item:not(:first-child) .page-link{margin-left:calc(var(--bs-border-width) * -1)}.page-item:first-child .page-link{border-top-left-radius:var(--bs-pagination-border-radius);border-bottom-left-radius:var(--bs-pagination-border-radius)}.page-item:last-child .page-link{border-top-right-radius:var(--bs-pagination-border-radius);border-bottom-right-radius:var(--bs-pagination-border-radius)}.pagination-lg{--bs-pagination-padding-x:1.5rem;--bs-pagination-padding-y:0.75rem;--bs-pagination-font-size:1.25rem;--bs-pagination-border-radius:var(--bs-border-radius-lg)}.pagination-sm{--bs-pagination-padding-x:0.5rem;--bs-pagination-padding-y:0.25rem;--bs-pagination-font-size:0.875rem;--bs-pagination-border-radius:var(--bs-border-radius-sm)}.badge{--bs-badge-padding-x:0.65em;--bs-badge-padding-y:0.35em;--bs-badge-font-size:0.75em;--bs-badge-font-weight:700;--bs-badge-color:#fff;--bs-badge-border-radius:var(--bs-border-radius);display:inline-block;padding:var(--bs-badge-padding-y) var(--bs-badge-padding-x);font-size:var(--bs-badge-font-size);font-weight:var(--bs-badge-font-weight);line-height:1;color:var(--bs-badge-color);text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:var(--bs-badge-border-radius)}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.alert{--bs-alert-bg:transparent;--bs-alert-padding-x:1rem;--bs-alert-padding-y:1rem;--bs-alert-margin-bottom:1rem;--bs-alert-color:inherit;--bs-alert-border-color:transparent;--bs-alert-border:var(--bs-border-width) solid var(--bs-alert-border-color);--bs-alert-border-radius:var(--bs-border-radius);--bs-alert-link-color:inherit;position:relative;padding:var(--bs-alert-padding-y) var(--bs-alert-padding-x);margin-bottom:var(--bs-alert-margin-bottom);color:var(--bs-alert-color);background-color:var(--bs-alert-bg);border:var(--bs-alert-border);border-radius:var(--bs-alert-border-radius)}.alert-heading{color:inherit}.alert-link{font-weight:700;color:var(--bs-alert-link-color)}.alert-dismissible{padding-right:3rem}.alert-dismissible .btn-close{position:absolute;top:0;right:0;z-index:2;padding:1.25rem 1rem}.alert-primary{--bs-alert-color:var(--bs-primary-text-emphasis);--bs-alert-bg:var(--bs-primary-bg-subtle);--bs-alert-border-color:var(--bs-primary-border-subtle);--bs-alert-link-color:var(--bs-primary-text-emphasis)}.alert-secondary{--bs-alert-color:var(--bs-secondary-text-emphasis);--bs-alert-bg:var(--bs-secondary-bg-subtle);--bs-alert-border-color:var(--bs-secondary-border-subtle);--bs-alert-link-color:var(--bs-secondary-text-emphasis)}.alert-success{--bs-alert-color:var(--bs-success-text-emphasis);--bs-alert-bg:var(--bs-success-bg-subtle);--bs-alert-border-color:var(--bs-success-border-subtle);--bs-alert-link-color:var(--bs-success-text-emphasis)}.alert-info{--bs-alert-color:var(--bs-info-text-emphasis);--bs-alert-bg:var(--bs-info-bg-subtle);--bs-alert-border-color:var(--bs-info-border-subtle);--bs-alert-link-color:var(--bs-info-text-emphasis)}.alert-warning{--bs-alert-color:var(--bs-warning-text-emphasis);--bs-alert-bg:var(--bs-warning-bg-subtle);--bs-alert-border-color:var(--bs-warning-border-subtle);--bs-alert-link-color:var(--bs-warning-text-emphasis)}.alert-danger{--bs-alert-color:var(--bs-danger-text-emphasis);--bs-alert-bg:var(--bs-danger-bg-subtle);--bs-alert-border-color:var(--bs-danger-border-subtle);--bs-alert-link-color:var(--bs-danger-text-emphasis)}.alert-light{--bs-alert-color:var(--bs-light-text-emphasis);--bs-alert-bg:var(--bs-light-bg-subtle);--bs-alert-border-color:var(--bs-light-border-subtle);--bs-alert-link-color:var(--bs-light-text-emphasis)}.alert-dark{--bs-alert-color:var(--bs-dark-text-emphasis);--bs-alert-bg:var(--bs-dark-bg-subtle);--bs-alert-border-color:var(--bs-dark-border-subtle);--bs-alert-link-color:var(--bs-dark-text-emphasis)}@keyframes progress-bar-stripes{0%{background-position-x:1rem}}.progress,.progress-stacked{--bs-progress-height:1rem;--bs-progress-font-size:0.75rem;--bs-progress-bg:var(--bs-secondary-bg);--bs-progress-border-radius:var(--bs-border-radius);--bs-progress-box-shadow:var(--bs-box-shadow-inset);--bs-progress-bar-color:#fff;--bs-progress-bar-bg:#0d6efd;--bs-progress-bar-transition:width 0.6s ease;display:flex;height:var(--bs-progress-height);overflow:hidden;font-size:var(--bs-progress-font-size);background-color:var(--bs-progress-bg);border-radius:var(--bs-progress-border-radius)}.progress-bar{display:flex;flex-direction:column;justify-content:center;overflow:hidden;color:var(--bs-progress-bar-color);text-align:center;white-space:nowrap;background-color:var(--bs-progress-bar-bg);transition:var(--bs-progress-bar-transition)}@media (prefers-reduced-motion:reduce){.progress-bar{transition:none}}.progress-bar-striped{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-size:var(--bs-progress-height) var(--bs-progress-height)}.progress-stacked>.progress{overflow:visible}.progress-stacked>.progress>.progress-bar{width:100%}.progress-bar-animated{animation:1s linear infinite progress-bar-stripes}@media (prefers-reduced-motion:reduce){.progress-bar-animated{animation:none}}.list-group{--bs-list-group-color:var(--bs-body-color);--bs-list-group-bg:var(--bs-body-bg);--bs-list-group-border-color:var(--bs-border-color);--bs-list-group-border-width:var(--bs-border-width);--bs-list-group-border-radius:var(--bs-border-radius);--bs-list-group-item-padding-x:1rem;--bs-list-group-item-padding-y:0.5rem;--bs-list-group-action-color:var(--bs-secondary-color);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-tertiary-bg);--bs-list-group-action-active-color:var(--bs-body-color);--bs-list-group-action-active-bg:var(--bs-secondary-bg);--bs-list-group-disabled-color:var(--bs-secondary-color);--bs-list-group-disabled-bg:var(--bs-body-bg);--bs-list-group-active-color:#fff;--bs-list-group-active-bg:#0d6efd;--bs-list-group-active-border-color:#0d6efd;display:flex;flex-direction:column;padding-left:0;margin-bottom:0;border-radius:var(--bs-list-group-border-radius)}.list-group-numbered{list-style-type:none;counter-reset:section}.list-group-numbered>.list-group-item::before{content:counters(section, \".\") \". \";counter-increment:section}.list-group-item-action{width:100%;color:var(--bs-list-group-action-color);text-align:inherit}.list-group-item-action:focus,.list-group-item-action:hover{z-index:1;color:var(--bs-list-group-action-hover-color);text-decoration:none;background-color:var(--bs-list-group-action-hover-bg)}.list-group-item-action:active{color:var(--bs-list-group-action-active-color);background-color:var(--bs-list-group-action-active-bg)}.list-group-item{position:relative;display:block;padding:var(--bs-list-group-item-padding-y) var(--bs-list-group-item-padding-x);color:var(--bs-list-group-color);text-decoration:none;background-color:var(--bs-list-group-bg);border:var(--bs-list-group-border-width) solid var(--bs-list-group-border-color)}.list-group-item:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.list-group-item:last-child{border-bottom-right-radius:inherit;border-bottom-left-radius:inherit}.list-group-item.disabled,.list-group-item:disabled{color:var(--bs-list-group-disabled-color);pointer-events:none;background-color:var(--bs-list-group-disabled-bg)}.list-group-item.active{z-index:2;color:var(--bs-list-group-active-color);background-color:var(--bs-list-group-active-bg);border-color:var(--bs-list-group-active-border-color)}.list-group-item+.list-group-item{border-top-width:0}.list-group-item+.list-group-item.active{margin-top:calc(-1 * var(--bs-list-group-border-width));border-top-width:var(--bs-list-group-border-width)}.list-group-horizontal{flex-direction:row}.list-group-horizontal>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal>.list-group-item.active{margin-top:0}.list-group-horizontal>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}@media (min-width:576px){.list-group-horizontal-sm{flex-direction:row}.list-group-horizontal-sm>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-sm>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-sm>.list-group-item.active{margin-top:0}.list-group-horizontal-sm>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-sm>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:768px){.list-group-horizontal-md{flex-direction:row}.list-group-horizontal-md>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-md>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-md>.list-group-item.active{margin-top:0}.list-group-horizontal-md>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-md>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:992px){.list-group-horizontal-lg{flex-direction:row}.list-group-horizontal-lg>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-lg>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-lg>.list-group-item.active{margin-top:0}.list-group-horizontal-lg>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-lg>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1200px){.list-group-horizontal-xl{flex-direction:row}.list-group-horizontal-xl>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xl>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xl>.list-group-item.active{margin-top:0}.list-group-horizontal-xl>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xl>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1400px){.list-group-horizontal-xxl{flex-direction:row}.list-group-horizontal-xxl>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xxl>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xxl>.list-group-item.active{margin-top:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}.list-group-flush{border-radius:0}.list-group-flush>.list-group-item{border-width:0 0 var(--bs-list-group-border-width)}.list-group-flush>.list-group-item:last-child{border-bottom-width:0}.list-group-item-primary{--bs-list-group-color:var(--bs-primary-text-emphasis);--bs-list-group-bg:var(--bs-primary-bg-subtle);--bs-list-group-border-color:var(--bs-primary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-primary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-primary-border-subtle);--bs-list-group-active-color:var(--bs-primary-bg-subtle);--bs-list-group-active-bg:var(--bs-primary-text-emphasis);--bs-list-group-active-border-color:var(--bs-primary-text-emphasis)}.list-group-item-secondary{--bs-list-group-color:var(--bs-secondary-text-emphasis);--bs-list-group-bg:var(--bs-secondary-bg-subtle);--bs-list-group-border-color:var(--bs-secondary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-secondary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-secondary-border-subtle);--bs-list-group-active-color:var(--bs-secondary-bg-subtle);--bs-list-group-active-bg:var(--bs-secondary-text-emphasis);--bs-list-group-active-border-color:var(--bs-secondary-text-emphasis)}.list-group-item-success{--bs-list-group-color:var(--bs-success-text-emphasis);--bs-list-group-bg:var(--bs-success-bg-subtle);--bs-list-group-border-color:var(--bs-success-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-success-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-success-border-subtle);--bs-list-group-active-color:var(--bs-success-bg-subtle);--bs-list-group-active-bg:var(--bs-success-text-emphasis);--bs-list-group-active-border-color:var(--bs-success-text-emphasis)}.list-group-item-info{--bs-list-group-color:var(--bs-info-text-emphasis);--bs-list-group-bg:var(--bs-info-bg-subtle);--bs-list-group-border-color:var(--bs-info-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-info-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-info-border-subtle);--bs-list-group-active-color:var(--bs-info-bg-subtle);--bs-list-group-active-bg:var(--bs-info-text-emphasis);--bs-list-group-active-border-color:var(--bs-info-text-emphasis)}.list-group-item-warning{--bs-list-group-color:var(--bs-warning-text-emphasis);--bs-list-group-bg:var(--bs-warning-bg-subtle);--bs-list-group-border-color:var(--bs-warning-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-warning-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-warning-border-subtle);--bs-list-group-active-color:var(--bs-warning-bg-subtle);--bs-list-group-active-bg:var(--bs-warning-text-emphasis);--bs-list-group-active-border-color:var(--bs-warning-text-emphasis)}.list-group-item-danger{--bs-list-group-color:var(--bs-danger-text-emphasis);--bs-list-group-bg:var(--bs-danger-bg-subtle);--bs-list-group-border-color:var(--bs-danger-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-danger-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-danger-border-subtle);--bs-list-group-active-color:var(--bs-danger-bg-subtle);--bs-list-group-active-bg:var(--bs-danger-text-emphasis);--bs-list-group-active-border-color:var(--bs-danger-text-emphasis)}.list-group-item-light{--bs-list-group-color:var(--bs-light-text-emphasis);--bs-list-group-bg:var(--bs-light-bg-subtle);--bs-list-group-border-color:var(--bs-light-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-light-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-light-border-subtle);--bs-list-group-active-color:var(--bs-light-bg-subtle);--bs-list-group-active-bg:var(--bs-light-text-emphasis);--bs-list-group-active-border-color:var(--bs-light-text-emphasis)}.list-group-item-dark{--bs-list-group-color:var(--bs-dark-text-emphasis);--bs-list-group-bg:var(--bs-dark-bg-subtle);--bs-list-group-border-color:var(--bs-dark-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-dark-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-dark-border-subtle);--bs-list-group-active-color:var(--bs-dark-bg-subtle);--bs-list-group-active-bg:var(--bs-dark-text-emphasis);--bs-list-group-active-border-color:var(--bs-dark-text-emphasis)}.btn-close{--bs-btn-close-color:#000;--bs-btn-close-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e\");--bs-btn-close-opacity:0.5;--bs-btn-close-hover-opacity:0.75;--bs-btn-close-focus-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-btn-close-focus-opacity:1;--bs-btn-close-disabled-opacity:0.25;--bs-btn-close-white-filter:invert(1) grayscale(100%) brightness(200%);box-sizing:content-box;width:1em;height:1em;padding:.25em .25em;color:var(--bs-btn-close-color);background:transparent var(--bs-btn-close-bg) center/1em auto no-repeat;border:0;border-radius:.375rem;opacity:var(--bs-btn-close-opacity)}.btn-close:hover{color:var(--bs-btn-close-color);text-decoration:none;opacity:var(--bs-btn-close-hover-opacity)}.btn-close:focus{outline:0;box-shadow:var(--bs-btn-close-focus-shadow);opacity:var(--bs-btn-close-focus-opacity)}.btn-close.disabled,.btn-close:disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:var(--bs-btn-close-disabled-opacity)}.btn-close-white{filter:var(--bs-btn-close-white-filter)}[data-bs-theme=dark] .btn-close{filter:var(--bs-btn-close-white-filter)}.toast{--bs-toast-zindex:1090;--bs-toast-padding-x:0.75rem;--bs-toast-padding-y:0.5rem;--bs-toast-spacing:1.5rem;--bs-toast-max-width:350px;--bs-toast-font-size:0.875rem;--bs-toast-color: ;--bs-toast-bg:rgba(var(--bs-body-bg-rgb), 0.85);--bs-toast-border-width:var(--bs-border-width);--bs-toast-border-color:var(--bs-border-color-translucent);--bs-toast-border-radius:var(--bs-border-radius);--bs-toast-box-shadow:var(--bs-box-shadow);--bs-toast-header-color:var(--bs-secondary-color);--bs-toast-header-bg:rgba(var(--bs-body-bg-rgb), 0.85);--bs-toast-header-border-color:var(--bs-border-color-translucent);width:var(--bs-toast-max-width);max-width:100%;font-size:var(--bs-toast-font-size);color:var(--bs-toast-color);pointer-events:auto;background-color:var(--bs-toast-bg);background-clip:padding-box;border:var(--bs-toast-border-width) solid var(--bs-toast-border-color);box-shadow:var(--bs-toast-box-shadow);border-radius:var(--bs-toast-border-radius)}.toast.showing{opacity:0}.toast:not(.show){display:none}.toast-container{--bs-toast-zindex:1090;position:absolute;z-index:var(--bs-toast-zindex);width:-webkit-max-content;width:-moz-max-content;width:max-content;max-width:100%;pointer-events:none}.toast-container>:not(:last-child){margin-bottom:var(--bs-toast-spacing)}.toast-header{display:flex;align-items:center;padding:var(--bs-toast-padding-y) var(--bs-toast-padding-x);color:var(--bs-toast-header-color);background-color:var(--bs-toast-header-bg);background-clip:padding-box;border-bottom:var(--bs-toast-border-width) solid var(--bs-toast-header-border-color);border-top-left-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width));border-top-right-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width))}.toast-header .btn-close{margin-right:calc(-.5 * var(--bs-toast-padding-x));margin-left:var(--bs-toast-padding-x)}.toast-body{padding:var(--bs-toast-padding-x);word-wrap:break-word}.modal{--bs-modal-zindex:1055;--bs-modal-width:500px;--bs-modal-padding:1rem;--bs-modal-margin:0.5rem;--bs-modal-color: ;--bs-modal-bg:var(--bs-body-bg);--bs-modal-border-color:var(--bs-border-color-translucent);--bs-modal-border-width:var(--bs-border-width);--bs-modal-border-radius:var(--bs-border-radius-lg);--bs-modal-box-shadow:var(--bs-box-shadow-sm);--bs-modal-inner-border-radius:calc(var(--bs-border-radius-lg) - (var(--bs-border-width)));--bs-modal-header-padding-x:1rem;--bs-modal-header-padding-y:1rem;--bs-modal-header-padding:1rem 1rem;--bs-modal-header-border-color:var(--bs-border-color);--bs-modal-header-border-width:var(--bs-border-width);--bs-modal-title-line-height:1.5;--bs-modal-footer-gap:0.5rem;--bs-modal-footer-bg: ;--bs-modal-footer-border-color:var(--bs-border-color);--bs-modal-footer-border-width:var(--bs-border-width);position:fixed;top:0;left:0;z-index:var(--bs-modal-zindex);display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog{position:relative;width:auto;margin:var(--bs-modal-margin);pointer-events:none}.modal.fade .modal-dialog{transition:transform .3s ease-out;transform:translate(0,-50px)}@media (prefers-reduced-motion:reduce){.modal.fade .modal-dialog{transition:none}}.modal.show .modal-dialog{transform:none}.modal.modal-static .modal-dialog{transform:scale(1.02)}.modal-dialog-scrollable{height:calc(100% - var(--bs-modal-margin) * 2)}.modal-dialog-scrollable .modal-content{max-height:100%;overflow:hidden}.modal-dialog-scrollable .modal-body{overflow-y:auto}.modal-dialog-centered{display:flex;align-items:center;min-height:calc(100% - var(--bs-modal-margin) * 2)}.modal-content{position:relative;display:flex;flex-direction:column;width:100%;color:var(--bs-modal-color);pointer-events:auto;background-color:var(--bs-modal-bg);background-clip:padding-box;border:var(--bs-modal-border-width) solid var(--bs-modal-border-color);border-radius:var(--bs-modal-border-radius);outline:0}.modal-backdrop{--bs-backdrop-zindex:1050;--bs-backdrop-bg:#000;--bs-backdrop-opacity:0.5;position:fixed;top:0;left:0;z-index:var(--bs-backdrop-zindex);width:100vw;height:100vh;background-color:var(--bs-backdrop-bg)}.modal-backdrop.fade{opacity:0}.modal-backdrop.show{opacity:var(--bs-backdrop-opacity)}.modal-header{display:flex;flex-shrink:0;align-items:center;justify-content:space-between;padding:var(--bs-modal-header-padding);border-bottom:var(--bs-modal-header-border-width) solid var(--bs-modal-header-border-color);border-top-left-radius:var(--bs-modal-inner-border-radius);border-top-right-radius:var(--bs-modal-inner-border-radius)}.modal-header .btn-close{padding:calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin:calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto}.modal-title{margin-bottom:0;line-height:var(--bs-modal-title-line-height)}.modal-body{position:relative;flex:1 1 auto;padding:var(--bs-modal-padding)}.modal-footer{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:calc(var(--bs-modal-padding) - var(--bs-modal-footer-gap) * .5);background-color:var(--bs-modal-footer-bg);border-top:var(--bs-modal-footer-border-width) solid var(--bs-modal-footer-border-color);border-bottom-right-radius:var(--bs-modal-inner-border-radius);border-bottom-left-radius:var(--bs-modal-inner-border-radius)}.modal-footer>*{margin:calc(var(--bs-modal-footer-gap) * .5)}@media (min-width:576px){.modal{--bs-modal-margin:1.75rem;--bs-modal-box-shadow:var(--bs-box-shadow)}.modal-dialog{max-width:var(--bs-modal-width);margin-right:auto;margin-left:auto}.modal-sm{--bs-modal-width:300px}}@media (min-width:992px){.modal-lg,.modal-xl{--bs-modal-width:800px}}@media (min-width:1200px){.modal-xl{--bs-modal-width:1140px}}.modal-fullscreen{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen .modal-footer,.modal-fullscreen .modal-header{border-radius:0}.modal-fullscreen .modal-body{overflow-y:auto}@media (max-width:575.98px){.modal-fullscreen-sm-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down .modal-footer,.modal-fullscreen-sm-down .modal-header{border-radius:0}.modal-fullscreen-sm-down .modal-body{overflow-y:auto}}@media (max-width:767.98px){.modal-fullscreen-md-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down .modal-footer,.modal-fullscreen-md-down .modal-header{border-radius:0}.modal-fullscreen-md-down .modal-body{overflow-y:auto}}@media (max-width:991.98px){.modal-fullscreen-lg-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down .modal-footer,.modal-fullscreen-lg-down .modal-header{border-radius:0}.modal-fullscreen-lg-down .modal-body{overflow-y:auto}}@media (max-width:1199.98px){.modal-fullscreen-xl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down .modal-footer,.modal-fullscreen-xl-down .modal-header{border-radius:0}.modal-fullscreen-xl-down .modal-body{overflow-y:auto}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down .modal-footer,.modal-fullscreen-xxl-down .modal-header{border-radius:0}.modal-fullscreen-xxl-down .modal-body{overflow-y:auto}}.tooltip{--bs-tooltip-zindex:1080;--bs-tooltip-max-width:200px;--bs-tooltip-padding-x:0.5rem;--bs-tooltip-padding-y:0.25rem;--bs-tooltip-margin: ;--bs-tooltip-font-size:0.875rem;--bs-tooltip-color:var(--bs-body-bg);--bs-tooltip-bg:var(--bs-emphasis-color);--bs-tooltip-border-radius:var(--bs-border-radius);--bs-tooltip-opacity:0.9;--bs-tooltip-arrow-width:0.8rem;--bs-tooltip-arrow-height:0.4rem;z-index:var(--bs-tooltip-zindex);display:block;margin:var(--bs-tooltip-margin);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-tooltip-font-size);word-wrap:break-word;opacity:0}.tooltip.show{opacity:var(--bs-tooltip-opacity)}.tooltip .tooltip-arrow{display:block;width:var(--bs-tooltip-arrow-width);height:var(--bs-tooltip-arrow-height)}.tooltip .tooltip-arrow::before{position:absolute;content:\"\";border-color:transparent;border-style:solid}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow,.bs-tooltip-top .tooltip-arrow{bottom:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow::before,.bs-tooltip-top .tooltip-arrow::before{top:-1px;border-width:var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-top-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow,.bs-tooltip-end .tooltip-arrow{left:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow::before,.bs-tooltip-end .tooltip-arrow::before{right:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-right-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow,.bs-tooltip-bottom .tooltip-arrow{top:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow::before,.bs-tooltip-bottom .tooltip-arrow::before{bottom:-1px;border-width:0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-bottom-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow,.bs-tooltip-start .tooltip-arrow{right:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow::before,.bs-tooltip-start .tooltip-arrow::before{left:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) 0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-left-color:var(--bs-tooltip-bg)}.tooltip-inner{max-width:var(--bs-tooltip-max-width);padding:var(--bs-tooltip-padding-y) var(--bs-tooltip-padding-x);color:var(--bs-tooltip-color);text-align:center;background-color:var(--bs-tooltip-bg);border-radius:var(--bs-tooltip-border-radius)}.popover{--bs-popover-zindex:1070;--bs-popover-max-width:276px;--bs-popover-font-size:0.875rem;--bs-popover-bg:var(--bs-body-bg);--bs-popover-border-width:var(--bs-border-width);--bs-popover-border-color:var(--bs-border-color-translucent);--bs-popover-border-radius:var(--bs-border-radius-lg);--bs-popover-inner-border-radius:calc(var(--bs-border-radius-lg) - var(--bs-border-width));--bs-popover-box-shadow:var(--bs-box-shadow);--bs-popover-header-padding-x:1rem;--bs-popover-header-padding-y:0.5rem;--bs-popover-header-font-size:1rem;--bs-popover-header-color:inherit;--bs-popover-header-bg:var(--bs-secondary-bg);--bs-popover-body-padding-x:1rem;--bs-popover-body-padding-y:1rem;--bs-popover-body-color:var(--bs-body-color);--bs-popover-arrow-width:1rem;--bs-popover-arrow-height:0.5rem;--bs-popover-arrow-border:var(--bs-popover-border-color);z-index:var(--bs-popover-zindex);display:block;max-width:var(--bs-popover-max-width);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-popover-font-size);word-wrap:break-word;background-color:var(--bs-popover-bg);background-clip:padding-box;border:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-radius:var(--bs-popover-border-radius)}.popover .popover-arrow{display:block;width:var(--bs-popover-arrow-width);height:var(--bs-popover-arrow-height)}.popover .popover-arrow::after,.popover .popover-arrow::before{position:absolute;display:block;content:\"\";border-color:transparent;border-style:solid;border-width:0}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow,.bs-popover-top>.popover-arrow{bottom:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::before,.bs-popover-top>.popover-arrow::after,.bs-popover-top>.popover-arrow::before{border-width:var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::before,.bs-popover-top>.popover-arrow::before{bottom:0;border-top-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::after,.bs-popover-top>.popover-arrow::after{bottom:var(--bs-popover-border-width);border-top-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow,.bs-popover-end>.popover-arrow{left:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::before,.bs-popover-end>.popover-arrow::after,.bs-popover-end>.popover-arrow::before{border-width:calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::before,.bs-popover-end>.popover-arrow::before{left:0;border-right-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::after,.bs-popover-end>.popover-arrow::after{left:var(--bs-popover-border-width);border-right-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow,.bs-popover-bottom>.popover-arrow{top:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::before,.bs-popover-bottom>.popover-arrow::after,.bs-popover-bottom>.popover-arrow::before{border-width:0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::before,.bs-popover-bottom>.popover-arrow::before{top:0;border-bottom-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::after,.bs-popover-bottom>.popover-arrow::after{top:var(--bs-popover-border-width);border-bottom-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom] .popover-header::before,.bs-popover-bottom .popover-header::before{position:absolute;top:0;left:50%;display:block;width:var(--bs-popover-arrow-width);margin-left:calc(-.5 * var(--bs-popover-arrow-width));content:\"\";border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-header-bg)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow,.bs-popover-start>.popover-arrow{right:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::before,.bs-popover-start>.popover-arrow::after,.bs-popover-start>.popover-arrow::before{border-width:calc(var(--bs-popover-arrow-width) * .5) 0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::before,.bs-popover-start>.popover-arrow::before{right:0;border-left-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::after,.bs-popover-start>.popover-arrow::after{right:var(--bs-popover-border-width);border-left-color:var(--bs-popover-bg)}.popover-header{padding:var(--bs-popover-header-padding-y) var(--bs-popover-header-padding-x);margin-bottom:0;font-size:var(--bs-popover-header-font-size);color:var(--bs-popover-header-color);background-color:var(--bs-popover-header-bg);border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-top-left-radius:var(--bs-popover-inner-border-radius);border-top-right-radius:var(--bs-popover-inner-border-radius)}.popover-header:empty{display:none}.popover-body{padding:var(--bs-popover-body-padding-y) var(--bs-popover-body-padding-x);color:var(--bs-popover-body-color)}.carousel{position:relative}.carousel.pointer-event{touch-action:pan-y}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner::after{display:block;clear:both;content:\"\"}.carousel-item{position:relative;display:none;float:left;width:100%;margin-right:-100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;transition:transform .6s ease-in-out}@media (prefers-reduced-motion:reduce){.carousel-item{transition:none}}.carousel-item-next,.carousel-item-prev,.carousel-item.active{display:block}.active.carousel-item-end,.carousel-item-next:not(.carousel-item-start){transform:translateX(100%)}.active.carousel-item-start,.carousel-item-prev:not(.carousel-item-end){transform:translateX(-100%)}.carousel-fade .carousel-item{opacity:0;transition-property:opacity;transform:none}.carousel-fade .carousel-item-next.carousel-item-start,.carousel-fade .carousel-item-prev.carousel-item-end,.carousel-fade .carousel-item.active{z-index:1;opacity:1}.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{z-index:0;opacity:0;transition:opacity 0s .6s}@media (prefers-reduced-motion:reduce){.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{transition:none}}.carousel-control-next,.carousel-control-prev{position:absolute;top:0;bottom:0;z-index:1;display:flex;align-items:center;justify-content:center;width:15%;padding:0;color:#fff;text-align:center;background:0 0;border:0;opacity:.5;transition:opacity .15s ease}@media (prefers-reduced-motion:reduce){.carousel-control-next,.carousel-control-prev{transition:none}}.carousel-control-next:focus,.carousel-control-next:hover,.carousel-control-prev:focus,.carousel-control-prev:hover{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev{left:0}.carousel-control-next{right:0}.carousel-control-next-icon,.carousel-control-prev-icon{display:inline-block;width:2rem;height:2rem;background-repeat:no-repeat;background-position:50%;background-size:100% 100%}.carousel-control-prev-icon{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z'/%3e%3c/svg%3e\")}.carousel-control-next-icon{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.carousel-indicators{position:absolute;right:0;bottom:0;left:0;z-index:2;display:flex;justify-content:center;padding:0;margin-right:15%;margin-bottom:1rem;margin-left:15%}.carousel-indicators [data-bs-target]{box-sizing:content-box;flex:0 1 auto;width:30px;height:3px;padding:0;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border:0;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media (prefers-reduced-motion:reduce){.carousel-indicators [data-bs-target]{transition:none}}.carousel-indicators .active{opacity:1}.carousel-caption{position:absolute;right:15%;bottom:1.25rem;left:15%;padding-top:1.25rem;padding-bottom:1.25rem;color:#fff;text-align:center}.carousel-dark .carousel-control-next-icon,.carousel-dark .carousel-control-prev-icon{filter:invert(1) grayscale(100)}.carousel-dark .carousel-indicators [data-bs-target]{background-color:#000}.carousel-dark .carousel-caption{color:#000}[data-bs-theme=dark] .carousel .carousel-control-next-icon,[data-bs-theme=dark] .carousel .carousel-control-prev-icon,[data-bs-theme=dark].carousel .carousel-control-next-icon,[data-bs-theme=dark].carousel .carousel-control-prev-icon{filter:invert(1) grayscale(100)}[data-bs-theme=dark] .carousel .carousel-indicators [data-bs-target],[data-bs-theme=dark].carousel .carousel-indicators [data-bs-target]{background-color:#000}[data-bs-theme=dark] .carousel .carousel-caption,[data-bs-theme=dark].carousel .carousel-caption{color:#000}.spinner-border,.spinner-grow{display:inline-block;width:var(--bs-spinner-width);height:var(--bs-spinner-height);vertical-align:var(--bs-spinner-vertical-align);border-radius:50%;animation:var(--bs-spinner-animation-speed) linear infinite var(--bs-spinner-animation-name)}@keyframes spinner-border{to{transform:rotate(360deg)}}.spinner-border{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-0.125em;--bs-spinner-border-width:0.25em;--bs-spinner-animation-speed:0.75s;--bs-spinner-animation-name:spinner-border;border:var(--bs-spinner-border-width) solid currentcolor;border-right-color:transparent}.spinner-border-sm{--bs-spinner-width:1rem;--bs-spinner-height:1rem;--bs-spinner-border-width:0.2em}@keyframes spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}.spinner-grow{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-0.125em;--bs-spinner-animation-speed:0.75s;--bs-spinner-animation-name:spinner-grow;background-color:currentcolor;opacity:0}.spinner-grow-sm{--bs-spinner-width:1rem;--bs-spinner-height:1rem}@media (prefers-reduced-motion:reduce){.spinner-border,.spinner-grow{--bs-spinner-animation-speed:1.5s}}.offcanvas,.offcanvas-lg,.offcanvas-md,.offcanvas-sm,.offcanvas-xl,.offcanvas-xxl{--bs-offcanvas-zindex:1045;--bs-offcanvas-width:400px;--bs-offcanvas-height:30vh;--bs-offcanvas-padding-x:1rem;--bs-offcanvas-padding-y:1rem;--bs-offcanvas-color:var(--bs-body-color);--bs-offcanvas-bg:var(--bs-body-bg);--bs-offcanvas-border-width:var(--bs-border-width);--bs-offcanvas-border-color:var(--bs-border-color-translucent);--bs-offcanvas-box-shadow:var(--bs-box-shadow-sm);--bs-offcanvas-transition:transform 0.3s ease-in-out;--bs-offcanvas-title-line-height:1.5}@media (max-width:575.98px){.offcanvas-sm{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:575.98px) and (prefers-reduced-motion:reduce){.offcanvas-sm{transition:none}}@media (max-width:575.98px){.offcanvas-sm.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-sm.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-sm.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-sm.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-sm.show:not(.hiding),.offcanvas-sm.showing{transform:none}.offcanvas-sm.hiding,.offcanvas-sm.show,.offcanvas-sm.showing{visibility:visible}}@media (min-width:576px){.offcanvas-sm{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-sm .offcanvas-header{display:none}.offcanvas-sm .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:767.98px){.offcanvas-md{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:767.98px) and (prefers-reduced-motion:reduce){.offcanvas-md{transition:none}}@media (max-width:767.98px){.offcanvas-md.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-md.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-md.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-md.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-md.show:not(.hiding),.offcanvas-md.showing{transform:none}.offcanvas-md.hiding,.offcanvas-md.show,.offcanvas-md.showing{visibility:visible}}@media (min-width:768px){.offcanvas-md{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-md .offcanvas-header{display:none}.offcanvas-md .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:991.98px){.offcanvas-lg{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:991.98px) and (prefers-reduced-motion:reduce){.offcanvas-lg{transition:none}}@media (max-width:991.98px){.offcanvas-lg.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-lg.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-lg.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-lg.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-lg.show:not(.hiding),.offcanvas-lg.showing{transform:none}.offcanvas-lg.hiding,.offcanvas-lg.show,.offcanvas-lg.showing{visibility:visible}}@media (min-width:992px){.offcanvas-lg{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-lg .offcanvas-header{display:none}.offcanvas-lg .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1199.98px){.offcanvas-xl{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1199.98px) and (prefers-reduced-motion:reduce){.offcanvas-xl{transition:none}}@media (max-width:1199.98px){.offcanvas-xl.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-xl.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-xl.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xl.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xl.show:not(.hiding),.offcanvas-xl.showing{transform:none}.offcanvas-xl.hiding,.offcanvas-xl.show,.offcanvas-xl.showing{visibility:visible}}@media (min-width:1200px){.offcanvas-xl{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xl .offcanvas-header{display:none}.offcanvas-xl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1399.98px){.offcanvas-xxl{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1399.98px) and (prefers-reduced-motion:reduce){.offcanvas-xxl{transition:none}}@media (max-width:1399.98px){.offcanvas-xxl.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-xxl.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-xxl.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xxl.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xxl.show:not(.hiding),.offcanvas-xxl.showing{transform:none}.offcanvas-xxl.hiding,.offcanvas-xxl.show,.offcanvas-xxl.showing{visibility:visible}}@media (min-width:1400px){.offcanvas-xxl{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xxl .offcanvas-header{display:none}.offcanvas-xxl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}.offcanvas{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}@media (prefers-reduced-motion:reduce){.offcanvas{transition:none}}.offcanvas.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas.show:not(.hiding),.offcanvas.showing{transform:none}.offcanvas.hiding,.offcanvas.show,.offcanvas.showing{visibility:visible}.offcanvas-backdrop{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.offcanvas-backdrop.fade{opacity:0}.offcanvas-backdrop.show{opacity:.5}.offcanvas-header{display:flex;align-items:center;justify-content:space-between;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x)}.offcanvas-header .btn-close{padding:calc(var(--bs-offcanvas-padding-y) * .5) calc(var(--bs-offcanvas-padding-x) * .5);margin-top:calc(-.5 * var(--bs-offcanvas-padding-y));margin-right:calc(-.5 * var(--bs-offcanvas-padding-x));margin-bottom:calc(-.5 * var(--bs-offcanvas-padding-y))}.offcanvas-title{margin-bottom:0;line-height:var(--bs-offcanvas-title-line-height)}.offcanvas-body{flex-grow:1;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x);overflow-y:auto}.placeholder{display:inline-block;min-height:1em;vertical-align:middle;cursor:wait;background-color:currentcolor;opacity:.5}.placeholder.btn::before{display:inline-block;content:\"\"}.placeholder-xs{min-height:.6em}.placeholder-sm{min-height:.8em}.placeholder-lg{min-height:1.2em}.placeholder-glow .placeholder{animation:placeholder-glow 2s ease-in-out infinite}@keyframes placeholder-glow{50%{opacity:.2}}.placeholder-wave{-webkit-mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);-webkit-mask-size:200% 100%;mask-size:200% 100%;animation:placeholder-wave 2s linear infinite}@keyframes placeholder-wave{100%{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}.clearfix::after{display:block;clear:both;content:\"\"}.text-bg-primary{color:#fff!important;background-color:RGBA(var(--bs-primary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-secondary{color:#fff!important;background-color:RGBA(var(--bs-secondary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-success{color:#fff!important;background-color:RGBA(var(--bs-success-rgb),var(--bs-bg-opacity,1))!important}.text-bg-info{color:#000!important;background-color:RGBA(var(--bs-info-rgb),var(--bs-bg-opacity,1))!important}.text-bg-warning{color:#000!important;background-color:RGBA(var(--bs-warning-rgb),var(--bs-bg-opacity,1))!important}.text-bg-danger{color:#fff!important;background-color:RGBA(var(--bs-danger-rgb),var(--bs-bg-opacity,1))!important}.text-bg-light{color:#000!important;background-color:RGBA(var(--bs-light-rgb),var(--bs-bg-opacity,1))!important}.text-bg-dark{color:#fff!important;background-color:RGBA(var(--bs-dark-rgb),var(--bs-bg-opacity,1))!important}.link-primary{color:RGBA(var(--bs-primary-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important}.link-primary:focus,.link-primary:hover{color:RGBA(10,88,202,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important}.link-secondary{color:RGBA(var(--bs-secondary-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important}.link-secondary:focus,.link-secondary:hover{color:RGBA(86,94,100,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important}.link-success{color:RGBA(var(--bs-success-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important}.link-success:focus,.link-success:hover{color:RGBA(20,108,67,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important}.link-info{color:RGBA(var(--bs-info-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important}.link-info:focus,.link-info:hover{color:RGBA(61,213,243,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important}.link-warning{color:RGBA(var(--bs-warning-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important}.link-warning:focus,.link-warning:hover{color:RGBA(255,205,57,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important}.link-danger{color:RGBA(var(--bs-danger-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important}.link-danger:focus,.link-danger:hover{color:RGBA(176,42,55,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important}.link-light{color:RGBA(var(--bs-light-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important}.link-light:focus,.link-light:hover{color:RGBA(249,250,251,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important}.link-dark{color:RGBA(var(--bs-dark-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important}.link-dark:focus,.link-dark:hover{color:RGBA(26,30,33,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important}.link-body-emphasis{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-body-emphasis:focus,.link-body-emphasis:hover{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,.75))!important;-webkit-text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,0.75))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,0.75))!important}.focus-ring:focus{outline:0;box-shadow:var(--bs-focus-ring-x,0) var(--bs-focus-ring-y,0) var(--bs-focus-ring-blur,0) var(--bs-focus-ring-width) var(--bs-focus-ring-color)}.icon-link{display:inline-flex;gap:.375rem;align-items:center;-webkit-text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,0.5));text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,0.5));text-underline-offset:0.25em;-webkit-backface-visibility:hidden;backface-visibility:hidden}.icon-link>.bi{flex-shrink:0;width:1em;height:1em;fill:currentcolor;transition:.2s ease-in-out transform}@media (prefers-reduced-motion:reduce){.icon-link>.bi{transition:none}}.icon-link-hover:focus-visible>.bi,.icon-link-hover:hover>.bi{transform:var(--bs-icon-link-transform,translate3d(.25em,0,0))}.ratio{position:relative;width:100%}.ratio::before{display:block;padding-top:var(--bs-aspect-ratio);content:\"\"}.ratio>*{position:absolute;top:0;left:0;width:100%;height:100%}.ratio-1x1{--bs-aspect-ratio:100%}.ratio-4x3{--bs-aspect-ratio:75%}.ratio-16x9{--bs-aspect-ratio:56.25%}.ratio-21x9{--bs-aspect-ratio:42.8571428571%}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}@media (min-width:576px){.sticky-sm-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-sm-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:768px){.sticky-md-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-md-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:992px){.sticky-lg-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-lg-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:1200px){.sticky-xl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-xl-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:1400px){.sticky-xxl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-xxl-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}.hstack{display:flex;flex-direction:row;align-items:center;align-self:stretch}.vstack{display:flex;flex:1 1 auto;flex-direction:column;align-self:stretch}.visually-hidden,.visually-hidden-focusable:not(:focus):not(:focus-within){width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.visually-hidden-focusable:not(:focus):not(:focus-within):not(caption),.visually-hidden:not(caption){position:absolute!important}.stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;content:\"\"}.text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vr{display:inline-block;align-self:stretch;width:var(--bs-border-width);min-height:1em;background-color:currentcolor;opacity:.25}.align-baseline{vertical-align:baseline!important}.align-top{vertical-align:top!important}.align-middle{vertical-align:middle!important}.align-bottom{vertical-align:bottom!important}.align-text-bottom{vertical-align:text-bottom!important}.align-text-top{vertical-align:text-top!important}.float-start{float:left!important}.float-end{float:right!important}.float-none{float:none!important}.object-fit-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-none{-o-object-fit:none!important;object-fit:none!important}.opacity-0{opacity:0!important}.opacity-25{opacity:.25!important}.opacity-50{opacity:.5!important}.opacity-75{opacity:.75!important}.opacity-100{opacity:1!important}.overflow-auto{overflow:auto!important}.overflow-hidden{overflow:hidden!important}.overflow-visible{overflow:visible!important}.overflow-scroll{overflow:scroll!important}.overflow-x-auto{overflow-x:auto!important}.overflow-x-hidden{overflow-x:hidden!important}.overflow-x-visible{overflow-x:visible!important}.overflow-x-scroll{overflow-x:scroll!important}.overflow-y-auto{overflow-y:auto!important}.overflow-y-hidden{overflow-y:hidden!important}.overflow-y-visible{overflow-y:visible!important}.overflow-y-scroll{overflow-y:scroll!important}.d-inline{display:inline!important}.d-inline-block{display:inline-block!important}.d-block{display:block!important}.d-grid{display:grid!important}.d-inline-grid{display:inline-grid!important}.d-table{display:table!important}.d-table-row{display:table-row!important}.d-table-cell{display:table-cell!important}.d-flex{display:flex!important}.d-inline-flex{display:inline-flex!important}.d-none{display:none!important}.shadow{box-shadow:var(--bs-box-shadow)!important}.shadow-sm{box-shadow:var(--bs-box-shadow-sm)!important}.shadow-lg{box-shadow:var(--bs-box-shadow-lg)!important}.shadow-none{box-shadow:none!important}.focus-ring-primary{--bs-focus-ring-color:rgba(var(--bs-primary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-secondary{--bs-focus-ring-color:rgba(var(--bs-secondary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-success{--bs-focus-ring-color:rgba(var(--bs-success-rgb), var(--bs-focus-ring-opacity))}.focus-ring-info{--bs-focus-ring-color:rgba(var(--bs-info-rgb), var(--bs-focus-ring-opacity))}.focus-ring-warning{--bs-focus-ring-color:rgba(var(--bs-warning-rgb), var(--bs-focus-ring-opacity))}.focus-ring-danger{--bs-focus-ring-color:rgba(var(--bs-danger-rgb), var(--bs-focus-ring-opacity))}.focus-ring-light{--bs-focus-ring-color:rgba(var(--bs-light-rgb), var(--bs-focus-ring-opacity))}.focus-ring-dark{--bs-focus-ring-color:rgba(var(--bs-dark-rgb), var(--bs-focus-ring-opacity))}.position-static{position:static!important}.position-relative{position:relative!important}.position-absolute{position:absolute!important}.position-fixed{position:fixed!important}.position-sticky{position:-webkit-sticky!important;position:sticky!important}.top-0{top:0!important}.top-50{top:50%!important}.top-100{top:100%!important}.bottom-0{bottom:0!important}.bottom-50{bottom:50%!important}.bottom-100{bottom:100%!important}.start-0{left:0!important}.start-50{left:50%!important}.start-100{left:100%!important}.end-0{right:0!important}.end-50{right:50%!important}.end-100{right:100%!important}.translate-middle{transform:translate(-50%,-50%)!important}.translate-middle-x{transform:translateX(-50%)!important}.translate-middle-y{transform:translateY(-50%)!important}.border{border:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-0{border:0!important}.border-top{border-top:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-top-0{border-top:0!important}.border-end{border-right:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-end-0{border-right:0!important}.border-bottom{border-bottom:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-bottom-0{border-bottom:0!important}.border-start{border-left:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-start-0{border-left:0!important}.border-primary{--bs-border-opacity:1;border-color:rgba(var(--bs-primary-rgb),var(--bs-border-opacity))!important}.border-secondary{--bs-border-opacity:1;border-color:rgba(var(--bs-secondary-rgb),var(--bs-border-opacity))!important}.border-success{--bs-border-opacity:1;border-color:rgba(var(--bs-success-rgb),var(--bs-border-opacity))!important}.border-info{--bs-border-opacity:1;border-color:rgba(var(--bs-info-rgb),var(--bs-border-opacity))!important}.border-warning{--bs-border-opacity:1;border-color:rgba(var(--bs-warning-rgb),var(--bs-border-opacity))!important}.border-danger{--bs-border-opacity:1;border-color:rgba(var(--bs-danger-rgb),var(--bs-border-opacity))!important}.border-light{--bs-border-opacity:1;border-color:rgba(var(--bs-light-rgb),var(--bs-border-opacity))!important}.border-dark{--bs-border-opacity:1;border-color:rgba(var(--bs-dark-rgb),var(--bs-border-opacity))!important}.border-black{--bs-border-opacity:1;border-color:rgba(var(--bs-black-rgb),var(--bs-border-opacity))!important}.border-white{--bs-border-opacity:1;border-color:rgba(var(--bs-white-rgb),var(--bs-border-opacity))!important}.border-primary-subtle{border-color:var(--bs-primary-border-subtle)!important}.border-secondary-subtle{border-color:var(--bs-secondary-border-subtle)!important}.border-success-subtle{border-color:var(--bs-success-border-subtle)!important}.border-info-subtle{border-color:var(--bs-info-border-subtle)!important}.border-warning-subtle{border-color:var(--bs-warning-border-subtle)!important}.border-danger-subtle{border-color:var(--bs-danger-border-subtle)!important}.border-light-subtle{border-color:var(--bs-light-border-subtle)!important}.border-dark-subtle{border-color:var(--bs-dark-border-subtle)!important}.border-1{border-width:1px!important}.border-2{border-width:2px!important}.border-3{border-width:3px!important}.border-4{border-width:4px!important}.border-5{border-width:5px!important}.border-opacity-10{--bs-border-opacity:0.1}.border-opacity-25{--bs-border-opacity:0.25}.border-opacity-50{--bs-border-opacity:0.5}.border-opacity-75{--bs-border-opacity:0.75}.border-opacity-100{--bs-border-opacity:1}.w-25{width:25%!important}.w-50{width:50%!important}.w-75{width:75%!important}.w-100{width:100%!important}.w-auto{width:auto!important}.mw-100{max-width:100%!important}.vw-100{width:100vw!important}.min-vw-100{min-width:100vw!important}.h-25{height:25%!important}.h-50{height:50%!important}.h-75{height:75%!important}.h-100{height:100%!important}.h-auto{height:auto!important}.mh-100{max-height:100%!important}.vh-100{height:100vh!important}.min-vh-100{min-height:100vh!important}.flex-fill{flex:1 1 auto!important}.flex-row{flex-direction:row!important}.flex-column{flex-direction:column!important}.flex-row-reverse{flex-direction:row-reverse!important}.flex-column-reverse{flex-direction:column-reverse!important}.flex-grow-0{flex-grow:0!important}.flex-grow-1{flex-grow:1!important}.flex-shrink-0{flex-shrink:0!important}.flex-shrink-1{flex-shrink:1!important}.flex-wrap{flex-wrap:wrap!important}.flex-nowrap{flex-wrap:nowrap!important}.flex-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-start{justify-content:flex-start!important}.justify-content-end{justify-content:flex-end!important}.justify-content-center{justify-content:center!important}.justify-content-between{justify-content:space-between!important}.justify-content-around{justify-content:space-around!important}.justify-content-evenly{justify-content:space-evenly!important}.align-items-start{align-items:flex-start!important}.align-items-end{align-items:flex-end!important}.align-items-center{align-items:center!important}.align-items-baseline{align-items:baseline!important}.align-items-stretch{align-items:stretch!important}.align-content-start{align-content:flex-start!important}.align-content-end{align-content:flex-end!important}.align-content-center{align-content:center!important}.align-content-between{align-content:space-between!important}.align-content-around{align-content:space-around!important}.align-content-stretch{align-content:stretch!important}.align-self-auto{align-self:auto!important}.align-self-start{align-self:flex-start!important}.align-self-end{align-self:flex-end!important}.align-self-center{align-self:center!important}.align-self-baseline{align-self:baseline!important}.align-self-stretch{align-self:stretch!important}.order-first{order:-1!important}.order-0{order:0!important}.order-1{order:1!important}.order-2{order:2!important}.order-3{order:3!important}.order-4{order:4!important}.order-5{order:5!important}.order-last{order:6!important}.m-0{margin:0!important}.m-1{margin:.25rem!important}.m-2{margin:.5rem!important}.m-3{margin:1rem!important}.m-4{margin:1.5rem!important}.m-5{margin:3rem!important}.m-auto{margin:auto!important}.mx-0{margin-right:0!important;margin-left:0!important}.mx-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-3{margin-right:1rem!important;margin-left:1rem!important}.mx-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-5{margin-right:3rem!important;margin-left:3rem!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.my-0{margin-top:0!important;margin-bottom:0!important}.my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-0{margin-top:0!important}.mt-1{margin-top:.25rem!important}.mt-2{margin-top:.5rem!important}.mt-3{margin-top:1rem!important}.mt-4{margin-top:1.5rem!important}.mt-5{margin-top:3rem!important}.mt-auto{margin-top:auto!important}.me-0{margin-right:0!important}.me-1{margin-right:.25rem!important}.me-2{margin-right:.5rem!important}.me-3{margin-right:1rem!important}.me-4{margin-right:1.5rem!important}.me-5{margin-right:3rem!important}.me-auto{margin-right:auto!important}.mb-0{margin-bottom:0!important}.mb-1{margin-bottom:.25rem!important}.mb-2{margin-bottom:.5rem!important}.mb-3{margin-bottom:1rem!important}.mb-4{margin-bottom:1.5rem!important}.mb-5{margin-bottom:3rem!important}.mb-auto{margin-bottom:auto!important}.ms-0{margin-left:0!important}.ms-1{margin-left:.25rem!important}.ms-2{margin-left:.5rem!important}.ms-3{margin-left:1rem!important}.ms-4{margin-left:1.5rem!important}.ms-5{margin-left:3rem!important}.ms-auto{margin-left:auto!important}.p-0{padding:0!important}.p-1{padding:.25rem!important}.p-2{padding:.5rem!important}.p-3{padding:1rem!important}.p-4{padding:1.5rem!important}.p-5{padding:3rem!important}.px-0{padding-right:0!important;padding-left:0!important}.px-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-3{padding-right:1rem!important;padding-left:1rem!important}.px-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-5{padding-right:3rem!important;padding-left:3rem!important}.py-0{padding-top:0!important;padding-bottom:0!important}.py-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-0{padding-top:0!important}.pt-1{padding-top:.25rem!important}.pt-2{padding-top:.5rem!important}.pt-3{padding-top:1rem!important}.pt-4{padding-top:1.5rem!important}.pt-5{padding-top:3rem!important}.pe-0{padding-right:0!important}.pe-1{padding-right:.25rem!important}.pe-2{padding-right:.5rem!important}.pe-3{padding-right:1rem!important}.pe-4{padding-right:1.5rem!important}.pe-5{padding-right:3rem!important}.pb-0{padding-bottom:0!important}.pb-1{padding-bottom:.25rem!important}.pb-2{padding-bottom:.5rem!important}.pb-3{padding-bottom:1rem!important}.pb-4{padding-bottom:1.5rem!important}.pb-5{padding-bottom:3rem!important}.ps-0{padding-left:0!important}.ps-1{padding-left:.25rem!important}.ps-2{padding-left:.5rem!important}.ps-3{padding-left:1rem!important}.ps-4{padding-left:1.5rem!important}.ps-5{padding-left:3rem!important}.gap-0{gap:0!important}.gap-1{gap:.25rem!important}.gap-2{gap:.5rem!important}.gap-3{gap:1rem!important}.gap-4{gap:1.5rem!important}.gap-5{gap:3rem!important}.row-gap-0{row-gap:0!important}.row-gap-1{row-gap:.25rem!important}.row-gap-2{row-gap:.5rem!important}.row-gap-3{row-gap:1rem!important}.row-gap-4{row-gap:1.5rem!important}.row-gap-5{row-gap:3rem!important}.column-gap-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.font-monospace{font-family:var(--bs-font-monospace)!important}.fs-1{font-size:calc(1.375rem + 1.5vw)!important}.fs-2{font-size:calc(1.325rem + .9vw)!important}.fs-3{font-size:calc(1.3rem + .6vw)!important}.fs-4{font-size:calc(1.275rem + .3vw)!important}.fs-5{font-size:1.25rem!important}.fs-6{font-size:1rem!important}.fst-italic{font-style:italic!important}.fst-normal{font-style:normal!important}.fw-lighter{font-weight:lighter!important}.fw-light{font-weight:300!important}.fw-normal{font-weight:400!important}.fw-medium{font-weight:500!important}.fw-semibold{font-weight:600!important}.fw-bold{font-weight:700!important}.fw-bolder{font-weight:bolder!important}.lh-1{line-height:1!important}.lh-sm{line-height:1.25!important}.lh-base{line-height:1.5!important}.lh-lg{line-height:2!important}.text-start{text-align:left!important}.text-end{text-align:right!important}.text-center{text-align:center!important}.text-decoration-none{text-decoration:none!important}.text-decoration-underline{text-decoration:underline!important}.text-decoration-line-through{text-decoration:line-through!important}.text-lowercase{text-transform:lowercase!important}.text-uppercase{text-transform:uppercase!important}.text-capitalize{text-transform:capitalize!important}.text-wrap{white-space:normal!important}.text-nowrap{white-space:nowrap!important}.text-break{word-wrap:break-word!important;word-break:break-word!important}.text-primary{--bs-text-opacity:1;color:rgba(var(--bs-primary-rgb),var(--bs-text-opacity))!important}.text-secondary{--bs-text-opacity:1;color:rgba(var(--bs-secondary-rgb),var(--bs-text-opacity))!important}.text-success{--bs-text-opacity:1;color:rgba(var(--bs-success-rgb),var(--bs-text-opacity))!important}.text-info{--bs-text-opacity:1;color:rgba(var(--bs-info-rgb),var(--bs-text-opacity))!important}.text-warning{--bs-text-opacity:1;color:rgba(var(--bs-warning-rgb),var(--bs-text-opacity))!important}.text-danger{--bs-text-opacity:1;color:rgba(var(--bs-danger-rgb),var(--bs-text-opacity))!important}.text-light{--bs-text-opacity:1;color:rgba(var(--bs-light-rgb),var(--bs-text-opacity))!important}.text-dark{--bs-text-opacity:1;color:rgba(var(--bs-dark-rgb),var(--bs-text-opacity))!important}.text-black{--bs-text-opacity:1;color:rgba(var(--bs-black-rgb),var(--bs-text-opacity))!important}.text-white{--bs-text-opacity:1;color:rgba(var(--bs-white-rgb),var(--bs-text-opacity))!important}.text-body{--bs-text-opacity:1;color:rgba(var(--bs-body-color-rgb),var(--bs-text-opacity))!important}.text-muted{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-black-50{--bs-text-opacity:1;color:rgba(0,0,0,.5)!important}.text-white-50{--bs-text-opacity:1;color:rgba(255,255,255,.5)!important}.text-body-secondary{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-body-tertiary{--bs-text-opacity:1;color:var(--bs-tertiary-color)!important}.text-body-emphasis{--bs-text-opacity:1;color:var(--bs-emphasis-color)!important}.text-reset{--bs-text-opacity:1;color:inherit!important}.text-opacity-25{--bs-text-opacity:0.25}.text-opacity-50{--bs-text-opacity:0.5}.text-opacity-75{--bs-text-opacity:0.75}.text-opacity-100{--bs-text-opacity:1}.text-primary-emphasis{color:var(--bs-primary-text-emphasis)!important}.text-secondary-emphasis{color:var(--bs-secondary-text-emphasis)!important}.text-success-emphasis{color:var(--bs-success-text-emphasis)!important}.text-info-emphasis{color:var(--bs-info-text-emphasis)!important}.text-warning-emphasis{color:var(--bs-warning-text-emphasis)!important}.text-danger-emphasis{color:var(--bs-danger-text-emphasis)!important}.text-light-emphasis{color:var(--bs-light-text-emphasis)!important}.text-dark-emphasis{color:var(--bs-dark-text-emphasis)!important}.link-opacity-10{--bs-link-opacity:0.1}.link-opacity-10-hover:hover{--bs-link-opacity:0.1}.link-opacity-25{--bs-link-opacity:0.25}.link-opacity-25-hover:hover{--bs-link-opacity:0.25}.link-opacity-50{--bs-link-opacity:0.5}.link-opacity-50-hover:hover{--bs-link-opacity:0.5}.link-opacity-75{--bs-link-opacity:0.75}.link-opacity-75-hover:hover{--bs-link-opacity:0.75}.link-opacity-100{--bs-link-opacity:1}.link-opacity-100-hover:hover{--bs-link-opacity:1}.link-offset-1{text-underline-offset:0.125em!important}.link-offset-1-hover:hover{text-underline-offset:0.125em!important}.link-offset-2{text-underline-offset:0.25em!important}.link-offset-2-hover:hover{text-underline-offset:0.25em!important}.link-offset-3{text-underline-offset:0.375em!important}.link-offset-3-hover:hover{text-underline-offset:0.375em!important}.link-underline-primary{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-secondary{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-success{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important}.link-underline-info{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important}.link-underline-warning{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important}.link-underline-danger{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important}.link-underline-light{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important}.link-underline-dark{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important}.link-underline{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-underline-opacity-0{--bs-link-underline-opacity:0}.link-underline-opacity-0-hover:hover{--bs-link-underline-opacity:0}.link-underline-opacity-10{--bs-link-underline-opacity:0.1}.link-underline-opacity-10-hover:hover{--bs-link-underline-opacity:0.1}.link-underline-opacity-25{--bs-link-underline-opacity:0.25}.link-underline-opacity-25-hover:hover{--bs-link-underline-opacity:0.25}.link-underline-opacity-50{--bs-link-underline-opacity:0.5}.link-underline-opacity-50-hover:hover{--bs-link-underline-opacity:0.5}.link-underline-opacity-75{--bs-link-underline-opacity:0.75}.link-underline-opacity-75-hover:hover{--bs-link-underline-opacity:0.75}.link-underline-opacity-100{--bs-link-underline-opacity:1}.link-underline-opacity-100-hover:hover{--bs-link-underline-opacity:1}.bg-primary{--bs-bg-opacity:1;background-color:rgba(var(--bs-primary-rgb),var(--bs-bg-opacity))!important}.bg-secondary{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-rgb),var(--bs-bg-opacity))!important}.bg-success{--bs-bg-opacity:1;background-color:rgba(var(--bs-success-rgb),var(--bs-bg-opacity))!important}.bg-info{--bs-bg-opacity:1;background-color:rgba(var(--bs-info-rgb),var(--bs-bg-opacity))!important}.bg-warning{--bs-bg-opacity:1;background-color:rgba(var(--bs-warning-rgb),var(--bs-bg-opacity))!important}.bg-danger{--bs-bg-opacity:1;background-color:rgba(var(--bs-danger-rgb),var(--bs-bg-opacity))!important}.bg-light{--bs-bg-opacity:1;background-color:rgba(var(--bs-light-rgb),var(--bs-bg-opacity))!important}.bg-dark{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}.bg-black{--bs-bg-opacity:1;background-color:rgba(var(--bs-black-rgb),var(--bs-bg-opacity))!important}.bg-white{--bs-bg-opacity:1;background-color:rgba(var(--bs-white-rgb),var(--bs-bg-opacity))!important}.bg-body{--bs-bg-opacity:1;background-color:rgba(var(--bs-body-bg-rgb),var(--bs-bg-opacity))!important}.bg-transparent{--bs-bg-opacity:1;background-color:transparent!important}.bg-body-secondary{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-bg-rgb),var(--bs-bg-opacity))!important}.bg-body-tertiary{--bs-bg-opacity:1;background-color:rgba(var(--bs-tertiary-bg-rgb),var(--bs-bg-opacity))!important}.bg-opacity-10{--bs-bg-opacity:0.1}.bg-opacity-25{--bs-bg-opacity:0.25}.bg-opacity-50{--bs-bg-opacity:0.5}.bg-opacity-75{--bs-bg-opacity:0.75}.bg-opacity-100{--bs-bg-opacity:1}.bg-primary-subtle{background-color:var(--bs-primary-bg-subtle)!important}.bg-secondary-subtle{background-color:var(--bs-secondary-bg-subtle)!important}.bg-success-subtle{background-color:var(--bs-success-bg-subtle)!important}.bg-info-subtle{background-color:var(--bs-info-bg-subtle)!important}.bg-warning-subtle{background-color:var(--bs-warning-bg-subtle)!important}.bg-danger-subtle{background-color:var(--bs-danger-bg-subtle)!important}.bg-light-subtle{background-color:var(--bs-light-bg-subtle)!important}.bg-dark-subtle{background-color:var(--bs-dark-bg-subtle)!important}.bg-gradient{background-image:var(--bs-gradient)!important}.user-select-all{-webkit-user-select:all!important;-moz-user-select:all!important;user-select:all!important}.user-select-auto{-webkit-user-select:auto!important;-moz-user-select:auto!important;user-select:auto!important}.user-select-none{-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important}.pe-none{pointer-events:none!important}.pe-auto{pointer-events:auto!important}.rounded{border-radius:var(--bs-border-radius)!important}.rounded-0{border-radius:0!important}.rounded-1{border-radius:var(--bs-border-radius-sm)!important}.rounded-2{border-radius:var(--bs-border-radius)!important}.rounded-3{border-radius:var(--bs-border-radius-lg)!important}.rounded-4{border-radius:var(--bs-border-radius-xl)!important}.rounded-5{border-radius:var(--bs-border-radius-xxl)!important}.rounded-circle{border-radius:50%!important}.rounded-pill{border-radius:var(--bs-border-radius-pill)!important}.rounded-top{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-0{border-top-left-radius:0!important;border-top-right-radius:0!important}.rounded-top-1{border-top-left-radius:var(--bs-border-radius-sm)!important;border-top-right-radius:var(--bs-border-radius-sm)!important}.rounded-top-2{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-3{border-top-left-radius:var(--bs-border-radius-lg)!important;border-top-right-radius:var(--bs-border-radius-lg)!important}.rounded-top-4{border-top-left-radius:var(--bs-border-radius-xl)!important;border-top-right-radius:var(--bs-border-radius-xl)!important}.rounded-top-5{border-top-left-radius:var(--bs-border-radius-xxl)!important;border-top-right-radius:var(--bs-border-radius-xxl)!important}.rounded-top-circle{border-top-left-radius:50%!important;border-top-right-radius:50%!important}.rounded-top-pill{border-top-left-radius:var(--bs-border-radius-pill)!important;border-top-right-radius:var(--bs-border-radius-pill)!important}.rounded-end{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-0{border-top-right-radius:0!important;border-bottom-right-radius:0!important}.rounded-end-1{border-top-right-radius:var(--bs-border-radius-sm)!important;border-bottom-right-radius:var(--bs-border-radius-sm)!important}.rounded-end-2{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-3{border-top-right-radius:var(--bs-border-radius-lg)!important;border-bottom-right-radius:var(--bs-border-radius-lg)!important}.rounded-end-4{border-top-right-radius:var(--bs-border-radius-xl)!important;border-bottom-right-radius:var(--bs-border-radius-xl)!important}.rounded-end-5{border-top-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-right-radius:var(--bs-border-radius-xxl)!important}.rounded-end-circle{border-top-right-radius:50%!important;border-bottom-right-radius:50%!important}.rounded-end-pill{border-top-right-radius:var(--bs-border-radius-pill)!important;border-bottom-right-radius:var(--bs-border-radius-pill)!important}.rounded-bottom{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-0{border-bottom-right-radius:0!important;border-bottom-left-radius:0!important}.rounded-bottom-1{border-bottom-right-radius:var(--bs-border-radius-sm)!important;border-bottom-left-radius:var(--bs-border-radius-sm)!important}.rounded-bottom-2{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-3{border-bottom-right-radius:var(--bs-border-radius-lg)!important;border-bottom-left-radius:var(--bs-border-radius-lg)!important}.rounded-bottom-4{border-bottom-right-radius:var(--bs-border-radius-xl)!important;border-bottom-left-radius:var(--bs-border-radius-xl)!important}.rounded-bottom-5{border-bottom-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-left-radius:var(--bs-border-radius-xxl)!important}.rounded-bottom-circle{border-bottom-right-radius:50%!important;border-bottom-left-radius:50%!important}.rounded-bottom-pill{border-bottom-right-radius:var(--bs-border-radius-pill)!important;border-bottom-left-radius:var(--bs-border-radius-pill)!important}.rounded-start{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-0{border-bottom-left-radius:0!important;border-top-left-radius:0!important}.rounded-start-1{border-bottom-left-radius:var(--bs-border-radius-sm)!important;border-top-left-radius:var(--bs-border-radius-sm)!important}.rounded-start-2{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-3{border-bottom-left-radius:var(--bs-border-radius-lg)!important;border-top-left-radius:var(--bs-border-radius-lg)!important}.rounded-start-4{border-bottom-left-radius:var(--bs-border-radius-xl)!important;border-top-left-radius:var(--bs-border-radius-xl)!important}.rounded-start-5{border-bottom-left-radius:var(--bs-border-radius-xxl)!important;border-top-left-radius:var(--bs-border-radius-xxl)!important}.rounded-start-circle{border-bottom-left-radius:50%!important;border-top-left-radius:50%!important}.rounded-start-pill{border-bottom-left-radius:var(--bs-border-radius-pill)!important;border-top-left-radius:var(--bs-border-radius-pill)!important}.visible{visibility:visible!important}.invisible{visibility:hidden!important}.z-n1{z-index:-1!important}.z-0{z-index:0!important}.z-1{z-index:1!important}.z-2{z-index:2!important}.z-3{z-index:3!important}@media (min-width:576px){.float-sm-start{float:left!important}.float-sm-end{float:right!important}.float-sm-none{float:none!important}.object-fit-sm-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-sm-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-sm-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-sm-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-sm-none{-o-object-fit:none!important;object-fit:none!important}.d-sm-inline{display:inline!important}.d-sm-inline-block{display:inline-block!important}.d-sm-block{display:block!important}.d-sm-grid{display:grid!important}.d-sm-inline-grid{display:inline-grid!important}.d-sm-table{display:table!important}.d-sm-table-row{display:table-row!important}.d-sm-table-cell{display:table-cell!important}.d-sm-flex{display:flex!important}.d-sm-inline-flex{display:inline-flex!important}.d-sm-none{display:none!important}.flex-sm-fill{flex:1 1 auto!important}.flex-sm-row{flex-direction:row!important}.flex-sm-column{flex-direction:column!important}.flex-sm-row-reverse{flex-direction:row-reverse!important}.flex-sm-column-reverse{flex-direction:column-reverse!important}.flex-sm-grow-0{flex-grow:0!important}.flex-sm-grow-1{flex-grow:1!important}.flex-sm-shrink-0{flex-shrink:0!important}.flex-sm-shrink-1{flex-shrink:1!important}.flex-sm-wrap{flex-wrap:wrap!important}.flex-sm-nowrap{flex-wrap:nowrap!important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-sm-start{justify-content:flex-start!important}.justify-content-sm-end{justify-content:flex-end!important}.justify-content-sm-center{justify-content:center!important}.justify-content-sm-between{justify-content:space-between!important}.justify-content-sm-around{justify-content:space-around!important}.justify-content-sm-evenly{justify-content:space-evenly!important}.align-items-sm-start{align-items:flex-start!important}.align-items-sm-end{align-items:flex-end!important}.align-items-sm-center{align-items:center!important}.align-items-sm-baseline{align-items:baseline!important}.align-items-sm-stretch{align-items:stretch!important}.align-content-sm-start{align-content:flex-start!important}.align-content-sm-end{align-content:flex-end!important}.align-content-sm-center{align-content:center!important}.align-content-sm-between{align-content:space-between!important}.align-content-sm-around{align-content:space-around!important}.align-content-sm-stretch{align-content:stretch!important}.align-self-sm-auto{align-self:auto!important}.align-self-sm-start{align-self:flex-start!important}.align-self-sm-end{align-self:flex-end!important}.align-self-sm-center{align-self:center!important}.align-self-sm-baseline{align-self:baseline!important}.align-self-sm-stretch{align-self:stretch!important}.order-sm-first{order:-1!important}.order-sm-0{order:0!important}.order-sm-1{order:1!important}.order-sm-2{order:2!important}.order-sm-3{order:3!important}.order-sm-4{order:4!important}.order-sm-5{order:5!important}.order-sm-last{order:6!important}.m-sm-0{margin:0!important}.m-sm-1{margin:.25rem!important}.m-sm-2{margin:.5rem!important}.m-sm-3{margin:1rem!important}.m-sm-4{margin:1.5rem!important}.m-sm-5{margin:3rem!important}.m-sm-auto{margin:auto!important}.mx-sm-0{margin-right:0!important;margin-left:0!important}.mx-sm-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-sm-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-sm-3{margin-right:1rem!important;margin-left:1rem!important}.mx-sm-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-sm-5{margin-right:3rem!important;margin-left:3rem!important}.mx-sm-auto{margin-right:auto!important;margin-left:auto!important}.my-sm-0{margin-top:0!important;margin-bottom:0!important}.my-sm-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-sm-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-sm-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-sm-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-sm-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-sm-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-sm-0{margin-top:0!important}.mt-sm-1{margin-top:.25rem!important}.mt-sm-2{margin-top:.5rem!important}.mt-sm-3{margin-top:1rem!important}.mt-sm-4{margin-top:1.5rem!important}.mt-sm-5{margin-top:3rem!important}.mt-sm-auto{margin-top:auto!important}.me-sm-0{margin-right:0!important}.me-sm-1{margin-right:.25rem!important}.me-sm-2{margin-right:.5rem!important}.me-sm-3{margin-right:1rem!important}.me-sm-4{margin-right:1.5rem!important}.me-sm-5{margin-right:3rem!important}.me-sm-auto{margin-right:auto!important}.mb-sm-0{margin-bottom:0!important}.mb-sm-1{margin-bottom:.25rem!important}.mb-sm-2{margin-bottom:.5rem!important}.mb-sm-3{margin-bottom:1rem!important}.mb-sm-4{margin-bottom:1.5rem!important}.mb-sm-5{margin-bottom:3rem!important}.mb-sm-auto{margin-bottom:auto!important}.ms-sm-0{margin-left:0!important}.ms-sm-1{margin-left:.25rem!important}.ms-sm-2{margin-left:.5rem!important}.ms-sm-3{margin-left:1rem!important}.ms-sm-4{margin-left:1.5rem!important}.ms-sm-5{margin-left:3rem!important}.ms-sm-auto{margin-left:auto!important}.p-sm-0{padding:0!important}.p-sm-1{padding:.25rem!important}.p-sm-2{padding:.5rem!important}.p-sm-3{padding:1rem!important}.p-sm-4{padding:1.5rem!important}.p-sm-5{padding:3rem!important}.px-sm-0{padding-right:0!important;padding-left:0!important}.px-sm-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-sm-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-sm-3{padding-right:1rem!important;padding-left:1rem!important}.px-sm-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-sm-5{padding-right:3rem!important;padding-left:3rem!important}.py-sm-0{padding-top:0!important;padding-bottom:0!important}.py-sm-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-sm-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-sm-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-sm-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-sm-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-sm-0{padding-top:0!important}.pt-sm-1{padding-top:.25rem!important}.pt-sm-2{padding-top:.5rem!important}.pt-sm-3{padding-top:1rem!important}.pt-sm-4{padding-top:1.5rem!important}.pt-sm-5{padding-top:3rem!important}.pe-sm-0{padding-right:0!important}.pe-sm-1{padding-right:.25rem!important}.pe-sm-2{padding-right:.5rem!important}.pe-sm-3{padding-right:1rem!important}.pe-sm-4{padding-right:1.5rem!important}.pe-sm-5{padding-right:3rem!important}.pb-sm-0{padding-bottom:0!important}.pb-sm-1{padding-bottom:.25rem!important}.pb-sm-2{padding-bottom:.5rem!important}.pb-sm-3{padding-bottom:1rem!important}.pb-sm-4{padding-bottom:1.5rem!important}.pb-sm-5{padding-bottom:3rem!important}.ps-sm-0{padding-left:0!important}.ps-sm-1{padding-left:.25rem!important}.ps-sm-2{padding-left:.5rem!important}.ps-sm-3{padding-left:1rem!important}.ps-sm-4{padding-left:1.5rem!important}.ps-sm-5{padding-left:3rem!important}.gap-sm-0{gap:0!important}.gap-sm-1{gap:.25rem!important}.gap-sm-2{gap:.5rem!important}.gap-sm-3{gap:1rem!important}.gap-sm-4{gap:1.5rem!important}.gap-sm-5{gap:3rem!important}.row-gap-sm-0{row-gap:0!important}.row-gap-sm-1{row-gap:.25rem!important}.row-gap-sm-2{row-gap:.5rem!important}.row-gap-sm-3{row-gap:1rem!important}.row-gap-sm-4{row-gap:1.5rem!important}.row-gap-sm-5{row-gap:3rem!important}.column-gap-sm-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-sm-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-sm-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-sm-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-sm-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-sm-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-sm-start{text-align:left!important}.text-sm-end{text-align:right!important}.text-sm-center{text-align:center!important}}@media (min-width:768px){.float-md-start{float:left!important}.float-md-end{float:right!important}.float-md-none{float:none!important}.object-fit-md-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-md-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-md-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-md-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-md-none{-o-object-fit:none!important;object-fit:none!important}.d-md-inline{display:inline!important}.d-md-inline-block{display:inline-block!important}.d-md-block{display:block!important}.d-md-grid{display:grid!important}.d-md-inline-grid{display:inline-grid!important}.d-md-table{display:table!important}.d-md-table-row{display:table-row!important}.d-md-table-cell{display:table-cell!important}.d-md-flex{display:flex!important}.d-md-inline-flex{display:inline-flex!important}.d-md-none{display:none!important}.flex-md-fill{flex:1 1 auto!important}.flex-md-row{flex-direction:row!important}.flex-md-column{flex-direction:column!important}.flex-md-row-reverse{flex-direction:row-reverse!important}.flex-md-column-reverse{flex-direction:column-reverse!important}.flex-md-grow-0{flex-grow:0!important}.flex-md-grow-1{flex-grow:1!important}.flex-md-shrink-0{flex-shrink:0!important}.flex-md-shrink-1{flex-shrink:1!important}.flex-md-wrap{flex-wrap:wrap!important}.flex-md-nowrap{flex-wrap:nowrap!important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-md-start{justify-content:flex-start!important}.justify-content-md-end{justify-content:flex-end!important}.justify-content-md-center{justify-content:center!important}.justify-content-md-between{justify-content:space-between!important}.justify-content-md-around{justify-content:space-around!important}.justify-content-md-evenly{justify-content:space-evenly!important}.align-items-md-start{align-items:flex-start!important}.align-items-md-end{align-items:flex-end!important}.align-items-md-center{align-items:center!important}.align-items-md-baseline{align-items:baseline!important}.align-items-md-stretch{align-items:stretch!important}.align-content-md-start{align-content:flex-start!important}.align-content-md-end{align-content:flex-end!important}.align-content-md-center{align-content:center!important}.align-content-md-between{align-content:space-between!important}.align-content-md-around{align-content:space-around!important}.align-content-md-stretch{align-content:stretch!important}.align-self-md-auto{align-self:auto!important}.align-self-md-start{align-self:flex-start!important}.align-self-md-end{align-self:flex-end!important}.align-self-md-center{align-self:center!important}.align-self-md-baseline{align-self:baseline!important}.align-self-md-stretch{align-self:stretch!important}.order-md-first{order:-1!important}.order-md-0{order:0!important}.order-md-1{order:1!important}.order-md-2{order:2!important}.order-md-3{order:3!important}.order-md-4{order:4!important}.order-md-5{order:5!important}.order-md-last{order:6!important}.m-md-0{margin:0!important}.m-md-1{margin:.25rem!important}.m-md-2{margin:.5rem!important}.m-md-3{margin:1rem!important}.m-md-4{margin:1.5rem!important}.m-md-5{margin:3rem!important}.m-md-auto{margin:auto!important}.mx-md-0{margin-right:0!important;margin-left:0!important}.mx-md-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-md-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-md-3{margin-right:1rem!important;margin-left:1rem!important}.mx-md-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-md-5{margin-right:3rem!important;margin-left:3rem!important}.mx-md-auto{margin-right:auto!important;margin-left:auto!important}.my-md-0{margin-top:0!important;margin-bottom:0!important}.my-md-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-md-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-md-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-md-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-md-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-md-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-md-0{margin-top:0!important}.mt-md-1{margin-top:.25rem!important}.mt-md-2{margin-top:.5rem!important}.mt-md-3{margin-top:1rem!important}.mt-md-4{margin-top:1.5rem!important}.mt-md-5{margin-top:3rem!important}.mt-md-auto{margin-top:auto!important}.me-md-0{margin-right:0!important}.me-md-1{margin-right:.25rem!important}.me-md-2{margin-right:.5rem!important}.me-md-3{margin-right:1rem!important}.me-md-4{margin-right:1.5rem!important}.me-md-5{margin-right:3rem!important}.me-md-auto{margin-right:auto!important}.mb-md-0{margin-bottom:0!important}.mb-md-1{margin-bottom:.25rem!important}.mb-md-2{margin-bottom:.5rem!important}.mb-md-3{margin-bottom:1rem!important}.mb-md-4{margin-bottom:1.5rem!important}.mb-md-5{margin-bottom:3rem!important}.mb-md-auto{margin-bottom:auto!important}.ms-md-0{margin-left:0!important}.ms-md-1{margin-left:.25rem!important}.ms-md-2{margin-left:.5rem!important}.ms-md-3{margin-left:1rem!important}.ms-md-4{margin-left:1.5rem!important}.ms-md-5{margin-left:3rem!important}.ms-md-auto{margin-left:auto!important}.p-md-0{padding:0!important}.p-md-1{padding:.25rem!important}.p-md-2{padding:.5rem!important}.p-md-3{padding:1rem!important}.p-md-4{padding:1.5rem!important}.p-md-5{padding:3rem!important}.px-md-0{padding-right:0!important;padding-left:0!important}.px-md-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-md-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-md-3{padding-right:1rem!important;padding-left:1rem!important}.px-md-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-md-5{padding-right:3rem!important;padding-left:3rem!important}.py-md-0{padding-top:0!important;padding-bottom:0!important}.py-md-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-md-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-md-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-md-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-md-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-md-0{padding-top:0!important}.pt-md-1{padding-top:.25rem!important}.pt-md-2{padding-top:.5rem!important}.pt-md-3{padding-top:1rem!important}.pt-md-4{padding-top:1.5rem!important}.pt-md-5{padding-top:3rem!important}.pe-md-0{padding-right:0!important}.pe-md-1{padding-right:.25rem!important}.pe-md-2{padding-right:.5rem!important}.pe-md-3{padding-right:1rem!important}.pe-md-4{padding-right:1.5rem!important}.pe-md-5{padding-right:3rem!important}.pb-md-0{padding-bottom:0!important}.pb-md-1{padding-bottom:.25rem!important}.pb-md-2{padding-bottom:.5rem!important}.pb-md-3{padding-bottom:1rem!important}.pb-md-4{padding-bottom:1.5rem!important}.pb-md-5{padding-bottom:3rem!important}.ps-md-0{padding-left:0!important}.ps-md-1{padding-left:.25rem!important}.ps-md-2{padding-left:.5rem!important}.ps-md-3{padding-left:1rem!important}.ps-md-4{padding-left:1.5rem!important}.ps-md-5{padding-left:3rem!important}.gap-md-0{gap:0!important}.gap-md-1{gap:.25rem!important}.gap-md-2{gap:.5rem!important}.gap-md-3{gap:1rem!important}.gap-md-4{gap:1.5rem!important}.gap-md-5{gap:3rem!important}.row-gap-md-0{row-gap:0!important}.row-gap-md-1{row-gap:.25rem!important}.row-gap-md-2{row-gap:.5rem!important}.row-gap-md-3{row-gap:1rem!important}.row-gap-md-4{row-gap:1.5rem!important}.row-gap-md-5{row-gap:3rem!important}.column-gap-md-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-md-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-md-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-md-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-md-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-md-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-md-start{text-align:left!important}.text-md-end{text-align:right!important}.text-md-center{text-align:center!important}}@media (min-width:992px){.float-lg-start{float:left!important}.float-lg-end{float:right!important}.float-lg-none{float:none!important}.object-fit-lg-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-lg-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-lg-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-lg-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-lg-none{-o-object-fit:none!important;object-fit:none!important}.d-lg-inline{display:inline!important}.d-lg-inline-block{display:inline-block!important}.d-lg-block{display:block!important}.d-lg-grid{display:grid!important}.d-lg-inline-grid{display:inline-grid!important}.d-lg-table{display:table!important}.d-lg-table-row{display:table-row!important}.d-lg-table-cell{display:table-cell!important}.d-lg-flex{display:flex!important}.d-lg-inline-flex{display:inline-flex!important}.d-lg-none{display:none!important}.flex-lg-fill{flex:1 1 auto!important}.flex-lg-row{flex-direction:row!important}.flex-lg-column{flex-direction:column!important}.flex-lg-row-reverse{flex-direction:row-reverse!important}.flex-lg-column-reverse{flex-direction:column-reverse!important}.flex-lg-grow-0{flex-grow:0!important}.flex-lg-grow-1{flex-grow:1!important}.flex-lg-shrink-0{flex-shrink:0!important}.flex-lg-shrink-1{flex-shrink:1!important}.flex-lg-wrap{flex-wrap:wrap!important}.flex-lg-nowrap{flex-wrap:nowrap!important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-lg-start{justify-content:flex-start!important}.justify-content-lg-end{justify-content:flex-end!important}.justify-content-lg-center{justify-content:center!important}.justify-content-lg-between{justify-content:space-between!important}.justify-content-lg-around{justify-content:space-around!important}.justify-content-lg-evenly{justify-content:space-evenly!important}.align-items-lg-start{align-items:flex-start!important}.align-items-lg-end{align-items:flex-end!important}.align-items-lg-center{align-items:center!important}.align-items-lg-baseline{align-items:baseline!important}.align-items-lg-stretch{align-items:stretch!important}.align-content-lg-start{align-content:flex-start!important}.align-content-lg-end{align-content:flex-end!important}.align-content-lg-center{align-content:center!important}.align-content-lg-between{align-content:space-between!important}.align-content-lg-around{align-content:space-around!important}.align-content-lg-stretch{align-content:stretch!important}.align-self-lg-auto{align-self:auto!important}.align-self-lg-start{align-self:flex-start!important}.align-self-lg-end{align-self:flex-end!important}.align-self-lg-center{align-self:center!important}.align-self-lg-baseline{align-self:baseline!important}.align-self-lg-stretch{align-self:stretch!important}.order-lg-first{order:-1!important}.order-lg-0{order:0!important}.order-lg-1{order:1!important}.order-lg-2{order:2!important}.order-lg-3{order:3!important}.order-lg-4{order:4!important}.order-lg-5{order:5!important}.order-lg-last{order:6!important}.m-lg-0{margin:0!important}.m-lg-1{margin:.25rem!important}.m-lg-2{margin:.5rem!important}.m-lg-3{margin:1rem!important}.m-lg-4{margin:1.5rem!important}.m-lg-5{margin:3rem!important}.m-lg-auto{margin:auto!important}.mx-lg-0{margin-right:0!important;margin-left:0!important}.mx-lg-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-lg-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-lg-3{margin-right:1rem!important;margin-left:1rem!important}.mx-lg-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-lg-5{margin-right:3rem!important;margin-left:3rem!important}.mx-lg-auto{margin-right:auto!important;margin-left:auto!important}.my-lg-0{margin-top:0!important;margin-bottom:0!important}.my-lg-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-lg-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-lg-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-lg-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-lg-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-lg-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-lg-0{margin-top:0!important}.mt-lg-1{margin-top:.25rem!important}.mt-lg-2{margin-top:.5rem!important}.mt-lg-3{margin-top:1rem!important}.mt-lg-4{margin-top:1.5rem!important}.mt-lg-5{margin-top:3rem!important}.mt-lg-auto{margin-top:auto!important}.me-lg-0{margin-right:0!important}.me-lg-1{margin-right:.25rem!important}.me-lg-2{margin-right:.5rem!important}.me-lg-3{margin-right:1rem!important}.me-lg-4{margin-right:1.5rem!important}.me-lg-5{margin-right:3rem!important}.me-lg-auto{margin-right:auto!important}.mb-lg-0{margin-bottom:0!important}.mb-lg-1{margin-bottom:.25rem!important}.mb-lg-2{margin-bottom:.5rem!important}.mb-lg-3{margin-bottom:1rem!important}.mb-lg-4{margin-bottom:1.5rem!important}.mb-lg-5{margin-bottom:3rem!important}.mb-lg-auto{margin-bottom:auto!important}.ms-lg-0{margin-left:0!important}.ms-lg-1{margin-left:.25rem!important}.ms-lg-2{margin-left:.5rem!important}.ms-lg-3{margin-left:1rem!important}.ms-lg-4{margin-left:1.5rem!important}.ms-lg-5{margin-left:3rem!important}.ms-lg-auto{margin-left:auto!important}.p-lg-0{padding:0!important}.p-lg-1{padding:.25rem!important}.p-lg-2{padding:.5rem!important}.p-lg-3{padding:1rem!important}.p-lg-4{padding:1.5rem!important}.p-lg-5{padding:3rem!important}.px-lg-0{padding-right:0!important;padding-left:0!important}.px-lg-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-lg-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-lg-3{padding-right:1rem!important;padding-left:1rem!important}.px-lg-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-lg-5{padding-right:3rem!important;padding-left:3rem!important}.py-lg-0{padding-top:0!important;padding-bottom:0!important}.py-lg-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-lg-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-lg-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-lg-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-lg-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-lg-0{padding-top:0!important}.pt-lg-1{padding-top:.25rem!important}.pt-lg-2{padding-top:.5rem!important}.pt-lg-3{padding-top:1rem!important}.pt-lg-4{padding-top:1.5rem!important}.pt-lg-5{padding-top:3rem!important}.pe-lg-0{padding-right:0!important}.pe-lg-1{padding-right:.25rem!important}.pe-lg-2{padding-right:.5rem!important}.pe-lg-3{padding-right:1rem!important}.pe-lg-4{padding-right:1.5rem!important}.pe-lg-5{padding-right:3rem!important}.pb-lg-0{padding-bottom:0!important}.pb-lg-1{padding-bottom:.25rem!important}.pb-lg-2{padding-bottom:.5rem!important}.pb-lg-3{padding-bottom:1rem!important}.pb-lg-4{padding-bottom:1.5rem!important}.pb-lg-5{padding-bottom:3rem!important}.ps-lg-0{padding-left:0!important}.ps-lg-1{padding-left:.25rem!important}.ps-lg-2{padding-left:.5rem!important}.ps-lg-3{padding-left:1rem!important}.ps-lg-4{padding-left:1.5rem!important}.ps-lg-5{padding-left:3rem!important}.gap-lg-0{gap:0!important}.gap-lg-1{gap:.25rem!important}.gap-lg-2{gap:.5rem!important}.gap-lg-3{gap:1rem!important}.gap-lg-4{gap:1.5rem!important}.gap-lg-5{gap:3rem!important}.row-gap-lg-0{row-gap:0!important}.row-gap-lg-1{row-gap:.25rem!important}.row-gap-lg-2{row-gap:.5rem!important}.row-gap-lg-3{row-gap:1rem!important}.row-gap-lg-4{row-gap:1.5rem!important}.row-gap-lg-5{row-gap:3rem!important}.column-gap-lg-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-lg-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-lg-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-lg-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-lg-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-lg-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-lg-start{text-align:left!important}.text-lg-end{text-align:right!important}.text-lg-center{text-align:center!important}}@media (min-width:1200px){.float-xl-start{float:left!important}.float-xl-end{float:right!important}.float-xl-none{float:none!important}.object-fit-xl-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-xl-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-xl-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-xl-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-xl-none{-o-object-fit:none!important;object-fit:none!important}.d-xl-inline{display:inline!important}.d-xl-inline-block{display:inline-block!important}.d-xl-block{display:block!important}.d-xl-grid{display:grid!important}.d-xl-inline-grid{display:inline-grid!important}.d-xl-table{display:table!important}.d-xl-table-row{display:table-row!important}.d-xl-table-cell{display:table-cell!important}.d-xl-flex{display:flex!important}.d-xl-inline-flex{display:inline-flex!important}.d-xl-none{display:none!important}.flex-xl-fill{flex:1 1 auto!important}.flex-xl-row{flex-direction:row!important}.flex-xl-column{flex-direction:column!important}.flex-xl-row-reverse{flex-direction:row-reverse!important}.flex-xl-column-reverse{flex-direction:column-reverse!important}.flex-xl-grow-0{flex-grow:0!important}.flex-xl-grow-1{flex-grow:1!important}.flex-xl-shrink-0{flex-shrink:0!important}.flex-xl-shrink-1{flex-shrink:1!important}.flex-xl-wrap{flex-wrap:wrap!important}.flex-xl-nowrap{flex-wrap:nowrap!important}.flex-xl-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xl-start{justify-content:flex-start!important}.justify-content-xl-end{justify-content:flex-end!important}.justify-content-xl-center{justify-content:center!important}.justify-content-xl-between{justify-content:space-between!important}.justify-content-xl-around{justify-content:space-around!important}.justify-content-xl-evenly{justify-content:space-evenly!important}.align-items-xl-start{align-items:flex-start!important}.align-items-xl-end{align-items:flex-end!important}.align-items-xl-center{align-items:center!important}.align-items-xl-baseline{align-items:baseline!important}.align-items-xl-stretch{align-items:stretch!important}.align-content-xl-start{align-content:flex-start!important}.align-content-xl-end{align-content:flex-end!important}.align-content-xl-center{align-content:center!important}.align-content-xl-between{align-content:space-between!important}.align-content-xl-around{align-content:space-around!important}.align-content-xl-stretch{align-content:stretch!important}.align-self-xl-auto{align-self:auto!important}.align-self-xl-start{align-self:flex-start!important}.align-self-xl-end{align-self:flex-end!important}.align-self-xl-center{align-self:center!important}.align-self-xl-baseline{align-self:baseline!important}.align-self-xl-stretch{align-self:stretch!important}.order-xl-first{order:-1!important}.order-xl-0{order:0!important}.order-xl-1{order:1!important}.order-xl-2{order:2!important}.order-xl-3{order:3!important}.order-xl-4{order:4!important}.order-xl-5{order:5!important}.order-xl-last{order:6!important}.m-xl-0{margin:0!important}.m-xl-1{margin:.25rem!important}.m-xl-2{margin:.5rem!important}.m-xl-3{margin:1rem!important}.m-xl-4{margin:1.5rem!important}.m-xl-5{margin:3rem!important}.m-xl-auto{margin:auto!important}.mx-xl-0{margin-right:0!important;margin-left:0!important}.mx-xl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xl-auto{margin-right:auto!important;margin-left:auto!important}.my-xl-0{margin-top:0!important;margin-bottom:0!important}.my-xl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xl-0{margin-top:0!important}.mt-xl-1{margin-top:.25rem!important}.mt-xl-2{margin-top:.5rem!important}.mt-xl-3{margin-top:1rem!important}.mt-xl-4{margin-top:1.5rem!important}.mt-xl-5{margin-top:3rem!important}.mt-xl-auto{margin-top:auto!important}.me-xl-0{margin-right:0!important}.me-xl-1{margin-right:.25rem!important}.me-xl-2{margin-right:.5rem!important}.me-xl-3{margin-right:1rem!important}.me-xl-4{margin-right:1.5rem!important}.me-xl-5{margin-right:3rem!important}.me-xl-auto{margin-right:auto!important}.mb-xl-0{margin-bottom:0!important}.mb-xl-1{margin-bottom:.25rem!important}.mb-xl-2{margin-bottom:.5rem!important}.mb-xl-3{margin-bottom:1rem!important}.mb-xl-4{margin-bottom:1.5rem!important}.mb-xl-5{margin-bottom:3rem!important}.mb-xl-auto{margin-bottom:auto!important}.ms-xl-0{margin-left:0!important}.ms-xl-1{margin-left:.25rem!important}.ms-xl-2{margin-left:.5rem!important}.ms-xl-3{margin-left:1rem!important}.ms-xl-4{margin-left:1.5rem!important}.ms-xl-5{margin-left:3rem!important}.ms-xl-auto{margin-left:auto!important}.p-xl-0{padding:0!important}.p-xl-1{padding:.25rem!important}.p-xl-2{padding:.5rem!important}.p-xl-3{padding:1rem!important}.p-xl-4{padding:1.5rem!important}.p-xl-5{padding:3rem!important}.px-xl-0{padding-right:0!important;padding-left:0!important}.px-xl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xl-0{padding-top:0!important;padding-bottom:0!important}.py-xl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xl-0{padding-top:0!important}.pt-xl-1{padding-top:.25rem!important}.pt-xl-2{padding-top:.5rem!important}.pt-xl-3{padding-top:1rem!important}.pt-xl-4{padding-top:1.5rem!important}.pt-xl-5{padding-top:3rem!important}.pe-xl-0{padding-right:0!important}.pe-xl-1{padding-right:.25rem!important}.pe-xl-2{padding-right:.5rem!important}.pe-xl-3{padding-right:1rem!important}.pe-xl-4{padding-right:1.5rem!important}.pe-xl-5{padding-right:3rem!important}.pb-xl-0{padding-bottom:0!important}.pb-xl-1{padding-bottom:.25rem!important}.pb-xl-2{padding-bottom:.5rem!important}.pb-xl-3{padding-bottom:1rem!important}.pb-xl-4{padding-bottom:1.5rem!important}.pb-xl-5{padding-bottom:3rem!important}.ps-xl-0{padding-left:0!important}.ps-xl-1{padding-left:.25rem!important}.ps-xl-2{padding-left:.5rem!important}.ps-xl-3{padding-left:1rem!important}.ps-xl-4{padding-left:1.5rem!important}.ps-xl-5{padding-left:3rem!important}.gap-xl-0{gap:0!important}.gap-xl-1{gap:.25rem!important}.gap-xl-2{gap:.5rem!important}.gap-xl-3{gap:1rem!important}.gap-xl-4{gap:1.5rem!important}.gap-xl-5{gap:3rem!important}.row-gap-xl-0{row-gap:0!important}.row-gap-xl-1{row-gap:.25rem!important}.row-gap-xl-2{row-gap:.5rem!important}.row-gap-xl-3{row-gap:1rem!important}.row-gap-xl-4{row-gap:1.5rem!important}.row-gap-xl-5{row-gap:3rem!important}.column-gap-xl-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-xl-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-xl-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-xl-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-xl-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-xl-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-xl-start{text-align:left!important}.text-xl-end{text-align:right!important}.text-xl-center{text-align:center!important}}@media (min-width:1400px){.float-xxl-start{float:left!important}.float-xxl-end{float:right!important}.float-xxl-none{float:none!important}.object-fit-xxl-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-xxl-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-xxl-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-xxl-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-xxl-none{-o-object-fit:none!important;object-fit:none!important}.d-xxl-inline{display:inline!important}.d-xxl-inline-block{display:inline-block!important}.d-xxl-block{display:block!important}.d-xxl-grid{display:grid!important}.d-xxl-inline-grid{display:inline-grid!important}.d-xxl-table{display:table!important}.d-xxl-table-row{display:table-row!important}.d-xxl-table-cell{display:table-cell!important}.d-xxl-flex{display:flex!important}.d-xxl-inline-flex{display:inline-flex!important}.d-xxl-none{display:none!important}.flex-xxl-fill{flex:1 1 auto!important}.flex-xxl-row{flex-direction:row!important}.flex-xxl-column{flex-direction:column!important}.flex-xxl-row-reverse{flex-direction:row-reverse!important}.flex-xxl-column-reverse{flex-direction:column-reverse!important}.flex-xxl-grow-0{flex-grow:0!important}.flex-xxl-grow-1{flex-grow:1!important}.flex-xxl-shrink-0{flex-shrink:0!important}.flex-xxl-shrink-1{flex-shrink:1!important}.flex-xxl-wrap{flex-wrap:wrap!important}.flex-xxl-nowrap{flex-wrap:nowrap!important}.flex-xxl-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xxl-start{justify-content:flex-start!important}.justify-content-xxl-end{justify-content:flex-end!important}.justify-content-xxl-center{justify-content:center!important}.justify-content-xxl-between{justify-content:space-between!important}.justify-content-xxl-around{justify-content:space-around!important}.justify-content-xxl-evenly{justify-content:space-evenly!important}.align-items-xxl-start{align-items:flex-start!important}.align-items-xxl-end{align-items:flex-end!important}.align-items-xxl-center{align-items:center!important}.align-items-xxl-baseline{align-items:baseline!important}.align-items-xxl-stretch{align-items:stretch!important}.align-content-xxl-start{align-content:flex-start!important}.align-content-xxl-end{align-content:flex-end!important}.align-content-xxl-center{align-content:center!important}.align-content-xxl-between{align-content:space-between!important}.align-content-xxl-around{align-content:space-around!important}.align-content-xxl-stretch{align-content:stretch!important}.align-self-xxl-auto{align-self:auto!important}.align-self-xxl-start{align-self:flex-start!important}.align-self-xxl-end{align-self:flex-end!important}.align-self-xxl-center{align-self:center!important}.align-self-xxl-baseline{align-self:baseline!important}.align-self-xxl-stretch{align-self:stretch!important}.order-xxl-first{order:-1!important}.order-xxl-0{order:0!important}.order-xxl-1{order:1!important}.order-xxl-2{order:2!important}.order-xxl-3{order:3!important}.order-xxl-4{order:4!important}.order-xxl-5{order:5!important}.order-xxl-last{order:6!important}.m-xxl-0{margin:0!important}.m-xxl-1{margin:.25rem!important}.m-xxl-2{margin:.5rem!important}.m-xxl-3{margin:1rem!important}.m-xxl-4{margin:1.5rem!important}.m-xxl-5{margin:3rem!important}.m-xxl-auto{margin:auto!important}.mx-xxl-0{margin-right:0!important;margin-left:0!important}.mx-xxl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xxl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xxl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xxl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xxl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xxl-auto{margin-right:auto!important;margin-left:auto!important}.my-xxl-0{margin-top:0!important;margin-bottom:0!important}.my-xxl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xxl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xxl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xxl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xxl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xxl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xxl-0{margin-top:0!important}.mt-xxl-1{margin-top:.25rem!important}.mt-xxl-2{margin-top:.5rem!important}.mt-xxl-3{margin-top:1rem!important}.mt-xxl-4{margin-top:1.5rem!important}.mt-xxl-5{margin-top:3rem!important}.mt-xxl-auto{margin-top:auto!important}.me-xxl-0{margin-right:0!important}.me-xxl-1{margin-right:.25rem!important}.me-xxl-2{margin-right:.5rem!important}.me-xxl-3{margin-right:1rem!important}.me-xxl-4{margin-right:1.5rem!important}.me-xxl-5{margin-right:3rem!important}.me-xxl-auto{margin-right:auto!important}.mb-xxl-0{margin-bottom:0!important}.mb-xxl-1{margin-bottom:.25rem!important}.mb-xxl-2{margin-bottom:.5rem!important}.mb-xxl-3{margin-bottom:1rem!important}.mb-xxl-4{margin-bottom:1.5rem!important}.mb-xxl-5{margin-bottom:3rem!important}.mb-xxl-auto{margin-bottom:auto!important}.ms-xxl-0{margin-left:0!important}.ms-xxl-1{margin-left:.25rem!important}.ms-xxl-2{margin-left:.5rem!important}.ms-xxl-3{margin-left:1rem!important}.ms-xxl-4{margin-left:1.5rem!important}.ms-xxl-5{margin-left:3rem!important}.ms-xxl-auto{margin-left:auto!important}.p-xxl-0{padding:0!important}.p-xxl-1{padding:.25rem!important}.p-xxl-2{padding:.5rem!important}.p-xxl-3{padding:1rem!important}.p-xxl-4{padding:1.5rem!important}.p-xxl-5{padding:3rem!important}.px-xxl-0{padding-right:0!important;padding-left:0!important}.px-xxl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xxl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xxl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xxl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xxl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xxl-0{padding-top:0!important;padding-bottom:0!important}.py-xxl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xxl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xxl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xxl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xxl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xxl-0{padding-top:0!important}.pt-xxl-1{padding-top:.25rem!important}.pt-xxl-2{padding-top:.5rem!important}.pt-xxl-3{padding-top:1rem!important}.pt-xxl-4{padding-top:1.5rem!important}.pt-xxl-5{padding-top:3rem!important}.pe-xxl-0{padding-right:0!important}.pe-xxl-1{padding-right:.25rem!important}.pe-xxl-2{padding-right:.5rem!important}.pe-xxl-3{padding-right:1rem!important}.pe-xxl-4{padding-right:1.5rem!important}.pe-xxl-5{padding-right:3rem!important}.pb-xxl-0{padding-bottom:0!important}.pb-xxl-1{padding-bottom:.25rem!important}.pb-xxl-2{padding-bottom:.5rem!important}.pb-xxl-3{padding-bottom:1rem!important}.pb-xxl-4{padding-bottom:1.5rem!important}.pb-xxl-5{padding-bottom:3rem!important}.ps-xxl-0{padding-left:0!important}.ps-xxl-1{padding-left:.25rem!important}.ps-xxl-2{padding-left:.5rem!important}.ps-xxl-3{padding-left:1rem!important}.ps-xxl-4{padding-left:1.5rem!important}.ps-xxl-5{padding-left:3rem!important}.gap-xxl-0{gap:0!important}.gap-xxl-1{gap:.25rem!important}.gap-xxl-2{gap:.5rem!important}.gap-xxl-3{gap:1rem!important}.gap-xxl-4{gap:1.5rem!important}.gap-xxl-5{gap:3rem!important}.row-gap-xxl-0{row-gap:0!important}.row-gap-xxl-1{row-gap:.25rem!important}.row-gap-xxl-2{row-gap:.5rem!important}.row-gap-xxl-3{row-gap:1rem!important}.row-gap-xxl-4{row-gap:1.5rem!important}.row-gap-xxl-5{row-gap:3rem!important}.column-gap-xxl-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-xxl-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-xxl-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-xxl-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-xxl-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-xxl-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-xxl-start{text-align:left!important}.text-xxl-end{text-align:right!important}.text-xxl-center{text-align:center!important}}@media (min-width:1200px){.fs-1{font-size:2.5rem!important}.fs-2{font-size:2rem!important}.fs-3{font-size:1.75rem!important}.fs-4{font-size:1.5rem!important}}@media print{.d-print-inline{display:inline!important}.d-print-inline-block{display:inline-block!important}.d-print-block{display:block!important}.d-print-grid{display:grid!important}.d-print-inline-grid{display:inline-grid!important}.d-print-table{display:table!important}.d-print-table-row{display:table-row!important}.d-print-table-cell{display:table-cell!important}.d-print-flex{display:flex!important}.d-print-inline-flex{display:inline-flex!important}.d-print-none{display:none!important}}",""]);const a=i},46:(t,e,r)=>{r.d(e,{Z:()=>a});var n=r(645),i=r.n(n)()((function(t){return t[1]}));i.push([t.id,"#headerLogo{\r\n    background-color: #D9D9D9;\r\n}\r\n\r\n\r\n#imgHeader{\r\n \r\n    margin-left: 42%;\r\n}\r\n\r\n\r\n#inscription{\r\n   \r\n    padding: 10px 30px;\r\n    border-radius: 20px;\r\n    background-color: #343A40;\r\n    color: #fff;\r\n    border: none;\r\n}\r\n\r\n#connexion{\r\n   margin-left: 17%;\r\n    padding: 10px 20px;\r\n    border-radius: 20px;\r\n    background-color: #D9D9D9;\r\n    color: #343A40;\r\n    border-color: #343A40 ;\r\n}\r\n\r\n#connexionForm{\r\n  padding-bottom: 20%;\r\n}\r\n\r\n/* css slider \r\n    background-image: linear-gradient(to right, #2B2F3A, #0D0E12);\r\n*/\r\n\r\n.slider{\r\n    position: relative;\r\n    width: 100%;\r\n    height: 60vh;\r\n    overflow: hidden;\r\n    background-color: #c697519d;\r\n}\r\n\r\n.title{\r\n    position: absolute;\r\n    top:4%;\r\n    right: 43%;\r\n    text-align: right;\r\n    color: #343A40;\r\n    font-size: 40px;\r\n    width: 40%;\r\n    font-family: 'Julius Sans One';\r\n}\r\n\r\n.title3{\r\n    margin-left: 43%;\r\n    color: #343A40;\r\n    font-size: 40px;\r\n    width: 40%;\r\n    font-family: 'Julius Sans One';\r\n}\r\n.title4{\r\n  margin-left: 40%;\r\n  color: #343A40;\r\n  font-size: 40px;\r\n  width: 40%;\r\n  font-family: 'Julius Sans One';\r\n  padding-top: 2%;\r\n}\r\n\r\n.images{\r\n    position: relative;\r\n    width: 200%;\r\n    height: 300px;\r\n    top: 16%;\r\n    left: 0px;\r\n}\r\n\r\n.images .item{\r\n   position: absolute;\r\n   left: -15%;\r\n}\r\n\r\n.images .item img{\r\n    height: 250px;\r\n}\r\n\r\n.content{\r\n    position: relative;\r\n    \r\n}\r\n.content h1{\r\n    color: white;\r\n    font-size: x-large;\r\n}\r\n.content button{\r\n    margin-top: 10px;\r\n    padding: 10px 30px;\r\n    border-radius: 20px;\r\n    background-color: #343A40;\r\n    color: #fff;\r\n    border: none;\r\n    \r\n}\r\n.content .item{\r\n    display: none;\r\n}\r\n.content .item.active{\r\n    display: inline-block;\r\n    margin-top: 5%;\r\n    margin-left: 43%;\r\n\r\n}\r\n\r\n\r\n\r\n@keyframes showContent{\r\n    from{\r\n        opacity: 0;\r\n        transform: translateX(-300px);\r\n    }to{\r\n        opacity: 1;\r\n        transform: translateX(0px);\r\n    }\r\n}\r\n\r\n@keyframes showImage{\r\n  from{\r\n      opacity: 0;\r\n      transform: translateX(-300px);\r\n  }to{\r\n      opacity: 1;\r\n      transform: translateX(850px);\r\n  }\r\n}\r\n\r\n.content .item.active h1{\r\n    opacity: 0;\r\n    animation: showContent 0.5s ease-in-out 1 forwards;\r\n}\r\n\r\n.content .item.active button{\r\n    opacity: 0;\r\n    animation: showContent 0.5s 0.6s ease-in-out 1 forwards;\r\n}\r\n\r\n.itemImg{\r\n  opacity: 0;\r\n  animation-name: showImage;\r\n  animation-duration: 2s;\r\n  animation-delay: 1s;\r\n  animation-iteration-count: 2;\r\n  animation-direction: alternate;\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#prev,\r\n#next{\r\n    position: absolute;\r\n    border: none;\r\n    top: 50%;\r\n    left: 250px;\r\n    font-size: 100px;\r\n    background-color: transparent;\r\n    color: #fff;\r\n    font-weight: bold;\r\n    opacity: 0.3\r\n}\r\n#next{\r\n    left: unset;\r\n    right: 250px;\r\n}\r\n#next:hover,\r\n#prev:hover{\r\n    opacity: 1\r\n}\r\n\r\n.hr-lines:after{\r\n    content:\" \";\r\n    height: 4px;\r\n    width: 260px;\r\n    background: #C69751;\r\n    display: block;\r\n    position: relative;\r\n\r\n   margin-left: 20px;\r\n  }\r\n  .hr-lines::before{\r\n    content:\" \";\r\n    height: 4px;\r\n    width: 260px;\r\n    background: #C69751;\r\n    display: block;\r\n    position: relative;\r\n    \r\n    margin-left: 20px;\r\n  }\r\n\r\n  #bloc3{\r\n    position: relative;\r\n    margin-top: 30px;\r\n    margin-bottom: 10%;\r\n\r\n  }\r\n\r\n  #bloc4{\r\n    position: relative;\r\n    margin-top: 30px;\r\n    background-color: #D9D9D9;\r\n    width: 100%;\r\n   \r\n    padding-top: 15px;\r\n  }\r\n\r\n  #cardBox{\r\n    \r\n    margin-top: 5%;\r\n    margin-left: 3%;\r\n    margin-right: 3%;\r\n  }\r\n\r\n  #cardBoxContent{\r\n    \r\n    margin-left: 7%;\r\n    font-size: 150%;\r\n    text-align: center;\r\n    margin-top: 6%;\r\n  }\r\n\r\n  #buttonBox{\r\n    \r\n    margin-left: 40%;\r\n    padding: 10px 30px;\r\n    border-radius: 20px;\r\n    background-color: #C69751;\r\n    color: #fff;\r\n    border: none;\r\n  }\r\n\r\n  .formInscriptionConnexion{\r\n    margin-top: 5%;\r\n    margin-left: 30%;\r\n    margin-right: 30%;\r\n    margin-bottom: 15%;\r\n  }\r\n\r\n  .titleInscriptionConnexionPage{\r\n    font-family: 'Julius Sans One';\r\n    margin-bottom: 5%;\r\n    margin-left: 5%;\r\n  }\r\n\r\n  .goldButton{\r\n    padding: 10px 120px;\r\n    border-radius: 20px;\r\n    background-color: #C69751;\r\n    color: #fff;\r\n    border: none;\r\n    margin-bottom: 5%;\r\n  }\r\n\r\n  .footer{\r\n    background-color: #343A40;\r\n   \r\n  }\r\n  #baguette{\r\n    position: absolute;\r\n    left: -14%;\r\n    top: 47%;\r\n    \r\n  }\r\n\r\n  #someSushis{\r\n    position: absolute;\r\n    right: 0%;\r\n    top: 45%;\r\n  }\r\n\r\n  .footerButton{\r\n    padding: 10px 30px;\r\n    border-radius: 20px;\r\n  }\r\n\r\n  .menu{\r\n    background-color: #151313;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .filter{\r\n    position: relative;\r\n    left:0%;\r\n    width: 15%;\r\n    height: 100vh;\r\n    background-color: #000000;\r\n    border-right: 3px #C69751 double;\r\n  }\r\n\r\n  .filter-card{\r\n    height: 17%;\r\n    border-bottom: 1px #C69751 solid;\r\n    text-align: center;\r\n    padding-top: 50px;\r\n    font-size: large;\r\n  }\r\n\r\n  .filter-card a{\r\n    color: #D9D9D9;\r\n    font-family: 'Julius Sans One';\r\n  }\r\n\r\n  #cardBox2{\r\n    position: absolute;\r\n    top: 180px;\r\n    left: 20%;\r\n\r\n  }\r\n\r\n  #buttonBox2{\r\n    position: absolute;\r\n    top: 65px;\r\n    right: 60px;\r\n    padding: 10px 15px;\r\n    border-radius: 10px;\r\n    background-color: #C69751;\r\n    color: #fff;\r\n    border: none;\r\n  }\r\n\r\n  #buttonBox3{\r\n    position: absolute;\r\n    top: 130px;\r\n    right: 60px;\r\n    padding: 10px 47px;\r\n    border-radius: 10px;\r\n    background-color: #343A40;\r\n    color: #fff;\r\n    border: none;\r\n  }\r\n\r\n  .profil{\r\n    background-color: #fff;\r\n    width: auto;\r\n    height: 80vh;\r\n    margin-top: 5%;\r\n  }\r\n\r\n  .infos{\r\n    margin-top: 5%;\r\n  }\r\n\r\n  .profilAvatar{\r\n    border-right: 3px #C69751 double;\r\n  }\r\n\r\n  #logOut{\r\n    padding: 10px 20px;\r\n    border-radius: 10px;\r\n    background-color: #343A40;\r\n    color: #ffffff;\r\n    border-color: #343A40 ;\r\n    margin-top: 50%;\r\n  }\r\n  .titleUsers{\r\n\r\n    margin-top:4%;\r\n    margin-left: 30%;\r\n    text-align: center;\r\n    color: #343A40;\r\n    font-size: 40px;\r\n    width: 40%;\r\n    font-family: 'Julius Sans One';\r\n}\r\n\r\n.tab{\r\n\r\n  margin-left: 5%;\r\n  margin-right: 5%;\r\n  margin-top: 2%;\r\n  border-radius: 5% !important;\r\n}\r\n\r\n.retour{\r\n  position: absolute;\r\n  top: 25%;\r\n  left: 1%;\r\n}\r\n\r\n.aboutUs{\r\n  width: 35%;\r\n  height: auto;\r\n  float: left;\r\n  text-align: center;\r\n  margin-top: 2%;\r\n  margin-right: 5%;\r\n  margin-left: 2%;\r\n  margin-bottom: 20%;\r\n}",""]);const a=i},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=t(e);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(n)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);n&&i[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),e.push(l))}},e}},379:(t,e,r)=>{var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},a=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),o=[];function s(t){for(var e=-1,r=0;r<o.length;r++)if(o[r].identifier===t){e=r;break}return e}function l(t,e){for(var r={},n=[],i=0;i<t.length;i++){var a=t[i],l=e.base?a[0]+e.base:a[0],c=r[l]||0,h="".concat(l," ").concat(c);r[l]=c+1;var d=s(h),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(o[d].references++,o[d].updater(p)):o.push({identifier:h,updater:g(p,e),references:1}),n.push(h)}return n}function c(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var i=r.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var o=a(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var h,d=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function p(t,e,r,n){var i=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=d(e,i);else{var a=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function u(t,e,r){var n=r.css,i=r.media,a=r.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var m=null,f=0;function g(t,e){var r,n,i;if(e.singleton){var a=f++;r=m||(m=c(e)),n=p.bind(null,r,a,!1),i=p.bind(null,r,a,!0)}else r=c(e),n=u.bind(null,r,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var r=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var i=s(r[n]);o[i].references--}for(var a=l(t,e),c=0;c<r.length;c++){var h=s(r[c]);0===o[h].references&&(o[h].updater(),o.splice(h,1))}r=a}}}}},__webpack_module_cache__={},inProgress,dataWebpackPrefix;function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((e,r)=>(__webpack_require__.f[r](t,e),e)),[])),__webpack_require__.u=t=>t+".bundle.min.js",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),inProgress={},dataWebpackPrefix="js-phaser-boilerplate:",__webpack_require__.l=(t,e,r,n)=>{if(inProgress[t])inProgress[t].push(e);else{var i,a;if(void 0!==r)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var l=o[s];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==dataWebpackPrefix+r){i=l;break}}i||(a=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.setAttribute("data-webpack",dataWebpackPrefix+r),i.src=t),inProgress[t]=[e];var c=(e,r)=>{i.onerror=i.onload=null,clearTimeout(h);var n=inProgress[t];if(delete inProgress[t],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((t=>t(r))),e)return e(r)},h=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),a&&document.head.appendChild(i)}},__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.p="/",(()=>{var t={179:0};__webpack_require__.f.j=(e,r)=>{var n=__webpack_require__.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise(((r,i)=>n=t[e]=[r,i]));r.push(n[2]=i);var a=__webpack_require__.p+__webpack_require__.u(e),o=new Error;__webpack_require__.l(a,(r=>{if(__webpack_require__.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,n[1](o)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,i,[a,o,s]=r,l=0;if(a.some((e=>0!==t[e]))){for(n in o)__webpack_require__.o(o,n)&&(__webpack_require__.m[n]=o[n]);if(s)s(__webpack_require__)}for(e&&e(r);l<a.length;l++)i=a[l],__webpack_require__.o(t,i)&&t[i]&&t[i][0](),t[i]=0},r=self.webpackChunkjs_phaser_boilerplate=self.webpackChunkjs_phaser_boilerplate||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{afterMain:()=>dT,afterRead:()=>lT,afterWrite:()=>mT,applyStyles:()=>_T,arrow:()=>VT,auto:()=>ZA,basePlacements:()=>KA,beforeMain:()=>cT,beforeRead:()=>oT,beforeWrite:()=>pT,bottom:()=>$A,clippingParents:()=>tT,computeStyles:()=>WT,createPopper:()=>wP,createPopperBase:()=>_P,createPopperLite:()=>SP,detectOverflow:()=>sP,end:()=>QA,eventListeners:()=>$T,flip:()=>lP,hide:()=>dP,left:()=>YA,main:()=>hT,modifierPhases:()=>fT,offset:()=>pP,placements:()=>aT,popper:()=>rT,popperGenerator:()=>xP,popperOffsets:()=>uP,preventOverflow:()=>mP,read:()=>sT,reference:()=>nT,right:()=>XA,start:()=>JA,top:()=>qA,variationPlacements:()=>iT,viewport:()=>eT,write:()=>uT});var e=__webpack_require__(379),r=__webpack_require__.n(e),n=__webpack_require__(666),i={insert:"head",singleton:!1};r()(n.Z,i);n.Z.locals;var a=__webpack_require__(46),o={insert:"head",singleton:!1};r()(a.Z,o);a.Z.locals;__webpack_require__(886);const s="159",l=1,c=2,h=3,d=0,p=1,u=100,m=0,f=1,g=2,v=0,b=1,y=2,x=3,_=4,w=5,S=301,E=302,M=303,A=304,T=306,P=1e3,C=1001,k=1002,D=1003,L=1004,R=1005,O=1006,I=1008,N=1009,z=1012,F=1013,U=1014,B=1015,V=1016,j=1020,G=1023,H=1026,W=1027,q=33776,$=33777,X=33778,Y=33779,Z=36492,K=2300,J=2301,Q=2302,tt=2400,et=2401,rt=2402,nt=3e3,it=3001,at="",ot="srgb",st="srgb-linear",lt="display-p3",ct="display-p3-linear",ht="linear",dt="srgb",pt="rec709",ut="p3",mt=7680,ft=35044,gt="300 es",vt=1035,bt=2e3,yt=2001;class xt{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const r=this._listeners[t];if(void 0!==r){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const r=e.slice(0);for(let e=0,n=r.length;e<n;e++)r[e].call(this,t);t.target=null}}}const _t=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let wt=1234567;const St=Math.PI/180,Et=180/Math.PI;function Mt(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(_t[255&t]+_t[t>>8&255]+_t[t>>16&255]+_t[t>>24&255]+"-"+_t[255&e]+_t[e>>8&255]+"-"+_t[e>>16&15|64]+_t[e>>24&255]+"-"+_t[63&r|128]+_t[r>>8&255]+"-"+_t[r>>16&255]+_t[r>>24&255]+_t[255&n]+_t[n>>8&255]+_t[n>>16&255]+_t[n>>24&255]).toLowerCase()}function At(t,e,r){return Math.max(e,Math.min(r,t))}function Tt(t,e){return(t%e+e)%e}function Pt(t,e,r){return(1-r)*t+r*e}function Ct(t){return 0==(t&t-1)&&0!==t}function kt(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Dt(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Lt(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const Rt={DEG2RAD:St,RAD2DEG:Et,generateUUID:Mt,clamp:At,euclideanModulo:Tt,mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},inverseLerp:function(t,e,r){return t!==e?(r-t)/(e-t):0},lerp:Pt,damp:function(t,e,r,n){return Pt(t,e,1-Math.exp(-r*n))},pingpong:function(t,e=1){return e-Math.abs(Tt(t,2*e)-e)},smoothstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(wt=t);let e=wt+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*St},radToDeg:function(t){return t*Et},isPowerOfTwo:Ct,ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:kt,setQuaternionFromProperEuler:function(t,e,r,n,i){const a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),c=a((e+n)/2),h=o((e+n)/2),d=a((e-n)/2),p=o((e-n)/2),u=a((n-e)/2),m=o((n-e)/2);switch(i){case"XYX":t.set(s*h,l*d,l*p,s*c);break;case"YZY":t.set(l*p,s*h,l*d,s*c);break;case"ZXZ":t.set(l*d,l*p,s*h,s*c);break;case"XZX":t.set(s*h,l*m,l*u,s*c);break;case"YXY":t.set(l*u,s*h,l*m,s*c);break;case"ZYZ":t.set(l*m,l*u,s*h,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:Lt,denormalize:Dt};class Ot{constructor(t=0,e=0){Ot.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,n=t.elements;return this.x=n[0]*e+n[3]*r+n[6],this.y=n[1]*e+n[4]*r+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(At(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),n=Math.sin(e),i=this.x-t.x,a=this.y-t.y;return this.x=i*r-a*n+t.x,this.y=i*n+a*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class It{constructor(t,e,r,n,i,a,o,s,l){It.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,r,n,i,a,o,s,l)}set(t,e,r,n,i,a,o,s,l){const c=this.elements;return c[0]=t,c[1]=n,c[2]=o,c[3]=e,c[4]=i,c[5]=s,c[6]=r,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,n=e.elements,i=this.elements,a=r[0],o=r[3],s=r[6],l=r[1],c=r[4],h=r[7],d=r[2],p=r[5],u=r[8],m=n[0],f=n[3],g=n[6],v=n[1],b=n[4],y=n[7],x=n[2],_=n[5],w=n[8];return i[0]=a*m+o*v+s*x,i[3]=a*f+o*b+s*_,i[6]=a*g+o*y+s*w,i[1]=l*m+c*v+h*x,i[4]=l*f+c*b+h*_,i[7]=l*g+c*y+h*w,i[2]=d*m+p*v+u*x,i[5]=d*f+p*b+u*_,i[8]=d*g+p*y+u*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*a*c-e*o*l-r*i*c+r*o*s+n*i*l-n*a*s}invert(){const t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],h=c*a-o*l,d=o*s-c*i,p=l*i-a*s,u=e*h+r*d+n*p;if(0===u)return this.set(0,0,0,0,0,0,0,0,0);const m=1/u;return t[0]=h*m,t[1]=(n*l-c*r)*m,t[2]=(o*r-n*a)*m,t[3]=d*m,t[4]=(c*e-n*s)*m,t[5]=(n*i-o*e)*m,t[6]=p*m,t[7]=(r*s-l*e)*m,t[8]=(a*e-r*i)*m,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,n,i,a,o){const s=Math.cos(i),l=Math.sin(i);return this.set(r*s,r*l,-r*(s*a+l*o)+a+t,-n*l,n*s,-n*(-l*a+s*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(Nt.makeScale(t,e)),this}rotate(t){return this.premultiply(Nt.makeRotation(-t)),this}translate(t,e){return this.premultiply(Nt.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<9;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Nt=new It;function zt(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Ft={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ut(t,e){return new Ft[t](e)}function Bt(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Vt(){const t=Bt("canvas");return t.style.display="block",t}const jt={};function Gt(t){t in jt||(jt[t]=!0,console.warn(t))}const Ht=(new It).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Wt=(new It).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),qt={[st]:{transfer:ht,primaries:pt,toReference:t=>t,fromReference:t=>t},[ot]:{transfer:dt,primaries:pt,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[ct]:{transfer:ht,primaries:ut,toReference:t=>t.applyMatrix3(Wt),fromReference:t=>t.applyMatrix3(Ht)},[lt]:{transfer:dt,primaries:ut,toReference:t=>t.convertSRGBToLinear().applyMatrix3(Wt),fromReference:t=>t.applyMatrix3(Ht).convertLinearToSRGB()}},$t=new Set([st,ct]),Xt={enabled:!0,_workingColorSpace:st,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!$t.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,r){if(!1===this.enabled||e===r||!e||!r)return t;const n=qt[e].toReference;return(0,qt[r].fromReference)(n(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return qt[t].primaries},getTransfer:function(t){return t===at?ht:qt[t].transfer}};function Yt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Zt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let Kt;class Jt{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Kt&&(Kt=Bt("canvas")),Kt.width=t.width,Kt.height=t.height;const r=Kt.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),e=Kt}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Bt("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const n=r.getImageData(0,0,t.width,t.height),i=n.data;for(let t=0;t<i.length;t++)i[t]=255*Yt(i[t]/255);return r.putImageData(n,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Yt(e[t]/255)):e[t]=Yt(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Qt=0;class te{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Qt++}),this.uuid=Mt(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let t;if(Array.isArray(n)){t=[];for(let e=0,r=n.length;e<r;e++)n[e].isDataTexture?t.push(ee(n[e].image)):t.push(ee(n[e]))}else t=ee(n);r.url=t}return e||(t.images[this.uuid]=r),r}}function ee(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Jt.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let re=0;class ne extends xt{constructor(t=ne.DEFAULT_IMAGE,e=ne.DEFAULT_MAPPING,r=1001,n=1001,i=1006,a=1008,o=1023,s=1009,l=ne.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:re++}),this.uuid=Mt(),this.name="",this.source=new te(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new Ot(0,0),this.repeat=new Ot(1,1),this.center=new Ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new It,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof c?this.colorSpace=c:(Gt("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===it?ot:at),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),e||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case P:t.x=t.x-Math.floor(t.x);break;case C:t.x=t.x<0?0:1;break;case k:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case P:t.y=t.y-Math.floor(t.y);break;case C:t.y=t.y<0?0:1;break;case k:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Gt("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ot?it:nt}set encoding(t){Gt("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===it?ot:at}}ne.DEFAULT_IMAGE=null,ne.DEFAULT_MAPPING=300,ne.DEFAULT_ANISOTROPY=1;class ie{constructor(t=0,e=0,r=0,n=1){ie.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,n=this.z,i=this.w,a=t.elements;return this.x=a[0]*e+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*e+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*e+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*e+a[7]*r+a[11]*n+a[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,n,i;const a=.01,o=.1,s=t.elements,l=s[0],c=s[4],h=s[8],d=s[1],p=s[5],u=s[9],m=s[2],f=s[6],g=s[10];if(Math.abs(c-d)<a&&Math.abs(h-m)<a&&Math.abs(u-f)<a){if(Math.abs(c+d)<o&&Math.abs(h+m)<o&&Math.abs(u+f)<o&&Math.abs(l+p+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,s=(p+1)/2,v=(g+1)/2,b=(c+d)/4,y=(h+m)/4,x=(u+f)/4;return t>s&&t>v?t<a?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(t),n=b/r,i=y/r):s>v?s<a?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(s),r=b/n,i=x/n):v<a?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(v),r=y/i,n=x/i),this.set(r,n,i,e),this}let v=Math.sqrt((f-u)*(f-u)+(h-m)*(h-m)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(f-u)/v,this.y=(h-m)/v,this.z=(d-c)/v,this.w=Math.acos((l+p+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ae extends xt{constructor(t=1,e=1,r={}){super(),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new ie(0,0,t,e),this.scissorTest=!1,this.viewport=new ie(0,0,t,e);const n={width:t,height:e,depth:1};void 0!==r.encoding&&(Gt("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===it?ot:at),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:O,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new ne(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(t,e,r=1){this.width===t&&this.height===e&&this.depth===r||(this.width=t,this.height=e,this.depth=r,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new te(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class oe extends ae{constructor(t=1,e=1,r={}){super(t,e,r),this.isWebGLRenderTarget=!0}}class se extends ne{constructor(t=null,e=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:r,depth:n},this.magFilter=D,this.minFilter=D,this.wrapR=C,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class le extends ne{constructor(t=null,e=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:r,depth:n},this.magFilter=D,this.minFilter=D,this.wrapR=C,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ce{constructor(t=0,e=0,r=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=n}static slerpFlat(t,e,r,n,i,a,o){let s=r[n+0],l=r[n+1],c=r[n+2],h=r[n+3];const d=i[a+0],p=i[a+1],u=i[a+2],m=i[a+3];if(0===o)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===o)return t[e+0]=d,t[e+1]=p,t[e+2]=u,void(t[e+3]=m);if(h!==m||s!==d||l!==p||c!==u){let t=1-o;const e=s*d+l*p+c*u+h*m,r=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const i=Math.sqrt(n),a=Math.atan2(i,e*r);t=Math.sin(t*a)/i,o=Math.sin(o*a)/i}const i=o*r;if(s=s*t+d*i,l=l*t+p*i,c=c*t+u*i,h=h*t+m*i,t===1-o){const t=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=t,l*=t,c*=t,h*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,r,n,i,a){const o=r[n],s=r[n+1],l=r[n+2],c=r[n+3],h=i[a],d=i[a+1],p=i[a+2],u=i[a+3];return t[e]=o*u+c*h+s*p-l*d,t[e+1]=s*u+c*d+l*h-o*p,t[e+2]=l*u+c*p+o*d-s*h,t[e+3]=c*u-o*h-s*d-l*p,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const r=t._x,n=t._y,i=t._z,a=t._order,o=Math.cos,s=Math.sin,l=o(r/2),c=o(n/2),h=o(i/2),d=s(r/2),p=s(n/2),u=s(i/2);switch(a){case"XYZ":this._x=d*c*h+l*p*u,this._y=l*p*h-d*c*u,this._z=l*c*u+d*p*h,this._w=l*c*h-d*p*u;break;case"YXZ":this._x=d*c*h+l*p*u,this._y=l*p*h-d*c*u,this._z=l*c*u-d*p*h,this._w=l*c*h+d*p*u;break;case"ZXY":this._x=d*c*h-l*p*u,this._y=l*p*h+d*c*u,this._z=l*c*u+d*p*h,this._w=l*c*h-d*p*u;break;case"ZYX":this._x=d*c*h-l*p*u,this._y=l*p*h+d*c*u,this._z=l*c*u-d*p*h,this._w=l*c*h+d*p*u;break;case"YZX":this._x=d*c*h+l*p*u,this._y=l*p*h+d*c*u,this._z=l*c*u-d*p*h,this._w=l*c*h-d*p*u;break;case"XZY":this._x=d*c*h-l*p*u,this._y=l*p*h-d*c*u,this._z=l*c*u+d*p*h,this._w=l*c*h+d*p*u;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,n=Math.sin(r);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],n=e[4],i=e[8],a=e[1],o=e[5],s=e[9],l=e[2],c=e[6],h=e[10],d=r+o+h;if(d>0){const t=.5/Math.sqrt(d+1);this._w=.25/t,this._x=(c-s)*t,this._y=(i-l)*t,this._z=(a-n)*t}else if(r>o&&r>h){const t=2*Math.sqrt(1+r-o-h);this._w=(c-s)/t,this._x=.25*t,this._y=(n+a)/t,this._z=(i+l)/t}else if(o>h){const t=2*Math.sqrt(1+o-r-h);this._w=(i-l)/t,this._x=(n+a)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+h-r-o);this._w=(a-n)/t,this._x=(i+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(At(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(0===r)return this;const n=Math.min(1,e/r);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,n=t._y,i=t._z,a=t._w,o=e._x,s=e._y,l=e._z,c=e._w;return this._x=r*c+a*o+n*l-i*s,this._y=n*c+a*s+i*o-r*l,this._z=i*c+a*l+r*s-n*o,this._w=a*c-r*o-n*s-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const r=this._x,n=this._y,i=this._z,a=this._w;let o=a*t._w+r*t._x+n*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;const s=1-o*o;if(s<=Number.EPSILON){const t=1-e;return this._w=t*a+e*this._w,this._x=t*r+e*this._x,this._y=t*n+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,d=Math.sin(e*c)/l;return this._w=a*h+this._w*d,this._x=r*h+this._x*d,this._y=n*h+this._y*d,this._z=i*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=Math.random(),e=Math.sqrt(1-t),r=Math.sqrt(t),n=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(n),r*Math.sin(i),r*Math.cos(i),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class he{constructor(t=0,e=0,r=0){he.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return void 0===r&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(pe.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(pe.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*n,this.y=i[1]*e+i[4]*r+i[7]*n,this.z=i[2]*e+i[5]*r+i[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,n=this.z,i=t.elements,a=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*a,this}applyQuaternion(t){const e=this.x,r=this.y,n=this.z,i=t.x,a=t.y,o=t.z,s=t.w,l=2*(a*n-o*r),c=2*(o*e-i*n),h=2*(i*r-a*e);return this.x=e+s*l+a*h-o*c,this.y=r+s*c+o*l-i*h,this.z=n+s*h+i*c-a*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n,this.y=i[1]*e+i[5]*r+i[9]*n,this.z=i[2]*e+i[6]*r+i[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,n=t.y,i=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return de.copy(this).projectOnVector(t),this.sub(de)}reflect(t){return this.sub(de.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(At(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return e*e+r*r+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const n=Math.sin(e)*t;return this.x=n*Math.sin(r),this.y=Math.cos(e)*t,this.z=n*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,r=Math.sqrt(1-t**2);return this.x=r*Math.cos(e),this.y=r*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const de=new he,pe=new ce;class ue{constructor(t=new he(1/0,1/0,1/0),e=new he(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e+=3)this.expandByPoint(fe.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,r=t.count;e<r;e++)this.expandByPoint(fe.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=fe.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(void 0!==r){const n=r.getAttribute("position");if(!0===e&&void 0!==n&&!0!==t.isInstancedMesh)for(let e=0,r=n.count;e<r;e++)!0===t.isMesh?t.getVertexPosition(e,fe):fe.fromBufferAttribute(n,e),fe.applyMatrix4(t.matrixWorld),this.expandByPoint(fe);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),ge.copy(t.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),ge.copy(r.boundingBox)),ge.applyMatrix4(t.matrixWorld),this.union(ge)}const n=t.children;for(let t=0,r=n.length;t<r;t++)this.expandByObject(n[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,fe),fe.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Se),Ee.subVectors(this.max,Se),ve.subVectors(t.a,Se),be.subVectors(t.b,Se),ye.subVectors(t.c,Se),xe.subVectors(be,ve),_e.subVectors(ye,be),we.subVectors(ve,ye);let e=[0,-xe.z,xe.y,0,-_e.z,_e.y,0,-we.z,we.y,xe.z,0,-xe.x,_e.z,0,-_e.x,we.z,0,-we.x,-xe.y,xe.x,0,-_e.y,_e.x,0,-we.y,we.x,0];return!!Te(e,ve,be,ye,Ee)&&(e=[1,0,0,0,1,0,0,0,1],!!Te(e,ve,be,ye,Ee)&&(Me.crossVectors(xe,_e),e=[Me.x,Me.y,Me.z],Te(e,ve,be,ye,Ee)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,fe).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(fe).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(me[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),me[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),me[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),me[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),me[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),me[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),me[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),me[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(me)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const me=[new he,new he,new he,new he,new he,new he,new he,new he],fe=new he,ge=new ue,ve=new he,be=new he,ye=new he,xe=new he,_e=new he,we=new he,Se=new he,Ee=new he,Me=new he,Ae=new he;function Te(t,e,r,n,i){for(let a=0,o=t.length-3;a<=o;a+=3){Ae.fromArray(t,a);const o=i.x*Math.abs(Ae.x)+i.y*Math.abs(Ae.y)+i.z*Math.abs(Ae.z),s=e.dot(Ae),l=r.dot(Ae),c=n.dot(Ae);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}const Pe=new ue,Ce=new he,ke=new he;class De{constructor(t=new he,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;void 0!==e?r.copy(e):Pe.setFromPoints(t).getCenter(r);let n=0;for(let e=0,i=t.length;e<i;e++)n=Math.max(n,r.distanceToSquared(t[e]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Ce.subVectors(t,this.center);const e=Ce.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),r=.5*(t-this.radius);this.center.addScaledVector(Ce,r/t),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(ke.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Ce.copy(t.center).add(ke)),this.expandByPoint(Ce.copy(t.center).sub(ke))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Le=new he,Re=new he,Oe=new he,Ie=new he,Ne=new he,ze=new he,Fe=new he;class Ue{constructor(t=new he,e=new he(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Le)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Le.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Le.copy(this.origin).addScaledVector(this.direction,e),Le.distanceToSquared(t))}distanceSqToSegment(t,e,r,n){Re.copy(t).add(e).multiplyScalar(.5),Oe.copy(e).sub(t).normalize(),Ie.copy(this.origin).sub(Re);const i=.5*t.distanceTo(e),a=-this.direction.dot(Oe),o=Ie.dot(this.direction),s=-Ie.dot(Oe),l=Ie.lengthSq(),c=Math.abs(1-a*a);let h,d,p,u;if(c>0)if(h=a*s-o,d=a*o-s,u=i*c,h>=0)if(d>=-u)if(d<=u){const t=1/c;h*=t,d*=t,p=h*(h+a*d+2*o)+d*(a*h+d+2*s)+l}else d=i,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*s)+l;else d=-i,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*s)+l;else d<=-u?(h=Math.max(0,-(-a*i+o)),d=h>0?-i:Math.min(Math.max(-i,-s),i),p=-h*h+d*(d+2*s)+l):d<=u?(h=0,d=Math.min(Math.max(-i,-s),i),p=d*(d+2*s)+l):(h=Math.max(0,-(a*i+o)),d=h>0?i:Math.min(Math.max(-i,-s),i),p=-h*h+d*(d+2*s)+l);else d=a>0?-i:i,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*s)+l;return r&&r.copy(this.origin).addScaledVector(this.direction,h),n&&n.copy(Re).addScaledVector(Oe,d),p}intersectSphere(t,e){Le.subVectors(t.center,this.origin);const r=Le.dot(this.direction),n=Le.dot(Le)-r*r,i=t.radius*t.radius;if(n>i)return null;const a=Math.sqrt(i-n),o=r-a,s=r+a;return s<0?null:o<0?this.at(s,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null}intersectPlane(t,e){const r=this.distanceToPlane(t);return null===r?null:this.at(r,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let r,n,i,a,o,s;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(r=(t.min.x-d.x)*l,n=(t.max.x-d.x)*l):(r=(t.max.x-d.x)*l,n=(t.min.x-d.x)*l),c>=0?(i=(t.min.y-d.y)*c,a=(t.max.y-d.y)*c):(i=(t.max.y-d.y)*c,a=(t.min.y-d.y)*c),r>a||i>n?null:((i>r||isNaN(r))&&(r=i),(a<n||isNaN(n))&&(n=a),h>=0?(o=(t.min.z-d.z)*h,s=(t.max.z-d.z)*h):(o=(t.max.z-d.z)*h,s=(t.min.z-d.z)*h),r>s||o>n?null:((o>r||r!=r)&&(r=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,Le)}intersectTriangle(t,e,r,n,i){Ne.subVectors(e,t),ze.subVectors(r,t),Fe.crossVectors(Ne,ze);let a,o=this.direction.dot(Fe);if(o>0){if(n)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Ie.subVectors(this.origin,t);const s=a*this.direction.dot(ze.crossVectors(Ie,ze));if(s<0)return null;const l=a*this.direction.dot(Ne.cross(Ie));if(l<0)return null;if(s+l>o)return null;const c=-a*Ie.dot(Fe);return c<0?null:this.at(c/o,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Be{constructor(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f){Be.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f)}set(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f){const g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=d,g[3]=p,g[7]=u,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Be).fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,n=1/Ve.setFromMatrixColumn(t,0).length(),i=1/Ve.setFromMatrixColumn(t,1).length(),a=1/Ve.setFromMatrixColumn(t,2).length();return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=0,e[4]=r[4]*i,e[5]=r[5]*i,e[6]=r[6]*i,e[7]=0,e[8]=r[8]*a,e[9]=r[9]*a,e[10]=r[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,n=t.y,i=t.z,a=Math.cos(r),o=Math.sin(r),s=Math.cos(n),l=Math.sin(n),c=Math.cos(i),h=Math.sin(i);if("XYZ"===t.order){const t=a*c,r=a*h,n=o*c,i=o*h;e[0]=s*c,e[4]=-s*h,e[8]=l,e[1]=r+n*l,e[5]=t-i*l,e[9]=-o*s,e[2]=i-t*l,e[6]=n+r*l,e[10]=a*s}else if("YXZ"===t.order){const t=s*c,r=s*h,n=l*c,i=l*h;e[0]=t+i*o,e[4]=n*o-r,e[8]=a*l,e[1]=a*h,e[5]=a*c,e[9]=-o,e[2]=r*o-n,e[6]=i+t*o,e[10]=a*s}else if("ZXY"===t.order){const t=s*c,r=s*h,n=l*c,i=l*h;e[0]=t-i*o,e[4]=-a*h,e[8]=n+r*o,e[1]=r+n*o,e[5]=a*c,e[9]=i-t*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){const t=a*c,r=a*h,n=o*c,i=o*h;e[0]=s*c,e[4]=n*l-r,e[8]=t*l+i,e[1]=s*h,e[5]=i*l+t,e[9]=r*l-n,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){const t=a*s,r=a*l,n=o*s,i=o*l;e[0]=s*c,e[4]=i-t*h,e[8]=n*h+r,e[1]=h,e[5]=a*c,e[9]=-o*c,e[2]=-l*c,e[6]=r*h+n,e[10]=t-i*h}else if("XZY"===t.order){const t=a*s,r=a*l,n=o*s,i=o*l;e[0]=s*c,e[4]=-h,e[8]=l*c,e[1]=t*h+i,e[5]=a*c,e[9]=r*h-n,e[2]=n*h-r,e[6]=o*c,e[10]=i*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Ge,t,He)}lookAt(t,e,r){const n=this.elements;return $e.subVectors(t,e),0===$e.lengthSq()&&($e.z=1),$e.normalize(),We.crossVectors(r,$e),0===We.lengthSq()&&(1===Math.abs(r.z)?$e.x+=1e-4:$e.z+=1e-4,$e.normalize(),We.crossVectors(r,$e)),We.normalize(),qe.crossVectors($e,We),n[0]=We.x,n[4]=qe.x,n[8]=$e.x,n[1]=We.y,n[5]=qe.y,n[9]=$e.y,n[2]=We.z,n[6]=qe.z,n[10]=$e.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,n=e.elements,i=this.elements,a=r[0],o=r[4],s=r[8],l=r[12],c=r[1],h=r[5],d=r[9],p=r[13],u=r[2],m=r[6],f=r[10],g=r[14],v=r[3],b=r[7],y=r[11],x=r[15],_=n[0],w=n[4],S=n[8],E=n[12],M=n[1],A=n[5],T=n[9],P=n[13],C=n[2],k=n[6],D=n[10],L=n[14],R=n[3],O=n[7],I=n[11],N=n[15];return i[0]=a*_+o*M+s*C+l*R,i[4]=a*w+o*A+s*k+l*O,i[8]=a*S+o*T+s*D+l*I,i[12]=a*E+o*P+s*L+l*N,i[1]=c*_+h*M+d*C+p*R,i[5]=c*w+h*A+d*k+p*O,i[9]=c*S+h*T+d*D+p*I,i[13]=c*E+h*P+d*L+p*N,i[2]=u*_+m*M+f*C+g*R,i[6]=u*w+m*A+f*k+g*O,i[10]=u*S+m*T+f*D+g*I,i[14]=u*E+m*P+f*L+g*N,i[3]=v*_+b*M+y*C+x*R,i[7]=v*w+b*A+y*k+x*O,i[11]=v*S+b*T+y*D+x*I,i[15]=v*E+b*P+y*L+x*N,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],c=t[2],h=t[6],d=t[10],p=t[14];return t[3]*(+i*s*h-n*l*h-i*o*d+r*l*d+n*o*p-r*s*p)+t[7]*(+e*s*p-e*l*d+i*a*d-n*a*p+n*l*c-i*s*c)+t[11]*(+e*l*h-e*o*p-i*a*h+r*a*p+i*o*c-r*l*c)+t[15]*(-n*o*c-e*s*h+e*o*d+n*a*h-r*a*d+r*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],u=t[12],m=t[13],f=t[14],g=t[15],v=h*f*l-m*d*l+m*s*p-o*f*p-h*s*g+o*d*g,b=u*d*l-c*f*l-u*s*p+a*f*p+c*s*g-a*d*g,y=c*m*l-u*h*l+u*o*p-a*m*p-c*o*g+a*h*g,x=u*h*s-c*m*s-u*o*d+a*m*d+c*o*f-a*h*f,_=e*v+r*b+n*y+i*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return t[0]=v*w,t[1]=(m*d*i-h*f*i-m*n*p+r*f*p+h*n*g-r*d*g)*w,t[2]=(o*f*i-m*s*i+m*n*l-r*f*l-o*n*g+r*s*g)*w,t[3]=(h*s*i-o*d*i-h*n*l+r*d*l+o*n*p-r*s*p)*w,t[4]=b*w,t[5]=(c*f*i-u*d*i+u*n*p-e*f*p-c*n*g+e*d*g)*w,t[6]=(u*s*i-a*f*i-u*n*l+e*f*l+a*n*g-e*s*g)*w,t[7]=(a*d*i-c*s*i+c*n*l-e*d*l-a*n*p+e*s*p)*w,t[8]=y*w,t[9]=(u*h*i-c*m*i-u*r*p+e*m*p+c*r*g-e*h*g)*w,t[10]=(a*m*i-u*o*i+u*r*l-e*m*l-a*r*g+e*o*g)*w,t[11]=(c*o*i-a*h*i-c*r*l+e*h*l+a*r*p-e*o*p)*w,t[12]=x*w,t[13]=(c*m*n-u*h*n+u*r*d-e*m*d-c*r*f+e*h*f)*w,t[14]=(u*o*n-a*m*n-u*r*s+e*m*s+a*r*f-e*o*f)*w,t[15]=(a*h*n-c*o*n+c*r*s-e*h*s-a*r*d+e*o*d)*w,this}scale(t){const e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))}makeTranslation(t,e,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),n=Math.sin(e),i=1-r,a=t.x,o=t.y,s=t.z,l=i*a,c=i*o;return this.set(l*a+r,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+r,c*s-n*a,0,l*s-n*o,c*s+n*a,i*s*s+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,n,i,a){return this.set(1,r,i,0,t,1,a,0,e,n,1,0,0,0,0,1),this}compose(t,e,r){const n=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,c=a+a,h=o+o,d=i*l,p=i*c,u=i*h,m=a*c,f=a*h,g=o*h,v=s*l,b=s*c,y=s*h,x=r.x,_=r.y,w=r.z;return n[0]=(1-(m+g))*x,n[1]=(p+y)*x,n[2]=(u-b)*x,n[3]=0,n[4]=(p-y)*_,n[5]=(1-(d+g))*_,n[6]=(f+v)*_,n[7]=0,n[8]=(u+b)*w,n[9]=(f-v)*w,n[10]=(1-(d+m))*w,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,r){const n=this.elements;let i=Ve.set(n[0],n[1],n[2]).length();const a=Ve.set(n[4],n[5],n[6]).length(),o=Ve.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],je.copy(this);const s=1/i,l=1/a,c=1/o;return je.elements[0]*=s,je.elements[1]*=s,je.elements[2]*=s,je.elements[4]*=l,je.elements[5]*=l,je.elements[6]*=l,je.elements[8]*=c,je.elements[9]*=c,je.elements[10]*=c,e.setFromRotationMatrix(je),r.x=i,r.y=a,r.z=o,this}makePerspective(t,e,r,n,i,a,o=2e3){const s=this.elements,l=2*i/(e-t),c=2*i/(r-n),h=(e+t)/(e-t),d=(r+n)/(r-n);let p,u;if(o===bt)p=-(a+i)/(a-i),u=-2*a*i/(a-i);else{if(o!==yt)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-a/(a-i),u=-a*i/(a-i)}return s[0]=l,s[4]=0,s[8]=h,s[12]=0,s[1]=0,s[5]=c,s[9]=d,s[13]=0,s[2]=0,s[6]=0,s[10]=p,s[14]=u,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,r,n,i,a,o=2e3){const s=this.elements,l=1/(e-t),c=1/(r-n),h=1/(a-i),d=(e+t)*l,p=(r+n)*c;let u,m;if(o===bt)u=(a+i)*h,m=-2*h;else{if(o!==yt)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);u=i*h,m=-1*h}return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-d,s[1]=0,s[5]=2*c,s[9]=0,s[13]=-p,s[2]=0,s[6]=0,s[10]=m,s[14]=-u,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<16;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const Ve=new he,je=new Be,Ge=new he(0,0,0),He=new he(1,1,1),We=new he,qe=new he,$e=new he,Xe=new Be,Ye=new ce;class Ze{constructor(t=0,e=0,r=0,n=Ze.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,n=this._order){return this._x=t,this._y=e,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const n=t.elements,i=n[0],a=n[4],o=n[8],s=n[1],l=n[5],c=n[9],h=n[2],d=n[6],p=n[10];switch(e){case"XYZ":this._y=Math.asin(At(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-At(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-h,i),this._z=0);break;case"ZXY":this._x=Math.asin(At(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-At(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(At(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,i)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-At(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return Xe.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Xe,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Ye.setFromEuler(this),this.setFromQuaternion(Ye,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ze.DEFAULT_ORDER="XYZ";class Ke{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Je=0;const Qe=new he,tr=new ce,er=new Be,rr=new he,nr=new he,ir=new he,ar=new ce,or=new he(1,0,0),sr=new he(0,1,0),lr=new he(0,0,1),cr={type:"added"},hr={type:"removed"};class dr extends xt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Je++}),this.uuid=Mt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dr.DEFAULT_UP.clone();const t=new he,e=new Ze,r=new ce,n=new he(1,1,1);e._onChange((function(){r.setFromEuler(e,!1)})),r._onChange((function(){e.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Be},normalMatrix:{value:new It}}),this.matrix=new Be,this.matrixWorld=new Be,this.matrixAutoUpdate=dr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=dr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ke,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return tr.setFromAxisAngle(t,e),this.quaternion.multiply(tr),this}rotateOnWorldAxis(t,e){return tr.setFromAxisAngle(t,e),this.quaternion.premultiply(tr),this}rotateX(t){return this.rotateOnAxis(or,t)}rotateY(t){return this.rotateOnAxis(sr,t)}rotateZ(t){return this.rotateOnAxis(lr,t)}translateOnAxis(t,e){return Qe.copy(t).applyQuaternion(this.quaternion),this.position.add(Qe.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(or,t)}translateY(t){return this.translateOnAxis(sr,t)}translateZ(t){return this.translateOnAxis(lr,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(er.copy(this.matrixWorld).invert())}lookAt(t,e,r){t.isVector3?rr.copy(t):rr.set(t,e,r);const n=this.parent;this.updateWorldMatrix(!0,!1),nr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?er.lookAt(nr,rr,this.up):er.lookAt(rr,nr,this.up),this.quaternion.setFromRotationMatrix(er),n&&(er.extractRotation(n.matrixWorld),tr.setFromRotationMatrix(er),this.quaternion.premultiply(tr.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(cr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(hr)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),er.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),er.multiply(t.parent.matrixWorld)),t.applyMatrix4(er),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let r=0,n=this.children.length;r<n;r++){const n=this.children[r].getObjectByProperty(t,e);if(void 0!==n)return n}}getObjectsByProperty(t,e,r=[]){this[t]===e&&r.push(this);const n=this.children;for(let i=0,a=n.length;i<a;i++)n[i].getObjectsByProperty(t,e,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nr,t,ir),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(nr,ar,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let r=0,n=e.length;r<n;r++)e[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,n=e.length;r<n;r++){const n=e[r];!0!==n.matrixWorldAutoUpdate&&!0!==t||n.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,r=t.length;e<r;e++){const r=t[e];!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};function i(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map((t=>({boxInitialized:t.boxInitialized,boxMin:t.box.min.toArray(),boxMax:t.box.max.toArray(),sphereInitialized:t.sphereInitialized,sphereRadius:t.sphere.radius,sphereCenter:t.sphere.center.toArray()}))),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),null!==this.boundingBox&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const r=e.shapes;if(Array.isArray(r))for(let e=0,n=r.length;e<n;e++){const n=r[e];i(t.shapes,n)}else i(t.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let r=0,n=this.material.length;r<n;r++)e.push(i(t.materials,this.material[r]));n.material=e}else n.material=i(t.materials,this.material);if(this.children.length>0){n.children=[];for(let e=0;e<this.children.length;e++)n.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let e=0;e<this.animations.length;e++){const r=this.animations[e];n.animations.push(i(t.animations,r))}}if(e){const e=a(t.geometries),n=a(t.materials),i=a(t.textures),o=a(t.images),s=a(t.shapes),l=a(t.skeletons),c=a(t.animations),h=a(t.nodes);e.length>0&&(r.geometries=e),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),o.length>0&&(r.images=o),s.length>0&&(r.shapes=s),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),h.length>0&&(r.nodes=h)}return r.object=n,r;function a(t){const e=[];for(const r in t){const n=t[r];delete n.metadata,e.push(n)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const r=t.children[e];this.add(r.clone())}return this}}dr.DEFAULT_UP=new he(0,1,0),dr.DEFAULT_MATRIX_AUTO_UPDATE=!0,dr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pr=new he,ur=new he,mr=new he,fr=new he,gr=new he,vr=new he,br=new he,yr=new he,xr=new he,_r=new he;let wr=!1;class Sr{constructor(t=new he,e=new he,r=new he){this.a=t,this.b=e,this.c=r}static getNormal(t,e,r,n){n.subVectors(r,e),pr.subVectors(t,e),n.cross(pr);const i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(t,e,r,n,i){pr.subVectors(n,e),ur.subVectors(r,e),mr.subVectors(t,e);const a=pr.dot(pr),o=pr.dot(ur),s=pr.dot(mr),l=ur.dot(ur),c=ur.dot(mr),h=a*l-o*o;if(0===h)return i.set(-2,-1,-1);const d=1/h,p=(l*s-o*c)*d,u=(a*c-o*s)*d;return i.set(1-p-u,u,p)}static containsPoint(t,e,r,n){return this.getBarycoord(t,e,r,n,fr),fr.x>=0&&fr.y>=0&&fr.x+fr.y<=1}static getUV(t,e,r,n,i,a,o,s){return!1===wr&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),wr=!0),this.getInterpolation(t,e,r,n,i,a,o,s)}static getInterpolation(t,e,r,n,i,a,o,s){return this.getBarycoord(t,e,r,n,fr),s.setScalar(0),s.addScaledVector(i,fr.x),s.addScaledVector(a,fr.y),s.addScaledVector(o,fr.z),s}static isFrontFacing(t,e,r,n){return pr.subVectors(r,e),ur.subVectors(t,e),pr.cross(ur).dot(n)<0}set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this}setFromPointsAndIndices(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,r,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return pr.subVectors(this.c,this.b),ur.subVectors(this.a,this.b),.5*pr.cross(ur).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Sr.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Sr.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,r,n,i){return!1===wr&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),wr=!0),Sr.getInterpolation(t,this.a,this.b,this.c,e,r,n,i)}getInterpolation(t,e,r,n,i){return Sr.getInterpolation(t,this.a,this.b,this.c,e,r,n,i)}containsPoint(t){return Sr.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Sr.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const r=this.a,n=this.b,i=this.c;let a,o;gr.subVectors(n,r),vr.subVectors(i,r),yr.subVectors(t,r);const s=gr.dot(yr),l=vr.dot(yr);if(s<=0&&l<=0)return e.copy(r);xr.subVectors(t,n);const c=gr.dot(xr),h=vr.dot(xr);if(c>=0&&h<=c)return e.copy(n);const d=s*h-c*l;if(d<=0&&s>=0&&c<=0)return a=s/(s-c),e.copy(r).addScaledVector(gr,a);_r.subVectors(t,i);const p=gr.dot(_r),u=vr.dot(_r);if(u>=0&&p<=u)return e.copy(i);const m=p*l-s*u;if(m<=0&&l>=0&&u<=0)return o=l/(l-u),e.copy(r).addScaledVector(vr,o);const f=c*u-p*h;if(f<=0&&h-c>=0&&p-u>=0)return br.subVectors(i,n),o=(h-c)/(h-c+(p-u)),e.copy(n).addScaledVector(br,o);const g=1/(f+m+d);return a=m*g,o=d*g,e.copy(r).addScaledVector(gr,a).addScaledVector(vr,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const Er={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Mr={h:0,s:0,l:0},Ar={h:0,s:0,l:0};function Tr(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}class Pr{constructor(t,e,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,r)}set(t,e,r){if(void 0===e&&void 0===r){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=ot){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Xt.toWorkingColorSpace(this,e),this}setRGB(t,e,r,n=Xt.workingColorSpace){return this.r=t,this.g=e,this.b=r,Xt.toWorkingColorSpace(this,n),this}setHSL(t,e,r,n=Xt.workingColorSpace){if(t=Tt(t,1),e=At(e,0,1),r=At(r,0,1),0===e)this.r=this.g=this.b=r;else{const n=r<=.5?r*(1+e):r+e-r*e,i=2*r-n;this.r=Tr(i,n,t+1/3),this.g=Tr(i,n,t),this.b=Tr(i,n,t-1/3)}return Xt.toWorkingColorSpace(this,n),this}setStyle(t,e=ot){function r(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(t)){let i;const a=n[1],o=n[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,e);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=n[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,e);if(6===i)return this.setHex(parseInt(r,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=ot){const r=Er[t.toLowerCase()];return void 0!==r?this.setHex(r,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Yt(t.r),this.g=Yt(t.g),this.b=Yt(t.b),this}copyLinearToSRGB(t){return this.r=Zt(t.r),this.g=Zt(t.g),this.b=Zt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=ot){return Xt.fromWorkingColorSpace(Cr.copy(this),t),65536*Math.round(At(255*Cr.r,0,255))+256*Math.round(At(255*Cr.g,0,255))+Math.round(At(255*Cr.b,0,255))}getHexString(t=ot){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Xt.workingColorSpace){Xt.fromWorkingColorSpace(Cr.copy(this),e);const r=Cr.r,n=Cr.g,i=Cr.b,a=Math.max(r,n,i),o=Math.min(r,n,i);let s,l;const c=(o+a)/2;if(o===a)s=0,l=0;else{const t=a-o;switch(l=c<=.5?t/(a+o):t/(2-a-o),a){case r:s=(n-i)/t+(n<i?6:0);break;case n:s=(i-r)/t+2;break;case i:s=(r-n)/t+4}s/=6}return t.h=s,t.s=l,t.l=c,t}getRGB(t,e=Xt.workingColorSpace){return Xt.fromWorkingColorSpace(Cr.copy(this),e),t.r=Cr.r,t.g=Cr.g,t.b=Cr.b,t}getStyle(t=ot){Xt.fromWorkingColorSpace(Cr.copy(this),t);const e=Cr.r,r=Cr.g,n=Cr.b;return t!==ot?`color(${t} ${e.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*r)},${Math.round(255*n)})`}offsetHSL(t,e,r){return this.getHSL(Mr),this.setHSL(Mr.h+t,Mr.s+e,Mr.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this}lerpHSL(t,e){this.getHSL(Mr),t.getHSL(Ar);const r=Pt(Mr.h,Ar.h,e),n=Pt(Mr.s,Ar.s,e),i=Pt(Mr.l,Ar.l,e);return this.setHSL(r,n,i),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,r=this.g,n=this.b,i=t.elements;return this.r=i[0]*e+i[3]*r+i[6]*n,this.g=i[1]*e+i[4]*r+i[7]*n,this.b=i[2]*e+i[5]*r+i[8]*n,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Cr=new Pr;Pr.NAMES=Er;let kr=0;class Dr extends xt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:kr++}),this.uuid=Mt(),this.name="",this.type="Material",this.blending=1,this.side=d,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=u,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pr(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mt,this.stencilZFail=mt,this.stencilZPass=mt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const r=t[e];if(void 0===r){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const n=this[e];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[e]=r:console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(t){const e=[];for(const r in t){const n=t[r];delete n.metadata,e.push(n)}return e}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),this.side!==d&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),204!==this.blendSrc&&(r.blendSrc=this.blendSrc),205!==this.blendDst&&(r.blendDst=this.blendDst),this.blendEquation!==u&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==mt&&(r.stencilFail=this.stencilFail),this.stencilZFail!==mt&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==mt&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),e){const e=n(t.textures),i=n(t.images);e.length>0&&(r.textures=e),i.length>0&&(r.images=i)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let r=null;if(null!==e){const t=e.length;r=new Array(t);for(let n=0;n!==t;++n)r[n]=e[n].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class Lr extends Dr{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=m,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Rr=new he,Or=new Ot;class Ir{constructor(t,e,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=r,this.usage=ft,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=B,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,r=this.count;e<r;e++)Or.fromBufferAttribute(this,e),Or.applyMatrix3(t),this.setXY(e,Or.x,Or.y);else if(3===this.itemSize)for(let e=0,r=this.count;e<r;e++)Rr.fromBufferAttribute(this,e),Rr.applyMatrix3(t),this.setXYZ(e,Rr.x,Rr.y,Rr.z);return this}applyMatrix4(t){for(let e=0,r=this.count;e<r;e++)Rr.fromBufferAttribute(this,e),Rr.applyMatrix4(t),this.setXYZ(e,Rr.x,Rr.y,Rr.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)Rr.fromBufferAttribute(this,e),Rr.applyNormalMatrix(t),this.setXYZ(e,Rr.x,Rr.y,Rr.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)Rr.fromBufferAttribute(this,e),Rr.transformDirection(t),this.setXYZ(e,Rr.x,Rr.y,Rr.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let r=this.array[t*this.itemSize+e];return this.normalized&&(r=Dt(r,this.array)),r}setComponent(t,e,r){return this.normalized&&(r=Lt(r,this.array)),this.array[t*this.itemSize+e]=r,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Dt(e,this.array)),e}setX(t,e){return this.normalized&&(e=Lt(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Dt(e,this.array)),e}setY(t,e){return this.normalized&&(e=Lt(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Dt(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Lt(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Dt(e,this.array)),e}setW(t,e){return this.normalized&&(e=Lt(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,r){return t*=this.itemSize,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array)),this.array[t+0]=e,this.array[t+1]=r,this}setXYZ(t,e,r,n){return t*=this.itemSize,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array),n=Lt(n,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this}setXYZW(t,e,r,n,i){return t*=this.itemSize,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array),n=Lt(n,this.array),i=Lt(i,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==ft&&(t.usage=this.usage),t}}class Nr extends Ir{constructor(t,e,r){super(new Uint16Array(t),e,r)}}class zr extends Ir{constructor(t,e,r){super(new Uint32Array(t),e,r)}}class Fr extends Ir{constructor(t,e,r){super(new Float32Array(t),e,r)}}let Ur=0;const Br=new Be,Vr=new dr,jr=new he,Gr=new ue,Hr=new ue,Wr=new he;class qr extends xt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ur++}),this.uuid=Mt(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(zt(t)?zr:Nr)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const e=(new It).getNormalMatrix(t);r.applyNormalMatrix(e),r.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Br.makeRotationFromQuaternion(t),this.applyMatrix4(Br),this}rotateX(t){return Br.makeRotationX(t),this.applyMatrix4(Br),this}rotateY(t){return Br.makeRotationY(t),this.applyMatrix4(Br),this}rotateZ(t){return Br.makeRotationZ(t),this.applyMatrix4(Br),this}translate(t,e,r){return Br.makeTranslation(t,e,r),this.applyMatrix4(Br),this}scale(t,e,r){return Br.makeScale(t,e,r),this.applyMatrix4(Br),this}lookAt(t){return Vr.lookAt(t),Vr.updateMatrix(),this.applyMatrix4(Vr.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jr).negate(),this.translate(jr.x,jr.y,jr.z),this}setFromPoints(t){const e=[];for(let r=0,n=t.length;r<n;r++){const n=t[r];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Fr(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ue);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new he(-1/0,-1/0,-1/0),new he(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];Gr.setFromBufferAttribute(r),this.morphTargetsRelative?(Wr.addVectors(this.boundingBox.min,Gr.min),this.boundingBox.expandByPoint(Wr),Wr.addVectors(this.boundingBox.max,Gr.max),this.boundingBox.expandByPoint(Wr)):(this.boundingBox.expandByPoint(Gr.min),this.boundingBox.expandByPoint(Gr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new De);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new he,1/0);if(t){const r=this.boundingSphere.center;if(Gr.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];Hr.setFromBufferAttribute(r),this.morphTargetsRelative?(Wr.addVectors(Gr.min,Hr.min),Gr.expandByPoint(Wr),Wr.addVectors(Gr.max,Hr.max),Gr.expandByPoint(Wr)):(Gr.expandByPoint(Hr.min),Gr.expandByPoint(Hr.max))}Gr.getCenter(r);let n=0;for(let e=0,i=t.count;e<i;e++)Wr.fromBufferAttribute(t,e),n=Math.max(n,r.distanceToSquared(Wr));if(e)for(let i=0,a=e.length;i<a;i++){const a=e[i],o=this.morphTargetsRelative;for(let e=0,i=a.count;e<i;e++)Wr.fromBufferAttribute(a,e),o&&(jr.fromBufferAttribute(t,e),Wr.add(jr)),n=Math.max(n,r.distanceToSquared(Wr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=t.array,n=e.position.array,i=e.normal.array,a=e.uv.array,o=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ir(new Float32Array(4*o),4));const s=this.getAttribute("tangent").array,l=[],c=[];for(let t=0;t<o;t++)l[t]=new he,c[t]=new he;const h=new he,d=new he,p=new he,u=new Ot,m=new Ot,f=new Ot,g=new he,v=new he;function b(t,e,r){h.fromArray(n,3*t),d.fromArray(n,3*e),p.fromArray(n,3*r),u.fromArray(a,2*t),m.fromArray(a,2*e),f.fromArray(a,2*r),d.sub(h),p.sub(h),m.sub(u),f.sub(u);const i=1/(m.x*f.y-f.x*m.y);isFinite(i)&&(g.copy(d).multiplyScalar(f.y).addScaledVector(p,-m.y).multiplyScalar(i),v.copy(p).multiplyScalar(m.x).addScaledVector(d,-f.x).multiplyScalar(i),l[t].add(g),l[e].add(g),l[r].add(g),c[t].add(v),c[e].add(v),c[r].add(v))}let y=this.groups;0===y.length&&(y=[{start:0,count:r.length}]);for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,i=n+e.count;t<i;t+=3)b(r[t+0],r[t+1],r[t+2])}const x=new he,_=new he,w=new he,S=new he;function E(t){w.fromArray(i,3*t),S.copy(w);const e=l[t];x.copy(e),x.sub(w.multiplyScalar(w.dot(e))).normalize(),_.crossVectors(S,e);const r=_.dot(c[t])<0?-1:1;s[4*t]=x.x,s[4*t+1]=x.y,s[4*t+2]=x.z,s[4*t+3]=r}for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,i=n+e.count;t<i;t+=3)E(r[t+0]),E(r[t+1]),E(r[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let r=this.getAttribute("normal");if(void 0===r)r=new Ir(new Float32Array(3*e.count),3),this.setAttribute("normal",r);else for(let t=0,e=r.count;t<e;t++)r.setXYZ(t,0,0,0);const n=new he,i=new he,a=new he,o=new he,s=new he,l=new he,c=new he,h=new he;if(t)for(let d=0,p=t.count;d<p;d+=3){const p=t.getX(d+0),u=t.getX(d+1),m=t.getX(d+2);n.fromBufferAttribute(e,p),i.fromBufferAttribute(e,u),a.fromBufferAttribute(e,m),c.subVectors(a,i),h.subVectors(n,i),c.cross(h),o.fromBufferAttribute(r,p),s.fromBufferAttribute(r,u),l.fromBufferAttribute(r,m),o.add(c),s.add(c),l.add(c),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(u,s.x,s.y,s.z),r.setXYZ(m,l.x,l.y,l.z)}else for(let t=0,o=e.count;t<o;t+=3)n.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),a.fromBufferAttribute(e,t+2),c.subVectors(a,i),h.subVectors(n,i),c.cross(h),r.setXYZ(t+0,c.x,c.y,c.z),r.setXYZ(t+1,c.x,c.y,c.z),r.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Wr.fromBufferAttribute(t,e),Wr.normalize(),t.setXYZ(e,Wr.x,Wr.y,Wr.z)}toNonIndexed(){function t(t,e){const r=t.array,n=t.itemSize,i=t.normalized,a=new r.constructor(e.length*n);let o=0,s=0;for(let i=0,l=e.length;i<l;i++){o=t.isInterleavedBufferAttribute?e[i]*t.data.stride+t.offset:e[i]*n;for(let t=0;t<n;t++)a[s++]=r[o++]}return new Ir(a,n,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new qr,r=this.index.array,n=this.attributes;for(const i in n){const a=t(n[i],r);e.setAttribute(i,a)}const i=this.morphAttributes;for(const n in i){const a=[],o=i[n];for(let e=0,n=o.length;e<n;e++){const n=t(o[e],r);a.push(n)}e.morphAttributes[n]=a}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let t=0,r=a.length;t<r;t++){const r=a[t];e.addGroup(r.start,r.count,r.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const e in r){const n=r[e];t.data.attributes[e]=n.toJSON(t.data)}const n={};let i=!1;for(const e in this.morphAttributes){const r=this.morphAttributes[e],a=[];for(let e=0,n=r.length;e<n;e++){const n=r[e];a.push(n.toJSON(t.data))}a.length>0&&(n[e]=a,i=!0)}i&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;null!==r&&this.setIndex(r.clone(e));const n=t.attributes;for(const t in n){const r=n[t];this.setAttribute(t,r.clone(e))}const i=t.morphAttributes;for(const t in i){const r=[],n=i[t];for(let t=0,i=n.length;t<i;t++)r.push(n[t].clone(e));this.morphAttributes[t]=r}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let t=0,e=a.length;t<e;t++){const e=a[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const $r=new Be,Xr=new Ue,Yr=new De,Zr=new he,Kr=new he,Jr=new he,Qr=new he,tn=new he,en=new he,rn=new Ot,nn=new Ot,an=new Ot,on=new he,sn=new he,ln=new he,cn=new he,hn=new he;class dn extends dr{constructor(t=new qr,e=new Lr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=r.length;t<e;t++){const e=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,a=r.morphTargetsRelative;e.fromBufferAttribute(n,t);const o=this.morphTargetInfluences;if(i&&o){en.set(0,0,0);for(let r=0,n=i.length;r<n;r++){const n=o[r],s=i[r];0!==n&&(tn.fromBufferAttribute(s,t),a?en.addScaledVector(tn,n):en.addScaledVector(tn.sub(e),n))}e.add(en)}return e}raycast(t,e){const r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n){if(null===r.boundingSphere&&r.computeBoundingSphere(),Yr.copy(r.boundingSphere),Yr.applyMatrix4(i),Xr.copy(t.ray).recast(t.near),!1===Yr.containsPoint(Xr.origin)){if(null===Xr.intersectSphere(Yr,Zr))return;if(Xr.origin.distanceToSquared(Zr)>(t.far-t.near)**2)return}$r.copy(i).invert(),Xr.copy(t.ray).applyMatrix4($r),null!==r.boundingBox&&!1===Xr.intersectsBox(r.boundingBox)||this._computeIntersections(t,e,Xr)}}_computeIntersections(t,e,r){let n;const i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,h=i.attributes.normal,d=i.groups,p=i.drawRange;if(null!==o)if(Array.isArray(a))for(let i=0,s=d.length;i<s;i++){const s=d[i],u=a[s.materialIndex];for(let i=Math.max(s.start,p.start),a=Math.min(o.count,Math.min(s.start+s.count,p.start+p.count));i<a;i+=3){n=pn(this,u,t,r,l,c,h,o.getX(i),o.getX(i+1),o.getX(i+2)),n&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=s.materialIndex,e.push(n))}}else{for(let i=Math.max(0,p.start),s=Math.min(o.count,p.start+p.count);i<s;i+=3){n=pn(this,a,t,r,l,c,h,o.getX(i),o.getX(i+1),o.getX(i+2)),n&&(n.faceIndex=Math.floor(i/3),e.push(n))}}else if(void 0!==s)if(Array.isArray(a))for(let i=0,o=d.length;i<o;i++){const o=d[i],u=a[o.materialIndex];for(let i=Math.max(o.start,p.start),a=Math.min(s.count,Math.min(o.start+o.count,p.start+p.count));i<a;i+=3){n=pn(this,u,t,r,l,c,h,i,i+1,i+2),n&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=o.materialIndex,e.push(n))}}else{for(let i=Math.max(0,p.start),o=Math.min(s.count,p.start+p.count);i<o;i+=3){n=pn(this,a,t,r,l,c,h,i,i+1,i+2),n&&(n.faceIndex=Math.floor(i/3),e.push(n))}}}}function pn(t,e,r,n,i,a,o,s,l,c){t.getVertexPosition(s,Kr),t.getVertexPosition(l,Jr),t.getVertexPosition(c,Qr);const h=function(t,e,r,n,i,a,o,s){let l;if(l=e.side===p?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,e.side===d,s),null===l)return null;hn.copy(s),hn.applyMatrix4(t.matrixWorld);const c=r.ray.origin.distanceTo(hn);return c<r.near||c>r.far?null:{distance:c,point:hn.clone(),object:t}}(t,e,r,n,Kr,Jr,Qr,cn);if(h){i&&(rn.fromBufferAttribute(i,s),nn.fromBufferAttribute(i,l),an.fromBufferAttribute(i,c),h.uv=Sr.getInterpolation(cn,Kr,Jr,Qr,rn,nn,an,new Ot)),a&&(rn.fromBufferAttribute(a,s),nn.fromBufferAttribute(a,l),an.fromBufferAttribute(a,c),h.uv1=Sr.getInterpolation(cn,Kr,Jr,Qr,rn,nn,an,new Ot),h.uv2=h.uv1),o&&(on.fromBufferAttribute(o,s),sn.fromBufferAttribute(o,l),ln.fromBufferAttribute(o,c),h.normal=Sr.getInterpolation(cn,Kr,Jr,Qr,on,sn,ln,new he),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const t={a:s,b:l,c,normal:new he,materialIndex:0};Sr.getNormal(Kr,Jr,Qr,t.normal),h.face=t}return h}class un extends qr{constructor(t=1,e=1,r=1,n=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};const o=this;n=Math.floor(n),i=Math.floor(i),a=Math.floor(a);const s=[],l=[],c=[],h=[];let d=0,p=0;function u(t,e,r,n,i,a,u,m,f,g,v){const b=a/f,y=u/g,x=a/2,_=u/2,w=m/2,S=f+1,E=g+1;let M=0,A=0;const T=new he;for(let a=0;a<E;a++){const o=a*y-_;for(let s=0;s<S;s++){const d=s*b-x;T[t]=d*n,T[e]=o*i,T[r]=w,l.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[r]=m>0?1:-1,c.push(T.x,T.y,T.z),h.push(s/f),h.push(1-a/g),M+=1}}for(let t=0;t<g;t++)for(let e=0;e<f;e++){const r=d+e+S*t,n=d+e+S*(t+1),i=d+(e+1)+S*(t+1),a=d+(e+1)+S*t;s.push(r,n,a),s.push(n,i,a),A+=6}o.addGroup(p,A,v),p+=A,d+=M}u("z","y","x",-1,-1,r,e,t,a,i,0),u("z","y","x",1,-1,r,e,-t,a,i,1),u("x","z","y",1,1,t,r,e,n,a,2),u("x","z","y",1,-1,t,r,-e,n,a,3),u("x","y","z",1,-1,t,e,r,n,i,4),u("x","y","z",-1,-1,t,e,-r,n,i,5),this.setIndex(s),this.setAttribute("position",new Fr(l,3)),this.setAttribute("normal",new Fr(c,3)),this.setAttribute("uv",new Fr(h,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new un(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function mn(t){const e={};for(const r in t){e[r]={};for(const n in t[r]){const i=t[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[r][n]=null):e[r][n]=i.clone():Array.isArray(i)?e[r][n]=i.slice():e[r][n]=i}}return e}function fn(t){const e={};for(let r=0;r<t.length;r++){const n=mn(t[r]);for(const t in n)e[t]=n[t]}return e}function gn(t){return null===t.getRenderTarget()?t.outputColorSpace:Xt.workingColorSpace}const vn={clone:mn,merge:fn};class bn extends Dr{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=mn(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let r=0;r<t.length;r++)e.push(t[r].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?e.uniforms[r]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[r]={type:"m4",value:n.toArray()}:e.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const r={};for(const t in this.extensions)!0===this.extensions[t]&&(r[t]=!0);return Object.keys(r).length>0&&(e.extensions=r),e}}class yn extends dr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Be,this.projectionMatrix=new Be,this.projectionMatrixInverse=new Be,this.coordinateSystem=bt}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class xn extends yn{constructor(t=50,e=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Et*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*St*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Et*Math.atan(Math.tan(.5*St*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,r,n,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*St*this.fov)/this.zoom,r=2*e,n=this.aspect*r,i=-.5*n;const a=this.view;if(null!==this.view&&this.view.enabled){const t=a.fullWidth,o=a.fullHeight;i+=a.offsetX*n/t,e-=a.offsetY*r/o,n*=a.width/t,r*=a.height/o}const o=this.filmOffset;0!==o&&(i+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,e,e-r,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const _n=-90;class wn extends dr{constructor(t,e,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new xn(_n,1,t,e);n.layers=this.layers,this.add(n);const i=new xn(_n,1,t,e);i.layers=this.layers,this.add(i);const a=new xn(_n,1,t,e);a.layers=this.layers,this.add(a);const o=new xn(_n,1,t,e);o.layers=this.layers,this.add(o);const s=new xn(_n,1,t,e);s.layers=this.layers,this.add(s);const l=new xn(_n,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[r,n,i,a,o,s]=e;for(const t of e)this.remove(t);if(t===bt)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(t!==yt)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const t of e)this.add(t),t.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[i,a,o,s,l,c]=this.children,h=t.getRenderTarget(),d=t.getActiveCubeFace(),p=t.getActiveMipmapLevel(),u=t.xr.enabled;t.xr.enabled=!1;const m=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0,n),t.render(e,i),t.setRenderTarget(r,1,n),t.render(e,a),t.setRenderTarget(r,2,n),t.render(e,o),t.setRenderTarget(r,3,n),t.render(e,s),t.setRenderTarget(r,4,n),t.render(e,l),r.texture.generateMipmaps=m,t.setRenderTarget(r,5,n),t.render(e,c),t.setRenderTarget(h,d,p),t.xr.enabled=u,r.texture.needsPMREMUpdate=!0}}class Sn extends ne{constructor(t,e,r,n,i,a,o,s,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:S,r,n,i,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class En extends oe{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const r={width:t,height:t,depth:1},n=[r,r,r,r,r,r];void 0!==e.encoding&&(Gt("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),e.colorSpace=e.encoding===it?ot:at),this.texture=new Sn(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:O}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new un(5,5,5),i=new bn({name:"CubemapFromEquirect",uniforms:mn(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:p,blending:0});i.uniforms.tEquirect.value=e;const a=new dn(n,i),o=e.minFilter;e.minFilter===I&&(e.minFilter=O);return new wn(1,10,this).update(t,a),e.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(t,e,r,n){const i=t.getRenderTarget();for(let i=0;i<6;i++)t.setRenderTarget(this,i),t.clear(e,r,n);t.setRenderTarget(i)}}const Mn=new he,An=new he,Tn=new It;class Pn{constructor(t=new he(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,r){const n=Mn.subVectors(r,e).cross(An.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const r=t.delta(Mn),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:e.copy(t.start).addScaledVector(r,i)}intersectsLine(t){const e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return e<0&&r>0||r<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const r=e||Tn.getNormalMatrix(t),n=this.coplanarPoint(Mn).applyMatrix4(t),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Cn=new De,kn=new he;class Dn{constructor(t=new Pn,e=new Pn,r=new Pn,n=new Pn,i=new Pn,a=new Pn){this.planes=[t,e,r,n,i,a]}set(t,e,r,n,i,a){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this}copy(t){const e=this.planes;for(let r=0;r<6;r++)e[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t,e=2e3){const r=this.planes,n=t.elements,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],h=n[6],d=n[7],p=n[8],u=n[9],m=n[10],f=n[11],g=n[12],v=n[13],b=n[14],y=n[15];if(r[0].setComponents(s-i,d-l,f-p,y-g).normalize(),r[1].setComponents(s+i,d+l,f+p,y+g).normalize(),r[2].setComponents(s+a,d+c,f+u,y+v).normalize(),r[3].setComponents(s-a,d-c,f-u,y-v).normalize(),r[4].setComponents(s-o,d-h,f-m,y-b).normalize(),e===bt)r[5].setComponents(s+o,d+h,f+m,y+b).normalize();else{if(e!==yt)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);r[5].setComponents(o,h,m,b).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Cn.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Cn.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Cn)}intersectsSprite(t){return Cn.center.set(0,0,0),Cn.radius=.7071067811865476,Cn.applyMatrix4(t.matrixWorld),this.intersectsSphere(Cn)}intersectsSphere(t){const e=this.planes,r=t.center,n=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(r)<n)return!1}return!0}intersectsBox(t){const e=this.planes;for(let r=0;r<6;r++){const n=e[r];if(kn.x=n.normal.x>0?t.max.x:t.min.x,kn.y=n.normal.y>0?t.max.y:t.min.y,kn.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(kn)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ln(){let t=null,e=!1,r=null,n=null;function i(e,a){r(e,a),n=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==r&&(n=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(t){r=t},setContext:function(e){t=e}}}function Rn(t,e){const r=e.isWebGL2,n=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),n.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const r=n.get(e);r&&(t.deleteBuffer(r.buffer),n.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){const t=n.get(e);return void((!t||t.version<e.version)&&n.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const a=n.get(e);if(void 0===a)n.set(e,function(e,n){const i=e.array,a=e.usage,o=i.byteLength,s=t.createBuffer();let l;if(t.bindBuffer(n,s),t.bufferData(n,i,a),e.onUploadCallback(),i instanceof Float32Array)l=t.FLOAT;else if(i instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");l=t.HALF_FLOAT}else l=t.UNSIGNED_SHORT;else if(i instanceof Int16Array)l=t.SHORT;else if(i instanceof Uint32Array)l=t.UNSIGNED_INT;else if(i instanceof Int32Array)l=t.INT;else if(i instanceof Int8Array)l=t.BYTE;else if(i instanceof Uint8Array)l=t.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);l=t.UNSIGNED_BYTE}return{buffer:s,type:l,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,size:o}}(e,i));else if(a.version<e.version){if(a.size!==e.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,n,i){const a=n.array,o=n._updateRange,s=n.updateRanges;if(t.bindBuffer(i,e),-1===o.count&&0===s.length&&t.bufferSubData(i,0,a),0!==s.length){for(let e=0,n=s.length;e<n;e++){const n=s[e];r?t.bufferSubData(i,n.start*a.BYTES_PER_ELEMENT,a,n.start,n.count):t.bufferSubData(i,n.start*a.BYTES_PER_ELEMENT,a.subarray(n.start,n.start+n.count))}n.clearUpdateRanges()}-1!==o.count&&(r?t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),n.onUploadCallback()}(a.buffer,e,i),a.version=e.version}}}}class On extends qr{constructor(t=1,e=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n};const i=t/2,a=e/2,o=Math.floor(r),s=Math.floor(n),l=o+1,c=s+1,h=t/o,d=e/s,p=[],u=[],m=[],f=[];for(let t=0;t<c;t++){const e=t*d-a;for(let r=0;r<l;r++){const n=r*h-i;u.push(n,-e,0),m.push(0,0,1),f.push(r/o),f.push(1-t/s)}}for(let t=0;t<s;t++)for(let e=0;e<o;e++){const r=e+l*t,n=e+l*(t+1),i=e+1+l*(t+1),a=e+1+l*t;p.push(r,n,a),p.push(n,i,a)}this.setIndex(p),this.setAttribute("position",new Fr(u,3)),this.setAttribute("normal",new Fr(m,3)),this.setAttribute("uv",new Fr(f,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new On(t.width,t.height,t.widthSegments,t.heightSegments)}}const In={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Nn={common:{diffuse:{value:new Pr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new It},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new It}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new It}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new It}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new It},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new It},normalScale:{value:new Ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new It},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new It}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new It}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new It}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0},uvTransform:{value:new It}},sprite:{diffuse:{value:new Pr(16777215)},opacity:{value:1},center:{value:new Ot(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new It},alphaMap:{value:null},alphaMapTransform:{value:new It},alphaTest:{value:0}}},zn={basic:{uniforms:fn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.fog]),vertexShader:In.meshbasic_vert,fragmentShader:In.meshbasic_frag},lambert:{uniforms:fn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new Pr(0)}}]),vertexShader:In.meshlambert_vert,fragmentShader:In.meshlambert_frag},phong:{uniforms:fn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new Pr(0)},specular:{value:new Pr(1118481)},shininess:{value:30}}]),vertexShader:In.meshphong_vert,fragmentShader:In.meshphong_frag},standard:{uniforms:fn([Nn.common,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.roughnessmap,Nn.metalnessmap,Nn.fog,Nn.lights,{emissive:{value:new Pr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag},toon:{uniforms:fn([Nn.common,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.gradientmap,Nn.fog,Nn.lights,{emissive:{value:new Pr(0)}}]),vertexShader:In.meshtoon_vert,fragmentShader:In.meshtoon_frag},matcap:{uniforms:fn([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,{matcap:{value:null}}]),vertexShader:In.meshmatcap_vert,fragmentShader:In.meshmatcap_frag},points:{uniforms:fn([Nn.points,Nn.fog]),vertexShader:In.points_vert,fragmentShader:In.points_frag},dashed:{uniforms:fn([Nn.common,Nn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:In.linedashed_vert,fragmentShader:In.linedashed_frag},depth:{uniforms:fn([Nn.common,Nn.displacementmap]),vertexShader:In.depth_vert,fragmentShader:In.depth_frag},normal:{uniforms:fn([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,{opacity:{value:1}}]),vertexShader:In.meshnormal_vert,fragmentShader:In.meshnormal_frag},sprite:{uniforms:fn([Nn.sprite,Nn.fog]),vertexShader:In.sprite_vert,fragmentShader:In.sprite_frag},background:{uniforms:{uvTransform:{value:new It},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:In.background_vert,fragmentShader:In.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:In.backgroundCube_vert,fragmentShader:In.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:In.cube_vert,fragmentShader:In.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:In.equirect_vert,fragmentShader:In.equirect_frag},distanceRGBA:{uniforms:fn([Nn.common,Nn.displacementmap,{referencePosition:{value:new he},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:In.distanceRGBA_vert,fragmentShader:In.distanceRGBA_frag},shadow:{uniforms:fn([Nn.lights,Nn.fog,{color:{value:new Pr(0)},opacity:{value:1}}]),vertexShader:In.shadow_vert,fragmentShader:In.shadow_frag}};zn.physical={uniforms:fn([zn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new It},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new It},clearcoatNormalScale:{value:new Ot(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new It},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new It},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new It},sheen:{value:0},sheenColor:{value:new Pr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new It},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new It},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new It},transmissionSamplerSize:{value:new Ot},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new It},attenuationDistance:{value:0},attenuationColor:{value:new Pr(0)},specularColor:{value:new Pr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new It},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new It},anisotropyVector:{value:new Ot},anisotropyMap:{value:null},anisotropyMapTransform:{value:new It}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag};const Fn={r:0,b:0,g:0};function Un(t,e,r,n,i,a,o){const s=new Pr(0);let l,c,h=!0===a?0:1,u=null,m=0,f=null;function g(e,r){e.getRGB(Fn,gn(t)),n.buffers.color.setClear(Fn.r,Fn.g,Fn.b,r,o)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),h=e,g(s,h)},getClearAlpha:function(){return h},setClearAlpha:function(t){h=t,g(s,h)},render:function(a,v){let b=!1,y=!0===v.isScene?v.background:null;if(y&&y.isTexture){y=(v.backgroundBlurriness>0?r:e).get(y)}null===y?g(s,h):y&&y.isColor&&(g(y,1),b=!0);const x=t.xr.getEnvironmentBlendMode();"additive"===x?n.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===x&&n.buffers.color.setClear(0,0,0,0,o),(t.autoClear||b)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),y&&(y.isCubeTexture||y.mapping===T)?(void 0===c&&(c=new dn(new un(1,1,1),new bn({name:"BackgroundCubeMaterial",uniforms:mn(zn.backgroundCube.uniforms),vertexShader:zn.backgroundCube.vertexShader,fragmentShader:zn.backgroundCube.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=y,c.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=Xt.getTransfer(y.colorSpace)!==dt,u===y&&m===y.version&&f===t.toneMapping||(c.material.needsUpdate=!0,u=y,m=y.version,f=t.toneMapping),c.layers.enableAll(),a.unshift(c,c.geometry,c.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new dn(new On(2,2),new bn({name:"BackgroundMaterial",uniforms:mn(zn.background.uniforms),vertexShader:zn.background.vertexShader,fragmentShader:zn.background.fragmentShader,side:d,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,l.material.toneMapped=Xt.getTransfer(y.colorSpace)!==dt,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),u===y&&m===y.version&&f===t.toneMapping||(l.material.needsUpdate=!0,u=y,m=y.version,f=t.toneMapping),l.layers.enableAll(),a.unshift(l,l.geometry,l.material,0,0,null))}}}function Bn(t,e,r,n){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),a=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==a,s={},l=u(null);let c=l,h=!1;function d(e){return n.isWebGL2?t.bindVertexArray(e):a.bindVertexArrayOES(e)}function p(e){return n.isWebGL2?t.deleteVertexArray(e):a.deleteVertexArrayOES(e)}function u(t){const e=[],r=[],n=[];for(let t=0;t<i;t++)e[t]=0,r[t]=0,n[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:r,attributeDivisors:n,object:t,attributes:{},index:null}}function m(){const t=c.newAttributes;for(let e=0,r=t.length;e<r;e++)t[e]=0}function f(t){g(t,0)}function g(r,i){const a=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;if(a[r]=1,0===o[r]&&(t.enableVertexAttribArray(r),o[r]=1),s[r]!==i){(n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),s[r]=i}}function v(){const e=c.newAttributes,r=c.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==e[n]&&(t.disableVertexAttribArray(n),r[n]=0)}function b(e,r,n,i,a,o,s){!0===s?t.vertexAttribIPointer(e,r,n,a,o):t.vertexAttribPointer(e,r,n,i,a,o)}function y(){x(),h=!0,c!==l&&(c=l,d(c.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,p,y,x){let _=!1;if(o){const e=function(e,r,i){const o=!0===i.wireframe;let l=s[e.id];void 0===l&&(l={},s[e.id]=l);let c=l[r.id];void 0===c&&(c={},l[r.id]=c);let h=c[o];void 0===h&&(h=u(n.isWebGL2?t.createVertexArray():a.createVertexArrayOES()),c[o]=h);return h}(y,p,l);c!==e&&(c=e,d(c.object)),_=function(t,e,r,n){const i=c.attributes,a=e.attributes;let o=0;const s=r.getAttributes();for(const e in s){if(s[e].location>=0){const r=i[e];let n=a[e];if(void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor)),void 0===r)return!0;if(r.attribute!==n)return!0;if(n&&r.data!==n.data)return!0;o++}}return c.attributesNum!==o||c.index!==n}(i,y,p,x),_&&function(t,e,r,n){const i={},a=e.attributes;let o=0;const s=r.getAttributes();for(const e in s){if(s[e].location>=0){let r=a[e];void 0===r&&("instanceMatrix"===e&&t.instanceMatrix&&(r=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(r=t.instanceColor));const n={};n.attribute=r,r&&r.data&&(n.data=r.data),i[e]=n,o++}}c.attributes=i,c.attributesNum=o,c.index=n}(i,y,p,x)}else{const t=!0===l.wireframe;c.geometry===y.id&&c.program===p.id&&c.wireframe===t||(c.geometry=y.id,c.program=p.id,c.wireframe=t,_=!0)}null!==x&&r.update(x,t.ELEMENT_ARRAY_BUFFER),(_||h)&&(h=!1,function(i,a,o,s){if(!1===n.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;m();const l=s.attributes,c=o.getAttributes(),h=a.defaultAttributeValues;for(const e in c){const a=c[e];if(a.location>=0){let o=l[e];if(void 0===o&&("instanceMatrix"===e&&i.instanceMatrix&&(o=i.instanceMatrix),"instanceColor"===e&&i.instanceColor&&(o=i.instanceColor)),void 0!==o){const e=o.normalized,l=o.itemSize,c=r.get(o);if(void 0===c)continue;const h=c.buffer,d=c.type,p=c.bytesPerElement,u=!0===n.isWebGL2&&(d===t.INT||d===t.UNSIGNED_INT||o.gpuType===F);if(o.isInterleavedBufferAttribute){const r=o.data,n=r.stride,c=o.offset;if(r.isInstancedInterleavedBuffer){for(let t=0;t<a.locationSize;t++)g(a.location+t,r.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let t=0;t<a.locationSize;t++)f(a.location+t);t.bindBuffer(t.ARRAY_BUFFER,h);for(let t=0;t<a.locationSize;t++)b(a.location+t,l/a.locationSize,d,e,n*p,(c+l/a.locationSize*t)*p,u)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<a.locationSize;t++)g(a.location+t,o.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<a.locationSize;t++)f(a.location+t);t.bindBuffer(t.ARRAY_BUFFER,h);for(let t=0;t<a.locationSize;t++)b(a.location+t,l/a.locationSize,d,e,l*p,l/a.locationSize*t*p,u)}}else if(void 0!==h){const r=h[e];if(void 0!==r)switch(r.length){case 2:t.vertexAttrib2fv(a.location,r);break;case 3:t.vertexAttrib3fv(a.location,r);break;case 4:t.vertexAttrib4fv(a.location,r);break;default:t.vertexAttrib1fv(a.location,r)}}}}v()}(i,l,p,y),null!==x&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.get(x).buffer))},reset:y,resetDefaultState:x,dispose:function(){y();for(const t in s){const e=s[t];for(const t in e){const r=e[t];for(const t in r)p(r[t].object),delete r[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const r=e[t];for(const t in r)p(r[t].object),delete r[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const r=s[e];if(void 0===r[t.id])continue;const n=r[t.id];for(const t in n)p(n[t].object),delete n[t];delete r[t.id]}},initAttributes:m,enableAttribute:f,disableUnusedAttributes:v}}function Vn(t,e,r,n){const i=n.isWebGL2;let a;this.setMode=function(t){a=t},this.render=function(e,n){t.drawArrays(a,e,n),r.update(n,a,1)},this.renderInstances=function(n,o,s){if(0===s)return;let l,c;if(i)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](a,n,o,s),r.update(o,a,s)},this.renderMultiDraw=function(t,n,i){if(0===i)return;const o=e.get("WEBGL_multi_draw");if(null===o)for(let e=0;e<i;e++)this.render(t[e],n[e]);else{o.multiDrawArraysWEBGL(a,t,0,n,0,i);let e=0;for(let t=0;t<i;t++)e+=n[t];r.update(e,a,1)}}}function jn(t,e,r){let n;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===t.constructor.name;let o=void 0!==r.precision?r.precision:"highp";const s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);const l=a||e.has("WEBGL_draw_buffers"),c=!0===r.logarithmicDepthBuffer,h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),m=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),g=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),b=d>0,y=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const r=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:u,maxAttributes:m,maxVertexUniforms:f,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:y,floatVertexTextures:b&&y,maxSamples:a?t.getParameter(t.MAX_SAMPLES):0}}function Gn(t){const e=this;let r=null,n=0,i=!1,a=!1;const o=new Pn,s=new It,l={value:null,needsUpdate:!1};function c(t,r,n,i){const a=null!==t?t.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){const e=n+4*a,i=r.matrixWorldInverse;s.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,r=n;e!==a;++e,r+=4)o.copy(t[e]).applyMatrix4(i,s),o.normal.toArray(c,r),c[r+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=a,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const r=0!==t.length||e||0!==n||i;return i=e,n=t.length,r},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(t,e){r=c(t,e,0)},this.setState=function(o,s,h){const d=o.clippingPlanes,p=o.clipIntersection,u=o.clipShadows,m=t.get(o);if(!i||null===d||0===d.length||a&&!u)a?c(null):function(){l.value!==r&&(l.value=r,l.needsUpdate=n>0);e.numPlanes=n,e.numIntersection=0}();else{const t=a?0:n,e=4*t;let i=m.clippingState||null;l.value=i,i=c(d,s,e,h);for(let t=0;t!==e;++t)i[t]=r[t];m.clippingState=i,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=t}}}function Hn(t){let e=new WeakMap;function r(t,e){return e===M?t.mapping=S:e===A&&(t.mapping=E),t}function n(t){const r=t.target;r.removeEventListener("dispose",n);const i=e.get(r);void 0!==i&&(e.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping;if(a===M||a===A){if(e.has(i)){return r(e.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const o=new En(a.height/2);return o.fromEquirectangularTexture(t,i),e.set(i,o),i.addEventListener("dispose",n),r(o.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}class Wn extends yn{constructor(t=-1,e=1,r=1,n=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=r,this.bottom=n,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let i=r-t,a=r+t,o=n+e,s=n-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,a=i+t*this.view.width,o-=e*this.view.offsetY,s=o-e*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const qn=[.125,.215,.35,.446,.526,.582],$n=20,Xn=new Wn,Yn=new Pr;let Zn=null,Kn=0,Jn=0;const Qn=(1+Math.sqrt(5))/2,ti=1/Qn,ei=[new he(1,1,1),new he(-1,1,1),new he(1,1,-1),new he(-1,1,-1),new he(0,Qn,ti),new he(0,Qn,-ti),new he(ti,0,Qn),new he(-ti,0,Qn),new he(Qn,ti,0),new he(-Qn,ti,0)];class ri{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,r=.1,n=100){Zn=this._renderer.getRenderTarget(),Kn=this._renderer.getActiveCubeFace(),Jn=this._renderer.getActiveMipmapLevel(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(t,r,n,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=oi(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=ai(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Zn,Kn,Jn),t.scissorTest=!1,ii(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===S||t.mapping===E?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Zn=this._renderer.getRenderTarget(),Kn=this._renderer.getActiveCubeFace(),Jn=this._renderer.getActiveMipmapLevel();const r=e||this._allocateTargets();return this._textureToCubeUV(t,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,r={magFilter:O,minFilter:O,generateMipmaps:!1,type:V,format:G,colorSpace:st,depthBuffer:!1},n=ni(t,e,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ni(t,e,r);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],r=[],n=[];let i=t;const a=t-4+1+qn.length;for(let o=0;o<a;o++){const a=Math.pow(2,i);r.push(a);let s=1/a;o>t-4?s=qn[o-t+4-1]:0===o&&(s=0),n.push(s);const l=1/(a-2),c=-l,h=1+l,d=[c,c,h,c,h,h,c,c,h,h,c,h],p=6,u=6,m=3,f=2,g=1,v=new Float32Array(m*u*p),b=new Float32Array(f*u*p),y=new Float32Array(g*u*p);for(let t=0;t<p;t++){const e=t%3*2/3-1,r=t>2?0:-1,n=[e,r,0,e+2/3,r,0,e+2/3,r+1,0,e,r,0,e+2/3,r+1,0,e,r+1,0];v.set(n,m*u*t),b.set(d,f*u*t);const i=[t,t,t,t,t,t];y.set(i,g*u*t)}const x=new qr;x.setAttribute("position",new Ir(v,m)),x.setAttribute("uv",new Ir(b,f)),x.setAttribute("faceIndex",new Ir(y,g)),e.push(x),i>4&&i--}return{lodPlanes:e,sizeLods:r,sigmas:n}}(n)),this._blurMaterial=function(t,e,r){const n=new Float32Array($n),i=new he(0,1,0),a=new bn({name:"SphericalGaussianBlur",defines:{n:$n,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return a}(n,t,e)}return n}_compileMaterial(t){const e=new dn(this._lodPlanes[0],t);this._renderer.compile(e,Xn)}_sceneToCubeUV(t,e,r,n){const i=new xn(90,1,e,r),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(Yn),s.toneMapping=v,s.autoClear=!1;const h=new Lr({name:"PMREM.Background",side:p,depthWrite:!1,depthTest:!1}),d=new dn(new un,h);let u=!1;const m=t.background;m?m.isColor&&(h.color.copy(m),t.background=null,u=!0):(h.color.copy(Yn),u=!0);for(let e=0;e<6;e++){const r=e%3;0===r?(i.up.set(0,a[e],0),i.lookAt(o[e],0,0)):1===r?(i.up.set(0,0,a[e]),i.lookAt(0,o[e],0)):(i.up.set(0,a[e],0),i.lookAt(0,0,o[e]));const l=this._cubeSize;ii(n,r*l,e>2?l:0,l,l),s.setRenderTarget(n),u&&s.render(d,i),s.render(t,i)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=c,s.autoClear=l,t.background=m}_textureToCubeUV(t,e){const r=this._renderer,n=t.mapping===S||t.mapping===E;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=oi()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ai());const i=n?this._cubemapMaterial:this._equirectMaterial,a=new dn(this._lodPlanes[0],i);i.uniforms.envMap.value=t;const o=this._cubeSize;ii(e,0,0,3*o,2*o),r.setRenderTarget(e),r.render(a,Xn)}_applyPMREM(t){const e=this._renderer,r=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const r=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),n=ei[(e-1)%ei.length];this._blur(t,e-1,e,r,n)}e.autoClear=r}_blur(t,e,r,n,i){const a=this._pingPongRenderTarget;this._halfBlur(t,a,e,r,n,"latitudinal",i),this._halfBlur(a,t,r,r,n,"longitudinal",i)}_halfBlur(t,e,r,n,i,a,o){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new dn(this._lodPlanes[n],l),h=l.uniforms,d=this._sizeLods[r]-1,p=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,u=i/p,m=isFinite(i)?1+Math.floor(3*u):$n;m>$n&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const f=[];let g=0;for(let t=0;t<$n;++t){const e=t/u,r=Math.exp(-e*e/2);f.push(r),0===t?g+=r:t<m&&(g+=2*r)}for(let t=0;t<f.length;t++)f[t]=f[t]/g;h.envMap.value=t.texture,h.samples.value=m,h.weights.value=f,h.latitudinal.value="latitudinal"===a,o&&(h.poleAxis.value=o);const{_lodMax:v}=this;h.dTheta.value=p,h.mipInt.value=v-r;const b=this._sizeLods[n];ii(e,3*b*(n>v-4?n-v+4:0),4*(this._cubeSize-b),3*b,2*b),s.setRenderTarget(e),s.render(c,Xn)}}function ni(t,e,r){const n=new oe(t,e,r);return n.texture.mapping=T,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function ii(t,e,r,n,i){t.viewport.set(e,r,n,i),t.scissor.set(e,r,n,i)}function ai(){return new bn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function oi(){return new bn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function si(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function li(t){let e=new WeakMap,r=null;function n(t){const r=t.target;r.removeEventListener("dispose",n);const i=e.get(r);void 0!==i&&(e.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,o=a===M||a===A,s=a===S||a===E;if(o||s){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let n=e.get(i);return null===r&&(r=new ri(t)),n=o?r.fromEquirectangular(i,n):r.fromCubemap(i,n),e.set(i,n),n.texture}if(e.has(i))return e.get(i).texture;{const a=i.image;if(o&&a&&a.height>0||s&&a&&function(t){let e=0;const r=6;for(let n=0;n<r;n++)void 0!==t[n]&&e++;return e===r}(a)){null===r&&(r=new ri(t));const a=o?r.fromEquirectangular(i):r.fromCubemap(i);return e.set(i,a),i.addEventListener("dispose",n),a.texture}return null}}}return i},dispose:function(){e=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function ci(t){const e={};function r(r){if(void 0!==e[r])return e[r];let n;switch(r){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return e[r]=n,n}return{has:function(t){return null!==r(t)},init:function(t){t.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(t){const e=r(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function hi(t,e,r,n){const i={},a=new WeakMap;function o(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const t in s.attributes)e.remove(s.attributes[t]);for(const t in s.morphAttributes){const r=s.morphAttributes[t];for(let t=0,n=r.length;t<n;t++)e.remove(r[t])}s.removeEventListener("dispose",o),delete i[s.id];const l=a.get(s);l&&(e.remove(l),a.delete(s)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,r.memory.geometries--}function s(t){const r=[],n=t.index,i=t.attributes.position;let o=0;if(null!==n){const t=n.array;o=n.version;for(let e=0,n=t.length;e<n;e+=3){const n=t[e+0],i=t[e+1],a=t[e+2];r.push(n,i,i,a,a,n)}}else{if(void 0===i)return;{const t=i.array;o=i.version;for(let e=0,n=t.length/3-1;e<n;e+=3){const t=e+0,n=e+1,i=e+2;r.push(t,n,n,i,i,t)}}}const s=new(zt(r)?zr:Nr)(r,1);s.version=o;const l=a.get(t);l&&e.remove(l),a.set(t,s)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",o),i[e.id]=!0,r.memory.geometries++),e},update:function(r){const n=r.attributes;for(const r in n)e.update(n[r],t.ARRAY_BUFFER);const i=r.morphAttributes;for(const r in i){const n=i[r];for(let r=0,i=n.length;r<i;r++)e.update(n[r],t.ARRAY_BUFFER)}},getWireframeAttribute:function(t){const e=a.get(t);if(e){const r=t.index;null!==r&&e.version<r.version&&s(t)}else s(t);return a.get(t)}}}function di(t,e,r,n){const i=n.isWebGL2;let a,o,s;this.setMode=function(t){a=t},this.setIndex=function(t){o=t.type,s=t.bytesPerElement},this.render=function(e,n){t.drawElements(a,n,o,e*s),r.update(n,a,1)},this.renderInstances=function(n,l,c){if(0===c)return;let h,d;if(i)h=t,d="drawElementsInstanced";else if(h=e.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===h)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[d](a,l,o,n*s,c),r.update(l,a,c)},this.renderMultiDraw=function(t,n,i){if(0===i)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<i;e++)this.render(t[e]/s,n[e]);else{l.multiDrawElementsWEBGL(a,n,0,o,t,0,i);let e=0;for(let t=0;t<i;t++)e+=n[t];r.update(e,a,1)}}}function pi(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(r,n,i){switch(e.calls++,n){case t.TRIANGLES:e.triangles+=i*(r/3);break;case t.LINES:e.lines+=i*(r/2);break;case t.LINE_STRIP:e.lines+=i*(r-1);break;case t.LINE_LOOP:e.lines+=i*r;break;case t.POINTS:e.points+=i*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function ui(t,e){return t[0]-e[0]}function mi(t,e){return Math.abs(e[1])-Math.abs(t[1])}function fi(t,e,r){const n={},i=new Float32Array(8),a=new WeakMap,o=new ie,s=[];for(let t=0;t<8;t++)s[t]=[t,0];return{update:function(l,c,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const p=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,u=void 0!==p?p.length:0;let m=a.get(c);if(void 0===m||m.count!==u){void 0!==m&&m.texture.dispose();const v=void 0!==c.morphAttributes.position,b=void 0!==c.morphAttributes.normal,y=void 0!==c.morphAttributes.color,x=c.morphAttributes.position||[],_=c.morphAttributes.normal||[],w=c.morphAttributes.color||[];let S=0;!0===v&&(S=1),!0===b&&(S=2),!0===y&&(S=3);let E=c.attributes.position.count*S,M=1;E>e.maxTextureSize&&(M=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);const A=new Float32Array(E*M*4*u),T=new se(A,E,M,u);T.type=B,T.needsUpdate=!0;const P=4*S;for(let k=0;k<u;k++){const D=x[k],L=_[k],R=w[k],O=E*M*4*k;for(let I=0;I<D.count;I++){const N=I*P;!0===v&&(o.fromBufferAttribute(D,I),A[O+N+0]=o.x,A[O+N+1]=o.y,A[O+N+2]=o.z,A[O+N+3]=0),!0===b&&(o.fromBufferAttribute(L,I),A[O+N+4]=o.x,A[O+N+5]=o.y,A[O+N+6]=o.z,A[O+N+7]=0),!0===y&&(o.fromBufferAttribute(R,I),A[O+N+8]=o.x,A[O+N+9]=o.y,A[O+N+10]=o.z,A[O+N+11]=4===R.itemSize?o.w:1)}}function C(){T.dispose(),a.delete(c),c.removeEventListener("dispose",C)}m={count:u,texture:T,size:new Ot(E,M)},a.set(c,m),c.addEventListener("dispose",C)}let f=0;for(let z=0;z<d.length;z++)f+=d[z];const g=c.morphTargetsRelative?1:1-f;h.getUniforms().setValue(t,"morphTargetBaseInfluence",g),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",m.texture,r),h.getUniforms().setValue(t,"morphTargetsTextureSize",m.size)}else{const F=void 0===d?0:d.length;let U=n[c.id];if(void 0===U||U.length!==F){U=[];for(let W=0;W<F;W++)U[W]=[W,0];n[c.id]=U}for(let q=0;q<F;q++){const $=U[q];$[0]=q,$[1]=d[q]}U.sort(mi);for(let X=0;X<8;X++)X<F&&U[X][1]?(s[X][0]=U[X][0],s[X][1]=U[X][1]):(s[X][0]=Number.MAX_SAFE_INTEGER,s[X][1]=0);s.sort(ui);const V=c.morphAttributes.position,j=c.morphAttributes.normal;let G=0;for(let Y=0;Y<8;Y++){const Z=s[Y],K=Z[0],J=Z[1];K!==Number.MAX_SAFE_INTEGER&&J?(V&&c.getAttribute("morphTarget"+Y)!==V[K]&&c.setAttribute("morphTarget"+Y,V[K]),j&&c.getAttribute("morphNormal"+Y)!==j[K]&&c.setAttribute("morphNormal"+Y,j[K]),i[Y]=J,G+=J):(V&&!0===c.hasAttribute("morphTarget"+Y)&&c.deleteAttribute("morphTarget"+Y),j&&!0===c.hasAttribute("morphNormal"+Y)&&c.deleteAttribute("morphNormal"+Y),i[Y]=0)}const H=c.morphTargetsRelative?1:1-G;h.getUniforms().setValue(t,"morphTargetBaseInfluence",H),h.getUniforms().setValue(t,"morphTargetInfluences",i)}}}}function gi(t,e,r,n){let i=new WeakMap;function a(t){const e=t.target;e.removeEventListener("dispose",a),r.remove(e.instanceMatrix),null!==e.instanceColor&&r.remove(e.instanceColor)}return{update:function(o){const s=n.render.frame,l=o.geometry,c=e.get(o,l);if(i.get(c)!==s&&(e.update(c),i.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(r.update(o.instanceMatrix,t.ARRAY_BUFFER),null!==o.instanceColor&&r.update(o.instanceColor,t.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){const t=o.skeleton;i.get(t)!==s&&(t.update(),i.set(t,s))}return c},dispose:function(){i=new WeakMap}}}class vi extends ne{constructor(t,e,r,n,i,a,o,s,l,c){if((c=void 0!==c?c:H)!==H&&c!==W)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===H&&(r=U),void 0===r&&c===W&&(r=j),super(null,n,i,a,o,s,c,r,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==o?o:D,this.minFilter=void 0!==s?s:D,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}const bi=new ne,yi=new vi(1,1);yi.compareFunction=515;const xi=new se,_i=new le,wi=new Sn,Si=[],Ei=[],Mi=new Float32Array(16),Ai=new Float32Array(9),Ti=new Float32Array(4);function Pi(t,e,r){const n=t[0];if(n<=0||n>0)return t;const i=e*r;let a=Si[i];if(void 0===a&&(a=new Float32Array(i),Si[i]=a),0!==e){n.toArray(a,0);for(let n=1,i=0;n!==e;++n)i+=r,t[n].toArray(a,i)}return a}function Ci(t,e){if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function ki(t,e){for(let r=0,n=e.length;r<n;r++)t[r]=e[r]}function Di(t,e){let r=Ei[e];void 0===r&&(r=new Int32Array(e),Ei[e]=r);for(let n=0;n!==e;++n)r[n]=t.allocateTextureUnit();return r}function Li(t,e){const r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function Ri(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(Ci(r,e))return;t.uniform2fv(this.addr,e),ki(r,e)}}function Oi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(void 0!==e.r)r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(Ci(r,e))return;t.uniform3fv(this.addr,e),ki(r,e)}}function Ii(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(Ci(r,e))return;t.uniform4fv(this.addr,e),ki(r,e)}}function Ni(t,e){const r=this.cache,n=e.elements;if(void 0===n){if(Ci(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),ki(r,e)}else{if(Ci(r,n))return;Ti.set(n),t.uniformMatrix2fv(this.addr,!1,Ti),ki(r,n)}}function zi(t,e){const r=this.cache,n=e.elements;if(void 0===n){if(Ci(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),ki(r,e)}else{if(Ci(r,n))return;Ai.set(n),t.uniformMatrix3fv(this.addr,!1,Ai),ki(r,n)}}function Fi(t,e){const r=this.cache,n=e.elements;if(void 0===n){if(Ci(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),ki(r,e)}else{if(Ci(r,n))return;Mi.set(n),t.uniformMatrix4fv(this.addr,!1,Mi),ki(r,n)}}function Ui(t,e){const r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function Bi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(Ci(r,e))return;t.uniform2iv(this.addr,e),ki(r,e)}}function Vi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(Ci(r,e))return;t.uniform3iv(this.addr,e),ki(r,e)}}function ji(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(Ci(r,e))return;t.uniform4iv(this.addr,e),ki(r,e)}}function Gi(t,e){const r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function Hi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(Ci(r,e))return;t.uniform2uiv(this.addr,e),ki(r,e)}}function Wi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(Ci(r,e))return;t.uniform3uiv(this.addr,e),ki(r,e)}}function qi(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(Ci(r,e))return;t.uniform4uiv(this.addr,e),ki(r,e)}}function $i(t,e,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i);const a=this.type===t.SAMPLER_2D_SHADOW?yi:bi;r.setTexture2D(e||a,i)}function Xi(t,e,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(e||_i,i)}function Yi(t,e,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(e||wi,i)}function Zi(t,e,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(e||xi,i)}function Ki(t,e){t.uniform1fv(this.addr,e)}function Ji(t,e){const r=Pi(e,this.size,2);t.uniform2fv(this.addr,r)}function Qi(t,e){const r=Pi(e,this.size,3);t.uniform3fv(this.addr,r)}function ta(t,e){const r=Pi(e,this.size,4);t.uniform4fv(this.addr,r)}function ea(t,e){const r=Pi(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}function ra(t,e){const r=Pi(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}function na(t,e){const r=Pi(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}function ia(t,e){t.uniform1iv(this.addr,e)}function aa(t,e){t.uniform2iv(this.addr,e)}function oa(t,e){t.uniform3iv(this.addr,e)}function sa(t,e){t.uniform4iv(this.addr,e)}function la(t,e){t.uniform1uiv(this.addr,e)}function ca(t,e){t.uniform2uiv(this.addr,e)}function ha(t,e){t.uniform3uiv(this.addr,e)}function da(t,e){t.uniform4uiv(this.addr,e)}function pa(t,e,r){const n=this.cache,i=e.length,a=Di(r,i);Ci(n,a)||(t.uniform1iv(this.addr,a),ki(n,a));for(let t=0;t!==i;++t)r.setTexture2D(e[t]||bi,a[t])}function ua(t,e,r){const n=this.cache,i=e.length,a=Di(r,i);Ci(n,a)||(t.uniform1iv(this.addr,a),ki(n,a));for(let t=0;t!==i;++t)r.setTexture3D(e[t]||_i,a[t])}function ma(t,e,r){const n=this.cache,i=e.length,a=Di(r,i);Ci(n,a)||(t.uniform1iv(this.addr,a),ki(n,a));for(let t=0;t!==i;++t)r.setTextureCube(e[t]||wi,a[t])}function fa(t,e,r){const n=this.cache,i=e.length,a=Di(r,i);Ci(n,a)||(t.uniform1iv(this.addr,a),ki(n,a));for(let t=0;t!==i;++t)r.setTexture2DArray(e[t]||xi,a[t])}class ga{constructor(t,e,r){this.id=t,this.addr=r,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return Li;case 35664:return Ri;case 35665:return Oi;case 35666:return Ii;case 35674:return Ni;case 35675:return zi;case 35676:return Fi;case 5124:case 35670:return Ui;case 35667:case 35671:return Bi;case 35668:case 35672:return Vi;case 35669:case 35673:return ji;case 5125:return Gi;case 36294:return Hi;case 36295:return Wi;case 36296:return qi;case 35678:case 36198:case 36298:case 36306:case 35682:return $i;case 35679:case 36299:case 36307:return Xi;case 35680:case 36300:case 36308:case 36293:return Yi;case 36289:case 36303:case 36311:case 36292:return Zi}}(e.type)}}class va{constructor(t,e,r){this.id=t,this.addr=r,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ki;case 35664:return Ji;case 35665:return Qi;case 35666:return ta;case 35674:return ea;case 35675:return ra;case 35676:return na;case 5124:case 35670:return ia;case 35667:case 35671:return aa;case 35668:case 35672:return oa;case 35669:case 35673:return sa;case 5125:return la;case 36294:return ca;case 36295:return ha;case 36296:return da;case 35678:case 36198:case 36298:case 36306:case 35682:return pa;case 35679:case 36299:case 36307:return ua;case 35680:case 36300:case 36308:case 36293:return ma;case 36289:case 36303:case 36311:case 36292:return fa}}(e.type)}}class ba{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,r){const n=this.seq;for(let i=0,a=n.length;i!==a;++i){const a=n[i];a.setValue(t,e[a.id],r)}}}const ya=/(\w+)(\])?(\[|\.)?/g;function xa(t,e){t.seq.push(e),t.map[e.id]=e}function _a(t,e,r){const n=t.name,i=n.length;for(ya.lastIndex=0;;){const a=ya.exec(n),o=ya.lastIndex;let s=a[1];const l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===i){xa(r,void 0===c?new ga(s,t,e):new va(s,t,e));break}{let t=r.map[s];void 0===t&&(t=new ba(s),xa(r,t)),r=t}}}class wa{constructor(t,e){this.seq=[],this.map={};const r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){const r=t.getActiveUniform(e,n);_a(r,t.getUniformLocation(e,r.name),this)}}setValue(t,e,r,n){const i=this.map[e];void 0!==i&&i.setValue(t,r,n)}setOptional(t,e,r){const n=e[r];void 0!==n&&this.setValue(t,r,n)}static upload(t,e,r,n){for(let i=0,a=e.length;i!==a;++i){const a=e[i],o=r[a.id];!1!==o.needsUpdate&&a.setValue(t,o.value,n)}}static seqWithValue(t,e){const r=[];for(let n=0,i=t.length;n!==i;++n){const i=t[n];i.id in e&&r.push(i)}return r}}function Sa(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}const Ea=37297;let Ma=0;function Aa(t,e,r){const n=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(n&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const n=parseInt(a[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+function(t,e){const r=t.split("\n"),n=[],i=Math.max(e-6,0),a=Math.min(e+6,r.length);for(let t=i;t<a;t++){const i=t+1;n.push(`${i===e?">":" "} ${i}: ${r[t]}`)}return n.join("\n")}(t.getShaderSource(e),n)}return i}function Ta(t,e){const r=function(t){const e=Xt.getPrimaries(Xt.workingColorSpace),r=Xt.getPrimaries(t);let n;switch(e===r?n="":e===ut&&r===pt?n="LinearDisplayP3ToLinearSRGB":e===pt&&r===ut&&(n="LinearSRGBToLinearDisplayP3"),t){case st:case ct:return[n,"LinearTransferOETF"];case ot:case lt:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[n,"LinearTransferOETF"]}}(e);return`vec4 ${t}( vec4 value ) { return ${r[0]}( ${r[1]}( value ) ); }`}function Pa(t,e){let r;switch(e){case b:r="Linear";break;case y:r="Reinhard";break;case x:r="OptimizedCineon";break;case _:r="ACESFilmic";break;case w:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Ca(t){return""!==t}function ka(t,e){const r=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Da(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const La=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ra(t){return t.replace(La,Ia)}const Oa=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Ia(t,e){let r=In[e];if(void 0===r){const t=Oa.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");r=In[t],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,t)}return Ra(r)}const Na=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function za(t){return t.replace(Na,Fa)}function Fa(t,e,r,n){let i="";for(let t=parseInt(e);t<parseInt(r);t++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return i}function Ua(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ba(t,e,r,n){const i=t.getContext(),a=r.defines;let o=r.vertexShader,s=r.fragmentShader;const d=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===l?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===c?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===h&&(e="SHADOWMAP_TYPE_VSM"),e}(r),p=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case S:case E:e="ENVMAP_TYPE_CUBE";break;case T:e="ENVMAP_TYPE_CUBE_UV"}return e}(r),u=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===E&&(e="ENVMAP_MODE_REFRACTION");return e}(r),b=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case m:e="ENVMAP_BLENDING_MULTIPLY";break;case f:e="ENVMAP_BLENDING_MIX";break;case g:e="ENVMAP_BLENDING_ADD"}return e}(r),y=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const r=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:n,maxMip:r}}(r),x=r.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ca).join("\n")}(r),_=function(t){const e=[];for(const r in t){const n=t[r];!1!==n&&e.push("#define "+r+" "+n)}return e.join("\n")}(a),w=i.createProgram();let M,A,P=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(M=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,_].filter(Ca).join("\n"),M.length>0&&(M+="\n"),A=[x,"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,_].filter(Ca).join("\n"),A.length>0&&(A+="\n")):(M=[Ua(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,_,r.batching?"#define USE_BATCHING":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.useLegacyLights?"#define LEGACY_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ca).join("\n"),A=[x,Ua(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,_,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.envMap?"#define "+u:"",r.envMap?"#define "+b:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.useLegacyLights?"#define LEGACY_LIGHTS":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==v?"#define TONE_MAPPING":"",r.toneMapping!==v?In.tonemapping_pars_fragment:"",r.toneMapping!==v?Pa("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",In.colorspace_pars_fragment,Ta("linearToOutputTexel",r.outputColorSpace),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Ca).join("\n")),o=Ra(o),o=ka(o,r),o=Da(o,r),s=Ra(s),s=ka(s,r),s=Da(s,r),o=za(o),s=za(s),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(P="#version 300 es\n",M=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+M,A=["precision mediump sampler2DArray;","#define varying in",r.glslVersion===gt?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===gt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+A);const C=P+M+o,k=P+A+s,D=Sa(i,i.VERTEX_SHADER,C),L=Sa(i,i.FRAGMENT_SHADER,k);function R(e){if(t.debug.checkShaderErrors){const r=i.getProgramInfoLog(w).trim(),n=i.getShaderInfoLog(D).trim(),a=i.getShaderInfoLog(L).trim();let o=!0,s=!0;if(!1===i.getProgramParameter(w,i.LINK_STATUS))if(o=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(i,w,D,L);else{const t=Aa(i,D,"vertex"),e=Aa(i,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(w,i.VALIDATE_STATUS)+"\n\nProgram Info Log: "+r+"\n"+t+"\n"+e)}else""!==r?console.warn("THREE.WebGLProgram: Program Info Log:",r):""!==n&&""!==a||(s=!1);s&&(e.diagnostics={runnable:o,programLog:r,vertexShader:{log:n,prefix:M},fragmentShader:{log:a,prefix:A}})}i.deleteShader(D),i.deleteShader(L),O=new wa(i,w),I=function(t,e){const r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const n=t.getActiveAttrib(e,i),a=n.name;let o=1;n.type===t.FLOAT_MAT2&&(o=2),n.type===t.FLOAT_MAT3&&(o=3),n.type===t.FLOAT_MAT4&&(o=4),r[a]={type:n.type,location:t.getAttribLocation(e,a),locationSize:o}}return r}(i,w)}let O,I;i.attachShader(w,D),i.attachShader(w,L),void 0!==r.index0AttributeName?i.bindAttribLocation(w,0,r.index0AttributeName):!0===r.morphTargets&&i.bindAttribLocation(w,0,"position"),i.linkProgram(w),this.getUniforms=function(){return void 0===O&&R(this),O},this.getAttributes=function(){return void 0===I&&R(this),I};let N=!1===r.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===N&&(N=i.getProgramParameter(w,Ea)),N},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(w),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=Ma++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=D,this.fragmentShader=L,this}let Va=0;class ja{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,r=t.fragmentShader,n=this._getShaderStage(e),i=this._getShaderStage(r),a=this._getShaderCacheForMaterial(t);return!1===a.has(n)&&(a.add(n),n.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let r=e.get(t);return void 0===r&&(r=new Set,e.set(t,r)),r}_getShaderStage(t){const e=this.shaderCache;let r=e.get(t);return void 0===r&&(r=new Ga(t),e.set(t,r)),r}}class Ga{constructor(t){this.id=Va++,this.code=t,this.usedTimes=0}}function Ha(t,e,r,n,i,a,o){const s=new Ke,l=new ja,c=[],h=i.isWebGL2,d=i.logarithmicDepthBuffer,u=i.vertexTextures;let m=i.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(t){return 0===t?"uv":`uv${t}`}return{getParameters:function(a,s,c,b,y){const x=b.fog,_=y.geometry,w=a.isMeshStandardMaterial?b.environment:null,S=(a.isMeshStandardMaterial?r:e).get(a.envMap||w),E=S&&S.mapping===T?S.image.height:null,M=f[a.type];null!==a.precision&&(m=i.getMaxPrecision(a.precision),m!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",m,"instead."));const A=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,P=void 0!==A?A.length:0;let C,k,D,L,R=0;if(void 0!==_.morphAttributes.position&&(R=1),void 0!==_.morphAttributes.normal&&(R=2),void 0!==_.morphAttributes.color&&(R=3),M){const t=zn[M];C=t.vertexShader,k=t.fragmentShader}else C=a.vertexShader,k=a.fragmentShader,l.update(a),D=l.getVertexShaderID(a),L=l.getFragmentShaderID(a);const O=t.getRenderTarget(),I=!0===y.isInstancedMesh,N=!0===y.isBatchedMesh,z=!!a.map,F=!!a.matcap,U=!!S,B=!!a.aoMap,V=!!a.lightMap,j=!!a.bumpMap,G=!!a.normalMap,H=!!a.displacementMap,W=!!a.emissiveMap,q=!!a.metalnessMap,$=!!a.roughnessMap,X=a.anisotropy>0,Y=a.clearcoat>0,Z=a.iridescence>0,K=a.sheen>0,J=a.transmission>0,Q=X&&!!a.anisotropyMap,tt=Y&&!!a.clearcoatMap,et=Y&&!!a.clearcoatNormalMap,rt=Y&&!!a.clearcoatRoughnessMap,nt=Z&&!!a.iridescenceMap,it=Z&&!!a.iridescenceThicknessMap,at=K&&!!a.sheenColorMap,ot=K&&!!a.sheenRoughnessMap,lt=!!a.specularMap,ct=!!a.specularColorMap,ht=!!a.specularIntensityMap,pt=J&&!!a.transmissionMap,ut=J&&!!a.thicknessMap,mt=!!a.gradientMap,ft=!!a.alphaMap,gt=a.alphaTest>0,vt=!!a.alphaHash,bt=!!a.extensions,yt=!!_.attributes.uv1,xt=!!_.attributes.uv2,_t=!!_.attributes.uv3;let wt=v;return a.toneMapped&&(null!==O&&!0!==O.isXRRenderTarget||(wt=t.toneMapping)),{isWebGL2:h,shaderID:M,shaderType:a.type,shaderName:a.name,vertexShader:C,fragmentShader:k,defines:a.defines,customVertexShaderID:D,customFragmentShaderID:L,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:m,batching:N,instancing:I,instancingColor:I&&null!==y.instanceColor,supportsVertexTextures:u,outputColorSpace:null===O?t.outputColorSpace:!0===O.isXRRenderTarget?O.texture.colorSpace:st,map:z,matcap:F,envMap:U,envMapMode:U&&S.mapping,envMapCubeUVHeight:E,aoMap:B,lightMap:V,bumpMap:j,normalMap:G,displacementMap:u&&H,emissiveMap:W,normalMapObjectSpace:G&&1===a.normalMapType,normalMapTangentSpace:G&&0===a.normalMapType,metalnessMap:q,roughnessMap:$,anisotropy:X,anisotropyMap:Q,clearcoat:Y,clearcoatMap:tt,clearcoatNormalMap:et,clearcoatRoughnessMap:rt,iridescence:Z,iridescenceMap:nt,iridescenceThicknessMap:it,sheen:K,sheenColorMap:at,sheenRoughnessMap:ot,specularMap:lt,specularColorMap:ct,specularIntensityMap:ht,transmission:J,transmissionMap:pt,thicknessMap:ut,gradientMap:mt,opaque:!1===a.transparent&&1===a.blending,alphaMap:ft,alphaTest:gt,alphaHash:vt,combine:a.combine,mapUv:z&&g(a.map.channel),aoMapUv:B&&g(a.aoMap.channel),lightMapUv:V&&g(a.lightMap.channel),bumpMapUv:j&&g(a.bumpMap.channel),normalMapUv:G&&g(a.normalMap.channel),displacementMapUv:H&&g(a.displacementMap.channel),emissiveMapUv:W&&g(a.emissiveMap.channel),metalnessMapUv:q&&g(a.metalnessMap.channel),roughnessMapUv:$&&g(a.roughnessMap.channel),anisotropyMapUv:Q&&g(a.anisotropyMap.channel),clearcoatMapUv:tt&&g(a.clearcoatMap.channel),clearcoatNormalMapUv:et&&g(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:rt&&g(a.clearcoatRoughnessMap.channel),iridescenceMapUv:nt&&g(a.iridescenceMap.channel),iridescenceThicknessMapUv:it&&g(a.iridescenceThicknessMap.channel),sheenColorMapUv:at&&g(a.sheenColorMap.channel),sheenRoughnessMapUv:ot&&g(a.sheenRoughnessMap.channel),specularMapUv:lt&&g(a.specularMap.channel),specularColorMapUv:ct&&g(a.specularColorMap.channel),specularIntensityMapUv:ht&&g(a.specularIntensityMap.channel),transmissionMapUv:pt&&g(a.transmissionMap.channel),thicknessMapUv:ut&&g(a.thicknessMap.channel),alphaMapUv:ft&&g(a.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(G||X),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,vertexUv1s:yt,vertexUv2s:xt,vertexUv3s:_t,pointsUvs:!0===y.isPoints&&!!_.attributes.uv&&(z||ft),fog:!!x,useFog:!0===a.fog,fogExp2:x&&x.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:P,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:wt,useLegacyLights:t._useLegacyLights,decodeVideoTexture:z&&!0===a.map.isVideoTexture&&Xt.getTransfer(a.map.colorSpace)===dt,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:a.side===p,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:bt&&!0===a.extensions.derivatives,extensionFragDepth:bt&&!0===a.extensions.fragDepth,extensionDrawBuffers:bt&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:bt&&!0===a.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(e){const r=[];if(e.shaderID?r.push(e.shaderID):(r.push(e.customVertexShaderID),r.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)r.push(t),r.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(r,e),function(t,e){s.disableAll(),e.isWebGL2&&s.enable(0);e.supportsVertexTextures&&s.enable(1);e.instancing&&s.enable(2);e.instancingColor&&s.enable(3);e.matcap&&s.enable(4);e.envMap&&s.enable(5);e.normalMapObjectSpace&&s.enable(6);e.normalMapTangentSpace&&s.enable(7);e.clearcoat&&s.enable(8);e.iridescence&&s.enable(9);e.alphaTest&&s.enable(10);e.vertexColors&&s.enable(11);e.vertexAlphas&&s.enable(12);e.vertexUv1s&&s.enable(13);e.vertexUv2s&&s.enable(14);e.vertexUv3s&&s.enable(15);e.vertexTangents&&s.enable(16);e.anisotropy&&s.enable(17);e.alphaHash&&s.enable(18);e.batching&&s.enable(19);t.push(s.mask),s.disableAll(),e.fog&&s.enable(0);e.useFog&&s.enable(1);e.flatShading&&s.enable(2);e.logarithmicDepthBuffer&&s.enable(3);e.skinning&&s.enable(4);e.morphTargets&&s.enable(5);e.morphNormals&&s.enable(6);e.morphColors&&s.enable(7);e.premultipliedAlpha&&s.enable(8);e.shadowMapEnabled&&s.enable(9);e.useLegacyLights&&s.enable(10);e.doubleSided&&s.enable(11);e.flipSided&&s.enable(12);e.useDepthPacking&&s.enable(13);e.dithering&&s.enable(14);e.transmission&&s.enable(15);e.sheen&&s.enable(16);e.opaque&&s.enable(17);e.pointsUvs&&s.enable(18);e.decodeVideoTexture&&s.enable(19);t.push(s.mask)}(r,e),r.push(t.outputColorSpace)),r.push(e.customProgramCacheKey),r.join()},getUniforms:function(t){const e=f[t.type];let r;if(e){const t=zn[e];r=vn.clone(t.uniforms)}else r=t.uniforms;return r},acquireProgram:function(e,r){let n;for(let t=0,e=c.length;t<e;t++){const e=c[t];if(e.cacheKey===r){n=e,++n.usedTimes;break}}return void 0===n&&(n=new Ba(t,r,e,a),c.push(n)),n},releaseProgram:function(t){if(0==--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:c,dispose:function(){l.dispose()}}}function Wa(){let t=new WeakMap;return{get:function(e){let r=t.get(e);return void 0===r&&(r={},t.set(e,r)),r},remove:function(e){t.delete(e)},update:function(e,r,n){t.get(e)[r]=n},dispose:function(){t=new WeakMap}}}function qa(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function $a(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Xa(){const t=[];let e=0;const r=[],n=[],i=[];function a(r,n,i,a,o,s){let l=t[e];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:a,renderOrder:r.renderOrder,z:o,group:s},t[e]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=a,l.renderOrder=r.renderOrder,l.z=o,l.group=s),e++,l}return{opaque:r,transmissive:n,transparent:i,init:function(){e=0,r.length=0,n.length=0,i.length=0},push:function(t,e,o,s,l,c){const h=a(t,e,o,s,l,c);o.transmission>0?n.push(h):!0===o.transparent?i.push(h):r.push(h)},unshift:function(t,e,o,s,l,c){const h=a(t,e,o,s,l,c);o.transmission>0?n.unshift(h):!0===o.transparent?i.unshift(h):r.unshift(h)},finish:function(){for(let r=e,n=t.length;r<n;r++){const e=t[r];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){r.length>1&&r.sort(t||qa),n.length>1&&n.sort(e||$a),i.length>1&&i.sort(e||$a)}}}function Ya(){let t=new WeakMap;return{get:function(e,r){const n=t.get(e);let i;return void 0===n?(i=new Xa,t.set(e,[i])):r>=n.length?(i=new Xa,n.push(i)):i=n[r],i},dispose:function(){t=new WeakMap}}}function Za(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new he,color:new Pr};break;case"SpotLight":r={position:new he,direction:new he,color:new Pr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new he,color:new Pr,distance:0,decay:0};break;case"HemisphereLight":r={direction:new he,skyColor:new Pr,groundColor:new Pr};break;case"RectAreaLight":r={color:new Pr,position:new he,halfWidth:new he,halfHeight:new he}}return t[e.id]=r,r}}}let Ka=0;function Ja(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Qa(t,e){const r=new Za,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let r;switch(e.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ot};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ot,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=r,r}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let t=0;t<9;t++)i.probe.push(new he);const a=new he,o=new Be,s=new Be;return{setup:function(a,o){let s=0,l=0,c=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let h=0,d=0,p=0,u=0,m=0,f=0,g=0,v=0,b=0,y=0,x=0;a.sort(Ja);const _=!0===o?Math.PI:1;for(let t=0,e=a.length;t<e;t++){const e=a[t],o=e.color,w=e.intensity,S=e.distance,E=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=o.r*w*_,l+=o.g*w*_,c+=o.b*w*_;else if(e.isLightProbe){for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],w);x++}else if(e.isDirectionalLight){const t=r.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*_),e.castShadow){const t=e.shadow,r=n.get(e);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,i.directionalShadow[h]=r,i.directionalShadowMap[h]=E,i.directionalShadowMatrix[h]=e.shadow.matrix,f++}i.directional[h]=t,h++}else if(e.isSpotLight){const t=r.get(e);t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(o).multiplyScalar(w*_),t.distance=S,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,i.spot[p]=t;const a=e.shadow;if(e.map&&(i.spotLightMap[b]=e.map,b++,a.updateMatrices(e),e.castShadow&&y++),i.spotLightMatrix[p]=a.matrix,e.castShadow){const t=n.get(e);t.shadowBias=a.bias,t.shadowNormalBias=a.normalBias,t.shadowRadius=a.radius,t.shadowMapSize=a.mapSize,i.spotShadow[p]=t,i.spotShadowMap[p]=E,v++}p++}else if(e.isRectAreaLight){const t=r.get(e);t.color.copy(o).multiplyScalar(w),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[u]=t,u++}else if(e.isPointLight){const t=r.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*_),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,r=n.get(e);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,r.shadowCameraNear=t.camera.near,r.shadowCameraFar=t.camera.far,i.pointShadow[d]=r,i.pointShadowMap[d]=E,i.pointShadowMatrix[d]=e.shadow.matrix,g++}i.point[d]=t,d++}else if(e.isHemisphereLight){const t=r.get(e);t.skyColor.copy(e.color).multiplyScalar(w*_),t.groundColor.copy(e.groundColor).multiplyScalar(w*_),i.hemi[m]=t,m++}}u>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=Nn.LTC_FLOAT_1,i.rectAreaLTC2=Nn.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Nn.LTC_HALF_1,i.rectAreaLTC2=Nn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=l,i.ambient[2]=c;const w=i.hash;w.directionalLength===h&&w.pointLength===d&&w.spotLength===p&&w.rectAreaLength===u&&w.hemiLength===m&&w.numDirectionalShadows===f&&w.numPointShadows===g&&w.numSpotShadows===v&&w.numSpotMaps===b&&w.numLightProbes===x||(i.directional.length=h,i.spot.length=p,i.rectArea.length=u,i.point.length=d,i.hemi.length=m,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=v+b-y,i.spotLightMap.length=b,i.numSpotLightShadowsWithMaps=y,i.numLightProbes=x,w.directionalLength=h,w.pointLength=d,w.spotLength=p,w.rectAreaLength=u,w.hemiLength=m,w.numDirectionalShadows=f,w.numPointShadows=g,w.numSpotShadows=v,w.numSpotMaps=b,w.numLightProbes=x,i.version=Ka++)},setupView:function(t,e){let r=0,n=0,l=0,c=0,h=0;const d=e.matrixWorldInverse;for(let e=0,p=t.length;e<p;e++){const p=t[e];if(p.isDirectionalLight){const t=i.directional[r];t.direction.setFromMatrixPosition(p.matrixWorld),a.setFromMatrixPosition(p.target.matrixWorld),t.direction.sub(a),t.direction.transformDirection(d),r++}else if(p.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(d),t.direction.setFromMatrixPosition(p.matrixWorld),a.setFromMatrixPosition(p.target.matrixWorld),t.direction.sub(a),t.direction.transformDirection(d),l++}else if(p.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(d),s.identity(),o.copy(p.matrixWorld),o.premultiply(d),s.extractRotation(o),t.halfWidth.set(.5*p.width,0,0),t.halfHeight.set(0,.5*p.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),c++}else if(p.isPointLight){const t=i.point[n];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(d),n++}else if(p.isHemisphereLight){const t=i.hemi[h];t.direction.setFromMatrixPosition(p.matrixWorld),t.direction.transformDirection(d),h++}}},state:i}}function to(t,e){const r=new Qa(t,e),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(t){r.setup(n,t)},setupLightsView:function(t){r.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){i.push(t)}}}function eo(t,e){let r=new WeakMap;return{get:function(n,i=0){const a=r.get(n);let o;return void 0===a?(o=new to(t,e),r.set(n,[o])):i>=a.length?(o=new to(t,e),a.push(o)):o=a[i],o},dispose:function(){r=new WeakMap}}}class ro extends Dr{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class no extends Dr{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function io(t,e,r){let n=new Dn;const i=new Ot,a=new Ot,o=new ie,s=new ro({depthPacking:3201}),c=new no,u={},m=r.maxTextureSize,f={[d]:p,[p]:d,2:2},g=new bn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ot},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const b=new qr;b.setAttribute("position",new Ir(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new dn(b,g),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=l;let _=this.type;function w(r,n){const a=e.update(y);g.defines.VSM_SAMPLES!==r.blurSamples&&(g.defines.VSM_SAMPLES=r.blurSamples,v.defines.VSM_SAMPLES=r.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new oe(i.x,i.y)),g.uniforms.shadow_pass.value=r.map.texture,g.uniforms.resolution.value=r.mapSize,g.uniforms.radius.value=r.radius,t.setRenderTarget(r.mapPass),t.clear(),t.renderBufferDirect(n,null,a,g,y,null),v.uniforms.shadow_pass.value=r.mapPass.texture,v.uniforms.resolution.value=r.mapSize,v.uniforms.radius.value=r.radius,t.setRenderTarget(r.map),t.clear(),t.renderBufferDirect(n,null,a,v,y,null)}function S(e,r,n,i){let a=null;const o=!0===n.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===n.isPointLight?c:s,t.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){const t=a.uuid,e=r.uuid;let n=u[t];void 0===n&&(n={},u[t]=n);let i=n[e];void 0===i&&(i=a.clone(),n[e]=i),a=i}if(a.visible=r.visible,a.wireframe=r.wireframe,a.side=i===h?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:f[r.side],a.alphaMap=r.alphaMap,a.alphaTest=r.alphaTest,a.map=r.map,a.clipShadows=r.clipShadows,a.clippingPlanes=r.clippingPlanes,a.clipIntersection=r.clipIntersection,a.displacementMap=r.displacementMap,a.displacementScale=r.displacementScale,a.displacementBias=r.displacementBias,a.wireframeLinewidth=r.wireframeLinewidth,a.linewidth=r.linewidth,!0===n.isPointLight&&!0===a.isMeshDistanceMaterial){t.properties.get(a).light=n}return a}function E(r,i,a,o,s){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&s===h)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,r.matrixWorld);const n=e.update(r),l=r.material;if(Array.isArray(l)){const e=n.groups;for(let c=0,h=e.length;c<h;c++){const h=e[c],d=l[h.materialIndex];if(d&&d.visible){const e=S(r,d,o,s);r.onBeforeShadow(t,r,i,a,n,e,h),t.renderBufferDirect(a,null,n,e,r,h),r.onAfterShadow(t,r,i,a,n,e,h)}}}else if(l.visible){const e=S(r,l,o,s);r.onBeforeShadow(t,r,i,a,n,e,null),t.renderBufferDirect(a,null,n,e,r,null),r.onAfterShadow(t,r,i,a,n,e,null)}}const l=r.children;for(let t=0,e=l.length;t<e;t++)E(l[t],i,a,o,s)}this.render=function(e,r,s){if(!1===x.enabled)return;if(!1===x.autoUpdate&&!1===x.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.state;p.setBlending(0),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);const u=_!==h&&this.type===h,f=_===h&&this.type!==h;for(let l=0,c=e.length;l<c;l++){const c=e[l],d=c.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;i.copy(d.mapSize);const g=d.getFrameExtents();if(i.multiply(g),a.copy(d.mapSize),(i.x>m||i.y>m)&&(i.x>m&&(a.x=Math.floor(m/g.x),i.x=a.x*g.x,d.mapSize.x=a.x),i.y>m&&(a.y=Math.floor(m/g.y),i.y=a.y*g.y,d.mapSize.y=a.y)),null===d.map||!0===u||!0===f){const t=this.type!==h?{minFilter:D,magFilter:D}:{};null!==d.map&&d.map.dispose(),d.map=new oe(i.x,i.y,t),d.map.texture.name=c.name+".shadowMap",d.camera.updateProjectionMatrix()}t.setRenderTarget(d.map),t.clear();const v=d.getViewportCount();for(let t=0;t<v;t++){const e=d.getViewport(t);o.set(a.x*e.x,a.y*e.y,a.x*e.z,a.y*e.w),p.viewport(o),d.updateMatrices(c,t),n=d.getFrustum(),E(r,s,d.camera,c,this.type)}!0!==d.isPointLightShadow&&this.type===h&&w(d,s),d.needsUpdate=!1}_=this.type,x.needsUpdate=!1,t.setRenderTarget(l,c,d)}}function ao(t,e,r){const n=r.isWebGL2;const i=new function(){let e=!1;const r=new ie;let n=null;const i=new ie(0,0,0,0);return{setMask:function(r){n===r||e||(t.colorMask(r,r,r,r),n=r)},setLocked:function(t){e=t},setClear:function(e,n,a,o,s){!0===s&&(e*=o,n*=o,a*=o),r.set(e,n,a,o),!1===i.equals(r)&&(t.clearColor(e,n,a,o),i.copy(r))},reset:function(){e=!1,n=null,i.set(-1,0,0,0)}}},a=new function(){let e=!1,r=null,n=null,i=null;return{setTest:function(e){e?H(t.DEPTH_TEST):W(t.DEPTH_TEST)},setMask:function(n){r===n||e||(t.depthMask(n),r=n)},setFunc:function(e){if(n!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}n=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,r=null,n=null,i=null}}},o=new function(){let e=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(r){e||(r?H(t.STENCIL_TEST):W(t.STENCIL_TEST))},setMask:function(n){r===n||e||(t.stencilMask(n),r=n)},setFunc:function(e,r,o){n===e&&i===r&&a===o||(t.stencilFunc(e,r,o),n=e,i=r,a=o)},setOp:function(e,r,n){o===e&&s===r&&l===n||(t.stencilOp(e,r,n),o=e,s=r,l=n)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,c=null}}},s=new WeakMap,l=new WeakMap;let c={},h={},d=new WeakMap,m=[],f=null,g=!1,v=null,b=null,y=null,x=null,_=null,w=null,S=null,E=new Pr(0,0,0),M=0,A=!1,T=null,P=null,C=null,k=null,D=null;const L=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,O=0;const I=t.getParameter(t.VERSION);-1!==I.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(I)[1]),R=O>=1):-1!==I.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),R=O>=2);let N=null,z={};const F=t.getParameter(t.SCISSOR_BOX),U=t.getParameter(t.VIEWPORT),B=(new ie).fromArray(F),V=(new ie).fromArray(U);function j(e,r,i,a){const o=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let s=0;s<i;s++)!n||e!==t.TEXTURE_3D&&e!==t.TEXTURE_2D_ARRAY?t.texImage2D(r+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o):t.texImage3D(r,0,t.RGBA,1,1,a,0,t.RGBA,t.UNSIGNED_BYTE,o);return s}const G={};function H(e){!0!==c[e]&&(t.enable(e),c[e]=!0)}function W(e){!1!==c[e]&&(t.disable(e),c[e]=!1)}G[t.TEXTURE_2D]=j(t.TEXTURE_2D,t.TEXTURE_2D,1),G[t.TEXTURE_CUBE_MAP]=j(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(G[t.TEXTURE_2D_ARRAY]=j(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),G[t.TEXTURE_3D]=j(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),i.setClear(0,0,0,1),a.setClear(1),o.setClear(0),H(t.DEPTH_TEST),a.setFunc(3),Y(!1),Z(1),H(t.CULL_FACE),X(0);const q={[u]:t.FUNC_ADD,101:t.FUNC_SUBTRACT,102:t.FUNC_REVERSE_SUBTRACT};if(n)q[103]=t.MIN,q[104]=t.MAX;else{const t=e.get("EXT_blend_minmax");null!==t&&(q[103]=t.MIN_EXT,q[104]=t.MAX_EXT)}const $={200:t.ZERO,201:t.ONE,202:t.SRC_COLOR,204:t.SRC_ALPHA,210:t.SRC_ALPHA_SATURATE,208:t.DST_COLOR,206:t.DST_ALPHA,203:t.ONE_MINUS_SRC_COLOR,205:t.ONE_MINUS_SRC_ALPHA,209:t.ONE_MINUS_DST_COLOR,207:t.ONE_MINUS_DST_ALPHA,211:t.CONSTANT_COLOR,212:t.ONE_MINUS_CONSTANT_COLOR,213:t.CONSTANT_ALPHA,214:t.ONE_MINUS_CONSTANT_ALPHA};function X(e,r,n,i,a,o,s,l,c,h){if(0!==e){if(!1===g&&(H(t.BLEND),g=!0),5===e)a=a||r,o=o||n,s=s||i,r===b&&a===_||(t.blendEquationSeparate(q[r],q[a]),b=r,_=a),n===y&&i===x&&o===w&&s===S||(t.blendFuncSeparate($[n],$[i],$[o],$[s]),y=n,x=i,w=o,S=s),!1!==l.equals(E)&&c===M||(t.blendColor(l.r,l.g,l.b,c),E.copy(l),M=c),v=e,A=!1;else if(e!==v||h!==A){if(b===u&&_===u||(t.blendEquation(t.FUNC_ADD),b=u,_=u),h)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}y=null,x=null,w=null,S=null,E.set(0,0,0),M=0,v=e,A=h}}else!0===g&&(W(t.BLEND),g=!1)}function Y(e){T!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),T=e)}function Z(e){0!==e?(H(t.CULL_FACE),e!==P&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):W(t.CULL_FACE),P=e}function K(e,r,n){e?(H(t.POLYGON_OFFSET_FILL),k===r&&D===n||(t.polygonOffset(r,n),k=r,D=n)):W(t.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:a,stencil:o},enable:H,disable:W,bindFramebuffer:function(e,r){return h[e]!==r&&(t.bindFramebuffer(e,r),h[e]=r,n&&(e===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=r),e===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=r)),!0)},drawBuffers:function(n,i){let a=m,o=!1;if(n)if(a=d.get(i),void 0===a&&(a=[],d.set(i,a)),n.isWebGLMultipleRenderTargets){const e=n.texture;if(a.length!==e.length||a[0]!==t.COLOR_ATTACHMENT0){for(let r=0,n=e.length;r<n;r++)a[r]=t.COLOR_ATTACHMENT0+r;a.length=e.length,o=!0}}else a[0]!==t.COLOR_ATTACHMENT0&&(a[0]=t.COLOR_ATTACHMENT0,o=!0);else a[0]!==t.BACK&&(a[0]=t.BACK,o=!0);o&&(r.isWebGL2?t.drawBuffers(a):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(e){return f!==e&&(t.useProgram(e),f=e,!0)},setBlending:X,setMaterial:function(e,r){2===e.side?W(t.CULL_FACE):H(t.CULL_FACE);let n=e.side===p;r&&(n=!n),Y(n),1===e.blending&&!1===e.transparent?X(0):X(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),i.setMask(e.colorWrite);const s=e.stencilWrite;o.setTest(s),s&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),K(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?H(t.SAMPLE_ALPHA_TO_COVERAGE):W(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Y,setCullFace:Z,setLineWidth:function(e){e!==C&&(R&&t.lineWidth(e),C=e)},setPolygonOffset:K,setScissorTest:function(e){e?H(t.SCISSOR_TEST):W(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+L-1),N!==e&&(t.activeTexture(e),N=e)},bindTexture:function(e,r,n){void 0===n&&(n=null===N?t.TEXTURE0+L-1:N);let i=z[n];void 0===i&&(i={type:void 0,texture:void 0},z[n]=i),i.type===e&&i.texture===r||(N!==n&&(t.activeTexture(n),N=n),t.bindTexture(e,r||G[e]),i.type=e,i.texture=r)},unbindTexture:function(){const e=z[N];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(e,r){let n=l.get(r);void 0===n&&(n=new WeakMap,l.set(r,n));let i=n.get(e);void 0===i&&(i=t.getUniformBlockIndex(r,e.name),n.set(e,i))},uniformBlockBinding:function(e,r){const n=l.get(r).get(e);s.get(r)!==n&&(t.uniformBlockBinding(r,n,e.__bindingPointIndex),s.set(r,n))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===B.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),B.copy(e))},viewport:function(e){!1===V.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),V.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),!0===n&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},N=null,z={},h={},d=new WeakMap,m=[],f=null,g=!1,v=null,b=null,y=null,x=null,_=null,w=null,S=null,E=new Pr(0,0,0),M=0,A=!1,T=null,P=null,C=null,k=null,D=null,B.set(0,0,t.canvas.width,t.canvas.height),V.set(0,0,t.canvas.width,t.canvas.height),i.reset(),a.reset(),o.reset()}}}function oo(t,e,r,n,i,a,o){const s=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,h=i.maxTextureSize,d=i.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let f;const g=new WeakMap;let v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function b(t,e){return v?new OffscreenCanvas(t,e):Bt("canvas")}function y(t,e,r,n){let i=1;if((t.width>n||t.height>n)&&(i=n/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=e?kt:Math.floor,a=n(i*t.width),o=n(i*t.height);void 0===f&&(f=b(a,o));const s=r?b(a,o):f;s.width=a,s.height=o;return s.getContext("2d").drawImage(t,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+o+")."),s}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function x(t){return Ct(t.width)&&Ct(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==D&&t.minFilter!==O}function w(e){t.generateMipmap(e)}function S(r,n,i,a,o=!1){if(!1===s)return n;if(null!==r){if(void 0!==t[r])return t[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let l=n;if(n===t.RED&&(i===t.FLOAT&&(l=t.R32F),i===t.HALF_FLOAT&&(l=t.R16F),i===t.UNSIGNED_BYTE&&(l=t.R8)),n===t.RED_INTEGER&&(i===t.UNSIGNED_BYTE&&(l=t.R8UI),i===t.UNSIGNED_SHORT&&(l=t.R16UI),i===t.UNSIGNED_INT&&(l=t.R32UI),i===t.BYTE&&(l=t.R8I),i===t.SHORT&&(l=t.R16I),i===t.INT&&(l=t.R32I)),n===t.RG&&(i===t.FLOAT&&(l=t.RG32F),i===t.HALF_FLOAT&&(l=t.RG16F),i===t.UNSIGNED_BYTE&&(l=t.RG8)),n===t.RGBA){const e=o?ht:Xt.getTransfer(a);i===t.FLOAT&&(l=t.RGBA32F),i===t.HALF_FLOAT&&(l=t.RGBA16F),i===t.UNSIGNED_BYTE&&(l=e===dt?t.SRGB8_ALPHA8:t.RGBA8),i===t.UNSIGNED_SHORT_4_4_4_4&&(l=t.RGBA4),i===t.UNSIGNED_SHORT_5_5_5_1&&(l=t.RGB5_A1)}return l!==t.R16F&&l!==t.R32F&&l!==t.RG16F&&l!==t.RG32F&&l!==t.RGBA16F&&l!==t.RGBA32F||e.get("EXT_color_buffer_float"),l}function E(t,e,r){return!0===_(t,r)||t.isFramebufferTexture&&t.minFilter!==D&&t.minFilter!==O?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function M(e){return e===D||e===L||e===R?t.NEAREST:t.LINEAR}function A(t){const e=t.target;e.removeEventListener("dispose",A),function(t){const e=n.get(t);if(void 0===e.__webglInit)return;const r=t.source,i=g.get(r);if(i){const n=i[e.__cacheKey];n.usedTimes--,0===n.usedTimes&&F(t),0===Object.keys(i).length&&g.delete(r)}n.remove(t)}(e),e.isVideoTexture&&m.delete(e)}function T(e){const r=e.target;r.removeEventListener("dispose",T),function(e){const r=e.texture,i=n.get(e),a=n.get(r);void 0!==a.__webglTexture&&(t.deleteTexture(a.__webglTexture),o.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++){if(Array.isArray(i.__webglFramebuffer[e]))for(let r=0;r<i.__webglFramebuffer[e].length;r++)t.deleteFramebuffer(i.__webglFramebuffer[e][r]);else t.deleteFramebuffer(i.__webglFramebuffer[e]);i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e])}else{if(Array.isArray(i.__webglFramebuffer))for(let e=0;e<i.__webglFramebuffer.length;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]);else t.deleteFramebuffer(i.__webglFramebuffer);if(i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let e=0;e<i.__webglColorRenderbuffer.length;e++)i.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(i.__webglColorRenderbuffer[e]);i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let e=0,i=r.length;e<i;e++){const i=n.get(r[e]);i.__webglTexture&&(t.deleteTexture(i.__webglTexture),o.memory.textures--),n.remove(r[e])}n.remove(r),n.remove(e)}(r)}function F(e){const r=n.get(e);t.deleteTexture(r.__webglTexture);const i=e.source;delete g.get(i)[r.__cacheKey],o.memory.textures--}let q=0;function $(e,i){const a=n.get(e);if(e.isVideoTexture&&function(t){const e=o.render.frame;m.get(t)!==e&&(m.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&a.__version!==e.version){const t=e.image;if(null===t)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==t.complete)return void Q(a,e,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.bindTexture(t.TEXTURE_2D,a.__webglTexture,t.TEXTURE0+i)}const X={[P]:t.REPEAT,[C]:t.CLAMP_TO_EDGE,[k]:t.MIRRORED_REPEAT},Y={[D]:t.NEAREST,[L]:t.NEAREST_MIPMAP_NEAREST,[R]:t.NEAREST_MIPMAP_LINEAR,[O]:t.LINEAR,1007:t.LINEAR_MIPMAP_NEAREST,[I]:t.LINEAR_MIPMAP_LINEAR},Z={512:t.NEVER,519:t.ALWAYS,513:t.LESS,515:t.LEQUAL,514:t.EQUAL,518:t.GEQUAL,516:t.GREATER,517:t.NOTEQUAL};function K(r,a,o){if(o?(t.texParameteri(r,t.TEXTURE_WRAP_S,X[a.wrapS]),t.texParameteri(r,t.TEXTURE_WRAP_T,X[a.wrapT]),r!==t.TEXTURE_3D&&r!==t.TEXTURE_2D_ARRAY||t.texParameteri(r,t.TEXTURE_WRAP_R,X[a.wrapR]),t.texParameteri(r,t.TEXTURE_MAG_FILTER,Y[a.magFilter]),t.texParameteri(r,t.TEXTURE_MIN_FILTER,Y[a.minFilter])):(t.texParameteri(r,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r!==t.TEXTURE_3D&&r!==t.TEXTURE_2D_ARRAY||t.texParameteri(r,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),a.wrapS===C&&a.wrapT===C||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(r,t.TEXTURE_MAG_FILTER,M(a.magFilter)),t.texParameteri(r,t.TEXTURE_MIN_FILTER,M(a.minFilter)),a.minFilter!==D&&a.minFilter!==O&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),a.compareFunction&&(t.texParameteri(r,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(r,t.TEXTURE_COMPARE_FUNC,Z[a.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(a.magFilter===D)return;if(a.minFilter!==R&&a.minFilter!==I)return;if(a.type===B&&!1===e.has("OES_texture_float_linear"))return;if(!1===s&&a.type===V&&!1===e.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(t.texParameterf(r,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function J(e,r){let n=!1;void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",A));const i=r.source;let a=g.get(i);void 0===a&&(a={},g.set(i,a));const s=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(r);if(s!==e.__cacheKey){void 0===a[s]&&(a[s]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,n=!0),a[s].usedTimes++;const i=a[e.__cacheKey];void 0!==i&&(a[e.__cacheKey].usedTimes--,0===i.usedTimes&&F(r)),e.__cacheKey=s,e.__webglTexture=a[s].texture}return n}function Q(e,i,o){let l=t.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),i.isData3DTexture&&(l=t.TEXTURE_3D);const c=J(e,i),d=i.source;r.bindTexture(l,e.__webglTexture,t.TEXTURE0+o);const p=n.get(d);if(d.version!==p.__version||!0===c){r.activeTexture(t.TEXTURE0+o);const e=Xt.getPrimaries(Xt.workingColorSpace),n=i.colorSpace===at?null:Xt.getPrimaries(i.colorSpace),u=i.colorSpace===at||e===n?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const m=function(t){return!s&&(t.wrapS!==C||t.wrapT!==C||t.minFilter!==D&&t.minFilter!==O)}(i)&&!1===x(i.image);let f=y(i.image,m,!1,h);f=ot(i,f);const g=x(f)||s,v=a.convert(i.format,i.colorSpace);let b,M=a.convert(i.type),A=S(i.internalFormat,v,M,i.colorSpace,i.isVideoTexture);K(l,i,g);const T=i.mipmaps,P=s&&!0!==i.isVideoTexture&&36196!==A,k=void 0===p.__version||!0===c,L=E(i,f,g);if(i.isDepthTexture)A=t.DEPTH_COMPONENT,s?A=i.type===B?t.DEPTH_COMPONENT32F:i.type===U?t.DEPTH_COMPONENT24:i.type===j?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT16:i.type===B&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===H&&A===t.DEPTH_COMPONENT&&i.type!==z&&i.type!==U&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=U,M=a.convert(i.type)),i.format===W&&A===t.DEPTH_COMPONENT&&(A=t.DEPTH_STENCIL,i.type!==j&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=j,M=a.convert(i.type))),k&&(P?r.texStorage2D(t.TEXTURE_2D,1,A,f.width,f.height):r.texImage2D(t.TEXTURE_2D,0,A,f.width,f.height,0,v,M,null));else if(i.isDataTexture)if(T.length>0&&g){P&&k&&r.texStorage2D(t.TEXTURE_2D,L,A,T[0].width,T[0].height);for(let e=0,n=T.length;e<n;e++)b=T[e],P?r.texSubImage2D(t.TEXTURE_2D,e,0,0,b.width,b.height,v,M,b.data):r.texImage2D(t.TEXTURE_2D,e,A,b.width,b.height,0,v,M,b.data);i.generateMipmaps=!1}else P?(k&&r.texStorage2D(t.TEXTURE_2D,L,A,f.width,f.height),r.texSubImage2D(t.TEXTURE_2D,0,0,0,f.width,f.height,v,M,f.data)):r.texImage2D(t.TEXTURE_2D,0,A,f.width,f.height,0,v,M,f.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){P&&k&&r.texStorage3D(t.TEXTURE_2D_ARRAY,L,A,T[0].width,T[0].height,f.depth);for(let e=0,n=T.length;e<n;e++)b=T[e],i.format!==G?null!==v?P?r.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,b.width,b.height,f.depth,v,b.data,0,0):r.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,A,b.width,b.height,f.depth,0,b.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):P?r.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,b.width,b.height,f.depth,v,M,b.data):r.texImage3D(t.TEXTURE_2D_ARRAY,e,A,b.width,b.height,f.depth,0,v,M,b.data)}else{P&&k&&r.texStorage2D(t.TEXTURE_2D,L,A,T[0].width,T[0].height);for(let e=0,n=T.length;e<n;e++)b=T[e],i.format!==G?null!==v?P?r.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,b.width,b.height,v,b.data):r.compressedTexImage2D(t.TEXTURE_2D,e,A,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):P?r.texSubImage2D(t.TEXTURE_2D,e,0,0,b.width,b.height,v,M,b.data):r.texImage2D(t.TEXTURE_2D,e,A,b.width,b.height,0,v,M,b.data)}else if(i.isDataArrayTexture)P?(k&&r.texStorage3D(t.TEXTURE_2D_ARRAY,L,A,f.width,f.height,f.depth),r.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,v,M,f.data)):r.texImage3D(t.TEXTURE_2D_ARRAY,0,A,f.width,f.height,f.depth,0,v,M,f.data);else if(i.isData3DTexture)P?(k&&r.texStorage3D(t.TEXTURE_3D,L,A,f.width,f.height,f.depth),r.texSubImage3D(t.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,v,M,f.data)):r.texImage3D(t.TEXTURE_3D,0,A,f.width,f.height,f.depth,0,v,M,f.data);else if(i.isFramebufferTexture){if(k)if(P)r.texStorage2D(t.TEXTURE_2D,L,A,f.width,f.height);else{let e=f.width,n=f.height;for(let i=0;i<L;i++)r.texImage2D(t.TEXTURE_2D,i,A,e,n,0,v,M,null),e>>=1,n>>=1}}else if(T.length>0&&g){P&&k&&r.texStorage2D(t.TEXTURE_2D,L,A,T[0].width,T[0].height);for(let e=0,n=T.length;e<n;e++)b=T[e],P?r.texSubImage2D(t.TEXTURE_2D,e,0,0,v,M,b):r.texImage2D(t.TEXTURE_2D,e,A,v,M,b);i.generateMipmaps=!1}else P?(k&&r.texStorage2D(t.TEXTURE_2D,L,A,f.width,f.height),r.texSubImage2D(t.TEXTURE_2D,0,0,0,v,M,f)):r.texImage2D(t.TEXTURE_2D,0,A,v,M,f);_(i,g)&&w(l),p.__version=d.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}function tt(e,i,o,s,l,c){const h=a.convert(o.format,o.colorSpace),d=a.convert(o.type),u=S(o.internalFormat,h,d,o.colorSpace);if(!n.get(i).__hasExternalTextures){const e=Math.max(1,i.width>>c),n=Math.max(1,i.height>>c);l===t.TEXTURE_3D||l===t.TEXTURE_2D_ARRAY?r.texImage3D(l,c,u,e,n,i.depth,0,h,d,null):r.texImage2D(l,c,u,e,n,0,h,d,null)}r.bindFramebuffer(t.FRAMEBUFFER,e),it(i)?p.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,s,l,n.get(o).__webglTexture,0,nt(i)):(l===t.TEXTURE_2D||l>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,s,l,n.get(o).__webglTexture,c),r.bindFramebuffer(t.FRAMEBUFFER,null)}function et(e,r,n){if(t.bindRenderbuffer(t.RENDERBUFFER,e),r.depthBuffer&&!r.stencilBuffer){let i=!0===s?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(n||it(r)){const e=r.depthTexture;e&&e.isDepthTexture&&(e.type===B?i=t.DEPTH_COMPONENT32F:e.type===U&&(i=t.DEPTH_COMPONENT24));const n=nt(r);it(r)?p.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,n,i,r.width,r.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,n,i,r.width,r.height)}else t.renderbufferStorage(t.RENDERBUFFER,i,r.width,r.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}else if(r.depthBuffer&&r.stencilBuffer){const i=nt(r);n&&!1===it(r)?t.renderbufferStorageMultisample(t.RENDERBUFFER,i,t.DEPTH24_STENCIL8,r.width,r.height):it(r)?p.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,i,t.DEPTH24_STENCIL8,r.width,r.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)}else{const e=!0===r.isWebGLMultipleRenderTargets?r.texture:[r.texture];for(let i=0;i<e.length;i++){const o=e[i],s=a.convert(o.format,o.colorSpace),l=a.convert(o.type),c=S(o.internalFormat,s,l,o.colorSpace),h=nt(r);n&&!1===it(r)?t.renderbufferStorageMultisample(t.RENDERBUFFER,h,c,r.width,r.height):it(r)?p.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,h,c,r.width,r.height):t.renderbufferStorage(t.RENDERBUFFER,c,r.width,r.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function rt(e){const i=n.get(e),a=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),$(i.depthTexture,0);const a=n.get(i.depthTexture).__webglTexture,o=nt(i);if(i.depthTexture.format===H)it(i)?p.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==W)throw new Error("Unknown depthTexture format");it(i)?p.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,e)}else if(a){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)r.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=t.createRenderbuffer(),et(i.__webglDepthbuffer[n],e,!1)}else r.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),et(i.__webglDepthbuffer,e,!1);r.bindFramebuffer(t.FRAMEBUFFER,null)}function nt(t){return Math.min(d,t.samples)}function it(t){const r=n.get(t);return s&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function ot(t,r){const n=t.colorSpace,i=t.format,a=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===vt||n!==st&&n!==at&&(Xt.getTransfer(n)===dt?!1===s?!0===e.has("EXT_sRGB")&&i===G?(t.format=vt,t.minFilter=O,t.generateMipmaps=!1):r=Jt.sRGBToLinear(r):i===G&&a===N||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),r}this.allocateTextureUnit=function(){const t=q;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),q+=1,t},this.resetTextureUnits=function(){q=0},this.setTexture2D=$,this.setTexture2DArray=function(e,i){const a=n.get(e);e.version>0&&a.__version!==e.version?Q(a,e,i):r.bindTexture(t.TEXTURE_2D_ARRAY,a.__webglTexture,t.TEXTURE0+i)},this.setTexture3D=function(e,i){const a=n.get(e);e.version>0&&a.__version!==e.version?Q(a,e,i):r.bindTexture(t.TEXTURE_3D,a.__webglTexture,t.TEXTURE0+i)},this.setTextureCube=function(e,i){const o=n.get(e);e.version>0&&o.__version!==e.version?function(e,i,o){if(6!==i.image.length)return;const l=J(e,i),h=i.source;r.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+o);const d=n.get(h);if(h.version!==d.__version||!0===l){r.activeTexture(t.TEXTURE0+o);const e=Xt.getPrimaries(Xt.workingColorSpace),n=i.colorSpace===at?null:Xt.getPrimaries(i.colorSpace),p=i.colorSpace===at||e===n?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);const u=i.isCompressedTexture||i.image[0].isCompressedTexture,m=i.image[0]&&i.image[0].isDataTexture,f=[];for(let t=0;t<6;t++)f[t]=u||m?m?i.image[t].image:i.image[t]:y(i.image[t],!1,!0,c),f[t]=ot(i,f[t]);const g=f[0],v=x(g)||s,b=a.convert(i.format,i.colorSpace),M=a.convert(i.type),A=S(i.internalFormat,b,M,i.colorSpace),T=s&&!0!==i.isVideoTexture,P=void 0===d.__version||!0===l;let C,k=E(i,g,v);if(K(t.TEXTURE_CUBE_MAP,i,v),u){T&&P&&r.texStorage2D(t.TEXTURE_CUBE_MAP,k,A,g.width,g.height);for(let e=0;e<6;e++){C=f[e].mipmaps;for(let n=0;n<C.length;n++){const a=C[n];i.format!==G?null!==b?T?r.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,0,0,a.width,a.height,b,a.data):r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,A,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):T?r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,0,0,a.width,a.height,b,M,a.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,A,a.width,a.height,0,b,M,a.data)}}}else{C=i.mipmaps,T&&P&&(C.length>0&&k++,r.texStorage2D(t.TEXTURE_CUBE_MAP,k,A,f[0].width,f[0].height));for(let e=0;e<6;e++)if(m){T?r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,f[e].width,f[e].height,b,M,f[e].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,A,f[e].width,f[e].height,0,b,M,f[e].data);for(let n=0;n<C.length;n++){const i=C[n].image[e].image;T?r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,i.width,i.height,b,M,i.data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,A,i.width,i.height,0,b,M,i.data)}}else{T?r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,b,M,f[e]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,A,b,M,f[e]);for(let n=0;n<C.length;n++){const i=C[n];T?r.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,b,M,i.image[e]):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,A,b,M,i.image[e])}}}_(i,v)&&w(t.TEXTURE_CUBE_MAP),d.__version=h.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}(o,e,i):r.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture,t.TEXTURE0+i)},this.rebindTextures=function(e,r,i){const a=n.get(e);void 0!==r&&tt(a.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==i&&rt(e)},this.setupRenderTarget=function(e){const l=e.texture,c=n.get(e),h=n.get(l);e.addEventListener("dispose",T),!0!==e.isWebGLMultipleRenderTargets&&(void 0===h.__webglTexture&&(h.__webglTexture=t.createTexture()),h.__version=l.version,o.memory.textures++);const d=!0===e.isWebGLCubeRenderTarget,p=!0===e.isWebGLMultipleRenderTargets,u=x(e)||s;if(d){c.__webglFramebuffer=[];for(let e=0;e<6;e++)if(s&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer[e]=[];for(let r=0;r<l.mipmaps.length;r++)c.__webglFramebuffer[e][r]=t.createFramebuffer()}else c.__webglFramebuffer[e]=t.createFramebuffer()}else{if(s&&l.mipmaps&&l.mipmaps.length>0){c.__webglFramebuffer=[];for(let e=0;e<l.mipmaps.length;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else c.__webglFramebuffer=t.createFramebuffer();if(p)if(i.drawBuffers){const r=e.texture;for(let e=0,i=r.length;e<i;e++){const i=n.get(r[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&e.samples>0&&!1===it(e)){const n=p?l:[l];c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=[],r.bindFramebuffer(t.FRAMEBUFFER,c.__webglMultisampledFramebuffer);for(let r=0;r<n.length;r++){const i=n[r];c.__webglColorRenderbuffer[r]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,c.__webglColorRenderbuffer[r]);const o=a.convert(i.format,i.colorSpace),s=a.convert(i.type),l=S(i.internalFormat,o,s,i.colorSpace,!0===e.isXRRenderTarget),h=nt(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,h,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+r,t.RENDERBUFFER,c.__webglColorRenderbuffer[r])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),et(c.__webglDepthRenderbuffer,e,!0)),r.bindFramebuffer(t.FRAMEBUFFER,null)}}if(d){r.bindTexture(t.TEXTURE_CUBE_MAP,h.__webglTexture),K(t.TEXTURE_CUBE_MAP,l,u);for(let r=0;r<6;r++)if(s&&l.mipmaps&&l.mipmaps.length>0)for(let n=0;n<l.mipmaps.length;n++)tt(c.__webglFramebuffer[r][n],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+r,n);else tt(c.__webglFramebuffer[r],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);_(l,u)&&w(t.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(p){const i=e.texture;for(let a=0,o=i.length;a<o;a++){const o=i[a],s=n.get(o);r.bindTexture(t.TEXTURE_2D,s.__webglTexture),K(t.TEXTURE_2D,o,u),tt(c.__webglFramebuffer,e,o,t.COLOR_ATTACHMENT0+a,t.TEXTURE_2D,0),_(o,u)&&w(t.TEXTURE_2D)}r.unbindTexture()}else{let n=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(s?n=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(n,h.__webglTexture),K(n,l,u),s&&l.mipmaps&&l.mipmaps.length>0)for(let r=0;r<l.mipmaps.length;r++)tt(c.__webglFramebuffer[r],e,l,t.COLOR_ATTACHMENT0,n,r);else tt(c.__webglFramebuffer,e,l,t.COLOR_ATTACHMENT0,n,0);_(l,u)&&w(n),r.unbindTexture()}e.depthBuffer&&rt(e)},this.updateRenderTargetMipmap=function(e){const i=x(e)||s,a=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let o=0,s=a.length;o<s;o++){const s=a[o];if(_(s,i)){const i=e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=n.get(s).__webglTexture;r.bindTexture(i,a),w(i),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(s&&e.samples>0&&!1===it(e)){const i=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],a=e.width,o=e.height;let s=t.COLOR_BUFFER_BIT;const l=[],c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,h=n.get(e),d=!0===e.isWebGLMultipleRenderTargets;if(d)for(let e=0;e<i.length;e++)r.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),r.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);r.bindFramebuffer(t.READ_FRAMEBUFFER,h.__webglMultisampledFramebuffer),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglFramebuffer);for(let r=0;r<i.length;r++){l.push(t.COLOR_ATTACHMENT0+r),e.depthBuffer&&l.push(c);const p=void 0!==h.__ignoreDepthValues&&h.__ignoreDepthValues;if(!1===p&&(e.depthBuffer&&(s|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&(s|=t.STENCIL_BUFFER_BIT)),d&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,h.__webglColorRenderbuffer[r]),!0===p&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[c]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[c])),d){const e=n.get(i[r]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,a,o,0,0,a,o,s,t.NEAREST),u&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l)}if(r.bindFramebuffer(t.READ_FRAMEBUFFER,null),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),d)for(let e=0;e<i.length;e++){r.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,h.__webglColorRenderbuffer[e]);const a=n.get(i[e]).__webglTexture;r.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,a,0)}r.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=rt,this.setupFrameBufferTexture=tt,this.useMultisampledRTT=it}function so(t,e,r){const n=r.isWebGL2;return{convert:function(r,i=""){let a;const o=Xt.getTransfer(i);if(r===N)return t.UNSIGNED_BYTE;if(1017===r)return t.UNSIGNED_SHORT_4_4_4_4;if(1018===r)return t.UNSIGNED_SHORT_5_5_5_1;if(1010===r)return t.BYTE;if(1011===r)return t.SHORT;if(r===z)return t.UNSIGNED_SHORT;if(r===F)return t.INT;if(r===U)return t.UNSIGNED_INT;if(r===B)return t.FLOAT;if(r===V)return n?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===r)return t.ALPHA;if(r===G)return t.RGBA;if(1024===r)return t.LUMINANCE;if(1025===r)return t.LUMINANCE_ALPHA;if(r===H)return t.DEPTH_COMPONENT;if(r===W)return t.DEPTH_STENCIL;if(r===vt)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===r)return t.RED;if(1029===r)return t.RED_INTEGER;if(1030===r)return t.RG;if(1031===r)return t.RG_INTEGER;if(1033===r)return t.RGBA_INTEGER;if(r===q||r===$||r===X||r===Y)if(o===dt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(r===q)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===$)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===X)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Y)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(r===q)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===$)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===X)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Y)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===r||35841===r||35842===r||35843===r){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===r)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===r)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===r)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===r)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===r)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===r||37496===r){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===r)return o===dt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===r||37809===r||37810===r||37811===r||37812===r||37813===r||37814===r||37815===r||37816===r||37817===r||37818===r||37819===r||37820===r||37821===r){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===r)return o===dt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===Z||36494===r||36495===r){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(r===Z)return o===dt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===r)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===r)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===r||36284===r||36285===r||36286===r){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(r===Z)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===r)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===r)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===r)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===j?n?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[r]?t[r]:null}}}class lo extends xn{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class co extends dr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ho={type:"move"};class po{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new co,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new co,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new he,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new he),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new co,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new he,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new he),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const r of t.hand.values())this._getHandJoint(e,r)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,r){let n=null,i=null,a=null;const o=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){a=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,r),i=this._getHandJoint(l,n);null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=t.radius),i.visible=null!==t}const n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=n.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&(i=e.getPose(t.gripSpace,r),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==o&&(n=e.getPose(t.targetRaySpace,r),null===n&&null!==i&&(n=i),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(ho)))}return null!==o&&(o.visible=null!==n),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const r=new co;r.matrixAutoUpdate=!1,r.visible=!1,t.joints[e.jointName]=r,t.add(r)}return t.joints[e.jointName]}}class uo extends xt{constructor(t,e){super();const r=this;let n=null,i=1,a=null,o="local-floor",s=1,l=null,c=null,h=null,d=null,p=null,u=null;const m=e.getContextAttributes();let f=null,g=null;const v=[],b=[],y=new Ot;let x=null;const _=new xn;_.layers.enable(1),_.viewport=new ie;const w=new xn;w.layers.enable(2),w.viewport=new ie;const S=[_,w],E=new lo;E.layers.enable(1),E.layers.enable(2);let M=null,A=null;function T(t){const e=b.indexOf(t.inputSource);if(-1===e)return;const r=v[e];void 0!==r&&(r.update(t.inputSource,t.frame,l||a),r.dispatchEvent({type:t.type,data:t.inputSource}))}function P(){n.removeEventListener("select",T),n.removeEventListener("selectstart",T),n.removeEventListener("selectend",T),n.removeEventListener("squeeze",T),n.removeEventListener("squeezestart",T),n.removeEventListener("squeezeend",T),n.removeEventListener("end",P),n.removeEventListener("inputsourceschange",C);for(let t=0;t<v.length;t++){const e=b[t];null!==e&&(b[t]=null,v[t].disconnect(e))}M=null,A=null,t.setRenderTarget(f),p=null,d=null,h=null,n=null,g=null,O.stop(),r.isPresenting=!1,t.setPixelRatio(x),t.setSize(y.width,y.height,!1),r.dispatchEvent({type:"sessionend"})}function C(t){for(let e=0;e<t.removed.length;e++){const r=t.removed[e],n=b.indexOf(r);n>=0&&(b[n]=null,v[n].disconnect(r))}for(let e=0;e<t.added.length;e++){const r=t.added[e];let n=b.indexOf(r);if(-1===n){for(let t=0;t<v.length;t++){if(t>=b.length){b.push(r),n=t;break}if(null===b[t]){b[t]=r,n=t;break}}if(-1===n)break}const i=v[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=v[t];return void 0===e&&(e=new po,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=v[t];return void 0===e&&(e=new po,v[t]=e),e.getGripSpace()},this.getHand=function(t){let e=v[t];return void 0===e&&(e=new po,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==d?d:p},this.getBinding=function(){return h},this.getFrame=function(){return u},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){if(f=t.getRenderTarget(),n.addEventListener("select",T),n.addEventListener("selectstart",T),n.addEventListener("selectend",T),n.addEventListener("squeeze",T),n.addEventListener("squeezestart",T),n.addEventListener("squeezeend",T),n.addEventListener("end",P),n.addEventListener("inputsourceschange",C),!0!==m.xrCompatible&&await e.makeXRCompatible(),x=t.getPixelRatio(),t.getSize(y),void 0===n.renderState.layers||!1===t.capabilities.isWebGL2){const r={antialias:void 0!==n.renderState.layers||m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:i};p=new XRWebGLLayer(n,e,r),n.updateRenderState({baseLayer:p}),t.setPixelRatio(1),t.setSize(p.framebufferWidth,p.framebufferHeight,!1),g=new oe(p.framebufferWidth,p.framebufferHeight,{format:G,type:N,colorSpace:t.outputColorSpace,stencilBuffer:m.stencil})}else{let r=null,a=null,o=null;m.depth&&(o=m.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,r=m.stencil?W:H,a=m.stencil?j:U);const s={colorFormat:e.RGBA8,depthFormat:o,scaleFactor:i};h=new XRWebGLBinding(n,e),d=h.createProjectionLayer(s),n.updateRenderState({layers:[d]}),t.setPixelRatio(1),t.setSize(d.textureWidth,d.textureHeight,!1),g=new oe(d.textureWidth,d.textureHeight,{format:G,type:N,depthTexture:new vi(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:m.stencil,colorSpace:t.outputColorSpace,samples:m.antialias?4:0});t.properties.get(g).__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await n.requestReferenceSpace(o),O.setContext(n),O.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode};const k=new he,D=new he;function L(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===n)return;E.near=w.near=_.near=t.near,E.far=w.far=_.far=t.far,M===E.near&&A===E.far||(n.updateRenderState({depthNear:E.near,depthFar:E.far}),M=E.near,A=E.far);const e=t.parent,r=E.cameras;L(E,e);for(let t=0;t<r.length;t++)L(r[t],e);2===r.length?function(t,e,r){k.setFromMatrixPosition(e.matrixWorld),D.setFromMatrixPosition(r.matrixWorld);const n=k.distanceTo(D),i=e.projectionMatrix.elements,a=r.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],h=(i[8]-1)/i[0],d=(a[8]+1)/a[0],p=o*h,u=o*d,m=n/(-h+d),f=m*-h;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(f),t.translateZ(m),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+m,v=s+m,b=p-f,y=u+(n-f),x=l*s/v*g,_=c*s/v*g;t.projectionMatrix.makePerspective(b,y,x,_,g,v),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}(E,_,w):E.projectionMatrix.copy(_.projectionMatrix),function(t,e,r){null===r?t.matrix.copy(e.matrixWorld):(t.matrix.copy(r.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*Et*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,E,e)},this.getCamera=function(){return E},this.getFoveation=function(){if(null!==d||null!==p)return s},this.setFoveation=function(t){s=t,null!==d&&(d.fixedFoveation=t),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=t)};let R=null;const O=new Ln;O.setAnimationLoop((function(e,n){if(c=n.getViewerPose(l||a),u=n,null!==c){const e=c.views;null!==p&&(t.setRenderTargetFramebuffer(g,p.framebuffer),t.setRenderTarget(g));let r=!1;e.length!==E.cameras.length&&(E.cameras.length=0,r=!0);for(let n=0;n<e.length;n++){const i=e[n];let a=null;if(null!==p)a=p.getViewport(i);else{const e=h.getViewSubImage(d,i);a=e.viewport,0===n&&(t.setRenderTargetTextures(g,e.colorTexture,d.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}let o=S[n];void 0===o&&(o=new xn,o.layers.enable(n),o.viewport=new ie,S[n]=o),o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(i.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(a.x,a.y,a.width,a.height),0===n&&(E.matrix.copy(o.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),!0===r&&E.cameras.push(o)}}for(let t=0;t<v.length;t++){const e=b[t],r=v[t];null!==e&&void 0!==r&&r.update(e,n,l||a)}R&&R(e,n),n.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:n}),u=null})),this.setAnimationLoop=function(t){R=t},this.dispose=function(){}}}function mo(t,e){function r(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map,r(i.map,n.mapTransform)),i.alphaMap&&(n.alphaMap.value=i.alphaMap,r(i.alphaMap,n.alphaMapTransform)),i.bumpMap&&(n.bumpMap.value=i.bumpMap,r(i.bumpMap,n.bumpMapTransform),n.bumpScale.value=i.bumpScale,i.side===p&&(n.bumpScale.value*=-1)),i.normalMap&&(n.normalMap.value=i.normalMap,r(i.normalMap,n.normalMapTransform),n.normalScale.value.copy(i.normalScale),i.side===p&&n.normalScale.value.negate()),i.displacementMap&&(n.displacementMap.value=i.displacementMap,r(i.displacementMap,n.displacementMapTransform),n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap,r(i.emissiveMap,n.emissiveMapTransform)),i.specularMap&&(n.specularMap.value=i.specularMap,r(i.specularMap,n.specularMapTransform)),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const a=e.get(i).envMap;if(a&&(n.envMap.value=a,n.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const e=!0===t._useLegacyLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*e,r(i.lightMap,n.lightMapTransform)}i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity,r(i.aoMap,n.aoMapTransform))}return{refreshFogUniforms:function(e,r){r.color.getRGB(e.fogColor.value,gn(t)),r.isFog?(e.fogNear.value=r.near,e.fogFar.value=r.far):r.isFogExp2&&(e.fogDensity.value=r.density)},refreshMaterialUniforms:function(t,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(t,i):i.isMeshToonMaterial?(n(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(n(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(n(t,i),function(t,n){t.metalness.value=n.metalness,n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap,r(n.metalnessMap,t.metalnessMapTransform));t.roughness.value=n.roughness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap,r(n.roughnessMap,t.roughnessMapTransform));const i=e.get(n).envMap;i&&(t.envMapIntensity.value=n.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,r(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,r(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,r(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,r(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,r(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),e.side===p&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,r(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,r(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,r(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,r(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,r(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,r(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,r(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,i,s)):i.isMeshMatcapMaterial?(n(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?n(t,i):i.isMeshDistanceMaterial?(n(t,i),function(t,r){const n=e.get(r).light;t.referencePosition.value.setFromMatrixPosition(n.matrixWorld),t.nearDistance.value=n.shadow.camera.near,t.farDistance.value=n.shadow.camera.far}(t,i)):i.isMeshNormalMaterial?n(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,r(e.map,t.mapTransform))}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map,r(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,r(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i,a,o):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,r(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,r(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function fo(t,e,r,n){let i={},a={},o=[];const s=r.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(t,e,r){const n=t.value;if(void 0===r[e]){if("number"==typeof n)r[e]=n;else{const t=Array.isArray(n)?n:[n],i=[];for(let e=0;e<t.length;e++)i.push(t[e].clone());r[e]=i}return!0}if("number"==typeof n){if(r[e]!==n)return r[e]=n,!0}else{const t=Array.isArray(r[e])?r[e]:[r[e]],i=Array.isArray(n)?n:[n];for(let e=0;e<t.length;e++){const r=t[e];if(!1===r.equals(i[e]))return r.copy(i[e]),!0}}return!1}function c(t){const e={boundary:0,storage:0};return"number"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),e}function h(e){const r=e.target;r.removeEventListener("dispose",h);const n=o.indexOf(r.__bindingPointIndex);o.splice(n,1),t.deleteBuffer(i[r.id]),delete i[r.id],delete a[r.id]}return{bind:function(t,e){const r=e.program;n.uniformBlockBinding(t,r)},update:function(r,d){let p=i[r.id];void 0===p&&(!function(t){const e=t.uniforms;let r=0;const n=16;let i=0;for(let t=0,a=e.length;t<a;t++){const a=e[t],o={boundary:0,storage:0},s=Array.isArray(a.value)?a.value:[a.value];for(let t=0,e=s.length;t<e;t++){const e=c(s[t]);o.boundary+=e.boundary,o.storage+=e.storage}if(a.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT),a.__offset=r,t>0){i=r%n;0!==i&&n-i-o.boundary<0&&(r+=n-i,a.__offset=r)}r+=o.storage}i=r%n,i>0&&(r+=n-i);t.__size=r,t.__cache={}}(r),p=function(e){const r=function(){for(let t=0;t<s;t++)if(-1===o.indexOf(t))return o.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=r;const n=t.createBuffer(),i=e.__size,a=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,i,a),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,r,n),n}(r),i[r.id]=p,r.addEventListener("dispose",h));const u=d.program;n.updateUBOMapping(r,u);const m=e.render.frame;a[r.id]!==m&&(!function(e){const r=i[e.id],n=e.uniforms,a=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,r);for(let e=0,r=n.length;e<r;e++){const r=n[e];if(!0===l(r,e,a)){const e=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let a=0;a<n.length;a++){const o=n[a],s=c(o);"number"==typeof o?(r.__data[0]=o,t.bufferSubData(t.UNIFORM_BUFFER,e+i,r.__data)):o.isMatrix3?(r.__data[0]=o.elements[0],r.__data[1]=o.elements[1],r.__data[2]=o.elements[2],r.__data[3]=o.elements[0],r.__data[4]=o.elements[3],r.__data[5]=o.elements[4],r.__data[6]=o.elements[5],r.__data[7]=o.elements[0],r.__data[8]=o.elements[6],r.__data[9]=o.elements[7],r.__data[10]=o.elements[8],r.__data[11]=o.elements[0]):(o.toArray(r.__data,i),i+=s.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,r.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(r),a[r.id]=m)},dispose:function(){for(const e in i)t.deleteBuffer(i[e]);o=[],i={},a={}}}}class go{constructor(t={}){const{canvas:e=Vt(),context:r=null,depth:n=!0,stencil:i=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:u=!1}=t;let m;this.isWebGLRenderer=!0,m=null!==r?r.getContextAttributes().alpha:a;const f=new Uint32Array(4),g=new Int32Array(4);let b=null,y=null;const x=[],_=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ot,this._useLegacyLights=!1,this.toneMapping=v,this.toneMappingExposure=1;const w=this;let S=!1,E=0,M=0,A=null,T=-1,P=null;const C=new ie,k=new ie;let D=null;const L=new Pr(0);let R=0,O=e.width,F=e.height,H=1,W=null,q=null;const $=new ie(0,0,O,F),X=new ie(0,0,O,F);let Y=!1;const Z=new Dn;let K=!1,J=!1,Q=null;const tt=new Be,et=new Ot,rt=new he,nt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function it(){return null===A?H:1}let at,lt,ct,ht,dt,pt,ut,mt,ft,gt,vt,bt,yt,xt,_t,wt,St,Et,Mt,At,Tt,Pt,Ct,Dt,Lt=r;function Rt(t,r){for(let n=0;n<t.length;n++){const i=t[n],a=e.getContext(i,r);if(null!==a)return a}return null}try{const t={alpha:!0,depth:n,stencil:i,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${s}`),e.addEventListener("webglcontextlost",zt,!1),e.addEventListener("webglcontextrestored",Ft,!1),e.addEventListener("webglcontextcreationerror",Ut,!1),null===Lt){const e=["webgl2","webgl","experimental-webgl"];if(!0===w.isWebGL1Renderer&&e.shift(),Lt=Rt(e,t),null===Lt)throw Rt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&Lt instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Lt.getShaderPrecisionFormat&&(Lt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function It(){at=new ci(Lt),lt=new jn(Lt,at,t),at.init(lt),Pt=new so(Lt,at,lt),ct=new ao(Lt,at,lt),ht=new pi(Lt),dt=new Wa,pt=new oo(Lt,at,ct,dt,lt,Pt,ht),ut=new Hn(w),mt=new li(w),ft=new Rn(Lt,lt),Ct=new Bn(Lt,at,ft,lt),gt=new hi(Lt,ft,ht,Ct),vt=new gi(Lt,gt,ft,ht),Mt=new fi(Lt,lt,pt),wt=new Gn(dt),bt=new Ha(w,ut,mt,at,lt,Ct,wt),yt=new mo(w,dt),xt=new Ya,_t=new eo(at,lt),Et=new Un(w,ut,mt,ct,vt,m,l),St=new io(w,vt,lt),Dt=new fo(Lt,ht,lt,ct),At=new Vn(Lt,at,ht,lt),Tt=new di(Lt,at,ht,lt),ht.programs=bt.programs,w.capabilities=lt,w.extensions=at,w.properties=dt,w.renderLists=xt,w.shadowMap=St,w.state=ct,w.info=ht}It();const Nt=new uo(w,Lt);function zt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function Ft(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const t=ht.autoReset,e=St.enabled,r=St.autoUpdate,n=St.needsUpdate,i=St.type;It(),ht.autoReset=t,St.enabled=e,St.autoUpdate=r,St.needsUpdate=n,St.type=i}function Ut(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function Bt(t){const e=t.target;e.removeEventListener("dispose",Bt),function(t){(function(t){const e=dt.get(t).programs;void 0!==e&&(e.forEach((function(t){bt.releaseProgram(t)})),t.isShaderMaterial&&bt.releaseShaderCache(t))})(t),dt.remove(t)}(e)}function jt(t,e,r){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=p,t.needsUpdate=!0,Kt(t,e,r),t.side=d,t.needsUpdate=!0,Kt(t,e,r),t.side=2):Kt(t,e,r)}this.xr=Nt,this.getContext=function(){return Lt},this.getContextAttributes=function(){return Lt.getContextAttributes()},this.forceContextLoss=function(){const t=at.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=at.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(t){void 0!==t&&(H=t,this.setSize(O,F,!1))},this.getSize=function(t){return t.set(O,F)},this.setSize=function(t,r,n=!0){Nt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(O=t,F=r,e.width=Math.floor(t*H),e.height=Math.floor(r*H),!0===n&&(e.style.width=t+"px",e.style.height=r+"px"),this.setViewport(0,0,t,r))},this.getDrawingBufferSize=function(t){return t.set(O*H,F*H).floor()},this.setDrawingBufferSize=function(t,r,n){O=t,F=r,H=n,e.width=Math.floor(t*n),e.height=Math.floor(r*n),this.setViewport(0,0,t,r)},this.getCurrentViewport=function(t){return t.copy(C)},this.getViewport=function(t){return t.copy($)},this.setViewport=function(t,e,r,n){t.isVector4?$.set(t.x,t.y,t.z,t.w):$.set(t,e,r,n),ct.viewport(C.copy($).multiplyScalar(H).floor())},this.getScissor=function(t){return t.copy(X)},this.setScissor=function(t,e,r,n){t.isVector4?X.set(t.x,t.y,t.z,t.w):X.set(t,e,r,n),ct.scissor(k.copy(X).multiplyScalar(H).floor())},this.getScissorTest=function(){return Y},this.setScissorTest=function(t){ct.setScissorTest(Y=t)},this.setOpaqueSort=function(t){W=t},this.setTransparentSort=function(t){q=t},this.getClearColor=function(t){return t.copy(Et.getClearColor())},this.setClearColor=function(){Et.setClearColor.apply(Et,arguments)},this.getClearAlpha=function(){return Et.getClearAlpha()},this.setClearAlpha=function(){Et.setClearAlpha.apply(Et,arguments)},this.clear=function(t=!0,e=!0,r=!0){let n=0;if(t){let t=!1;if(null!==A){const e=A.texture.format;t=1033===e||1031===e||1029===e}if(t){const t=A.texture.type,e=t===N||t===U||t===z||t===j||1017===t||1018===t,r=Et.getClearColor(),n=Et.getClearAlpha(),i=r.r,a=r.g,o=r.b;e?(f[0]=i,f[1]=a,f[2]=o,f[3]=n,Lt.clearBufferuiv(Lt.COLOR,0,f)):(g[0]=i,g[1]=a,g[2]=o,g[3]=n,Lt.clearBufferiv(Lt.COLOR,0,g))}else n|=Lt.COLOR_BUFFER_BIT}e&&(n|=Lt.DEPTH_BUFFER_BIT),r&&(n|=Lt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Lt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",zt,!1),e.removeEventListener("webglcontextrestored",Ft,!1),e.removeEventListener("webglcontextcreationerror",Ut,!1),xt.dispose(),_t.dispose(),dt.dispose(),ut.dispose(),mt.dispose(),vt.dispose(),Ct.dispose(),Dt.dispose(),bt.dispose(),Nt.dispose(),Nt.removeEventListener("sessionstart",Ht),Nt.removeEventListener("sessionend",Wt),Q&&(Q.dispose(),Q=null),qt.stop()},this.renderBufferDirect=function(t,e,r,n,i,a){null===e&&(e=nt);const o=i.isMesh&&i.matrixWorld.determinant()<0,s=function(t,e,r,n,i){!0!==e.isScene&&(e=nt);pt.resetTextureUnits();const a=e.fog,o=n.isMeshStandardMaterial?e.environment:null,s=null===A?w.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:st,l=(n.isMeshStandardMaterial?mt:ut).get(n.envMap||o),c=!0===n.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,h=!!r.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),d=!!r.morphAttributes.position,p=!!r.morphAttributes.normal,u=!!r.morphAttributes.color;let m=v;n.toneMapped&&(null!==A&&!0!==A.isXRRenderTarget||(m=w.toneMapping));const f=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,g=void 0!==f?f.length:0,b=dt.get(n),x=y.state.lights;if(!0===K&&(!0===J||t!==P)){const e=t===P&&n.id===T;wt.setState(n,t,e)}let _=!1;n.version===b.__version?b.needsLights&&b.lightsStateVersion!==x.state.version||b.outputColorSpace!==s||i.isBatchedMesh&&!1===b.batching?_=!0:i.isBatchedMesh||!0!==b.batching?i.isInstancedMesh&&!1===b.instancing?_=!0:i.isInstancedMesh||!0!==b.instancing?i.isSkinnedMesh&&!1===b.skinning?_=!0:i.isSkinnedMesh||!0!==b.skinning?i.isInstancedMesh&&!0===b.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===b.instancingColor&&null!==i.instanceColor||b.envMap!==l||!0===n.fog&&b.fog!==a?_=!0:void 0===b.numClippingPlanes||b.numClippingPlanes===wt.numPlanes&&b.numIntersection===wt.numIntersection?(b.vertexAlphas!==c||b.vertexTangents!==h||b.morphTargets!==d||b.morphNormals!==p||b.morphColors!==u||b.toneMapping!==m||!0===lt.isWebGL2&&b.morphTargetsCount!==g)&&(_=!0):_=!0:_=!0:_=!0:_=!0:(_=!0,b.__version=n.version);let S=b.currentProgram;!0===_&&(S=Kt(n,e,i));let E=!1,M=!1,C=!1;const k=S.getUniforms(),D=b.uniforms;ct.useProgram(S.program)&&(E=!0,M=!0,C=!0);n.id!==T&&(T=n.id,M=!0);if(E||P!==t){k.setValue(Lt,"projectionMatrix",t.projectionMatrix),k.setValue(Lt,"viewMatrix",t.matrixWorldInverse);const e=k.map.cameraPosition;void 0!==e&&e.setValue(Lt,rt.setFromMatrixPosition(t.matrixWorld)),lt.logarithmicDepthBuffer&&k.setValue(Lt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&k.setValue(Lt,"isOrthographic",!0===t.isOrthographicCamera),P!==t&&(P=t,M=!0,C=!0)}if(i.isSkinnedMesh){k.setOptional(Lt,i,"bindMatrix"),k.setOptional(Lt,i,"bindMatrixInverse");const t=i.skeleton;t&&(lt.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),k.setValue(Lt,"boneTexture",t.boneTexture,pt)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}i.isBatchedMesh&&(k.setOptional(Lt,i,"batchingTexture"),k.setValue(Lt,"batchingTexture",i._matricesTexture,pt));const L=r.morphAttributes;(void 0!==L.position||void 0!==L.normal||void 0!==L.color&&!0===lt.isWebGL2)&&Mt.update(i,r,S);(M||b.receiveShadow!==i.receiveShadow)&&(b.receiveShadow=i.receiveShadow,k.setValue(Lt,"receiveShadow",i.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(D.envMap.value=l,D.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);M&&(k.setValue(Lt,"toneMappingExposure",w.toneMappingExposure),b.needsLights&&(O=C,(R=D).ambientLightColor.needsUpdate=O,R.lightProbe.needsUpdate=O,R.directionalLights.needsUpdate=O,R.directionalLightShadows.needsUpdate=O,R.pointLights.needsUpdate=O,R.pointLightShadows.needsUpdate=O,R.spotLights.needsUpdate=O,R.spotLightShadows.needsUpdate=O,R.rectAreaLights.needsUpdate=O,R.hemisphereLights.needsUpdate=O),a&&!0===n.fog&&yt.refreshFogUniforms(D,a),yt.refreshMaterialUniforms(D,n,H,F,Q),wa.upload(Lt,Jt(b),D,pt));var R,O;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(wa.upload(Lt,Jt(b),D,pt),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&k.setValue(Lt,"center",i.center);if(k.setValue(Lt,"modelViewMatrix",i.modelViewMatrix),k.setValue(Lt,"normalMatrix",i.normalMatrix),k.setValue(Lt,"modelMatrix",i.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const t=n.uniformsGroups;for(let e=0,r=t.length;e<r;e++)if(lt.isWebGL2){const r=t[e];Dt.update(r,S),Dt.bind(r,S)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return S}(t,e,r,n,i);ct.setMaterial(n,o);let l=r.index,c=1;if(!0===n.wireframe){if(l=gt.getWireframeAttribute(r),void 0===l)return;c=2}const h=r.drawRange,d=r.attributes.position;let p=h.start*c,u=(h.start+h.count)*c;null!==a&&(p=Math.max(p,a.start*c),u=Math.min(u,(a.start+a.count)*c)),null!==l?(p=Math.max(p,0),u=Math.min(u,l.count)):null!=d&&(p=Math.max(p,0),u=Math.min(u,d.count));const m=u-p;if(m<0||m===1/0)return;let f;Ct.setup(i,n,s,r,l);let g=At;if(null!==l&&(f=ft.get(l),g=Tt,g.setIndex(f)),i.isMesh)!0===n.wireframe?(ct.setLineWidth(n.wireframeLinewidth*it()),g.setMode(Lt.LINES)):g.setMode(Lt.TRIANGLES);else if(i.isLine){let t=n.linewidth;void 0===t&&(t=1),ct.setLineWidth(t*it()),i.isLineSegments?g.setMode(Lt.LINES):i.isLineLoop?g.setMode(Lt.LINE_LOOP):g.setMode(Lt.LINE_STRIP)}else i.isPoints?g.setMode(Lt.POINTS):i.isSprite&&g.setMode(Lt.TRIANGLES);if(i.isBatchedMesh)g.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else if(i.isInstancedMesh)g.renderInstances(p,m,i.count);else if(r.isInstancedBufferGeometry){const t=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,e=Math.min(r.instanceCount,t);g.renderInstances(p,m,e)}else g.render(p,m)},this.compile=function(t,e,r=null){null===r&&(r=t),y=_t.get(r),y.init(),_.push(y),r.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(y.pushLight(t),t.castShadow&&y.pushShadow(t))})),t!==r&&t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(y.pushLight(t),t.castShadow&&y.pushShadow(t))})),y.setupLights(w._useLegacyLights);const n=new Set;return t.traverse((function(t){const e=t.material;if(e)if(Array.isArray(e))for(let i=0;i<e.length;i++){const a=e[i];jt(a,r,t),n.add(a)}else jt(e,r,t),n.add(e)})),_.pop(),y=null,n},this.compileAsync=function(t,e,r=null){const n=this.compile(t,e,r);return new Promise((e=>{function r(){n.forEach((function(t){dt.get(t).currentProgram.isReady()&&n.delete(t)})),0!==n.size?setTimeout(r,10):e(t)}null!==at.get("KHR_parallel_shader_compile")?r():setTimeout(r,10)}))};let Gt=null;function Ht(){qt.stop()}function Wt(){qt.start()}const qt=new Ln;function $t(t,e,r,n){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)y.pushLight(t),t.castShadow&&y.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||Z.intersectsSprite(t)){n&&rt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(tt);const e=vt.update(t),i=t.material;i.visible&&b.push(t,e,i,r,rt.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||Z.intersectsObject(t))){const e=vt.update(t),i=t.material;if(n&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),rt.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),rt.copy(e.boundingSphere.center)),rt.applyMatrix4(t.matrixWorld).applyMatrix4(tt)),Array.isArray(i)){const n=e.groups;for(let a=0,o=n.length;a<o;a++){const o=n[a],s=i[o.materialIndex];s&&s.visible&&b.push(t,e,s,r,rt.z,o)}}else i.visible&&b.push(t,e,i,r,rt.z,null)}const i=t.children;for(let t=0,a=i.length;t<a;t++)$t(i[t],e,r,n)}function Xt(t,e,r,n){const i=t.opaque,a=t.transmissive,o=t.transparent;y.setupLightsView(r),!0===K&&wt.setGlobalState(w.clippingPlanes,r),a.length>0&&function(t,e,r,n){const i=!0===r.isScene?r.overrideMaterial:null;if(null!==i)return;const a=lt.isWebGL2;null===Q&&(Q=new oe(1,1,{generateMipmaps:!0,type:at.has("EXT_color_buffer_half_float")?V:N,minFilter:I,samples:a?4:0}));w.getDrawingBufferSize(et),a?Q.setSize(et.x,et.y):Q.setSize(kt(et.x),kt(et.y));const o=w.getRenderTarget();w.setRenderTarget(Q),w.getClearColor(L),R=w.getClearAlpha(),R<1&&w.setClearColor(16777215,.5);w.clear();const s=w.toneMapping;w.toneMapping=v,Yt(t,r,n),pt.updateMultisampleRenderTarget(Q),pt.updateRenderTargetMipmap(Q);let l=!1;for(let t=0,i=e.length;t<i;t++){const i=e[t],a=i.object,o=i.geometry,s=i.material,c=i.group;if(2===s.side&&a.layers.test(n.layers)){const t=s.side;s.side=p,s.needsUpdate=!0,Zt(a,r,n,o,s,c),s.side=t,s.needsUpdate=!0,l=!0}}!0===l&&(pt.updateMultisampleRenderTarget(Q),pt.updateRenderTargetMipmap(Q));w.setRenderTarget(o),w.setClearColor(L,R),w.toneMapping=s}(i,a,e,r),n&&ct.viewport(C.copy(n)),i.length>0&&Yt(i,e,r),a.length>0&&Yt(a,e,r),o.length>0&&Yt(o,e,r),ct.buffers.depth.setTest(!0),ct.buffers.depth.setMask(!0),ct.buffers.color.setMask(!0),ct.setPolygonOffset(!1)}function Yt(t,e,r){const n=!0===e.isScene?e.overrideMaterial:null;for(let i=0,a=t.length;i<a;i++){const a=t[i],o=a.object,s=a.geometry,l=null===n?a.material:n,c=a.group;o.layers.test(r.layers)&&Zt(o,e,r,s,l,c)}}function Zt(t,e,r,n,i,a){t.onBeforeRender(w,e,r,n,i,a),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(w,e,r,n,t,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=p,i.needsUpdate=!0,w.renderBufferDirect(r,e,n,i,t,a),i.side=d,i.needsUpdate=!0,w.renderBufferDirect(r,e,n,i,t,a),i.side=2):w.renderBufferDirect(r,e,n,i,t,a),t.onAfterRender(w,e,r,n,i,a)}function Kt(t,e,r){!0!==e.isScene&&(e=nt);const n=dt.get(t),i=y.state.lights,a=y.state.shadowsArray,o=i.state.version,s=bt.getParameters(t,i.state,a,e,r),l=bt.getProgramCacheKey(s);let c=n.programs;n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=(t.isMeshStandardMaterial?mt:ut).get(t.envMap||n.environment),void 0===c&&(t.addEventListener("dispose",Bt),c=new Map,n.programs=c);let h=c.get(l);if(void 0!==h){if(n.currentProgram===h&&n.lightsStateVersion===o)return Qt(t,s),h}else s.uniforms=bt.getUniforms(t),t.onBuild(r,s,w),t.onBeforeCompile(s,w),h=bt.acquireProgram(s,l),c.set(l,h),n.uniforms=s.uniforms;const d=n.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(d.clippingPlanes=wt.uniform),Qt(t,s),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=o,n.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotLightMatrix.value=i.state.spotLightMatrix,d.spotLightMap.value=i.state.spotLightMap,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix),n.currentProgram=h,n.uniformsList=null,h}function Jt(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=wa.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function Qt(t,e){const r=dt.get(t);r.outputColorSpace=e.outputColorSpace,r.batching=e.batching,r.instancing=e.instancing,r.instancingColor=e.instancingColor,r.skinning=e.skinning,r.morphTargets=e.morphTargets,r.morphNormals=e.morphNormals,r.morphColors=e.morphColors,r.morphTargetsCount=e.morphTargetsCount,r.numClippingPlanes=e.numClippingPlanes,r.numIntersection=e.numClipIntersection,r.vertexAlphas=e.vertexAlphas,r.vertexTangents=e.vertexTangents,r.toneMapping=e.toneMapping}qt.setAnimationLoop((function(t){Gt&&Gt(t)})),"undefined"!=typeof self&&qt.setContext(self),this.setAnimationLoop=function(t){Gt=t,Nt.setAnimationLoop(t),null===t?qt.stop():qt.start()},Nt.addEventListener("sessionstart",Ht),Nt.addEventListener("sessionend",Wt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===S)return;!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===Nt.enabled&&!0===Nt.isPresenting&&(!0===Nt.cameraAutoUpdate&&Nt.updateCamera(e),e=Nt.getCamera()),!0===t.isScene&&t.onBeforeRender(w,t,e,A),y=_t.get(t,_.length),y.init(),_.push(y),tt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Z.setFromProjectionMatrix(tt),J=this.localClippingEnabled,K=wt.init(this.clippingPlanes,J),b=xt.get(t,x.length),b.init(),x.push(b),$t(t,e,0,w.sortObjects),b.finish(),!0===w.sortObjects&&b.sort(W,q),this.info.render.frame++,!0===K&&wt.beginShadows();const r=y.state.shadowsArray;if(St.render(r,t,e),!0===K&&wt.endShadows(),!0===this.info.autoReset&&this.info.reset(),Et.render(b,t),y.setupLights(w._useLegacyLights),e.isArrayCamera){const r=e.cameras;for(let e=0,n=r.length;e<n;e++){const n=r[e];Xt(b,t,n,n.viewport)}}else Xt(b,t,e);null!==A&&(pt.updateMultisampleRenderTarget(A),pt.updateRenderTargetMipmap(A)),!0===t.isScene&&t.onAfterRender(w,t,e),Ct.resetDefaultState(),T=-1,P=null,_.pop(),y=_.length>0?_[_.length-1]:null,x.pop(),b=x.length>0?x[x.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(t,e,r){dt.get(t.texture).__webglTexture=e,dt.get(t.depthTexture).__webglTexture=r;const n=dt.get(t);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0===at.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const r=dt.get(t);r.__webglFramebuffer=e,r.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,r=0){A=t,E=e,M=r;let n=!0,i=null,a=!1,o=!1;if(t){const s=dt.get(t);void 0!==s.__useDefaultFramebuffer?(ct.bindFramebuffer(Lt.FRAMEBUFFER,null),n=!1):void 0===s.__webglFramebuffer?pt.setupRenderTarget(t):s.__hasExternalTextures&&pt.rebindTextures(t,dt.get(t.texture).__webglTexture,dt.get(t.depthTexture).__webglTexture);const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=dt.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=Array.isArray(c[e])?c[e][r]:c[e],a=!0):i=lt.isWebGL2&&t.samples>0&&!1===pt.useMultisampledRTT(t)?dt.get(t).__webglMultisampledFramebuffer:Array.isArray(c)?c[r]:c,C.copy(t.viewport),k.copy(t.scissor),D=t.scissorTest}else C.copy($).multiplyScalar(H).floor(),k.copy(X).multiplyScalar(H).floor(),D=Y;if(ct.bindFramebuffer(Lt.FRAMEBUFFER,i)&&lt.drawBuffers&&n&&ct.drawBuffers(t,i),ct.viewport(C),ct.scissor(k),ct.setScissorTest(D),a){const n=dt.get(t.texture);Lt.framebufferTexture2D(Lt.FRAMEBUFFER,Lt.COLOR_ATTACHMENT0,Lt.TEXTURE_CUBE_MAP_POSITIVE_X+e,n.__webglTexture,r)}else if(o){const n=dt.get(t.texture),i=e||0;Lt.framebufferTextureLayer(Lt.FRAMEBUFFER,Lt.COLOR_ATTACHMENT0,n.__webglTexture,r||0,i)}T=-1},this.readRenderTargetPixels=function(t,e,r,n,i,a,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=dt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){ct.bindFramebuffer(Lt.FRAMEBUFFER,s);try{const o=t.texture,s=o.format,l=o.type;if(s!==G&&Pt.convert(s)!==Lt.getParameter(Lt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===V&&(at.has("EXT_color_buffer_half_float")||lt.isWebGL2&&at.has("EXT_color_buffer_float"));if(!(l===N||Pt.convert(l)===Lt.getParameter(Lt.IMPLEMENTATION_COLOR_READ_TYPE)||l===B&&(lt.isWebGL2||at.has("OES_texture_float")||at.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-n&&r>=0&&r<=t.height-i&&Lt.readPixels(e,r,n,i,Pt.convert(s),Pt.convert(l),a)}finally{const t=null!==A?dt.get(A).__webglFramebuffer:null;ct.bindFramebuffer(Lt.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t,e,r=0){const n=Math.pow(2,-r),i=Math.floor(e.image.width*n),a=Math.floor(e.image.height*n);pt.setTexture2D(e,0),Lt.copyTexSubImage2D(Lt.TEXTURE_2D,r,0,0,t.x,t.y,i,a),ct.unbindTexture()},this.copyTextureToTexture=function(t,e,r,n=0){const i=e.image.width,a=e.image.height,o=Pt.convert(r.format),s=Pt.convert(r.type);pt.setTexture2D(r,0),Lt.pixelStorei(Lt.UNPACK_FLIP_Y_WEBGL,r.flipY),Lt.pixelStorei(Lt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),Lt.pixelStorei(Lt.UNPACK_ALIGNMENT,r.unpackAlignment),e.isDataTexture?Lt.texSubImage2D(Lt.TEXTURE_2D,n,t.x,t.y,i,a,o,s,e.image.data):e.isCompressedTexture?Lt.compressedTexSubImage2D(Lt.TEXTURE_2D,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):Lt.texSubImage2D(Lt.TEXTURE_2D,n,t.x,t.y,o,s,e.image),0===n&&r.generateMipmaps&&Lt.generateMipmap(Lt.TEXTURE_2D),ct.unbindTexture()},this.copyTextureToTexture3D=function(t,e,r,n,i=0){if(w.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const a=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,s=t.max.z-t.min.z+1,l=Pt.convert(n.format),c=Pt.convert(n.type);let h;if(n.isData3DTexture)pt.setTexture3D(n,0),h=Lt.TEXTURE_3D;else{if(!n.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");pt.setTexture2DArray(n,0),h=Lt.TEXTURE_2D_ARRAY}Lt.pixelStorei(Lt.UNPACK_FLIP_Y_WEBGL,n.flipY),Lt.pixelStorei(Lt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),Lt.pixelStorei(Lt.UNPACK_ALIGNMENT,n.unpackAlignment);const d=Lt.getParameter(Lt.UNPACK_ROW_LENGTH),p=Lt.getParameter(Lt.UNPACK_IMAGE_HEIGHT),u=Lt.getParameter(Lt.UNPACK_SKIP_PIXELS),m=Lt.getParameter(Lt.UNPACK_SKIP_ROWS),f=Lt.getParameter(Lt.UNPACK_SKIP_IMAGES),g=r.isCompressedTexture?r.mipmaps[0]:r.image;Lt.pixelStorei(Lt.UNPACK_ROW_LENGTH,g.width),Lt.pixelStorei(Lt.UNPACK_IMAGE_HEIGHT,g.height),Lt.pixelStorei(Lt.UNPACK_SKIP_PIXELS,t.min.x),Lt.pixelStorei(Lt.UNPACK_SKIP_ROWS,t.min.y),Lt.pixelStorei(Lt.UNPACK_SKIP_IMAGES,t.min.z),r.isDataTexture||r.isData3DTexture?Lt.texSubImage3D(h,i,e.x,e.y,e.z,a,o,s,l,c,g.data):r.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Lt.compressedTexSubImage3D(h,i,e.x,e.y,e.z,a,o,s,l,g.data)):Lt.texSubImage3D(h,i,e.x,e.y,e.z,a,o,s,l,c,g),Lt.pixelStorei(Lt.UNPACK_ROW_LENGTH,d),Lt.pixelStorei(Lt.UNPACK_IMAGE_HEIGHT,p),Lt.pixelStorei(Lt.UNPACK_SKIP_PIXELS,u),Lt.pixelStorei(Lt.UNPACK_SKIP_ROWS,m),Lt.pixelStorei(Lt.UNPACK_SKIP_IMAGES,f),0===i&&n.generateMipmaps&&Lt.generateMipmap(h),ct.unbindTexture()},this.initTexture=function(t){t.isCubeTexture?pt.setTextureCube(t,0):t.isData3DTexture?pt.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?pt.setTexture2DArray(t,0):pt.setTexture2D(t,0),ct.unbindTexture()},this.resetState=function(){E=0,M=0,A=null,ct.reset(),Ct.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return bt}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=t===lt?"display-p3":"srgb",e.unpackColorSpace=Xt.workingColorSpace===ct?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(t){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!t}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===ot?it:nt}set outputEncoding(t){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=t===it?ot:st}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(t){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=t}}(class extends go{}).prototype.isWebGL1Renderer=!0;class vo{constructor(t,e=1,r=1e3){this.isFog=!0,this.name="",this.color=new Pr(t),this.near=e,this.far=r}clone(){return new vo(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class bo extends dr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e}}class yo{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=ft,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Mt()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}get updateRange(){return console.warn('THREE.InterleavedBuffer: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,r){t*=this.stride,r*=e.stride;for(let n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Mt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(e,this.stride);return r.setUsage(this.usage),r}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Mt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const xo=new he;class _o{constructor(t,e,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,r=this.data.count;e<r;e++)xo.fromBufferAttribute(this,e),xo.applyMatrix4(t),this.setXYZ(e,xo.x,xo.y,xo.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)xo.fromBufferAttribute(this,e),xo.applyNormalMatrix(t),this.setXYZ(e,xo.x,xo.y,xo.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)xo.fromBufferAttribute(this,e),xo.transformDirection(t),this.setXYZ(e,xo.x,xo.y,xo.z);return this}setX(t,e){return this.normalized&&(e=Lt(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=Lt(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=Lt(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=Lt(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Dt(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Dt(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Dt(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Dt(e,this.array)),e}setXY(t,e,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=r,this}setXYZ(t,e,r,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array),n=Lt(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this}setXYZW(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=Lt(e,this.array),r=Lt(r,this.array),n=Lt(n,this.array),i=Lt(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const r=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[r+e])}return new Ir(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new _o(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const r=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[r+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class wo extends dr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class So extends ne{constructor(t=null,e=1,r=1,n,i,a,o,s,l=1003,c=1003,h,d){super(null,a,o,s,l,c,n,i,h,d),this.isDataTexture=!0,this.image={data:t,width:e,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Eo=new Be,Mo=new Be;class Ao{constructor(t=[],e=[]){this.uuid=Mt(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Be)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new Be;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=t.length;n<i;n++){const i=t[n]?t[n].matrixWorld:Mo;Eo.multiplyMatrices(i,e[n]),Eo.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new Ao(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const r=new So(e,t,t,G,B);return r.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=r,this}getBoneByName(t){for(let e=0,r=this.bones.length;e<r;e++){const r=this.bones[e];if(r.name===t)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let r=0,n=t.bones.length;r<n;r++){const n=t.bones[r];let i=e[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new wo),this.bones.push(i),this.boneInverses.push((new Be).fromArray(t.boneInverses[r]))}return this.init(),this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,r=this.boneInverses;for(let n=0,i=e.length;n<i;n++){const i=e[n];t.bones.push(i.uuid);const a=r[n];t.boneInverses.push(a.toArray())}return t}}class To extends Ir{constructor(t,e,r,n=1){super(t,e,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}class Po extends Dr{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const Co=new he,ko=new he,Do=new Be,Lo=new Ue,Ro=new De;class Oo extends dr{constructor(t=new qr,e=new Po){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,r=[0];for(let t=1,n=e.count;t<n;t++)Co.fromBufferAttribute(e,t-1),ko.fromBufferAttribute(e,t),r[t]=r[t-1],r[t]+=Co.distanceTo(ko);t.setAttribute("lineDistance",new Fr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const r=this.geometry,n=this.matrixWorld,i=t.params.Line.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Ro.copy(r.boundingSphere),Ro.applyMatrix4(n),Ro.radius+=i,!1===t.ray.intersectsSphere(Ro))return;Do.copy(n).invert(),Lo.copy(t.ray).applyMatrix4(Do);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new he,c=new he,h=new he,d=new he,p=this.isLineSegments?2:1,u=r.index,m=r.attributes.position;if(null!==u){for(let r=Math.max(0,a.start),n=Math.min(u.count,a.start+a.count)-1;r<n;r+=p){const n=u.getX(r),i=u.getX(r+1);l.fromBufferAttribute(m,n),c.fromBufferAttribute(m,i);if(Lo.distanceSqToSegment(l,c,d,h)>s)continue;d.applyMatrix4(this.matrixWorld);const a=t.ray.origin.distanceTo(d);a<t.near||a>t.far||e.push({distance:a,point:h.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,a.start),n=Math.min(m.count,a.start+a.count)-1;r<n;r+=p){l.fromBufferAttribute(m,r),c.fromBufferAttribute(m,r+1);if(Lo.distanceSqToSegment(l,c,d,h)>s)continue;d.applyMatrix4(this.matrixWorld);const n=t.ray.origin.distanceTo(d);n<t.near||n>t.far||e.push({distance:n,point:h.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=r.length;t<e;t++){const e=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const Io=new he,No=new he;class zo extends Oo{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,r=[];for(let t=0,n=e.count;t<n;t+=2)Io.fromBufferAttribute(e,t),No.fromBufferAttribute(e,t+1),r[t]=0===t?0:r[t-1],r[t+1]=r[t]+Io.distanceTo(No);t.setAttribute("lineDistance",new Fr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Fo extends ne{constructor(t,e,r,n,i,a,o,s,l){super(t,e,r,n,i,a,o,s,l),this.isVideoTexture=!0,this.minFilter=void 0!==a?a:O,this.magFilter=void 0!==i?i:O,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Uo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const r=this.getUtoTmapping(t);return this.getPoint(r,e)}getPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return e}getSpacedPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let r,n=this.getPoint(0),i=0;e.push(0);for(let a=1;a<=t;a++)r=this.getPoint(a/t),i+=r.distanceTo(n),e.push(i),n=r;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const r=this.getLengths();let n=0;const i=r.length;let a;a=e||t*r[i-1];let o,s=0,l=i-1;for(;s<=l;)if(n=Math.floor(s+(l-s)/2),o=r[n]-a,o<0)s=n+1;else{if(!(o>0)){l=n;break}l=n-1}if(n=l,r[n]===a)return n/(i-1);const c=r[n];return(n+(a-c)/(r[n+1]-c))/(i-1)}getTangent(t,e){const r=1e-4;let n=t-r,i=t+r;n<0&&(n=0),i>1&&(i=1);const a=this.getPoint(n),o=this.getPoint(i),s=e||(a.isVector2?new Ot:new he);return s.copy(o).sub(a).normalize(),s}getTangentAt(t,e){const r=this.getUtoTmapping(t);return this.getTangent(r,e)}computeFrenetFrames(t,e){const r=new he,n=[],i=[],a=[],o=new he,s=new Be;for(let e=0;e<=t;e++){const r=e/t;n[e]=this.getTangentAt(r,new he)}i[0]=new he,a[0]=new he;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),h=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=l&&(l=c,r.set(1,0,0)),h<=l&&(l=h,r.set(0,1,0)),d<=l&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),a[0].crossVectors(n[0],i[0]);for(let e=1;e<=t;e++){if(i[e]=i[e-1].clone(),a[e]=a[e-1].clone(),o.crossVectors(n[e-1],n[e]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(At(n[e-1].dot(n[e]),-1,1));i[e].applyMatrix4(s.makeRotationAxis(o,t))}a[e].crossVectors(n[e],i[e])}if(!0===e){let e=Math.acos(At(i[0].dot(i[t]),-1,1));e/=t,n[0].dot(o.crossVectors(i[0],i[t]))>0&&(e=-e);for(let r=1;r<=t;r++)i[r].applyMatrix4(s.makeRotationAxis(n[r],e*r)),a[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Bo extends Uo{constructor(t=0,e=0,r=1,n=1,i=0,a=2*Math.PI,o=!1,s=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(t,e){const r=e||new Ot,n=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=a?0:n),!0!==this.aClockwise||a||(i===n?i=-n:i-=n);const o=this.aStartAngle+t*i;let s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),r=s-this.aX,n=l-this.aY;s=r*t-n*e+this.aX,l=r*e+n*t+this.aY}return r.set(s,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}function Vo(){let t=0,e=0,r=0,n=0;function i(i,a,o,s){t=i,e=o,r=-3*i+3*a-2*o-s,n=2*i-2*a+o+s}return{initCatmullRom:function(t,e,r,n,a){i(e,r,a*(r-t),a*(n-e))},initNonuniformCatmullRom:function(t,e,r,n,a,o,s){let l=(e-t)/a-(r-t)/(a+o)+(r-e)/o,c=(r-e)/o-(n-e)/(o+s)+(n-r)/s;l*=o,c*=o,i(e,r,l,c)},calc:function(i){const a=i*i;return t+e*i+r*a+n*(a*i)}}}const jo=new he,Go=new Vo,Ho=new Vo,Wo=new Vo;function qo(t,e,r,n,i){const a=.5*(n-e),o=.5*(i-r),s=t*t;return(2*r-2*n+a+o)*(t*s)+(-3*r+3*n-2*a-o)*s+a*t+r}function $o(t,e,r,n){return function(t,e){const r=1-t;return r*r*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,r)+function(t,e){return t*t*e}(t,n)}function Xo(t,e,r,n,i){return function(t,e){const r=1-t;return r*r*r*e}(t,e)+function(t,e){const r=1-t;return 3*r*r*t*e}(t,r)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,i)}class Yo extends Uo{constructor(t=new Ot,e=new Ot,r=new Ot,n=new Ot){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=r,this.v3=n}getPoint(t,e=new Ot){const r=e,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(Xo(t,n.x,i.x,a.x,o.x),Xo(t,n.y,i.y,a.y,o.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Zo extends Uo{constructor(t=new he,e=new he,r=new he,n=new he){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=r,this.v3=n}getPoint(t,e=new he){const r=e,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(Xo(t,n.x,i.x,a.x,o.x),Xo(t,n.y,i.y,a.y,o.y),Xo(t,n.z,i.z,a.z,o.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Ko extends Uo{constructor(t=new Ot,e=new Ot){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Ot){const r=e;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Ot){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Jo extends Uo{constructor(t=new he,e=new he){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new he){const r=e;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new he){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Qo extends Uo{constructor(t=new Ot,e=new Ot,r=new Ot){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new Ot){const r=e,n=this.v0,i=this.v1,a=this.v2;return r.set($o(t,n.x,i.x,a.x),$o(t,n.y,i.y,a.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class ts extends Uo{constructor(t=new he,e=new he,r=new he){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new he){const r=e,n=this.v0,i=this.v1,a=this.v2;return r.set($o(t,n.x,i.x,a.x),$o(t,n.y,i.y,a.y),$o(t,n.z,i.z,a.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class es extends Uo{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Ot){const r=e,n=this.points,i=(n.length-1)*t,a=Math.floor(i),o=i-a,s=n[0===a?a:a-1],l=n[a],c=n[a>n.length-2?n.length-1:a+1],h=n[a>n.length-3?n.length-1:a+2];return r.set(qo(o,s.x,l.x,c.x,h.x),qo(o,s.y,l.y,c.y,h.y)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const r=t.points[e];this.points.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const r=t.points[e];this.points.push((new Ot).fromArray(r))}return this}}var rs=Object.freeze({__proto__:null,ArcCurve:class extends Bo{constructor(t,e,r,n,i,a){super(t,e,r,r,n,i,a),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends Uo{constructor(t=[],e=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=r,this.tension=n}getPoint(t,e=new he){const r=e,n=this.points,i=n.length,a=(i-(this.closed?0:1))*t;let o,s,l=Math.floor(a),c=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?o=n[(l-1)%i]:(jo.subVectors(n[0],n[1]).add(n[0]),o=jo);const h=n[l%i],d=n[(l+1)%i];if(this.closed||l+2<i?s=n[(l+2)%i]:(jo.subVectors(n[i-1],n[i-2]).add(n[i-1]),s=jo),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(d),t),n=Math.pow(d.distanceToSquared(s),t);r<1e-4&&(r=1),e<1e-4&&(e=r),n<1e-4&&(n=r),Go.initNonuniformCatmullRom(o.x,h.x,d.x,s.x,e,r,n),Ho.initNonuniformCatmullRom(o.y,h.y,d.y,s.y,e,r,n),Wo.initNonuniformCatmullRom(o.z,h.z,d.z,s.z,e,r,n)}else"catmullrom"===this.curveType&&(Go.initCatmullRom(o.x,h.x,d.x,s.x,this.tension),Ho.initCatmullRom(o.y,h.y,d.y,s.y,this.tension),Wo.initCatmullRom(o.z,h.z,d.z,s.z,this.tension));return r.set(Go.calc(c),Ho.calc(c),Wo.calc(c)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const r=t.points[e];this.points.push((new he).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}},CubicBezierCurve:Yo,CubicBezierCurve3:Zo,EllipseCurve:Bo,LineCurve:Ko,LineCurve3:Jo,QuadraticBezierCurve:Qo,QuadraticBezierCurve3:ts,SplineCurve:es});class ns extends Uo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const r=!0===t.isVector2?"LineCurve":"LineCurve3";this.curves.push(new rs[r](e,t))}return this}getPoint(t,e){const r=t*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=r){const t=n[i]-r,a=this.curves[i],o=a.getLength(),s=0===o?0:1-t/o;return a.getPointAt(s,e)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let r;for(let n=0,i=this.curves;n<i.length;n++){const a=i[n],o=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o);for(let t=0;t<s.length;t++){const n=s[t];r&&r.equals(n)||(e.push(n),r=n)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,r=this.curves.length;e<r;e++){const r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const r=t.curves[e];this.curves.push((new rs[r.type]).fromJSON(r))}return this}}class is extends ns{constructor(t){super(),this.type="Path",this.currentPoint=new Ot,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const r=new Ko(this.currentPoint.clone(),new Ot(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,r,n){const i=new Qo(this.currentPoint.clone(),new Ot(t,e),new Ot(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(t,e,r,n,i,a){const o=new Yo(this.currentPoint.clone(),new Ot(t,e),new Ot(r,n),new Ot(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),r=new es(e);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,r,n,i,a){const o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,r,n,i,a),this}absarc(t,e,r,n,i,a){return this.absellipse(t,e,r,r,n,i,a),this}ellipse(t,e,r,n,i,a,o,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,r,n,i,a,o,s),this}absellipse(t,e,r,n,i,a,o,s){const l=new Bo(t,e,r,n,i,a,o,s);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class as extends qr{constructor(t=[new Ot(0,-.5),new Ot(.5,0),new Ot(0,.5)],e=12,r=0,n=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},e=Math.floor(e),n=At(n,0,2*Math.PI);const i=[],a=[],o=[],s=[],l=[],c=1/e,h=new he,d=new Ot,p=new he,u=new he,m=new he;let f=0,g=0;for(let e=0;e<=t.length-1;e++)switch(e){case 0:f=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,p.x=1*g,p.y=-f,p.z=0*g,m.copy(p),p.normalize(),s.push(p.x,p.y,p.z);break;case t.length-1:s.push(m.x,m.y,m.z);break;default:f=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,p.x=1*g,p.y=-f,p.z=0*g,u.copy(p),p.x+=m.x,p.y+=m.y,p.z+=m.z,p.normalize(),s.push(p.x,p.y,p.z),m.copy(u)}for(let i=0;i<=e;i++){const p=r+i*c*n,u=Math.sin(p),m=Math.cos(p);for(let r=0;r<=t.length-1;r++){h.x=t[r].x*u,h.y=t[r].y,h.z=t[r].x*m,a.push(h.x,h.y,h.z),d.x=i/e,d.y=r/(t.length-1),o.push(d.x,d.y);const n=s[3*r+0]*u,c=s[3*r+1],p=s[3*r+0]*m;l.push(n,c,p)}}for(let r=0;r<e;r++)for(let e=0;e<t.length-1;e++){const n=e+r*t.length,a=n,o=n+t.length,s=n+t.length+1,l=n+1;i.push(a,o,l),i.push(s,l,o)}this.setIndex(i),this.setAttribute("position",new Fr(a,3)),this.setAttribute("uv",new Fr(o,2)),this.setAttribute("normal",new Fr(l,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new as(t.points,t.segments,t.phiStart,t.phiLength)}}class os extends qr{constructor(t=1,e=1,r=1,n=32,i=1,a=!1,o=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};const l=this;n=Math.floor(n),i=Math.floor(i);const c=[],h=[],d=[],p=[];let u=0;const m=[],f=r/2;let g=0;function v(r){const i=u,a=new Ot,m=new he;let v=0;const b=!0===r?t:e,y=!0===r?1:-1;for(let t=1;t<=n;t++)h.push(0,f*y,0),d.push(0,y,0),p.push(.5,.5),u++;const x=u;for(let t=0;t<=n;t++){const e=t/n*s+o,r=Math.cos(e),i=Math.sin(e);m.x=b*i,m.y=f*y,m.z=b*r,h.push(m.x,m.y,m.z),d.push(0,y,0),a.x=.5*r+.5,a.y=.5*i*y+.5,p.push(a.x,a.y),u++}for(let t=0;t<n;t++){const e=i+t,n=x+t;!0===r?c.push(n,n+1,e):c.push(n+1,n,e),v+=3}l.addGroup(g,v,!0===r?1:2),g+=v}!function(){const a=new he,v=new he;let b=0;const y=(e-t)/r;for(let l=0;l<=i;l++){const c=[],g=l/i,b=g*(e-t)+t;for(let t=0;t<=n;t++){const e=t/n,i=e*s+o,l=Math.sin(i),m=Math.cos(i);v.x=b*l,v.y=-g*r+f,v.z=b*m,h.push(v.x,v.y,v.z),a.set(l,y,m).normalize(),d.push(a.x,a.y,a.z),p.push(e,1-g),c.push(u++)}m.push(c)}for(let t=0;t<n;t++)for(let e=0;e<i;e++){const r=m[e][t],n=m[e+1][t],i=m[e+1][t+1],a=m[e][t+1];c.push(r,n,a),c.push(n,i,a),b+=6}l.addGroup(g,b,0),g+=b}(),!1===a&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Fr(h,3)),this.setAttribute("normal",new Fr(d,3)),this.setAttribute("uv",new Fr(p,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new os(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class ss extends os{constructor(t=1,e=1,r=32,n=1,i=!1,a=0,o=2*Math.PI){super(0,t,e,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}static fromJSON(t){return new ss(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class ls extends qr{constructor(t=[],e=[],r=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n};const i=[],a=[];function o(t,e,r,n){const i=n+1,a=[];for(let n=0;n<=i;n++){a[n]=[];const o=t.clone().lerp(r,n/i),s=e.clone().lerp(r,n/i),l=i-n;for(let t=0;t<=l;t++)a[n][t]=0===t&&n===i?o:o.clone().lerp(s,t/l)}for(let t=0;t<i;t++)for(let e=0;e<2*(i-t)-1;e++){const r=Math.floor(e/2);e%2==0?(s(a[t][r+1]),s(a[t+1][r]),s(a[t][r])):(s(a[t][r+1]),s(a[t+1][r+1]),s(a[t+1][r]))}}function s(t){i.push(t.x,t.y,t.z)}function l(e,r){const n=3*e;r.x=t[n+0],r.y=t[n+1],r.z=t[n+2]}function c(t,e,r,n){n<0&&1===t.x&&(a[e]=t.x-1),0===r.x&&0===r.z&&(a[e]=n/2/Math.PI+.5)}function h(t){return Math.atan2(t.z,-t.x)}!function(t){const r=new he,n=new he,i=new he;for(let a=0;a<e.length;a+=3)l(e[a+0],r),l(e[a+1],n),l(e[a+2],i),o(r,n,i,t)}(n),function(t){const e=new he;for(let r=0;r<i.length;r+=3)e.x=i[r+0],e.y=i[r+1],e.z=i[r+2],e.normalize().multiplyScalar(t),i[r+0]=e.x,i[r+1]=e.y,i[r+2]=e.z}(r),function(){const t=new he;for(let r=0;r<i.length;r+=3){t.x=i[r+0],t.y=i[r+1],t.z=i[r+2];const n=h(t)/2/Math.PI+.5,o=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);a.push(n,1-o)}var e;(function(){const t=new he,e=new he,r=new he,n=new he,o=new Ot,s=new Ot,l=new Ot;for(let d=0,p=0;d<i.length;d+=9,p+=6){t.set(i[d+0],i[d+1],i[d+2]),e.set(i[d+3],i[d+4],i[d+5]),r.set(i[d+6],i[d+7],i[d+8]),o.set(a[p+0],a[p+1]),s.set(a[p+2],a[p+3]),l.set(a[p+4],a[p+5]),n.copy(t).add(e).add(r).divideScalar(3);const u=h(n);c(o,p+0,t,u),c(s,p+2,e,u),c(l,p+4,r,u)}})(),function(){for(let t=0;t<a.length;t+=6){const e=a[t+0],r=a[t+2],n=a[t+4],i=Math.max(e,r,n),o=Math.min(e,r,n);i>.9&&o<.1&&(e<.2&&(a[t+0]+=1),r<.2&&(a[t+2]+=1),n<.2&&(a[t+4]+=1))}}()}(),this.setAttribute("position",new Fr(i,3)),this.setAttribute("normal",new Fr(i.slice(),3)),this.setAttribute("uv",new Fr(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ls(t.vertices,t.indices,t.radius,t.details)}}class cs extends ls{constructor(t=1,e=0){const r=(1+Math.sqrt(5))/2,n=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new cs(t.radius,t.detail)}}class hs extends is{constructor(t){super(t),this.uuid=Mt(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,r=this.holes.length;e<r;e++){const r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const r=t.holes[e];this.holes.push((new is).fromJSON(r))}return this}}const ds=function(t,e,r=2){const n=e&&e.length,i=n?e[0]*r:t.length;let a=ps(t,0,i,r,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,c,h,d,p,u;if(n&&(a=function(t,e,r,n){const i=[];let a,o,s,l,c;for(a=0,o=e.length;a<o;a++)s=e[a]*n,l=a<o-1?e[a+1]*n:t.length,c=ps(t,s,l,n,!1),c===c.next&&(c.steiner=!0),i.push(Ss(c));for(i.sort(ys),a=0;a<i.length;a++)r=xs(i[a],r);return r}(t,e,a,r)),t.length>80*r){s=c=t[0],l=h=t[1];for(let e=r;e<i;e+=r)d=t[e],p=t[e+1],d<s&&(s=d),p<l&&(l=p),d>c&&(c=d),p>h&&(h=p);u=Math.max(c-s,h-l),u=0!==u?32767/u:0}return ms(a,o,r,s,l,u,0),o};function ps(t,e,r,n,i){let a,o;if(i===function(t,e,r,n){let i=0;for(let a=e,o=r-n;a<r;a+=n)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}(t,e,r,n)>0)for(a=e;a<r;a+=n)o=Rs(a,t[a],t[a+1],o);else for(a=r-n;a>=e;a-=n)o=Rs(a,t[a],t[a+1],o);return o&&Ts(o,o.next)&&(Os(o),o=o.next),o}function us(t,e){if(!t)return t;e||(e=t);let r,n=t;do{if(r=!1,n.steiner||!Ts(n,n.next)&&0!==As(n.prev,n,n.next))n=n.next;else{if(Os(n),n=e=n.prev,n===n.next)break;r=!0}}while(r||n!==e);return e}function ms(t,e,r,n,i,a,o){if(!t)return;!o&&a&&function(t,e,r,n){let i=t;do{0===i.z&&(i.z=ws(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,r,n,i,a,o,s,l,c=1;do{for(r=t,t=null,a=null,o=0;r;){for(o++,n=r,s=0,e=0;e<c&&(s++,n=n.nextZ,n);e++);for(l=c;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=n}a.nextZ=null,c*=2}while(o>1)}(i)}(t,n,i,a);let s,l,c=t;for(;t.prev!==t.next;)if(s=t.prev,l=t.next,a?gs(t,n,i,a):fs(t))e.push(s.i/r|0),e.push(t.i/r|0),e.push(l.i/r|0),Os(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?ms(t=vs(us(t),e,r),e,r,n,i,a,2):2===o&&bs(t,e,r,n,i,a):ms(us(t),e,r,n,i,a,1);break}}function fs(t){const e=t.prev,r=t,n=t.next;if(As(e,r,n)>=0)return!1;const i=e.x,a=r.x,o=n.x,s=e.y,l=r.y,c=n.y,h=i<a?i<o?i:o:a<o?a:o,d=s<l?s<c?s:c:l<c?l:c,p=i>a?i>o?i:o:a>o?a:o,u=s>l?s>c?s:c:l>c?l:c;let m=n.next;for(;m!==e;){if(m.x>=h&&m.x<=p&&m.y>=d&&m.y<=u&&Es(i,s,a,l,o,c,m.x,m.y)&&As(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function gs(t,e,r,n){const i=t.prev,a=t,o=t.next;if(As(i,a,o)>=0)return!1;const s=i.x,l=a.x,c=o.x,h=i.y,d=a.y,p=o.y,u=s<l?s<c?s:c:l<c?l:c,m=h<d?h<p?h:p:d<p?d:p,f=s>l?s>c?s:c:l>c?l:c,g=h>d?h>p?h:p:d>p?d:p,v=ws(u,m,e,r,n),b=ws(f,g,e,r,n);let y=t.prevZ,x=t.nextZ;for(;y&&y.z>=v&&x&&x.z<=b;){if(y.x>=u&&y.x<=f&&y.y>=m&&y.y<=g&&y!==i&&y!==o&&Es(s,h,l,d,c,p,y.x,y.y)&&As(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,x.x>=u&&x.x<=f&&x.y>=m&&x.y<=g&&x!==i&&x!==o&&Es(s,h,l,d,c,p,x.x,x.y)&&As(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;y&&y.z>=v;){if(y.x>=u&&y.x<=f&&y.y>=m&&y.y<=g&&y!==i&&y!==o&&Es(s,h,l,d,c,p,y.x,y.y)&&As(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=b;){if(x.x>=u&&x.x<=f&&x.y>=m&&x.y<=g&&x!==i&&x!==o&&Es(s,h,l,d,c,p,x.x,x.y)&&As(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function vs(t,e,r){let n=t;do{const i=n.prev,a=n.next.next;!Ts(i,a)&&Ps(i,n,n.next,a)&&Ds(i,a)&&Ds(a,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(a.i/r|0),Os(n),Os(n.next),n=t=a),n=n.next}while(n!==t);return us(n)}function bs(t,e,r,n,i,a){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&Ms(o,t)){let s=Ls(o,t);return o=us(o,o.next),s=us(s,s.next),ms(o,e,r,n,i,a,0),void ms(s,e,r,n,i,a,0)}t=t.next}o=o.next}while(o!==t)}function ys(t,e){return t.x-e.x}function xs(t,e){const r=function(t,e){let r,n=e,i=-1/0;const a=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const t=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=a&&t>i&&(i=t,r=n.x<n.next.x?n:n.next,t===a))return r}n=n.next}while(n!==e);if(!r)return null;const s=r,l=r.x,c=r.y;let h,d=1/0;n=r;do{a>=n.x&&n.x>=l&&a!==n.x&&Es(o<c?a:i,o,l,c,o<c?i:a,o,n.x,n.y)&&(h=Math.abs(o-n.y)/(a-n.x),Ds(n,t)&&(h<d||h===d&&(n.x>r.x||n.x===r.x&&_s(r,n)))&&(r=n,d=h)),n=n.next}while(n!==s);return r}(t,e);if(!r)return e;const n=Ls(r,t);return us(n,n.next),us(r,r.next)}function _s(t,e){return As(t.prev,t,e.prev)<0&&As(e.next,t,t.next)<0}function ws(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ss(t){let e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Es(t,e,r,n,i,a,o,s){return(i-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(n-s)>=(r-o)*(e-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function Ms(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Ps(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(Ds(t,e)&&Ds(e,t)&&function(t,e){let r=t,n=!1;const i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(As(t.prev,t,e.prev)||As(t,e.prev,e))||Ts(t,e)&&As(t.prev,t,t.next)>0&&As(e.prev,e,e.next)>0)}function As(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Ts(t,e){return t.x===e.x&&t.y===e.y}function Ps(t,e,r,n){const i=ks(As(t,e,r)),a=ks(As(t,e,n)),o=ks(As(r,n,t)),s=ks(As(r,n,e));return i!==a&&o!==s||(!(0!==i||!Cs(t,r,e))||(!(0!==a||!Cs(t,n,e))||(!(0!==o||!Cs(r,t,n))||!(0!==s||!Cs(r,e,n)))))}function Cs(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function ks(t){return t>0?1:t<0?-1:0}function Ds(t,e){return As(t.prev,t,t.next)<0?As(t,e,t.next)>=0&&As(t,t.prev,e)>=0:As(t,e,t.prev)<0||As(t,t.next,e)<0}function Ls(t,e){const r=new Is(t.i,t.x,t.y),n=new Is(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Rs(t,e,r,n){const i=new Is(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Os(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Is(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ns{static area(t){const e=t.length;let r=0;for(let n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r}static isClockWise(t){return Ns.area(t)<0}static triangulateShape(t,e){const r=[],n=[],i=[];zs(t),Fs(r,t);let a=t.length;e.forEach(zs);for(let t=0;t<e.length;t++)n.push(a),a+=e[t].length,Fs(r,e[t]);const o=ds(r,n);for(let t=0;t<o.length;t+=3)i.push(o.slice(t,t+3));return i}}function zs(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Fs(t,e){for(let r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}class Us extends ls{constructor(t=1,e=0){const r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Us(t.radius,t.detail)}}class Bs extends qr{constructor(t=1,e=32,r=16,n=0,i=2*Math.PI,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},e=Math.max(3,Math.floor(e)),r=Math.max(2,Math.floor(r));const s=Math.min(a+o,Math.PI);let l=0;const c=[],h=new he,d=new he,p=[],u=[],m=[],f=[];for(let p=0;p<=r;p++){const g=[],v=p/r;let b=0;0===p&&0===a?b=.5/e:p===r&&s===Math.PI&&(b=-.5/e);for(let r=0;r<=e;r++){const s=r/e;h.x=-t*Math.cos(n+s*i)*Math.sin(a+v*o),h.y=t*Math.cos(a+v*o),h.z=t*Math.sin(n+s*i)*Math.sin(a+v*o),u.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),f.push(s+b,1-v),g.push(l++)}c.push(g)}for(let t=0;t<r;t++)for(let n=0;n<e;n++){const e=c[t][n+1],i=c[t][n],o=c[t+1][n],l=c[t+1][n+1];(0!==t||a>0)&&p.push(e,i,l),(t!==r-1||s<Math.PI)&&p.push(i,o,l)}this.setIndex(p),this.setAttribute("position",new Fr(u,3)),this.setAttribute("normal",new Fr(m,3)),this.setAttribute("uv",new Fr(f,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Bs(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class Vs extends qr{constructor(t=1,e=.4,r=64,n=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:a},r=Math.floor(r),n=Math.floor(n);const o=[],s=[],l=[],c=[],h=new he,d=new he,p=new he,u=new he,m=new he,f=new he,g=new he;for(let o=0;o<=r;++o){const b=o/r*i*Math.PI*2;v(b,i,a,t,p),v(b+.01,i,a,t,u),f.subVectors(u,p),g.addVectors(u,p),m.crossVectors(f,g),g.crossVectors(m,f),m.normalize(),g.normalize();for(let t=0;t<=n;++t){const i=t/n*Math.PI*2,a=-e*Math.cos(i),u=e*Math.sin(i);h.x=p.x+(a*g.x+u*m.x),h.y=p.y+(a*g.y+u*m.y),h.z=p.z+(a*g.z+u*m.z),s.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),l.push(d.x,d.y,d.z),c.push(o/r),c.push(t/n)}}for(let t=1;t<=r;t++)for(let e=1;e<=n;e++){const r=(n+1)*(t-1)+(e-1),i=(n+1)*t+(e-1),a=(n+1)*t+e,s=(n+1)*(t-1)+e;o.push(r,i,s),o.push(i,a,s)}function v(t,e,r,n,i){const a=Math.cos(t),o=Math.sin(t),s=r/e*t,l=Math.cos(s);i.x=n*(2+l)*.5*a,i.y=n*(2+l)*o*.5,i.z=n*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new Fr(s,3)),this.setAttribute("normal",new Fr(l,3)),this.setAttribute("uv",new Fr(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Vs(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}function js(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function Gs(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class Hs{constructor(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{let a;r:{n:if(!(t<n)){for(let a=r+2;;){if(void 0===n){if(t<i)break n;return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(i=n,n=e[++r],t<n)break e}a=e.length;break r}if(t>=i)break t;{const o=e[1];t<o&&(r=2,i=o);for(let a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(n=i,i=e[--r-1],t>=i)break e}a=r,r=0}}for(;r<a;){const n=r+a>>>1;t<e[n]?a=n:r=n+1}if(n=e[r],i=e[r-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=t*n;for(let t=0;t!==n;++t)e[t]=r[i+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ws extends Hs{constructor(t,e,r,n){super(t,e,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:tt,endingEnd:tt}}intervalChanged_(t,e,r){const n=this.parameterPositions;let i=t-2,a=t+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case et:i=t,o=2*e-r;break;case rt:i=n.length-2,o=e+n[i]-n[i+1];break;default:i=t,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case et:a=t,s=2*r-e;break;case rt:a=1,s=r+n[1]-n[0];break;default:a=t-1,s=e}const l=.5*(r-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-r),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(t,e,r,n){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,u=(r-e)/(n-e),m=u*u,f=m*u,g=-d*f+2*d*m-d*u,v=(1+d)*f+(-1.5-2*d)*m+(-.5+d)*u+1,b=(-1-p)*f+(1.5+p)*m+.5*u,y=p*f-p*m;for(let t=0;t!==o;++t)i[t]=g*a[c+t]+v*a[l+t]+b*a[s+t]+y*a[h+t];return i}}class qs extends Hs{constructor(t,e,r,n){super(t,e,r,n)}interpolate_(t,e,r,n){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=(r-e)/(n-e),h=1-c;for(let t=0;t!==o;++t)i[t]=a[l+t]*h+a[s+t]*c;return i}}class $s extends Hs{constructor(t,e,r,n){super(t,e,r,n)}interpolate_(t){return this.copySampleValue_(t-1)}}class Xs{constructor(t,e,r,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=js(e,this.TimeBufferType),this.values=js(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let r;if(e.toJSON!==this.toJSON)r=e.toJSON(t);else{r={name:t.name,times:js(t.times,Array),values:js(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(r.interpolation=e)}return r.type=t.ValueTypeName,r}InterpolantFactoryMethodDiscrete(t){return new $s(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new qs(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Ws(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case K:e=this.InterpolantFactoryMethodDiscrete;break;case J:e=this.InterpolantFactoryMethodLinear;break;case Q:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return K;case this.InterpolantFactoryMethodLinear:return J;case this.InterpolantFactoryMethodSmooth:return Q}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let r=0,n=e.length;r!==n;++r)e[r]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let r=0,n=e.length;r!==n;++r)e[r]*=t}return this}trim(t,e){const r=this.times,n=r.length;let i=0,a=n-1;for(;i!==n&&r[i]<t;)++i;for(;-1!==a&&r[a]>e;)--a;if(++a,0!==i||a!==n){i>=a&&(a=Math.max(a,1),i=a-1);const t=this.getValueSize();this.times=r.slice(i,a),this.values=this.values.slice(i*t,a*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let a=null;for(let e=0;e!==i;e++){const n=r[e];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,n),t=!1;break}if(null!==a&&a>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,n,a),t=!1;break}a=n}if(void 0!==n&&Gs(n))for(let e=0,r=n.length;e!==r;++e){const r=n[e];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,r),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),r=this.getValueSize(),n=this.getInterpolation()===Q,i=t.length-1;let a=1;for(let o=1;o<i;++o){let i=!1;const s=t[o];if(s!==t[o+1]&&(1!==o||s!==t[0]))if(n)i=!0;else{const t=o*r,n=t-r,a=t+r;for(let o=0;o!==r;++o){const r=e[t+o];if(r!==e[n+o]||r!==e[a+o]){i=!0;break}}}if(i){if(o!==a){t[a]=t[o];const n=o*r,i=a*r;for(let t=0;t!==r;++t)e[i+t]=e[n+t]}++a}}if(i>0){t[a]=t[i];for(let t=i*r,n=a*r,o=0;o!==r;++o)e[n+o]=e[t+o];++a}return a!==t.length?(this.times=t.slice(0,a),this.values=e.slice(0,a*r)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}Xs.prototype.TimeBufferType=Float32Array,Xs.prototype.ValueBufferType=Float32Array,Xs.prototype.DefaultInterpolation=J;class Ys extends Xs{}Ys.prototype.ValueTypeName="bool",Ys.prototype.ValueBufferType=Array,Ys.prototype.DefaultInterpolation=K,Ys.prototype.InterpolantFactoryMethodLinear=void 0,Ys.prototype.InterpolantFactoryMethodSmooth=void 0;class Zs extends Xs{}Zs.prototype.ValueTypeName="color";class Ks extends Xs{}Ks.prototype.ValueTypeName="number";class Js extends Hs{constructor(t,e,r,n){super(t,e,r,n)}interpolate_(t,e,r,n){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(r-e)/(n-e);let l=t*o;for(let t=l+o;l!==t;l+=4)ce.slerpFlat(i,0,a,l-o,a,l,s);return i}}class Qs extends Xs{InterpolantFactoryMethodLinear(t){return new Js(this.times,this.values,this.getValueSize(),t)}}Qs.prototype.ValueTypeName="quaternion",Qs.prototype.DefaultInterpolation=J,Qs.prototype.InterpolantFactoryMethodSmooth=void 0;class tl extends Xs{}tl.prototype.ValueTypeName="string",tl.prototype.ValueBufferType=Array,tl.prototype.DefaultInterpolation=K,tl.prototype.InterpolantFactoryMethodLinear=void 0,tl.prototype.InterpolantFactoryMethodSmooth=void 0;class el extends Xs{}el.prototype.ValueTypeName="vector";const rl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class nl{constructor(t,e,r){const n=this;let i,a=!1,o=0,s=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){s++,!1===a&&void 0!==n.onStart&&n.onStart(t,o,s),a=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,s),o===s&&(a=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,r=l.length;e<r;e+=2){const r=l[e],n=l[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return n}return null}}}const il=new nl;class al{constructor(t){this.manager=void 0!==t?t:il,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const r=this;return new Promise((function(n,i){r.load(t,n,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}al.DEFAULT_MATERIAL_NAME="__DEFAULT";const ol={};class sl extends Error{constructor(t,e){super(t),this.response=e}}class ll extends al{constructor(t){super(t)}load(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=rl.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==ol[t])return void ol[t].push({onLoad:e,onProgress:r,onError:n});ol[t]=[],ol[t].push({onLoad:e,onProgress:r,onError:n});const a=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then((e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const r=ol[t],n=e.body.getReader(),i=e.headers.get("Content-Length")||e.headers.get("X-File-Size"),a=i?parseInt(i):0,o=0!==a;let s=0;const l=new ReadableStream({start(t){!function e(){n.read().then((({done:n,value:i})=>{if(n)t.close();else{s+=i.byteLength;const n=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a});for(let t=0,e=r.length;t<e;t++){const e=r[t];e.onProgress&&e.onProgress(n)}t.enqueue(i),e()}}))}()}});return new Response(l)}throw new sl(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)})).then((t=>{switch(s){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,o)));case"json":return t.json();default:if(void 0===o)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(o),r=e&&e[1]?e[1].toLowerCase():void 0,n=new TextDecoder(r);return t.arrayBuffer().then((t=>n.decode(t)))}}})).then((e=>{rl.add(t,e);const r=ol[t];delete ol[t];for(let t=0,n=r.length;t<n;t++){const n=r[t];n.onLoad&&n.onLoad(e)}})).catch((e=>{const r=ol[t];if(void 0===r)throw this.manager.itemError(t),e;delete ol[t];for(let t=0,n=r.length;t<n;t++){const n=r[t];n.onError&&n.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class cl extends dr{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Pr(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}class hl extends cl{constructor(t,e,r){super(t,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(dr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pr(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const dl=new Be,pl=new he,ul=new he;class ml{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ot(512,512),this.map=null,this.mapPass=null,this.matrix=new Be,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Dn,this._frameExtents=new Ot(1,1),this._viewportCount=1,this._viewports=[new ie(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,r=this.matrix;pl.setFromMatrixPosition(t.matrixWorld),e.position.copy(pl),ul.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(ul),e.updateMatrixWorld(),dl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dl),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(dl)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class fl extends ml{constructor(){super(new xn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,r=2*Et*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class gl extends cl{constructor(t,e,r=0,n=Math.PI/3,i=0,a=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(dr.DEFAULT_UP),this.updateMatrix(),this.target=new dr,this.distance=r,this.angle=n,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new fl}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const vl=new Be,bl=new he,yl=new he;class xl extends ml{constructor(){super(new xn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ot(4,2),this._viewportCount=6,this._viewports=[new ie(2,1,1,1),new ie(0,1,1,1),new ie(3,1,1,1),new ie(1,1,1,1),new ie(3,0,1,1),new ie(1,0,1,1)],this._cubeDirections=[new he(1,0,0),new he(-1,0,0),new he(0,0,1),new he(0,0,-1),new he(0,1,0),new he(0,-1,0)],this._cubeUps=[new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,0,1),new he(0,0,-1)]}updateMatrices(t,e=0){const r=this.camera,n=this.matrix,i=t.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),bl.setFromMatrixPosition(t.matrixWorld),r.position.copy(bl),yl.copy(r.position),yl.add(this._cubeDirections[e]),r.up.copy(this._cubeUps[e]),r.lookAt(yl),r.updateMatrixWorld(),n.makeTranslation(-bl.x,-bl.y,-bl.z),vl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vl)}}class _l extends cl{constructor(t,e,r=0,n=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new xl}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class wl extends ml{constructor(){super(new Wn(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Sl extends cl{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(dr.DEFAULT_UP),this.updateMatrix(),this.target=new dr,this.shadow=new wl}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class El extends qr{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class Ml extends al{constructor(t){super(t)}load(t,e,r,n){const i=this,a=new ll(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(t,(function(r){try{e(i.parse(JSON.parse(r)))}catch(e){n?n(e):console.error(e),i.manager.itemError(t)}}),r,n)}parse(t){const e={},r={};function n(t,n){if(void 0!==e[n])return e[n];const i=t.interleavedBuffers[n],a=function(t,e){if(void 0!==r[e])return r[e];const n=t.arrayBuffers,i=n[e],a=new Uint32Array(i).buffer;return r[e]=a,a}(t,i.buffer),o=Ut(i.type,a),s=new yo(o,i.stride);return s.uuid=i.uuid,e[n]=s,s}const i=t.isInstancedBufferGeometry?new El:new qr,a=t.data.index;if(void 0!==a){const t=Ut(a.type,a.array);i.setIndex(new Ir(t,1))}const o=t.data.attributes;for(const e in o){const r=o[e];let a;if(r.isInterleavedBufferAttribute){const e=n(t.data,r.data);a=new _o(e,r.itemSize,r.offset,r.normalized)}else{const t=Ut(r.type,r.array);a=new(r.isInstancedBufferAttribute?To:Ir)(t,r.itemSize,r.normalized)}void 0!==r.name&&(a.name=r.name),void 0!==r.usage&&a.setUsage(r.usage),i.setAttribute(e,a)}const s=t.data.morphAttributes;if(s)for(const e in s){const r=s[e],a=[];for(let e=0,i=r.length;e<i;e++){const i=r[e];let o;if(i.isInterleavedBufferAttribute){const e=n(t.data,i.data);o=new _o(e,i.itemSize,i.offset,i.normalized)}else{const t=Ut(i.type,i.array);o=new Ir(t,i.itemSize,i.normalized)}void 0!==i.name&&(o.name=i.name),a.push(o)}i.morphAttributes[e]=a}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let t=0,e=l.length;t!==e;++t){const e=l[t];i.addGroup(e.start,e.count,e.materialIndex)}const c=t.data.boundingSphere;if(void 0!==c){const t=new he;void 0!==c.center&&t.fromArray(c.center),i.boundingSphere=new De(t,c.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}}const Al="\\[\\]\\.:\\/",Tl=new RegExp("["+Al+"]","g"),Pl="[^"+Al+"]",Cl="[^"+Al.replace("\\.","")+"]",kl=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Pl)+/(WCOD+)?/.source.replace("WCOD",Cl)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Pl)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Pl)+"$"),Dl=["material","materials","bones","map"];class Ll{constructor(t,e,r){this.path=e,this.parsedPath=r||Ll.parseTrackName(e),this.node=Ll.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,r){return t&&t.isAnimationObjectGroup?new Ll.Composite(t,e,r):new Ll(t,e,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Tl,"")}static parseTrackName(t){const e=kl.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=r.nodeName.substring(n+1);-1!==Dl.indexOf(t)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=t)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(void 0!==r)return r}if(t.children){const r=function(t){for(let n=0;n<t.length;n++){const i=t[n];if(i.name===e||i.uuid===e)return i;const a=r(i.children);if(a)return a}return null},n=r(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)t[e++]=r[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,r=e.objectName,n=e.propertyName;let i=e.propertyIndex;if(t||(t=Ll.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let n=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==n){if(void 0===t[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[n]}}const a=t[n];if(void 0===a){const r=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+n+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ll.Composite=class{constructor(t,e,r){const n=r||Ll.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(t,e)}setValue(t,e){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}},Ll.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ll.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ll.prototype.GetterByBindingType=[Ll.prototype._getValue_direct,Ll.prototype._getValue_array,Ll.prototype._getValue_arrayElement,Ll.prototype._getValue_toArray],Ll.prototype.SetterByBindingTypeAndVersioning=[[Ll.prototype._setValue_direct,Ll.prototype._setValue_direct_setNeedsUpdate,Ll.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_array,Ll.prototype._setValue_array_setNeedsUpdate,Ll.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_arrayElement,Ll.prototype._setValue_arrayElement_setNeedsUpdate,Ll.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ll.prototype._setValue_fromArray,Ll.prototype._setValue_fromArray_setNeedsUpdate,Ll.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);function Rl(t,e){return t.distance-e.distance}function Ol(t,e,r,n){if(t.layers.test(e.layers)&&t.raycast(e,r),!0===n){const n=t.children;for(let t=0,i=n.length;t<i;t++)Ol(n[t],e,r,!0)}}const Il=new Ot;class Nl{constructor(t=new Ot(1/0,1/0),e=new Ot(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=Il.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Il).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const zl=new he,Fl=new he;class Ul{constructor(t=new he,e=new he){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){zl.subVectors(t,this.start),Fl.subVectors(this.end,this.start);const r=Fl.dot(Fl);let n=Fl.dot(zl)/r;return e&&(n=At(n,0,1)),n}closestPointToPoint(t,e,r){const n=this.closestPointToPointParameter(t,e);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Bl=new he;class Vl extends dr{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";const r=new qr,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,r=32;t<r;t++,e++){const i=t/r*Math.PI*2,a=e/r*Math.PI*2;n.push(Math.cos(i),Math.sin(i),1,Math.cos(a),Math.sin(a),1)}r.setAttribute("position",new Fr(n,3));const i=new Po({fog:!1,toneMapped:!1});this.cone=new zo(r,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Bl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Bl),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}class jl extends dn{constructor(t,e,r){super(new Bs(e,4,2),new Lr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Gl=new he,Hl=new he,Wl=new he;class ql extends dr{constructor(t,e,r){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",void 0===e&&(e=1);let n=new qr;n.setAttribute("position",new Fr([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new Po({fog:!1,toneMapped:!1});this.lightPlane=new Oo(n,i),this.add(this.lightPlane),n=new qr,n.setAttribute("position",new Fr([0,0,0,0,0,1],3)),this.targetLine=new Oo(n,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Gl.setFromMatrixPosition(this.light.matrixWorld),Hl.setFromMatrixPosition(this.light.target.matrixWorld),Wl.subVectors(Hl,Gl),this.lightPlane.lookAt(Hl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Hl),this.targetLine.scale.z=Wl.length()}}const $l=new he,Xl=new yn;class Yl extends zo{constructor(t){const e=new qr,r=new Po({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],a={};function o(t,e){s(t),s(e)}function s(t){n.push(0,0,0),i.push(0,0,0),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),e.setAttribute("position",new Fr(n,3)),e.setAttribute("color",new Fr(i,3)),super(e,r),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new Pr(16755200),c=new Pr(16711680),h=new Pr(43775),d=new Pr(16777215),p=new Pr(3355443);this.setColors(l,c,h,d,p)}setColors(t,e,r,n,i){const a=this.geometry.getAttribute("color");a.setXYZ(0,t.r,t.g,t.b),a.setXYZ(1,t.r,t.g,t.b),a.setXYZ(2,t.r,t.g,t.b),a.setXYZ(3,t.r,t.g,t.b),a.setXYZ(4,t.r,t.g,t.b),a.setXYZ(5,t.r,t.g,t.b),a.setXYZ(6,t.r,t.g,t.b),a.setXYZ(7,t.r,t.g,t.b),a.setXYZ(8,t.r,t.g,t.b),a.setXYZ(9,t.r,t.g,t.b),a.setXYZ(10,t.r,t.g,t.b),a.setXYZ(11,t.r,t.g,t.b),a.setXYZ(12,t.r,t.g,t.b),a.setXYZ(13,t.r,t.g,t.b),a.setXYZ(14,t.r,t.g,t.b),a.setXYZ(15,t.r,t.g,t.b),a.setXYZ(16,t.r,t.g,t.b),a.setXYZ(17,t.r,t.g,t.b),a.setXYZ(18,t.r,t.g,t.b),a.setXYZ(19,t.r,t.g,t.b),a.setXYZ(20,t.r,t.g,t.b),a.setXYZ(21,t.r,t.g,t.b),a.setXYZ(22,t.r,t.g,t.b),a.setXYZ(23,t.r,t.g,t.b),a.setXYZ(24,e.r,e.g,e.b),a.setXYZ(25,e.r,e.g,e.b),a.setXYZ(26,e.r,e.g,e.b),a.setXYZ(27,e.r,e.g,e.b),a.setXYZ(28,e.r,e.g,e.b),a.setXYZ(29,e.r,e.g,e.b),a.setXYZ(30,e.r,e.g,e.b),a.setXYZ(31,e.r,e.g,e.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,n.r,n.g,n.b),a.setXYZ(39,n.r,n.g,n.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}update(){const t=this.geometry,e=this.pointMap;Xl.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Zl("c",e,t,Xl,0,0,-1),Zl("t",e,t,Xl,0,0,1),Zl("n1",e,t,Xl,-1,-1,-1),Zl("n2",e,t,Xl,1,-1,-1),Zl("n3",e,t,Xl,-1,1,-1),Zl("n4",e,t,Xl,1,1,-1),Zl("f1",e,t,Xl,-1,-1,1),Zl("f2",e,t,Xl,1,-1,1),Zl("f3",e,t,Xl,-1,1,1),Zl("f4",e,t,Xl,1,1,1),Zl("u1",e,t,Xl,.7,1.1,-1),Zl("u2",e,t,Xl,-.7,1.1,-1),Zl("u3",e,t,Xl,0,2,-1),Zl("cf1",e,t,Xl,-1,0,1),Zl("cf2",e,t,Xl,1,0,1),Zl("cf3",e,t,Xl,0,-1,1),Zl("cf4",e,t,Xl,0,1,1),Zl("cn1",e,t,Xl,-1,0,-1),Zl("cn2",e,t,Xl,1,0,-1),Zl("cn3",e,t,Xl,0,-1,-1),Zl("cn4",e,t,Xl,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Zl(t,e,r,n,i,a,o){$l.set(i,a,o).unproject(n);const s=e[t];if(void 0!==s){const t=r.getAttribute("position");for(let e=0,r=s.length;e<r;e++)t.setXYZ(s[e],$l.x,$l.y,$l.z)}}class Kl extends zo{constructor(t,e=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new qr;n.setIndex(new Ir(r,1)),n.setAttribute("position",new Fr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new Po({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Jl extends zo{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],r=new qr;r.setAttribute("position",new Fr(e,3)),r.setAttribute("color",new Fr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(r,new Po({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,r){const n=new Pr,i=this.geometry.attributes.color.array;return n.set(t),n.toArray(i,0),n.toArray(i,3),n.set(e),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ql(t){let e,r,n,i=-1,a=0;for(let o=0;o<t.length;++o){const s=t[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=s.array.constructor),e!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=s.itemSize),r!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=s.normalized),n!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===i&&(i=s.gpuType),i!==s.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=s.array.length}const o=new e(a);let s=0;for(let e=0;e<t.length;++e)o.set(t[e].array,s),s+=t[e].array.length;const l=new Ir(o,r,n);return void 0!==i&&(l.gpuType=i),l}function tc(t,e=!1){return console.warn("THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries()."),function(t,e=!1){const r=null!==t[0].index,n=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),a={},o={},s=t[0].morphTargetsRelative,l=new qr;let c=0;for(let h=0;h<t.length;++h){const d=t[h];let p=0;if(r!==(null!==d.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const t in d.attributes){if(!n.has(t))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[t]&&(a[t]=[]),a[t].push(d.attributes[t]),p++}if(p!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(s!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const t in d.morphAttributes){if(!i.has(t))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[t]&&(o[t]=[]),o[t].push(d.morphAttributes[t])}if(e){let t;if(r)t=d.index.count;else{if(void 0===d.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;t=d.attributes.position.count}l.addGroup(c,t,h),c+=t}}if(r){let e=0;const r=[];for(let n=0;n<t.length;++n){const i=t[n].index;for(let t=0;t<i.count;++t)r.push(i.getX(t)+e);e+=t[n].attributes.position.count}l.setIndex(r)}for(const t in a){const e=Ql(a[t]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+t+" attribute."),null;l.setAttribute(t,e)}for(const t in o){const e=o[t][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[t]=[];for(let r=0;r<e;++r){const e=[];for(let n=0;n<o[t].length;++n)e.push(o[t][n][r]);const n=Ql(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+t+" morphAttribute."),null;l.morphAttributes[t].push(n)}}return l}(t,e)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:s}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=s);var ec=Object.create,rc=Object.defineProperty,nc=Object.getOwnPropertyDescriptor,ic=Object.getOwnPropertyNames,ac=Object.getPrototypeOf,oc=Object.prototype.hasOwnProperty,sc=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),lc=(t,e,r)=>(r=null!=t?ec(ac(t)):{},((t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let i of ic(e))!oc.call(t,i)&&i!==r&&rc(t,i,{get:()=>e[i],enumerable:!(n=nc(e,i))||n.enumerable});return t})(!e&&t&&t.__esModule?r:rc(r,"default",{value:t,enumerable:!0}),t)),cc=(t,e,r)=>(((t,e,r)=>{e in t?rc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r),hc=sc(((t,e)=>{var r,n;r=t,n=function(){return t.importState=function(e){var r=new t;return r.importState(e),r},t;function t(){return function(t){var e=0,r=0,n=0,i=1;0==t.length&&(t=[+new Date]);var a=function(){var t=4022871197,e=function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)};return e.version="Mash 0.9",e}();e=a(" "),r=a(" "),n=a(" ");for(var o=0;o<t.length;o++)(e-=a(t[o]))<0&&(e+=1),(r-=a(t[o]))<0&&(r+=1),(n-=a(t[o]))<0&&(n+=1);a=null;var s=function(){var t=2091639*e+2.3283064365386963e-10*i;return e=r,r=n,n=t-(i=0|t)};return s.next=s,s.uint32=function(){return 4294967296*s()},s.fract53=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.version="Alea 0.9",s.args=t,s.exportState=function(){return[e,r,n,i]},s.importState=function(t){e=+t[0]||0,r=+t[1]||0,n=+t[2]||0,i=+t[3]||0},s}(Array.prototype.slice.call(arguments))}},"object"==typeof t?e.exports=n():"function"==typeof define&&define.amd?define(n):r.Alea=n()})),dc=sc(((t,e)=>{var r,n;r=t,n=function(t){t.SVD=function(t,e,r,n,i){if(e=void 0===e||e,r=void 0===r||r,i=1e-64/(n=n||Math.pow(2,-52)),!t)throw new TypeError("Matrix a is not defined");var a,o,s,l,c,h,d,p,u,m,f,g,v=t[0].length,b=t.length;if(b<v)throw new TypeError("Invalid matrix: m < n");for(var y=[],x=[],_=[],w="f"===e?b:v,S=m=d=0;S<b;S++)x[S]=new Array(w).fill(0);for(S=0;S<v;S++)_[S]=new Array(v).fill(0);var E,M=new Array(v).fill(0);for(S=0;S<b;S++)for(a=0;a<v;a++)x[S][a]=t[S][a];for(S=0;S<v;S++){for(y[S]=d,u=0,s=S+1,a=S;a<b;a++)u+=Math.pow(x[a][S],2);if(u<i)d=0;else for(p=(h=x[S][S])*(d=h<0?Math.sqrt(u):-Math.sqrt(u))-u,x[S][S]=h-d,a=s;a<v;a++){for(u=0,o=S;o<b;o++)u+=x[o][S]*x[o][a];for(h=u/p,o=S;o<b;o++)x[o][a]=x[o][a]+h*x[o][S]}for(M[S]=d,u=0,a=s;a<v;a++)u+=Math.pow(x[S][a],2);if(u<i)d=0;else{for(p=(h=x[S][S+1])*(d=h<0?Math.sqrt(u):-Math.sqrt(u))-u,x[S][S+1]=h-d,a=s;a<v;a++)y[a]=x[S][a]/p;for(a=s;a<b;a++){for(u=0,o=s;o<v;o++)u+=x[a][o]*x[S][o];for(o=s;o<v;o++)x[a][o]=x[a][o]+u*y[o]}}m<(f=Math.abs(M[S])+Math.abs(y[S]))&&(m=f)}if(r)for(S=v-1;0<=S;S--){if(0!==d){for(p=x[S][S+1]*d,a=s;a<v;a++)_[a][S]=x[S][a]/p;for(a=s;a<v;a++){for(u=0,o=s;o<v;o++)u+=x[S][o]*_[o][a];for(o=s;o<v;o++)_[o][a]=_[o][a]+u*_[o][S]}}for(a=s;a<v;a++)_[S][a]=0,_[a][S]=0;_[S][S]=1,d=y[S],s=S}if(e){if("f"===e)for(S=v;S<b;S++){for(a=v;a<b;a++)x[S][a]=0;x[S][S]=1}for(S=v-1;0<=S;S--){for(s=S+1,d=M[S],a=s;a<w;a++)x[S][a]=0;if(0!==d){for(p=x[S][S]*d,a=s;a<w;a++){for(u=0,o=s;o<b;o++)u+=x[o][S]*x[o][a];for(h=u/p,o=S;o<b;o++)x[o][a]=x[o][a]+h*x[o][S]}for(a=S;a<b;a++)x[a][S]=x[a][S]/d}else for(a=S;a<b;a++)x[a][S]=0;x[S][S]=x[S][S]+1}}for(n*=m,o=v-1;0<=o;o--)for(var A=0;A<50;A++){for(E=!1,s=o;0<=s;s--){if(Math.abs(y[s])<=n){E=!0;break}if(Math.abs(M[s-1])<=n)break}if(!E)for(c=0,l=s-(u=1),S=s;S<o+1&&(h=u*y[S],y[S]=c*y[S],!(Math.abs(h)<=n));S++)if(d=M[S],M[S]=Math.sqrt(h*h+d*d),c=d/(p=M[S]),u=-h/p,e)for(a=0;a<b;a++)f=x[a][l],g=x[a][S],x[a][l]=f*c+g*u,x[a][S]=-f*u+g*c;if(g=M[o],s===o){if(g<0&&(M[o]=-g,r))for(a=0;a<v;a++)_[a][o]=-_[a][o];break}for(m=M[s],h=(((f=M[o-1])-g)*(f+g)+((d=y[o-1])-(p=y[o]))*(d+p))/(2*p*f),d=Math.sqrt(h*h+1),h=((m-g)*(m+g)+p*(f/(h<0?h-d:h+d)-p))/m,S=s+(u=c=1);S<o+1;S++){if(d=y[S],f=M[S],p=u*d,d*=c,g=Math.sqrt(h*h+p*p),h=m*(c=h/(y[S-1]=g))+d*(u=p/g),d=-m*u+d*c,p=f*u,f*=c,r)for(a=0;a<v;a++)m=_[a][S-1],g=_[a][S],_[a][S-1]=m*c+g*u,_[a][S]=-m*u+g*c;if(g=Math.sqrt(h*h+p*p),h=(c=h/(M[S-1]=g))*d+(u=p/g)*f,m=-u*d+c*f,e)for(a=0;a<b;a++)f=x[a][S-1],g=x[a][S],x[a][S-1]=f*c+g*u,x[a][S]=-f*u+g*c}y[s]=0,y[o]=h,M[o]=m}for(S=0;S<v;S++)M[S]<n&&(M[S]=0);return{u:x,q:M,v:_}},t.VERSION="1.1.1",Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof t&&typeof e<"u"?n(t):"function"==typeof define&&define.amd?define(["exports"],n):n((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})),pc=sc(((t,e)=>{var r,n;r=t,n=function(){var t=function(t,r){if(void 0===t&&(t=[]),void 0===r&&(r=e),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function e(t,e){return t<e?-1:t>e?1:0}return t.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var i=t-1>>1,a=e[i];if(r(n,a)>=0)break;e[t]=a,t=i}e[t]=n},t.prototype._down=function(t){for(var e=this.data,r=this.compare,n=this.length>>1,i=e[t];t<n;){var a=1+(t<<1),o=e[a],s=a+1;if(s<this.length&&r(e[s],o)<0&&(a=s,o=e[s]),r(o,i)>=0)break;e[t]=o,t=a}e[t]=i},t},"object"==typeof t&&typeof e<"u"?e.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).TinyQueue=n()})),uc=sc(((t,e)=>{var r=pc();function n(t,e,n){e=e||1;for(var o,s,l,c,h=0;h<t[0].length;h++){var d=t[0][h];(!h||d[0]<o)&&(o=d[0]),(!h||d[1]<s)&&(s=d[1]),(!h||d[0]>l)&&(l=d[0]),(!h||d[1]>c)&&(c=d[1])}var p=l-o,u=c-s,m=Math.min(p,u),f=m/2;if(0===m){var g=[o,s];return g.distance=0,g}for(var v=new r(void 0,i),b=o;b<l;b+=m)for(var y=s;y<c;y+=m)v.push(new a(b+f,y+f,f,t));var x=function(t){for(var e=0,r=0,n=0,i=t[0],o=0,s=i.length,l=s-1;o<s;l=o++){var c=i[o],h=i[l],d=c[0]*h[1]-h[0]*c[1];r+=(c[0]+h[0])*d,n+=(c[1]+h[1])*d,e+=3*d}return 0===e?new a(i[0][0],i[0][1],0,t):new a(r/e,n/e,0,t)}(t),_=new a(o+p/2,s+u/2,0,t);_.d>x.d&&(x=_);for(var w=v.length;v.length;){var S=v.pop();S.d>x.d&&(x=S,n&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,w)),!(S.max-x.d<=e)&&(f=S.h/2,v.push(new a(S.x-f,S.y-f,f,t)),v.push(new a(S.x+f,S.y-f,f,t)),v.push(new a(S.x-f,S.y+f,f,t)),v.push(new a(S.x+f,S.y+f,f,t)),w+=4)}n&&(console.log("num probes: "+w),console.log("best distance: "+x.d));var E=[x.x,x.y];return E.distance=x.d,E}function i(t,e){return e.max-t.max}function a(t,e,r,n){this.x=t,this.y=e,this.h=r,this.d=function(t,e,r){for(var n=!1,i=1/0,a=0;a<r.length;a++)for(var s=r[a],l=0,c=s.length,h=c-1;l<c;h=l++){var d=s[l],p=s[h];d[1]>e!=p[1]>e&&t<(p[0]-d[0])*(e-d[1])/(p[1]-d[1])+d[0]&&(n=!n),i=Math.min(i,o(t,e,d,p))}return 0===i?0:(n?1:-1)*Math.sqrt(i)}(t,e,n),this.max=this.d+this.h*Math.SQRT2}function o(t,e,r,n){var i=r[0],a=r[1],o=n[0]-i,s=n[1]-a;if(0!==o||0!==s){var l=((t-i)*o+(e-a)*s)/(o*o+s*s);l>1?(i=n[0],a=n[1]):l>0&&(i+=o*l,a+=s*l)}return(o=t-i)*o+(s=e-a)*s}r.default&&(r=r.default),e.exports=n,e.exports.default=n})),mc=sc((t=>{!function(){var e=function(){this.init()};e.prototype={init:function(){var t=this||r;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator=typeof window<"u"&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||r;if(t=parseFloat(t),e.ctx||h(),typeof t<"u"&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,r.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),a=0;a<i.length;a++){var o=e._howls[n]._soundById(i[a]);o&&o._node&&(o._node.volume=o._volume*t)}return e}return e._volume},mute:function(t){var e=this||r;e.ctx||h(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,r.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),a=0;a<i.length;a++){var o=e._howls[n]._soundById(i[a]);o&&o._node&&(o._node.muted=!!t||o._muted)}return e},stop:function(){for(var t=this||r,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||r,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&typeof t.ctx.close<"u"&&(t.ctx.close(),t.ctx=null,h()),t},codecs:function(t){return(this||r)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||r;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if(typeof Audio<"u")try{typeof(new Audio).oncanplaythrough>"u"&&(t._canPlayEvent="canplay")}catch{t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch{}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||r,e=null;try{e=typeof Audio<"u"?new Audio:null}catch{return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i=t._navigator?t._navigator.userAgent:"",a=i.match(/OPR\/([0-6].)/g),o=a&&parseInt(a[0].split("/")[1],10)<33,s=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),c=s&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||r;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,!t._mobileUnloaded&&44100!==t.ctx.sampleRate&&(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(r){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}catch{t.noAudio=!0;break}for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var a=t._howls[i]._getSoundIds(),o=0;o<a.length;o++){var s=t._howls[i]._soundById(a[o]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),typeof l.start>"u"?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var r=0;r<t._howls.length;r++)t._howls[r]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||r;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&typeof Promise<"u"&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||r;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&!(typeof t.ctx.suspend>"u")&&r.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&!(typeof t.ctx.resume>"u")&&r.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var r=new e,n=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(t){var e=this;return r.ctx||h(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=r.usingWebAudio&&!e._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(r.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var a,s;if(t._format&&t._format[n])a=t._format[n];else{if("string"!=typeof(s=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(a=/^data:audio\/([^;,]+);/i.exec(s))||(a=/\.([^.]+)$/.exec(s.split("?",1)[0])),a&&(a=a[1].toLowerCase())}if(a||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),a&&r.codecs(a)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new i(t),t._webAudio&&o(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,i=null;if("number"==typeof t)i=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(typeof t>"u"&&(t="__default",!n._playLock)){for(var a=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(a++,i=n._sounds[o]._id);1===a?t=null:i=null}}var s=i?n._soundById(i):n._inactiveSound();if(!s)return null;if(i&&!t&&(t=s._sprite||"__default"),"loaded"!==n._state){s._sprite=t,s._ended=!1;var l=s._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(i&&!s._paused)return e||n._loadQueue("play"),s._id;n._webAudio&&r._autoResume();var c=Math.max(0,s._seek>0?s._seek:n._sprite[t][0]/1e3),h=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-c),d=1e3*h/Math.abs(s._rate),p=n._sprite[t][0]/1e3,u=(n._sprite[t][0]+n._sprite[t][1])/1e3;s._sprite=t,s._ended=!1;var m=function(){s._paused=!1,s._seek=c,s._start=p,s._stop=u,s._loop=!(!s._loop&&!n._sprite[t][2])};if(!(c>=u)){var f=s._node;if(n._webAudio){var g=function(){n._playLock=!1,m(),n._refreshBuffer(s);var t=s._muted||n._muted?0:s._volume;f.gain.setValueAtTime(t,r.ctx.currentTime),s._playStart=r.ctx.currentTime,typeof f.bufferSource.start>"u"?s._loop?f.bufferSource.noteGrainOn(0,c,86400):f.bufferSource.noteGrainOn(0,c,h):s._loop?f.bufferSource.start(0,c,86400):f.bufferSource.start(0,c,h),d!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),d)),e||setTimeout((function(){n._emit("play",s._id),n._loadQueue()}),0)};"running"===r.state&&"interrupted"!==r.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(s._id))}else{var v=function(){f.currentTime=c,f.muted=s._muted||n._muted||r._muted||f.muted,f.volume=s._volume*r.volume(),f.playbackRate=s._rate;try{var i=f.play();if(i&&typeof Promise<"u"&&(i instanceof Promise||"function"==typeof i.then)?(n._playLock=!0,m(),i.then((function(){n._playLock=!1,f._unlocked=!0,e?n._loadQueue():n._emit("play",s._id)})).catch((function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):e||(n._playLock=!1,m(),n._emit("play",s._id)),f.playbackRate=s._rate,f.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),d):(n._endTimers[s._id]=function(){n._ended(s),f.removeEventListener("ended",n._endTimers[s._id],!1)},f.addEventListener("ended",n._endTimers[s._id],!1))}catch(t){n._emit("playerror",s._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===f.src&&(f.src=n._src,f.load());var b=window&&window.ejecta||!f.readyState&&r._navigator.isCocoonJS;if(f.readyState>=3||b)v();else{n._playLock=!0,n._state="loading";var y=function(){n._state="loaded",v(),f.removeEventListener(r._canPlayEvent,y,!1)};f.addEventListener(r._canPlayEvent,y,!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var r=e._getSoundIds(t),n=0;n<r.length;n++){e._clearTimer(r[n]);var i=e._soundById(r[n]);if(i&&!i._paused&&(i._seek=e.seek(r[n]),i._rateSeek=0,i._paused=!0,e._stopFade(r[n]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;typeof i._node.bufferSource.stop>"u"?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else(!isNaN(i._node.duration)||i._node.duration===1/0)&&i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"stop",action:function(){r.stop(t)}}),r;for(var n=r._getSoundIds(t),i=0;i<n.length;i++){r._clearTimer(n[i]);var a=r._soundById(n[i]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,r._stopFade(n[i]),a._node&&(r._webAudio?a._node.bufferSource&&(typeof a._node.bufferSource.stop>"u"?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),r._cleanBuffer(a._node)):(!isNaN(a._node.duration)||a._node.duration===1/0)&&(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&r._clearSound(a._node))),e||r._emit("stop",a._id))}return r},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(typeof e>"u"){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var i=n._getSoundIds(e),a=0;a<i.length;a++){var o=n._soundById(i[a]);o&&(o._muted=t,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,r.ctx.currentTime):o._node&&(o._node.muted=!!r._muted||t),n._emit("mute",o._id))}return n},volume:function(){var t,e,n,i=this,a=arguments;if(0===a.length)return i._volume;1===a.length||2===a.length&&typeof a[1]>"u"?i._getSoundIds().indexOf(a[0])>=0?e=parseInt(a[0],10):t=parseFloat(a[0]):a.length>=2&&(t=parseFloat(a[0]),e=parseInt(a[1],10));if(!(typeof t<"u"&&t>=0&&t<=1))return(n=e?i._soundById(e):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,a)}}),i;typeof e>"u"&&(i._volume=t),e=i._getSoundIds(e);for(var o=0;o<e.length;o++)(n=i._soundById(e[o]))&&(n._volume=t,a[2]||i._stopFade(e[o]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,r.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*r.volume()),i._emit("volume",n._id));return i},fade:function(t,e,n,i){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(t,e,n,i)}}),a;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),a.volume(t,i);for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var l=a._soundById(o[s]);if(l){if(i||a._stopFade(o[s]),a._webAudio&&!l._muted){var c=r.ctx.currentTime,h=c+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,c),l._node.gain.linearRampToValueAtTime(e,h)}a._startFadeInterval(l,t,e,n,o[s],typeof i>"u")}}return a},_startFadeInterval:function(t,e,r,n,i,a){var o=this,s=e,l=r-e,c=Math.abs(l/.01),h=Math.max(4,c>0?n/c:n),d=Date.now();t._fadeTo=r,t._interval=setInterval((function(){var i=(Date.now()-d)/n;d=Date.now(),s+=l*i,s=Math.round(100*s)/100,s=l<0?Math.max(r,s):Math.min(r,s),o._webAudio?t._volume=s:o.volume(s,t._id,!0),a&&(o._volume=s),(r<e&&s<=r||r>e&&s>=r)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(r,t._id),o._emit("fade",t._id))}),h)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,r,n=this,i=arguments;if(0===i.length)return n._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(r=n._soundById(parseInt(i[0],10)))&&r._loop;t=i[0],n._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var a=n._getSoundIds(e),o=0;o<a.length;o++)(r=n._soundById(a[o]))&&(r._loop=t,n._webAudio&&r._node&&r._node.bufferSource&&(r._node.bufferSource.loop=t,t&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop,n.playing(a[o])&&(n.pause(a[o],!0),n.play(a[o],!0)))));return n},rate:function(){var t,e,n,i=this,a=arguments;if(0===a.length)e=i._sounds[0]._id;else if(1===a.length){i._getSoundIds().indexOf(a[0])>=0?e=parseInt(a[0],10):t=parseFloat(a[0])}else 2===a.length&&(t=parseFloat(a[0]),e=parseInt(a[1],10));if("number"!=typeof t)return(n=i._soundById(e))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,a)}}),i;typeof e>"u"&&(i._rate=t),e=i._getSoundIds(e);for(var o=0;o<e.length;o++)if(n=i._soundById(e[o])){i.playing(e[o])&&(n._rateSeek=i.seek(e[o]),n._playStart=i._webAudio?r.ctx.currentTime:n._playStart),n._rate=t,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,r.ctx.currentTime):n._node&&(n._node.playbackRate=t);var s=i.seek(e[o]),l=1e3*((i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-s)/Math.abs(n._rate);(i._endTimers[e[o]]||!n._paused)&&(i._clearTimer(e[o]),i._endTimers[e[o]]=setTimeout(i._ended.bind(i,n),l)),i._emit("rate",n._id)}return i},seek:function(){var t,e,n=this,i=arguments;if(0===i.length)n._sounds.length&&(e=n._sounds[0]._id);else if(1===i.length){n._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(i[0]))}else 2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if(typeof e>"u")return 0;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var a=n._soundById(e);if(a){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var o=n.playing(e)?r.ctx.currentTime-a._playStart:0,s=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(s+o*Math.abs(a._rate))}return a._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),a._seek=t,a._ended=!1,n._clearTimer(e),!n._webAudio&&a._node&&!isNaN(a._node.duration)&&(a._node.currentTime=t);var c=function(){l&&n.play(e,!0),n._emit("seek",e)};if(l&&!n._webAudio){var h=function(){n._playLock?setTimeout(h,0):c()};setTimeout(h,0)}else c()}return n},playing:function(t){var e=this;if("number"==typeof t){var r=e._soundById(t);return!!r&&!r._paused}for(var n=0;n<e._sounds.length;n++)if(!e._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this,r=e._duration,n=e._soundById(t);return n&&(r=e._sprite[n._sprite][1]/1e3),r},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(r._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),r._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var i=r._howls.indexOf(t);i>=0&&r._howls.splice(i,1);var o=!0;for(n=0;n<r._howls.length;n++)if(r._howls[n]._src===t._src||t._src.indexOf(r._howls[n]._src)>=0){o=!1;break}return a&&o&&delete a[t._src],r.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,r,n){var i=this["_on"+t];return"function"==typeof e&&i.push(n?{id:r,fn:e,once:n}:{id:r,fn:e}),this},off:function(t,e,r){var n=this,i=n["_on"+t],a=0;if("number"==typeof e&&(r=e,e=null),e||r)for(a=0;a<i.length;a++){var o=r===i[a].id;if(e===i[a].fn&&o||!e&&o){i.splice(a,1);break}}else if(t)n["_on"+t]=[];else{var s=Object.keys(n);for(a=0;a<s.length;a++)0===s[a].indexOf("_on")&&Array.isArray(n[s[a]])&&(n[s[a]]=[])}return n},once:function(t,e,r){return this.on(t,e,r,1),this},_emit:function(t,e,r){for(var n=this,i=n["_on"+t],a=i.length-1;a>=0;a--)(!i[a].id||i[a].id===e||"load"===t)&&(setTimeout(function(t){t.call(this,e,r)}.bind(n,i[a].fn),0),i[a].once&&n.off(t,i[a].fn,i[a].id));return n._loadQueue(t),n},_loadQueue:function(t){var e=this;if(e._queue.length>0){var r=e._queue[0];r.event===t&&(e._queue.shift(),e._loadQueue()),t||r.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var i=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&i&&e.stop(t._id,!0).play(t._id),e._webAudio&&i){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=r.ctx.currentTime;var a=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),a)}return e._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),r._autoSuspend()),!e._webAudio&&!i&&e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var r=e._soundById(t);r&&r._node&&r._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,r=0;r<e._sounds.length;r++)if(t===e._sounds[r]._id)return e._sounds[r];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new i(t)},_drain:function(){var t=this,e=t._pool,r=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&r++;for(n=t._sounds.length-1;n>=0;n--){if(r<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),r--)}}},_getSoundIds:function(t){if(typeof t>"u"){for(var e=[],r=0;r<this._sounds.length;r++)e.push(this._sounds[r]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=r.ctx.createBufferSource(),t._node.bufferSource.buffer=a[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,r.ctx.currentTime),this},_cleanBuffer:function(t){var e=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=r._scratchBuffer}catch{}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(t){this._parent=t,this.init()};i.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++r._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=r._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),t._node.gain.setValueAtTime(n,r.ctx.currentTime),t._node.paused=!0,t._node.connect(r.masterGain)):r.noAudio||(t._node=r._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(r._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*r.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++r._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(r._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var a={},o=function(t){var e=t._src;if(a[e])return t._duration=a[e].duration,void c(t);if(/^data:[^;]+;base64,/.test(e)){for(var r=atob(e.split(",")[1]),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);l(n.buffer,t)}else{var o=new XMLHttpRequest;o.open(t._xhr.method,e,!0),o.withCredentials=t._xhr.withCredentials,o.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){o.setRequestHeader(e,t._xhr.headers[e])})),o.onload=function(){var e=(o.status+"")[0];"0"===e||"2"===e||"3"===e?l(o.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete a[e],t.load())},s(o)}},s=function(t){try{t.send()}catch{t.onerror()}},l=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},i=function(t){t&&e._sounds.length>0?(a[e._src]=t,c(e,t)):n()};typeof Promise<"u"&&1===r.ctx.decodeAudioData.length?r.ctx.decodeAudioData(t).then(i).catch(n):r.ctx.decodeAudioData(t,i,n)},c=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},h=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),e=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var i=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!i&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:r,Howl:n}})),typeof t<"u"&&(t.Howler=r,t.Howl=n),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=r,global.Howl=n,global.Sound=i):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=r,window.Howl=n,window.Sound=i)}(),function(){var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var r=e._howls.length-1;r>=0;r--)e._howls[r].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,r){var n=this;return n.ctx&&n.ctx.listener?(e="number"!=typeof e?n._pos[1]:e,r="number"!=typeof r?n._pos[2]:r,"number"!=typeof t?n._pos:(n._pos=[t,e,r],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(t,e,r,n,i,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var s=o._orientation;return e="number"!=typeof e?s[1]:e,r="number"!=typeof r?s[2]:r,n="number"!=typeof n?s[3]:n,i="number"!=typeof i?s[4]:i,a="number"!=typeof a?s[5]:a,"number"!=typeof t?s:(o._orientation=[t,e,r,n,i,a],typeof o.ctx.listener.forwardX<"u"?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,r,n,i,a),o)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var r=this;return r._orientation=e.orientation||[1,0,0],r._stereo=e.stereo||null,r._pos=e.pos||null,r._pannerAttr={coneInnerAngle:typeof e.coneInnerAngle<"u"?e.coneInnerAngle:360,coneOuterAngle:typeof e.coneOuterAngle<"u"?e.coneOuterAngle:360,coneOuterGain:typeof e.coneOuterGain<"u"?e.coneOuterGain:0,distanceModel:typeof e.distanceModel<"u"?e.distanceModel:"inverse",maxDistance:typeof e.maxDistance<"u"?e.maxDistance:1e4,panningModel:typeof e.panningModel<"u"?e.panningModel:"HRTF",refDistance:typeof e.refDistance<"u"?e.refDistance:1,rolloffFactor:typeof e.rolloffFactor<"u"?e.rolloffFactor:1},r._onstereo=e.onstereo?[{fn:e.onstereo}]:[],r._onpos=e.onpos?[{fn:e.onpos}]:[],r._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,r){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(t,r)}}),n;var i=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u"){if("number"!=typeof t)return n._stereo;n._stereo=t,n._pos=[t,0,0]}for(var a=n._getSoundIds(r),o=0;o<a.length;o++){var s=n._soundById(a[o]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",(!s._panner||!s._panner.pan)&&e(s,i),"spatial"===i?typeof s._panner.positionX<"u"?(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(t,0,0):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),n._emit("stereo",s._id)}}return n},Howl.prototype.pos=function(t,r,n,i){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(t,r,n,i)}}),a;if(r="number"!=typeof r?0:r,n="number"!=typeof n?-.5:n,typeof i>"u"){if("number"!=typeof t)return a._pos;a._pos=[t,r,n]}for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var l=a._soundById(o[s]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,r,n],l._node&&((!l._panner||l._panner.pan)&&e(l,"spatial"),typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(t,r,n)),a._emit("pos",l._id)}}return a},Howl.prototype.orientation=function(t,r,n,i){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(t,r,n,i)}}),a;if(r="number"!=typeof r?a._orientation[1]:r,n="number"!=typeof n?a._orientation[2]:n,typeof i>"u"){if("number"!=typeof t)return a._orientation;a._orientation=[t,r,n]}for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var l=a._soundById(o[s]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,r,n],l._node&&(l._panner||(l._pos||(l._pos=a._pos||[0,0,-.5]),e(l,"spatial")),typeof l._panner.orientationX<"u"?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(t,r,n)),a._emit("orientation",l._id)}}return a},Howl.prototype.pannerAttr=function(){var t,r,n,i=this,a=arguments;if(!i._webAudio)return i;if(0===a.length)return i._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(n=i._soundById(parseInt(a[0],10)))?n._pannerAttr:i._pannerAttr;t=a[0],typeof r>"u"&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),i._pannerAttr={coneInnerAngle:typeof t.pannerAttr.coneInnerAngle<"u"?t.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof t.pannerAttr.coneOuterAngle<"u"?t.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof t.pannerAttr.coneOuterGain<"u"?t.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof t.pannerAttr.distanceModel<"u"?t.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof t.pannerAttr.maxDistance<"u"?t.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof t.pannerAttr.refDistance<"u"?t.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof t.pannerAttr.rolloffFactor<"u"?t.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof t.pannerAttr.panningModel<"u"?t.pannerAttr.panningModel:i._panningModel})}else 2===a.length&&(t=a[0],r=parseInt(a[1],10));for(var o=i._getSoundIds(r),s=0;s<o.length;s++)if(n=i._soundById(o[s])){var l=n._pannerAttr;l={coneInnerAngle:typeof t.coneInnerAngle<"u"?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:typeof t.coneOuterAngle<"u"?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:typeof t.coneOuterGain<"u"?t.coneOuterGain:l.coneOuterGain,distanceModel:typeof t.distanceModel<"u"?t.distanceModel:l.distanceModel,maxDistance:typeof t.maxDistance<"u"?t.maxDistance:l.maxDistance,refDistance:typeof t.refDistance<"u"?t.refDistance:l.refDistance,rolloffFactor:typeof t.rolloffFactor<"u"?t.rolloffFactor:l.rolloffFactor,panningModel:typeof t.panningModel<"u"?t.panningModel:l.panningModel};var c=n._panner;c?(c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel):(n._pos||(n._pos=i._pos||[0,0,-.5]),e(n,"spatial"))}return i},Sound.prototype.init=function(t){return function(){var e=this,r=e._parent;e._orientation=r._orientation,e._stereo=r._stereo,e._pos=r._pos,e._pannerAttr=r._pannerAttr,t.call(this),e._stereo?r.stereo(e._stereo):e._pos&&r.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,r=e._parent;return e._orientation=r._orientation,e._stereo=r._stereo,e._pos=r._pos,e._pannerAttr=r._pannerAttr,e._stereo?r.stereo(e._stereo):e._pos?r.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,r._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()})),fc=sc(((t,e)=>{e.exports=function(t){for(var e=new Array(t),r=0;r<t;++r)e[r]=r;return e}})),gc=sc(((t,e)=>{function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}e.exports=function(t){return null!=t&&(r(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}})),vc=sc(((t,e)=>{var r=fc(),n=gc(),i=typeof Float64Array<"u";function a(t,e){return t[0]-e[0]}function o(){var t,e=this.stride,r=new Array(e.length);for(t=0;t<r.length;++t)r[t]=[Math.abs(e[t]),t];r.sort(a);var n=new Array(r.length);for(t=0;t<n.length;++t)n[t]=r[t][1];return n}function s(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(a)()}if(0===e){a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",a)(l[t][0])}a=["'use strict'"];var s=r(e),c=s.map((function(t){return"i"+t})),h="this.offset+"+s.map((function(t){return"this.stride["+t+"]*i"+t})).join("+"),d=s.map((function(t){return"b"+t})).join(","),p=s.map((function(t){return"c"+t})).join(",");a.push("function "+n+"(a,"+d+","+p+",d){this.data=a","this.shape=["+d+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+s.map((function(t){return"this.shape["+t+"]"})).join("*"),"}})"),1===e?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),e<4?(a.push("function "+n+"_order(){"),2===e?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?a.push("return this.data.set("+h+",v)}"):a.push("return this.data["+h+"]=v}"),a.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?a.push("return this.data.get("+h+")}"):a.push("return this.data["+h+"]}"),a.push("proto.index=function "+n+"_index(",c.join(),"){return "+h+"}"),a.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+s.map((function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")})).join(",")+","+s.map((function(t){return"this.stride["+t+"]"})).join(",")+",this.offset)}");var u=s.map((function(t){return"a"+t+"=this.shape["+t+"]"})),m=s.map((function(t){return"c"+t+"=this.stride["+t+"]"}));a.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+u.join(",")+","+m.join(","));for(var f=0;f<e;++f)a.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");a.push("return new "+n+"(this.data,"+s.map((function(t){return"a"+t})).join(",")+","+s.map((function(t){return"c"+t})).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+s.map((function(t){return"a"+t+"=this.shape["+t+"]"})).join(",")+","+s.map((function(t){return"b"+t+"=this.stride["+t+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(f=0;f<e;++f)a.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");a.push("return new "+n+"(this.data,"+s.map((function(t){return"a"+t})).join(",")+","+s.map((function(t){return"b"+t})).join(",")+",c)}");var g=new Array(e),v=new Array(e);for(f=0;f<e;++f)g[f]="a[i"+f+"]",v[f]="b[i"+f+"]";a.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map((function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+v.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(f=0;f<e;++f)a.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this.stride["+f+"]*i"+f+")|0}else{a.push(this.shape["+f+"]);b.push(this.stride["+f+"])}");return a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map((function(t){return"shape["+t+"]"})).join(",")+","+s.map((function(t){return"stride["+t+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",a.join("\n"))(l[t],o)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(t,e,r,a){if(void 0===t)return(0,l.array[0])([]);"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var o=e.length;if(void 0===r){r=new Array(o);for(var c=o-1,h=1;c>=0;--c)r[c]=h,h*=e[c]}if(void 0===a){a=0;for(c=0;c<o;++c)r[c]<0&&(a-=(e[c]-1)*r[c])}for(var d=function(t){if(n(t))return"buffer";if(i)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(t)?"array":"generic"}(t),p=l[d];p.length<=o+1;)p.push(s(d,p.length-1));return(0,p[o+1])(t,e,r,a)}})),bc=sc(((t,e)=>{e.exports=function(t,e,r){return 0===t.length?t:e?(r||t.sort(e),function(t,e){for(var r=1,n=t.length,i=t[0],a=t[0],o=1;o<n;++o)if(a=i,e(i=t[o],a)){if(o===r){r++;continue}t[r++]=i}return t.length=r,t}(t,e)):(r||t.sort(),function(t){for(var e=1,r=t.length,n=t[0],i=t[0],a=1;a<r;++a,i=n)if(i=n,(n=t[a])!==i){if(a===e){e++;continue}t[e++]=n}return t.length=e,t}(t))}})),yc=sc(((t,e)=>{var r=bc();function n(t,e,r){var n,i,a=t.length,o=e.arrayArgs.length,s=e.indexArgs.length>0,l=[],c=[],h=0,d=0;for(n=0;n<a;++n)c.push(["i",n,"=0"].join(""));for(i=0;i<o;++i)for(n=0;n<a;++n)d=h,h=t[n],0===n?c.push(["d",i,"s",n,"=t",i,"p",h].join("")):c.push(["d",i,"s",n,"=(t",i,"p",h,"-s",d,"*t",i,"p",d,")"].join(""));for(c.length>0&&l.push("var "+c.join(",")),n=a-1;n>=0;--n)h=t[n],l.push(["for(i",n,"=0;i",n,"<s",h,";++i",n,"){"].join(""));for(l.push(r),n=0;n<a;++n){for(d=h,h=t[n],i=0;i<o;++i)l.push(["p",i,"+=d",i,"s",n].join(""));s&&(n>0&&l.push(["index[",d,"]-=s",d].join("")),l.push(["++index[",h,"]"].join(""))),l.push("}")}return l.join("\n")}function i(t,e,r){for(var n=t.body,i=[],a=[],o=0;o<t.args.length;++o){var s=t.args[o];if(!(s.count<=0)){var l=new RegExp(s.name,"g"),c="",h=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var d=e.offsetArgIndex.indexOf(o);h=e.offsetArgs[d].array,c="+q"+d;case"array":c="p"+h+c;var p="l"+o,u="a"+h;if(0===e.arrayBlockIndices[h])1===s.count?"generic"===r[h]?s.lvalue?(i.push(["var ",p,"=",u,".get(",c,")"].join("")),n=n.replace(l,p),a.push([u,".set(",c,",",p,")"].join(""))):n=n.replace(l,[u,".get(",c,")"].join("")):n=n.replace(l,[u,"[",c,"]"].join("")):"generic"===r[h]?(i.push(["var ",p,"=",u,".get(",c,")"].join("")),n=n.replace(l,p),s.lvalue&&a.push([u,".set(",c,",",p,")"].join(""))):(i.push(["var ",p,"=",u,"[",c,"]"].join("")),n=n.replace(l,p),s.lvalue&&a.push([u,"[",c,"]=",p].join("")));else{for(var m=[s.name],f=[c],g=0;g<Math.abs(e.arrayBlockIndices[h]);g++)m.push("\\s*\\[([^\\]]+)\\]"),f.push("$"+(g+1)+"*t"+h+"b"+g);if(l=new RegExp(m.join(""),"g"),c=f.join("+"),"generic"===r[h])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(l,[u,"[",c,"]"].join(""))}break;case"scalar":n=n.replace(l,"Y"+e.scalarArgs.indexOf(o));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape")}}}return[i.join("\n"),n,a.join("\n")].join("\n").trim()}function a(t){for(var e=new Array(t.length),r=!0,n=0;n<t.length;++n){var i=t[n],a=i.match(/\d+/);a=a?a[0]:"",0===i.charAt(0)?e[n]="u"+i.charAt(1)+a:e[n]=i.charAt(0)+a,n>0&&(r=r&&e[n]===e[n-1])}return r?e[0]:e.join("")}e.exports=function(t,e){for(var o=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,s=new Array(t.arrayArgs.length),l=new Array(t.arrayArgs.length),c=0;c<t.arrayArgs.length;++c)l[c]=e[2*c],s[c]=e[2*c+1];var h=[],d=[],p=[],u=[],m=[];for(c=0;c<t.arrayArgs.length;++c){t.arrayBlockIndices[c]<0?(p.push(0),u.push(o),h.push(o),d.push(o+t.arrayBlockIndices[c])):(p.push(t.arrayBlockIndices[c]),u.push(t.arrayBlockIndices[c]+o),h.push(0),d.push(t.arrayBlockIndices[c]));for(var f=[],g=0;g<s[c].length;g++)p[c]<=s[c][g]&&s[c][g]<u[c]&&f.push(s[c][g]-p[c]);m.push(f)}var v=["SS"],b=["'use strict'"],y=[];for(g=0;g<o;++g)y.push(["s",g,"=SS[",g,"]"].join(""));for(c=0;c<t.arrayArgs.length;++c){v.push("a"+c),v.push("t"+c),v.push("p"+c);for(g=0;g<o;++g)y.push(["t",c,"p",g,"=t",c,"[",p[c]+g,"]"].join(""));for(g=0;g<Math.abs(t.arrayBlockIndices[c]);++g)y.push(["t",c,"b",g,"=t",c,"[",h[c]+g,"]"].join(""))}for(c=0;c<t.scalarArgs.length;++c)v.push("Y"+c);if(t.shapeArgs.length>0&&y.push("shape=SS.slice(0)"),t.indexArgs.length>0){var x=new Array(o);for(c=0;c<o;++c)x[c]="0";y.push(["index=[",x.join(","),"]"].join(""))}for(c=0;c<t.offsetArgs.length;++c){var _=t.offsetArgs[c],w=[];for(g=0;g<_.offset.length;++g)0!==_.offset[g]&&(1===_.offset[g]?w.push(["t",_.array,"p",g].join("")):w.push([_.offset[g],"*t",_.array,"p",g].join("")));0===w.length?y.push("q"+c+"=0"):y.push(["q",c,"=",w.join("+")].join(""))}var S=r([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));for((y=y.concat(S)).length>0&&b.push("var "+y.join(",")),c=0;c<t.arrayArgs.length;++c)b.push("p"+c+"|=0");t.pre.body.length>3&&b.push(i(t.pre,t,l));var E=i(t.body,t,l),M=function(t){for(var e=0,r=t[0].length;e<r;){for(var n=1;n<t.length;++n)if(t[n][e]!==t[0][e])return e;++e}return e}(m);M<o?b.push(function(t,e,r,i){for(var a=e.length,o=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,c=[],h=0;h<o;++h)c.push(["var offset",h,"=p",h].join(""));for(h=t;h<a;++h)c.push(["for(var j"+h+"=SS[",e[h],"]|0;j",h,">0;){"].join("")),c.push(["if(j",h,"<",s,"){"].join("")),c.push(["s",e[h],"=j",h].join("")),c.push(["j",h,"=0"].join("")),c.push(["}else{s",e[h],"=",s].join("")),c.push(["j",h,"-=",s,"}"].join("")),l&&c.push(["index[",e[h],"]=j",h].join(""));for(h=0;h<o;++h){for(var d=["offset"+h],p=t;p<a;++p)d.push(["j",p,"*t",h,"p",e[p]].join(""));c.push(["p",h,"=(",d.join("+"),")"].join(""))}for(c.push(n(e,r,i)),h=t;h<a;++h)c.push("}");return c.join("\n")}(M,m[0],t,E)):b.push(n(m[0],t,E)),t.post.body.length>3&&b.push(i(t.post,t,l)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+b.join("\n")+"\n----------");var A=[t.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",M,a(l)].join("");return new Function(["function ",A,"(",v.join(","),"){",b.join("\n"),"} return ",A].join(""))()}})),xc=sc(((t,e)=>{var r=yc();e.exports=function(t){var e=["'use strict'","var CACHED={}"],n=[],i=t.funcName+"_cwise_thunk";e.push(["return function ",i,"(",t.shimArgs.join(","),"){"].join(""));for(var a=[],o=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],l=[],c=[],h=0;h<t.arrayArgs.length;++h){var d=t.arrayArgs[h];n.push(["t",d,"=array",d,".dtype,","r",d,"=array",d,".order"].join("")),a.push("t"+d),a.push("r"+d),o.push("t"+d),o.push("r"+d+".join()"),s.push("array"+d+".data"),s.push("array"+d+".stride"),s.push("array"+d+".offset|0"),h>0&&(l.push("array"+t.arrayArgs[0]+".shape.length===array"+d+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[h]))),c.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+d+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[h])+"]"))}for(t.arrayArgs.length>1&&(e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}")),h=0;h<t.scalarArgs.length;++h)s.push("scalar"+t.scalarArgs[h]);return n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------"),new Function("compile",e.join("\n"))(r.bind(void 0,t))}})),_c=sc(((t,e)=>{var r=xc();function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(t){var e=new n;e.pre=t.pre,e.body=t.body,e.post=t.post;var i=t.args.slice(0);e.argTypes=i;for(var a=0;a<i.length;++a){var o=i[a];if("array"===o||"object"==typeof o&&o.blockIndices){if(e.argTypes[a]="array",e.arrayArgs.push(a),e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),e.shimArgs.push("array"+a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array args");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)e.scalarArgs.push(a),e.shimArgs.push("scalar"+a);else if("index"===o){if(e.indexArgs.push(a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array index");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array index");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(e.shapeArgs.push(a),a<e.pre.args.length&&e.pre.args[a].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array shape");if(a<e.post.args.length&&e.post.args[a].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+i[a]);e.argTypes[a]="offset",e.offsetArgs.push({array:o.array,offset:o.offset}),e.offsetArgIndex.push(a)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>i.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>i.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>i.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,r(e)}})),wc=sc((t=>{var e=_c(),r={body:"",args:[],thisVars:[],localVars:[]};function n(t){if(!t)return r;for(var e=0;e<t.args.length;++e){var n=t.args[e];t.args[e]=0===e?{name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function i(t){for(var r=[],i=0;i<t.args.length;++i)r.push("a"+i);return new Function("P",["return function ",t.funcName,"_ndarrayops(",r.join(","),") {P(",r.join(","),");return a0}"].join(""))(function(t){return e({args:t.args,pre:n(t.pre),body:n(t.body),post:n(t.proc),funcName:t.funcName})}(t))}var a={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in a){var r=a[e];t[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:e}),t[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+r+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:e+"s"}),t[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+r+"=s"},rvalue:!0,funcName:e+"seq"})}}();var o={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in o){var r=o[e];t[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+r+"b"},funcName:e}),t[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+r+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var s={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in s){var r=s[e];t[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:e}),t[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:e+"s"}),t[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+r+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+r+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<l.length;++e){var r=l[e];t[r]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:r}),t[r+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"})}}();var c=["max","min","atan2","pow"];!function(){for(var e=0;e<c.length;++e){var r=c[e];t[r]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r}),t[r+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r+"s"}),t[r+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"}),t[r+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"seq"})}}();var h=["atan2","pow"];!function(){for(var e=0;e<h.length;++e){var r=h[e];t[r+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"op"}),t[r+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"ops"}),t[r+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opeq"}),t[r+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opseq"})}}(),t.any=e({args:["array"],pre:r,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=e({args:["array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=e({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=e({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=e({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=e({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=e({args:["array","array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})})),Sc=sc(((t,e)=>{e.exports=function(t,e){for(var r=t.split("."),n=e.split("."),i=0;i<3;i++){var a=Number(r[i]),o=Number(n[i]);if(a>o)return 1;if(o>a)return-1;if(!isNaN(a)&&isNaN(o))return 1;if(isNaN(a)&&!isNaN(o))return-1}return 0}}));function Ec(t,e){return Object.setPrototypeOf(t,e),t}function Mc(t){return Array.isArray(t)?t:[t]}var Ac="object"==typeof global&&global&&global.Object===Object&&global,Tc="object"==typeof self&&self&&self.Object===Object&&self,Pc=Ac||Tc||Function("return this")(),Cc=Pc.Symbol,kc=Object.prototype,Dc=kc.hasOwnProperty,Lc=kc.toString,Rc=Cc?Cc.toStringTag:void 0;var Oc=function(t){var e=Dc.call(t,Rc),r=t[Rc];try{t[Rc]=void 0;var n=!0}catch{}var i=Lc.call(t);return n&&(e?t[Rc]=r:delete t[Rc]),i},Ic=Object.prototype.toString;var Nc=function(t){return Ic.call(t)},zc=Cc?Cc.toStringTag:void 0;var Fc=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":zc&&zc in Object(t)?Oc(t):Nc(t)};var Uc=function(t){return null!=t&&"object"==typeof t};var Bc=function(t){return"symbol"==typeof t||Uc(t)&&"[object Symbol]"==Fc(t)};var Vc=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i},jc=Array.isArray,Gc=Cc?Cc.prototype:void 0,Hc=Gc?Gc.toString:void 0;var Wc=function t(e){if("string"==typeof e)return e;if(jc(e))return Vc(e,t)+"";if(Bc(e))return Hc?Hc.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r};var qc=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var $c=function(t){return t};var Xc,Yc=function(t){if(!qc(t))return!1;var e=Fc(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Zc=Pc["__core-js_shared__"],Kc=(Xc=/[^.]+$/.exec(Zc&&Zc.keys&&Zc.keys.IE_PROTO||""))?"Symbol(src)_1."+Xc:"";var Jc=function(t){return!!Kc&&Kc in t},Qc=Function.prototype.toString;var th=function(t){if(null!=t){try{return Qc.call(t)}catch{}try{return t+""}catch{}}return""},eh=/^\[object .+?Constructor\]$/,rh=Function.prototype,nh=Object.prototype,ih=rh.toString,ah=nh.hasOwnProperty,oh=RegExp("^"+ih.call(ah).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var sh=function(t){return!(!qc(t)||Jc(t))&&(Yc(t)?oh:eh).test(th(t))};var lh=function(t,e){return t?.[e]};var ch=function(t,e){var r=lh(t,e);return sh(r)?r:void 0},hh=ch(Pc,"WeakMap"),dh=Object.create,ph=function(){function t(){}return function(e){if(!qc(e))return{};if(dh)return dh(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),uh=ph;var mh=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)};var fh=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e},gh=Date.now;var vh=function(t){var e=0,r=0;return function(){var n=gh(),i=16-(n-r);if(r=n,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}};var bh=function(t){return function(){return t}},yh=function(){try{var t=ch(Object,"defineProperty");return t({},"",{}),t}catch{}}(),xh=yh,_h=xh?function(t,e){return xh(t,"toString",{configurable:!0,enumerable:!1,value:bh(e),writable:!0})}:$c,wh=vh(_h);var Sh=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},Eh=/^(?:0|[1-9]\d*)$/;var Mh=function(t,e){var r=typeof t;return!!(e=e??9007199254740991)&&("number"==r||"symbol"!=r&&Eh.test(t))&&t>-1&&t%1==0&&t<e};var Ah=function(t,e,r){"__proto__"==e&&xh?xh(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var Th=function(t,e){return t===e||t!=t&&e!=e},Ph=Object.prototype.hasOwnProperty;var Ch=function(t,e,r){var n=t[e];(!Ph.call(t,e)||!Th(n,r)||void 0===r&&!(e in t))&&Ah(t,e,r)};var kh=function(t,e,r,n){var i=!r;r||(r={});for(var a=-1,o=e.length;++a<o;){var s=e[a],l=n?n(r[s],t[s],s,r,t):void 0;void 0===l&&(l=t[s]),i?Ah(r,s,l):Ch(r,s,l)}return r},Dh=Math.max;var Lh=function(t,e,r){return e=Dh(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=Dh(n.length-e,0),o=Array(a);++i<a;)o[i]=n[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=n[i];return s[e]=r(o),mh(t,this,s)}};var Rh=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Oh=function(t){return null!=t&&Rh(t.length)&&!Yc(t)},Ih=Object.prototype;var Nh=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ih)};var zh=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Fh=function(t){return Uc(t)&&"[object Arguments]"==Fc(t)},Uh=Object.prototype,Bh=Uh.hasOwnProperty,Vh=Uh.propertyIsEnumerable,jh=Fh(function(){return arguments}())?Fh:function(t){return Uc(t)&&Bh.call(t,"callee")&&!Vh.call(t,"callee")},Gh=jh;var Hh=function(){return!1},Wh="object"==typeof exports&&exports&&!exports.nodeType&&exports,qh=Wh&&"object"==typeof module&&module&&!module.nodeType&&module,$h=qh&&qh.exports===Wh?Pc.Buffer:void 0,Xh=($h?$h.isBuffer:void 0)||Hh,Yh={};Yh["[object Float32Array]"]=Yh["[object Float64Array]"]=Yh["[object Int8Array]"]=Yh["[object Int16Array]"]=Yh["[object Int32Array]"]=Yh["[object Uint8Array]"]=Yh["[object Uint8ClampedArray]"]=Yh["[object Uint16Array]"]=Yh["[object Uint32Array]"]=!0,Yh["[object Arguments]"]=Yh["[object Array]"]=Yh["[object ArrayBuffer]"]=Yh["[object Boolean]"]=Yh["[object DataView]"]=Yh["[object Date]"]=Yh["[object Error]"]=Yh["[object Function]"]=Yh["[object Map]"]=Yh["[object Number]"]=Yh["[object Object]"]=Yh["[object RegExp]"]=Yh["[object Set]"]=Yh["[object String]"]=Yh["[object WeakMap]"]=!1;var Zh=function(t){return Uc(t)&&Rh(t.length)&&!!Yh[Fc(t)]};var Kh=function(t){return function(e){return t(e)}},Jh="object"==typeof exports&&exports&&!exports.nodeType&&exports,Qh=Jh&&"object"==typeof module&&module&&!module.nodeType&&module,td=Qh&&Qh.exports===Jh&&Ac.process,ed=function(){try{return Qh&&Qh.require&&Qh.require("util").types||td&&td.binding&&td.binding("util")}catch{}}(),rd=ed&&ed.isTypedArray,nd=rd?Kh(rd):Zh,id=Object.prototype.hasOwnProperty;var ad=function(t,e){var r=jc(t),n=!r&&Gh(t),i=!r&&!n&&Xh(t),a=!r&&!n&&!i&&nd(t),o=r||n||i||a,s=o?zh(t.length,String):[],l=s.length;for(var c in t)(e||id.call(t,c))&&(!o||!("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Mh(c,l)))&&s.push(c);return s};var od=function(t,e){return function(r){return t(e(r))}},sd=od(Object.keys,Object),ld=Object.prototype.hasOwnProperty;var cd=function(t){if(!Nh(t))return sd(t);var e=[];for(var r in Object(t))ld.call(t,r)&&"constructor"!=r&&e.push(r);return e};var hd=function(t){return Oh(t)?ad(t):cd(t)};var dd=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},pd=Object.prototype.hasOwnProperty;var ud=function(t){if(!qc(t))return dd(t);var e=Nh(t),r=[];for(var n in t)"constructor"==n&&(e||!pd.call(t,n))||r.push(n);return r};var md=function(t){return Oh(t)?ad(t,!0):ud(t)},fd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gd=/^\w*$/;var vd=function(t,e){if(jc(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Bc(t))||(gd.test(t)||!fd.test(t)||null!=e&&t in Object(e))},bd=ch(Object,"create");var yd=function(){this.__data__=bd?bd(null):{},this.size=0};var xd=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},_d=Object.prototype.hasOwnProperty;var wd=function(t){var e=this.__data__;if(bd){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return _d.call(e,t)?e[t]:void 0},Sd=Object.prototype.hasOwnProperty;var Ed=function(t){var e=this.__data__;return bd?void 0!==e[t]:Sd.call(e,t)};var Md=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=bd&&void 0===e?"__lodash_hash_undefined__":e,this};function Ad(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ad.prototype.clear=yd,Ad.prototype.delete=xd,Ad.prototype.get=wd,Ad.prototype.has=Ed,Ad.prototype.set=Md;var Td=Ad;var Pd=function(){this.__data__=[],this.size=0};var Cd=function(t,e){for(var r=t.length;r--;)if(Th(t[r][0],e))return r;return-1},kd=Array.prototype.splice;var Dd=function(t){var e=this.__data__,r=Cd(e,t);return!(r<0)&&(r==e.length-1?e.pop():kd.call(e,r,1),--this.size,!0)};var Ld=function(t){var e=this.__data__,r=Cd(e,t);return r<0?void 0:e[r][1]};var Rd=function(t){return Cd(this.__data__,t)>-1};var Od=function(t,e){var r=this.__data__,n=Cd(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Id(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Id.prototype.clear=Pd,Id.prototype.delete=Dd,Id.prototype.get=Ld,Id.prototype.has=Rd,Id.prototype.set=Od;var Nd=Id,zd=ch(Pc,"Map");var Fd=function(){this.size=0,this.__data__={hash:new Td,map:new(zd||Nd),string:new Td}};var Ud=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Bd=function(t,e){var r=t.__data__;return Ud(e)?r["string"==typeof e?"string":"hash"]:r.map};var Vd=function(t){var e=Bd(this,t).delete(t);return this.size-=e?1:0,e};var jd=function(t){return Bd(this,t).get(t)};var Gd=function(t){return Bd(this,t).has(t)};var Hd=function(t,e){var r=Bd(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Wd(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Wd.prototype.clear=Fd,Wd.prototype.delete=Vd,Wd.prototype.get=jd,Wd.prototype.has=Gd,Wd.prototype.set=Hd;var qd=Wd;function $d(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=t.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new($d.Cache||qd),r}$d.Cache=qd;var Xd=$d;var Yd=function(t){var e=Xd(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e},Zd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kd=/\\(\\)?/g,Jd=Yd((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Zd,(function(t,r,n,i){e.push(n?i.replace(Kd,"$1"):r||t)})),e})),Qd=Jd;var tp=function(t){return null==t?"":Wc(t)};var ep=function(t,e){return jc(t)?t:vd(t,e)?[t]:Qd(tp(t))};var rp=function(t){if("string"==typeof t||Bc(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var np=function(t,e){for(var r=0,n=(e=ep(e,t)).length;null!=t&&r<n;)t=t[rp(e[r++])];return r&&r==n?t:void 0};var ip=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t},ap=Cc?Cc.isConcatSpreadable:void 0;var op=function(t){return jc(t)||Gh(t)||!!(ap&&t&&t[ap])};var sp=function t(e,r,n,i,a){var o=-1,s=e.length;for(n||(n=op),a||(a=[]);++o<s;){var l=e[o];r>0&&n(l)?r>1?t(l,r-1,n,i,a):ip(a,l):i||(a[a.length]=l)}return a};var lp=function(t){return(null==t?0:t.length)?sp(t,1):[]};var cp=function(t){return wh(Lh(t,void 0,lp),t+"")},hp=od(Object.getPrototypeOf,Object),dp=Function.prototype,pp=Object.prototype,up=dp.toString,mp=pp.hasOwnProperty,fp=up.call(Object);var gp=function(t){if(!Uc(t)||"[object Object]"!=Fc(t))return!1;var e=hp(t);if(null===e)return!0;var r=mp.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&up.call(r)==fp};var vp=function(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(i);++n<i;)a[n]=t[n+e];return a};var bp=function(){this.__data__=new Nd,this.size=0};var yp=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var xp=function(t){return this.__data__.get(t)};var _p=function(t){return this.__data__.has(t)};var wp=function(t,e){var r=this.__data__;if(r instanceof Nd){var n=r.__data__;if(!zd||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new qd(n)}return r.set(t,e),this.size=r.size,this};function Sp(t){var e=this.__data__=new Nd(t);this.size=e.size}Sp.prototype.clear=bp,Sp.prototype.delete=yp,Sp.prototype.get=xp,Sp.prototype.has=_p,Sp.prototype.set=wp;var Ep=Sp;var Mp=function(t,e){return t&&kh(e,hd(e),t)};var Ap=function(t,e){return t&&kh(e,md(e),t)},Tp="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pp=Tp&&"object"==typeof module&&module&&!module.nodeType&&module,Cp=Pp&&Pp.exports===Tp?Pc.Buffer:void 0,kp=Cp?Cp.allocUnsafe:void 0;var Dp=function(t,e){if(e)return t.slice();var r=t.length,n=kp?kp(r):new t.constructor(r);return t.copy(n),n};var Lp=function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a};var Rp=function(){return[]},Op=Object.prototype.propertyIsEnumerable,Ip=Object.getOwnPropertySymbols,Np=Ip?function(t){return null==t?[]:(t=Object(t),Lp(Ip(t),(function(e){return Op.call(t,e)})))}:Rp,zp=Np;var Fp=function(t,e){return kh(t,zp(t),e)},Up=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ip(e,zp(t)),t=hp(t);return e}:Rp,Bp=Up;var Vp=function(t,e){return kh(t,Bp(t),e)};var jp=function(t,e,r){var n=e(t);return jc(t)?n:ip(n,r(t))};var Gp=function(t){return jp(t,hd,zp)};var Hp=function(t){return jp(t,md,Bp)},Wp=ch(Pc,"DataView"),qp=ch(Pc,"Promise"),$p=ch(Pc,"Set"),Xp="[object Map]",Yp="[object Promise]",Zp="[object Set]",Kp="[object WeakMap]",Jp="[object DataView]",Qp=th(Wp),tu=th(zd),eu=th(qp),ru=th($p),nu=th(hh),iu=Fc;(Wp&&iu(new Wp(new ArrayBuffer(1)))!=Jp||zd&&iu(new zd)!=Xp||qp&&iu(qp.resolve())!=Yp||$p&&iu(new $p)!=Zp||hh&&iu(new hh)!=Kp)&&(iu=function(t){var e=Fc(t),r="[object Object]"==e?t.constructor:void 0,n=r?th(r):"";if(n)switch(n){case Qp:return Jp;case tu:return Xp;case eu:return Yp;case ru:return Zp;case nu:return Kp}return e});var au=iu,ou=Object.prototype.hasOwnProperty;var su=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ou.call(t,"index")&&(r.index=t.index,r.input=t.input),r},lu=Pc.Uint8Array;var cu=function(t){var e=new t.constructor(t.byteLength);return new lu(e).set(new lu(t)),e};var hu=function(t,e){var r=e?cu(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},du=/\w*$/;var pu=function(t){var e=new t.constructor(t.source,du.exec(t));return e.lastIndex=t.lastIndex,e},uu=Cc?Cc.prototype:void 0,mu=uu?uu.valueOf:void 0;var fu=function(t){return mu?Object(mu.call(t)):{}};var gu=function(t,e){var r=e?cu(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var vu=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return cu(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return hu(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return gu(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return pu(t);case"[object Symbol]":return fu(t)}};var bu=function(t){return"function"!=typeof t.constructor||Nh(t)?{}:uh(hp(t))};var yu=function(t){return Uc(t)&&"[object Map]"==au(t)},xu=ed&&ed.isMap,_u=xu?Kh(xu):yu;var wu=function(t){return Uc(t)&&"[object Set]"==au(t)},Su=ed&&ed.isSet,Eu=Su?Kh(Su):wu,Mu="[object Arguments]",Au="[object Function]",Tu="[object Object]",Pu={};Pu[Mu]=Pu["[object Array]"]=Pu["[object ArrayBuffer]"]=Pu["[object DataView]"]=Pu["[object Boolean]"]=Pu["[object Date]"]=Pu["[object Float32Array]"]=Pu["[object Float64Array]"]=Pu["[object Int8Array]"]=Pu["[object Int16Array]"]=Pu["[object Int32Array]"]=Pu["[object Map]"]=Pu["[object Number]"]=Pu[Tu]=Pu["[object RegExp]"]=Pu["[object Set]"]=Pu["[object String]"]=Pu["[object Symbol]"]=Pu["[object Uint8Array]"]=Pu["[object Uint8ClampedArray]"]=Pu["[object Uint16Array]"]=Pu["[object Uint32Array]"]=!0,Pu["[object Error]"]=Pu[Au]=Pu["[object WeakMap]"]=!1;var Cu=function t(e,r,n,i,a,o){var s,l=1&r,c=2&r,h=4&r;if(n&&(s=a?n(e,i,a,o):n(e)),void 0!==s)return s;if(!qc(e))return e;var d=jc(e);if(d){if(s=su(e),!l)return fh(e,s)}else{var p=au(e),u=p==Au||"[object GeneratorFunction]"==p;if(Xh(e))return Dp(e,l);if(p==Tu||p==Mu||u&&!a){if(s=c||u?{}:bu(e),!l)return c?Vp(e,Ap(s,e)):Fp(e,Mp(s,e))}else{if(!Pu[p])return a?e:{};s=vu(e,p,l)}}o||(o=new Ep);var m=o.get(e);if(m)return m;o.set(e,s),Eu(e)?e.forEach((function(i){s.add(t(i,r,n,i,e,o))})):_u(e)&&e.forEach((function(i,a){s.set(a,t(i,r,n,a,e,o))}));var f=d?void 0:(h?c?Hp:Gp:c?md:hd)(e);return Sh(f||e,(function(i,a){f&&(i=e[a=i]),Ch(s,a,t(i,r,n,a,e,o))})),s};var ku=function(t){return Cu(t,5)};var Du=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var Lu=function(t){return this.__data__.has(t)};function Ru(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new qd;++e<r;)this.add(t[e])}Ru.prototype.add=Ru.prototype.push=Du,Ru.prototype.has=Lu;var Ou=Ru;var Iu=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var Nu=function(t,e){return t.has(e)};var zu=function(t,e,r,n,i,a){var o=1&r,s=t.length,l=e.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(t),h=a.get(e);if(c&&h)return c==e&&h==t;var d=-1,p=!0,u=2&r?new Ou:void 0;for(a.set(t,e),a.set(e,t);++d<s;){var m=t[d],f=e[d];if(n)var g=o?n(f,m,d,e,t,a):n(m,f,d,t,e,a);if(void 0!==g){if(g)continue;p=!1;break}if(u){if(!Iu(e,(function(t,e){if(!Nu(u,e)&&(m===t||i(m,t,r,n,a)))return u.push(e)}))){p=!1;break}}else if(m!==f&&!i(m,f,r,n,a)){p=!1;break}}return a.delete(t),a.delete(e),p};var Fu=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r};var Uu=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},Bu=Cc?Cc.prototype:void 0,Vu=Bu?Bu.valueOf:void 0;var ju=function(t,e,r,n,i,a,o){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new lu(t),new lu(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Th(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=Fu;case"[object Set]":var l=1&n;if(s||(s=Uu),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;n|=2,o.set(t,e);var h=zu(s(t),s(e),n,i,a,o);return o.delete(t),h;case"[object Symbol]":if(Vu)return Vu.call(t)==Vu.call(e)}return!1},Gu=Object.prototype.hasOwnProperty;var Hu=function(t,e,r,n,i,a){var o=1&r,s=Gp(t),l=s.length;if(l!=Gp(e).length&&!o)return!1;for(var c=l;c--;){var h=s[c];if(!(o?h in e:Gu.call(e,h)))return!1}var d=a.get(t),p=a.get(e);if(d&&p)return d==e&&p==t;var u=!0;a.set(t,e),a.set(e,t);for(var m=o;++c<l;){var f=t[h=s[c]],g=e[h];if(n)var v=o?n(g,f,h,e,t,a):n(f,g,h,t,e,a);if(!(void 0===v?f===g||i(f,g,r,n,a):v)){u=!1;break}m||(m="constructor"==h)}if(u&&!m){var b=t.constructor,y=e.constructor;b!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y)&&(u=!1)}return a.delete(t),a.delete(e),u},Wu="[object Arguments]",qu="[object Array]",$u="[object Object]",Xu=Object.prototype.hasOwnProperty;var Yu=function(t,e,r,n,i,a){var o=jc(t),s=jc(e),l=o?qu:au(t),c=s?qu:au(e),h=(l=l==Wu?$u:l)==$u,d=(c=c==Wu?$u:c)==$u,p=l==c;if(p&&Xh(t)){if(!Xh(e))return!1;o=!0,h=!1}if(p&&!h)return a||(a=new Ep),o||nd(t)?zu(t,e,r,n,i,a):ju(t,e,l,r,n,i,a);if(!(1&r)){var u=h&&Xu.call(t,"__wrapped__"),m=d&&Xu.call(e,"__wrapped__");if(u||m){var f=u?t.value():t,g=m?e.value():e;return a||(a=new Ep),i(f,g,r,n,a)}}return!!p&&(a||(a=new Ep),Hu(t,e,r,n,i,a))};var Zu=function t(e,r,n,i,a){return e===r||(null==e||null==r||!Uc(e)&&!Uc(r)?e!=e&&r!=r:Yu(e,r,n,i,t,a))};var Ku=function(t,e){return null!=t&&e in Object(t)};var Ju=function(t,e,r){for(var n=-1,i=(e=ep(e,t)).length,a=!1;++n<i;){var o=rp(e[n]);if(!(a=null!=t&&r(t,o)))break;t=t[o]}return a||++n!=i?a:!!(i=null==t?0:t.length)&&Rh(i)&&Mh(o,i)&&(jc(t)||Gh(t))};var Qu=function(t,e){return null!=t&&Ju(t,e,Ku)};var tm=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var em=function(t,e){return e.length<2?t:np(t,vp(e,0,-1))};var rm=function(t,e){return Zu(t,e)};var nm=function(t,e){return e=ep(e,t),null==(t=em(t,e))||delete t[rp(tm(e))]};var im=function(t){return gp(t)?void 0:t},am=cp((function(t,e){var r={};if(null==t)return r;var n=!1;e=Vc(e,(function(e){return e=ep(e,t),n||(n=e.length>1),e})),kh(t,Hp(t),r),n&&(r=Cu(r,7,im));for(var i=e.length;i--;)nm(r,e[i]);return r})),om=am;var sm=function(t,e,r,n){if(!qc(t))return t;for(var i=-1,a=(e=ep(e,t)).length,o=a-1,s=t;null!=s&&++i<a;){var l=rp(e[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=o){var h=s[l];void 0===(c=n?n(h,l,s):void 0)&&(c=qc(h)?h:Mh(e[i+1])?[]:{})}Ch(s,l,c),s=s[l]}return t};var lm=function(t,e,r){for(var n=-1,i=e.length,a={};++n<i;){var o=e[n],s=np(t,o);r(s,o)&&sm(a,ep(o,t),s)}return a};var cm=function(t,e){return lm(t,e,(function(e,r){return Qu(t,r)}))},hm=cp((function(t,e){return null==t?{}:cm(t,e)})),dm=hm,pm=class{modifyById(t,e){let r=this;if(void 0===r[t])throw new Error("not expected");{let n={...r,[t]:e};return Object.setPrototypeOf(n,pm.prototype),n}}add(t,e){return this.runOp({type:1,id:t,data:e})?.data??this}runOp(t){let e=this;if(1===t.type){let r,n=e[t.id];r=void 0===n?{type:2,id:t.id}:{type:1,id:t.id,data:n};let{id:i,data:a}=t,o={...e,[i]:a};return Object.setPrototypeOf(o,pm.prototype),{data:o,actual:t,reverse:r}}if(2===t.type){let{id:r}=t,n=e[r];if(void 0===n)return null;{let i={...e};return Object.setPrototypeOf(i,pm.prototype),delete i[r],{data:i,actual:t,reverse:{type:1,id:r,data:n}}}}return null}};function um(t){if(void 0!==t.deepFreeze)return void t.deepFreeze(t);let e=Object.getOwnPropertyNames(t);for(let r of e){let e=t[r];e&&"object"==typeof e&&um(e)}return Object.freeze(t)}var mm=class extends Error{};function fm(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function gm(t,e,r){if(void 0===t?void 0===e?(t=0,e=10):t=e-10:void 0===e&&(e=t+10),t>e){let r=t;t=e,e=r}let n=[],i=1/(r+1);for(let a=0;a<r;a++){let r=t+(e-t)*(a+.75+.5*Math.random())*i;n.push(r)}return n}function vm(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function bm(t,e){for(let r of t)!0!==e(r.id,r.data)&&bm(r.children,e)}function ym(t,e){if(!0!==e(t.id,t.data))for(let r of t.children)ym(r,e)}var xm,_m=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,_m.prototype)}deepFreeze(){let t=0;for(;t<this.length;)um(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let e of t.children)this.fillCaches0(e,t.id)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(0!==t.length)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let r=this.parent(t);if(r===e)return!0;t=r}return!1}rootAcestor(t){for(;t;){let e=this.parent(t);if(!e)return t;t=e}return t}isDescendantOf(t,e){for(;t;){let r=this.parent(t);if(r===e)return!0;t=r}return!1}data(t){return this.get(t)?.data}has(t){return void 0!==this.childrenOf(t)}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){return null===t?this:this.get(t)?.children}traverseFrom(t,e){if(null===t)this.traverse(e);else{let r=this.get(t);r&&ym(r,e)}}traverse(t){bm(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return null===t?this:this.get(t).children}modifyById(t,e){if(void 0===this.get(t))throw new Error("not expected");{let r=this.parent(t),n=this.childrenArray(r),i=n.findIndex((e=>e.id===t));if(i<0)throw new Error("not expected");let a=n[i];return n=[...n],n[i]={...a,data:e},this.modifyArrayBy(r,n)}}modifyArrayBy(t,e){let r=t,n=e;for(;null!==r;){let t=n,e=r;if(r=this.parent(r),void 0===r)throw new Error;n=this.childrenArray(r);let i=n.findIndex((t=>t.id===e));if(i<0)throw new Error;n=[...n],n[i]={...n[i],children:t}}Object.setPrototypeOf(n,_m.prototype);let i=n;return i.fillCaches(),i}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(void 0!==this.get(t))return!0;for(let t of e)if(this.checkDuplicatedIdRec(t))return!0;return!1}addOp(t){let{parent:e,fi:r,id:n,data:i,children:a}=t;if(null!==e&&void 0===this.get(e))return null;if(this.checkDuplicatedIdRec(t))return null;{let o=e,s=this.childrenArray(o),l={fi:r,id:n,data:i,children:a};return s=[...s,l],s.sort(((t,e)=>t.fi-e.fi)),t.localIndex=s.indexOf(l),{data:this.modifyArrayBy(o,s),actual:t,reverse:{type:8,id:n}}}}deleteOp(t){let{id:e}=t;if(null===this.get(e))return null;{let r=this.parent(e);if(void 0===r)return null;let n=this.childrenArray(r),i=n.findIndex((t=>t.id===e));t.localIndex=i,n=[...n];let a=n.splice(i,1)[0];return{data:this.modifyArrayBy(r,n),actual:t,reverse:{type:7,...a,parent:r}}}}moveOp(t){let{parent:e,fi:r,id:n}=t;if(null!==e&&void 0===this.get(e))return this.deleteOp({type:8,id:n});if(null!==e){let t=e;for(;null!==t;){if(void 0===t)throw new Error;if(t===n)throw new mm("cyclic tree");t=this.parent(t)}}let i=this.parent(n);if(void 0===i)return null;let a=i,o=this.childrenArray(i),s=o.findIndex((t=>t.id===n));o=[...o];let l=o.splice(s,1)[0],c=this.modifyArrayBy(i,o);i=e,o=c.childrenArray(i);let h=l.fi;return l={...l,fi:r},o=[...o,l],o.sort(((t,e)=>t.fi-e.fi)),t.localIndex=o.indexOf(l),c=c.modifyArrayBy(i,o),{data:c,actual:t,reverse:{type:9,parent:a,fi:h,id:n}}}previous(t,e){if(null===e){let e=this.childrenArray(t);return 0===e.length?null:e[e.length-1].id}let r=null;for(let n of this.childrenArray(t)){if(n.id===e)return r;r=n.id}return null}traverseSortNext(t){let e=this.parent(t);if(void 0!==e){let r=this.childrenArray(e),n=r.findIndex((e=>e.id===t))+1;if(n<r.length)return r[n].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(void 0!==e){let r=this.childrenArray(e),n=r.findIndex((e=>e.id===t))-1;return n>=0?this.traverseSortPrevious(r[n].id):e}}getAllSorted(t){let e=[];for(let r of t){let t=this.getWithSortKey(r.id);void 0!==t&&e.push({...r,...t})}e.sort(((t,e)=>function(t,e){let r=0;for(;r<t.length&&r<e.length;){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1;r+=1}return r!==e.length?-1:r!==t.length?1:0}(t.sortKey,e.sortKey)));for(let t of e)delete t.sortKey;return e}getWithSortKey(t){var e=t;let r=[],n=this.get(e),i=n;if(void 0!==n){for(;e;)r.splice(0,0,n.fi),null!==(e=this.parent(e))&&(n=this.get(e));return{...i,sortKey:r}}}insertBeforeHelper(t,e,r){return this.insertAfterHelper(t,this.previous(t,e),r)}insertAfterHelper(t,e,r){let n=this.childrenArray(t);if(null===e){if(0===n.length)return gm(0,r,r);{let t=n[0].fi;return gm(t-r,t,r)}}{let i=this.get(e);if(void 0===i||this.parent(e)!==t)throw new Error("illegal args");let a=n.find((t=>t.fi>i.fi));if(void 0===a){let t=n[n.length-1].fi;return gm(t,t+r,r)}return gm(i.fi,a.fi,r)}}};(xm||(xm={})).runOp=function(t,e){if(0!==e.type)return null;if(Array.isArray(t)){let r=e.props,n={},i=[...t],a=!1;if(r)for(let t of Object.keys(r)){let e=parseInt(t);if(isNaN(e))throw new Error("wrong index");n[t]=i[e],i[e]=r[t],a=!0}return a?{data:i,actual:e,reverse:{type:0,props:n}}:null}{let r=e.props,n={},i={...t},a=!1;if(r)for(let t of Object.keys(r)){n[t]=i[t];let e=r[t];void 0===e?delete i[t]:i[t]=e,a=!0}return a?{data:i,actual:e,reverse:{type:0,props:n}}:null}};var wm=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,wm.prototype)}deepFreeze(){let t=0;for(;t<this.length;)um(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(0!==t.length)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){return this.get(t)?.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(void 0===this.get(t))throw new Error("not expected");{let r=this,n=r.findIndex((e=>e.id===t));if(n<0)throw new Error("not expected");let i=r[n];return r=[...r],r[n]={...i,data:e},this.modifyArrayBy(r)}}modifyArrayBy(t){Object.setPrototypeOf(t,wm.prototype);let e=t;return typeof process<"u"||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:r,data:n}=t,i=this,a={fi:e,id:r,data:n};return i=[...i,a],i.sort(((t,e)=>t.fi-e.fi)),t.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:t,reverse:{type:5,id:r}}}deleteOp(t){let{id:e}=t,r=this,n=r.findIndex((t=>t.id===e));if(-1===n)return null;t.localIndex=n,r=[...r];let i=r.splice(n,1)[0];return{data:this.modifyArrayBy(r),actual:t,reverse:{type:4,...i}}}moveOp(t){let{fi:e,id:r}=t,n=this;n=[...n];let i=n.findIndex((t=>t.id===r));if(-1===i)return null;let a=n[i].fi,o={...n[i],fi:e};return n[i]=o,n.sort(((t,e)=>t.fi-e.fi)),t.localIndex=n.indexOf(o),{data:this.modifyArrayBy(n),actual:t,reverse:{type:6,fi:a,id:r}}}previous(t){if(null===t)return 0===this.length?null:this[this.length-1].id;let e=null;for(let r of this){if(r.id===t)return e;e=r.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let r=this;if(null===t){if(0===r.length)return gm(0,e,e);{let t=r[0].fi;return gm(t-e,t,e)}}{let n=this.get(t);if(void 0===n)throw new Error("illegal args");let i=r.find((t=>t.fi>n.fi));if(void 0===i){let t=r[r.length-1].fi;return gm(t,t+e,e)}return gm(n.fi,i.fi,e)}}};function Sm(t){return t&&"object"==typeof t&&t instanceof Cm}var Em,Mm,Am,Tm,Pm,Cm=class{unusedFunOverridesTable(t){}runOp(t){let e=[],r=this,n=0,i={};for(;n<t.path.length;){if(e.push(r),r=void 0===r?void 0:r[t.path[n]],void 0!==r&&!Sm(r))return null;n+=1}r=r?fm(r):new Cm;for(let[e,n]of Object.entries(t.props)){let t=r[e];i[e]=t,void 0===n?delete r[e]:r[e]=n}for(;n>0;){if(0===Object.keys(r).length){let i=e[n-1];i&&(r=fm(i),delete r[t.path[n-1]])}else{let i=e[n-1];if(i){let e=fm(i);e[t.path[n-1]]=r,r=e}else{let e=new Cm;e[t.path[n-1]]=r,r=e}}n-=1}return{data:Object.setPrototypeOf(r,Cm.prototype),actual:t,reverse:{...t,props:i}}}};function km(t,e){if(void 0===e)return;let r=!1,n=t.map((t=>{let n=t.id,i=Dm(t.data,e[n]);if(r=r||void 0!==i,void 0===i&&(i=t.data),t.children){let a=km(t.children,e);return void 0!==a?r=!0:a=t.children,{...t,id:n,data:i,children:a}}return{...t,id:n,data:i}}));return r?n:void 0}function Dm(t,e){if(!Sm(e))return e;if(t instanceof _m){let r=km(t,e);return void 0!==r&&Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}if(t instanceof wm)return function(t,e){if(void 0===e)return;let r=!1,n=t.map((t=>{let n=t.id,i=Dm(t.data,e[n]);return r=r||void 0!==i,void 0===i&&(i=t.data),{...t,id:n,data:i}}));return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}(t,e);if(Array.isArray(t)){let r=!1,n=t.map(((t,n)=>{let i=Dm(t,e[n]);return r=r||void 0!==i,void 0===i&&(i=t),i}));return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}if(t instanceof Cm)return Lm(t,e);if(t&&"object"==typeof t){let r={},n=!1;for(let[i,a]of Object.entries(t)){let t=Dm(a,e[i]);n=n||void 0!==t,void 0===t&&(t=a),r[i]=t}return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}}function Lm(t,e){if(void 0===t)return e;if(void 0===e)return t;if(!Sm(e))return e;if(!Sm(t))return Em.apply(t,e);let r=new Set;for(let e of Object.keys(t))r.add(e);for(let t of Object.keys(e))r.add(t);let n=new Cm;for(let i of r){let r=Lm(void 0===t?void 0:t[i],void 0===e?void 0:e[i]);n[i]=r}return n}function Rm(t,e){let r={cur:[],result:[],len:0};return[t=zm(t,e,r)??t,r.result]}function Om(t,e){return null===t?null:(t.cur[t.len]=e,t.len+=1,t)}function Im(t){t&&(t.len-=1)}function Nm(t,e,r){let n=!1,i=t.map((t=>{let i=t.id,a=e[i];if(void 0!==a&&"string"==typeof a&&(n=!0,i=a,null!==r))throw new Error("not supported");let o=zm(t.data,e,Om(r,i));Im(r),n=n||void 0!==o,void 0===o&&(o=t.data);let s=Nm(t.children,e,r);return void 0!==s?n=!0:s=t.children,{...t,id:i,data:o,children:s}}));if(n)return i}function zm(t,e,r){if(t instanceof _m){let n=Nm(t,e,r);return void 0!==n&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}if(t instanceof wm)return function(t,e,r){let n=!1,i=t.map((t=>{let i=t.id,a=e[i];if(void 0!==a&&"string"==typeof a&&(n=!0,i=a,null!==r))throw new Error("not supported");let o=zm(t.data,e,Om(r,i));return Im(r),n=n||void 0!==o,void 0===o&&(o=t.data),{...t,id:i,data:o}}));if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}(t,e,r);if(Array.isArray(t)){let n=!1,i=t.map(((t,i)=>{let a=zm(t,e,Om(r,i));return Im(r),n=n||void 0!==a,void 0===a&&(a=t),a}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}if(t&&"object"==typeof t&&!vm(t)){let n={},i=!1;for(let[a,o]of Object.entries(t))if("name"!==a){let t=e[a];if("string"==typeof t){if(null!==r)throw new Error("not supported");i=!0,a=t}let s=zm(o,e,Om(r,a));Im(r),i=i||void 0!==s,void 0===s&&(s=o),n[a]=s}else n[a]=o;return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}if("string"==typeof t){let n=e[t];return void 0!==n&&function(t){if(null===t)return null;t.result.push(t.cur.slice(0,t.len))}(r),n}}(Mm=Em||(Em={})).apply=function(t,e){return Dm(t,e)??t},Mm.merge=function(t,e){return Lm(t,e)},Mm.filterOp=function(t,e){let r=0,n=e.path,i=t;for(;r<n.length&&void 0!==i;){if(i=Zm.zoomOnce(i,n[r]),void 0===i)return e;if(!Sm(i))return;r+=1}if(void 0===i)return e;if(Sm(i)){if(0===e.type){let t={...e.props};for(let e of Object.keys(i))delete t[e];return{...e,props:t}}if(1===e.type||4===e.type||7===e.type){let t=km([e],i);return t?(console.log(t),t):e}return e}},(t=>{t.replaceProps=function(t,e){let r=Zm.zoom(e,t.path);if("object"==typeof r){let e={};for(let n of Object.keys(t.props))e[n]=r[n];return{...t,props:e}}return{...t,props:{}}}})(Am||(Am={})),(t=>{function e(t,e){let r=e.path;for(var n=[];;){let i;if(t instanceof Cm&&0===e.type&&(i=t.runOp({...e,path:r.slice(n.length)}),null===i&&(i=void 0)),void 0===i&&n.length===r.length&&(i=t instanceof _m||t instanceof wm||t instanceof pm?t.runOp(e):xm.runOp(t,e)),void 0!==i){if(null!==i){let t=i.data;for(let e=n.length-1;e>=0;e--){let i=r[e],a=n[e];if(a instanceof _m){if("number"==typeof i)throw new Error("illegal arg");t=a.modifyById(i,t)}else if(a instanceof wm){if("number"==typeof i)throw new Error("illegal arg");t=a.modifyById(i,t)}else if(a instanceof pm){if("number"==typeof i)throw new Error("illegal arg");t=a.modifyById(i,t)}else if(a instanceof Cm){let e={...a,[i]:t};t=Object.setPrototypeOf(e,Cm.prototype)}else{if("object"!=typeof a)return null;if(Array.isArray(a)){if("string"==typeof i&&(i=parseInt(i),isNaN(i)))throw new Error("Invalid path");let e=t;t=[...a],t[i]=e}else t={...a,[i]:t}}}return{data:t,actual:{...i.actual,path:r},reverse:{...i.reverse,path:r}}}return null}let a,o=r[n.length];if(t instanceof _m){if("number"==typeof o)throw new Error("");a=t.get(o)?.data}else if(t instanceof wm){if("number"==typeof o)throw new Error("");a=t.get(o)?.data}else null!==t&&(a=t[o]);if(void 0===a)return null;n.push(t),t=a}}function r(t,e){for(let r=0;r<t.length&&r<e.length;r++)if(t[r]!==e[r])return!0;return!1}function n(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}t.drop=function(t,e){return{...t,path:t.path.slice(e)}},t.applySimple=function(t,r){return e(t,r)?.data??t},t.apply=e,t.pathDisjoint=r,t.pathEq=n,t.commutative=function(t,e){return r(t.path,e.path)},t.subsumed=function(t,e){return!(0!==t.type||0!==e.type||!n(t.path,e.path))&&Object.keys(t.props).every((t=>void 0!==e.props[t]))}})(Tm||(Tm={})),(t=>{function e(t,e){var r=t;let n=[],i=[];for(let t of e)try{if(3===t.type||5===t.type&&"variables"===t.path[t.path.length-1]){let e,a,o;if(3===t.type?(e=Zm.zoom(r,[...t.path,t.id]),o=Tm.apply(r,{...t,type:2})):(e=Zm.zoom(r,[...t.path,t.id,"value"]),o=Tm.apply(r,t)),null!==o){r=o.data;let[s,l]=Rm(r,{[t.id]:e});r=s;for(let o=0;o<l.length;o++){let s=l[o],c=s.pop();if("number"==typeof c){let n=[c];for(let t=o+1;t<l.length;t++){let e=l[t],r=e[e.length-1];if("number"!=typeof r||!Zm.equal(s,e.slice(0,e.length-1)))break;n.push(r),l.splice(t,1)}let i=Zm.zoom(r,s);a=i.map(((e,r)=>n.includes(r)?t.id:e)),e=i,c=s.pop()}else{if("alphaOverride"===c||"alpha"===c){e/=100;let t=e,n=Zm.zoom(r,s.slice(0,s.length-2)),i=n.layers.map((e=>e.id===s[s.length-1]?{...e,data:{...e.data,[c]:t}}:e));Object.setPrototypeOf(i,Object.getPrototypeOf(n.layers)),n.layers=i}a=t.id}n.push({type:0,path:s,props:{[c]:e}}),i.push({type:0,path:s,props:{[c]:a}})}i.push(o.reverse),n.push(o.actual)}}else{let e=Tm.apply(r,t);null!==e&&(n.push(e.actual),r=e.data,i.push(e.reverse))}}catch(t){if(t instanceof mm)return null;throw t}return{data:r,actual:n,reverse:i.reverse()}}t.empty=function(){return[]},t.removePrefix=function(t,e){let r=[];for(let n of t){let[t,...i]=n.path;t===e&&r.push({...n,path:i})}return r},t.addPrefix=function(t,e){return t.map((t=>({...t,path:[e,...t.path]})))},t.concat=function(t,e){return[...t,...e]},t.compress=function(t,e){return[...t.filter((t=>!e.some((e=>Tm.subsumed(t,e))))),...e]},t.commutative=function(t,e){return t.every((t=>e.every((e=>Tm.commutative(t,e)))))},t.applyAll=function(t,r){for(let n of r){let r=e(t,n);null!==r&&(t=r.data)}return t},t.apply=e})(Pm||(Pm={}));var Fm=Symbol(),Um=Symbol(),Bm=Symbol(),Vm=class{reportOp(t,e,r=[]){let n=this;if(null===e)return;n._current=e.data;let i=r;for(;!(n instanceof Km);){let t=n._path,e=n._current;if(""!==t&&i.splice(0,0,t),n=n._parent,null===n)return;n.update(t,e)}n.push(i,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let r=e[Bm];r&&r(),delete this._children[t]}}}},jm=class extends Vm{constructor(t,e,r){super(),this._parent=t,this._path=e,this._current=r}update(t,e){if(Array.isArray(this._current)){if("string"==typeof t&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,xm.runOp(this._current,t),t.path)}},Gm=class extends Vm{constructor(t,e,r){super(),this._parent=t,this._path=e,this._current=r}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,pm.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},Hm={get(t,e){if(e===Bm)return()=>{t._parent=null};if(e===Fm)return t._current;if(e===Um)return t;let{_current:r,_children:n}=t;if("push"===e&&Array.isArray(r))throw new Error("not supported to expand array");let i=void 0===n?void 0:n[e];if(void 0!==i)return i;let a=r[e],o=Jm(t,e,a);return o!==a?(void 0===n&&(n={},t._children=n),n[e]=o,o):a},has:(t,e)=>e in t._current,ownKeys:t=>Reflect.ownKeys(t._current),defineProperty(){throw Error("not supported")},getPrototypeOf:t=>Object.getPrototypeOf(t._current),setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let r=t._current,n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:r[e]}}},Wm={...Hm,set(t,e,r){let n={type:0,props:{[e]:ef(r)??r}};return t.deleteChildren(e),t.runOp(n),!0},deleteProperty(t,e){let r={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(r),!0}},qm={...Hm,set(t,e,r){return void 0===r?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:r})),!0},deleteProperty:(t,e)=>(t.runOp({type:2,id:e}),!0)},$m=class extends Vm{constructor(t,e,r){super(),this._children={},this._parent=t,this._path=e,this._current=r,this[Bm]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse(((e,r)=>{t(e,this.data(e))}))}data(t){let{_current:e,_children:r}=this,n=void 0===r?void 0:r[t];if(void 0!==n)return n;let i=e.get(t)?.data,a=Jm(this,t,i);return a!==i?(void 0===r&&(r={},this._children=r),r[t]=a,a):i}add(t,e,r,n,i){this.runOp({type:7,parent:t,fi:e,id:r,data:n,children:i})}move(t,e,r){this.runOp({type:9,parent:t,fi:e,id:r})}insertAfter(t,e,r){let n=this._current.insertAfterHelper(t,e,r.length);for(let e=0;e<r.length;e++){let i=r[e];this.add(t,n[e],i.id,i.data,i.children)}}insertBefore(t,e,r){let n=this._current.insertBeforeHelper(t,e,r.length);for(let e=0;e<r.length;e++){let i=r[e];this.add(t,n[e],i.id,i.data,i.children)}}moveAfter(t,e,r){let n=this._current.insertAfterHelper(t,e,r.length);for(let e=0;e<r.length;e++){let i=r[e];this.move(t,n[e],i)}}moveBefore(t,e,r){let n=this._current.insertBeforeHelper(t,e,r.length);for(let e=0;e<r.length;e++){let i=r[e];this.move(t,n[e],i)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},Xm=class extends Vm{constructor(t,e,r){super(),this._children={},this._parent=t,this._path=e,this._current=r,this[Bm]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let r=0;r<e;r++){let e=this._current[r].id,n=this._current[r].fi;t(this.data(this._current[r].id),e,n)}}find(t){let e=this.length;for(let r=0;r<e;r++){let e=this._current[r].id;if(t(this.data(e),e))return this.get(e)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){let{_current:e,_children:r}=this,n=void 0===r?void 0:r[t];if(void 0!==n)return n;let i=e.get(t)?.data,a=Jm(this,t,i);return a!==i?(void 0===r&&(r={},this._children=r),r[t]=a,a):i}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,r){this.runOp({type:4,fi:t,id:e,data:r})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let r=this._current.insertAfterHelper(t,e.length);for(let t=0;t<e.length;t++){let n=e[t];this.add(r[t],n.id,n.data)}}insertBefore(t,e){let r=this._current.insertBeforeHelper(t,e.length);for(let t=0;t<e.length;t++){let n=e[t];this.add(r[t],n.id,n.data)}}moveAfter(t,e){let r=this._current.insertAfterHelper(t,e.length);for(let t=0;t<e.length;t++){let n=e[t];this.move(r[t],n)}}moveBefore(t,e){let r=this._current.insertBeforeHelper(t,e.length);for(let t=0;t<e.length;t++){let n=e[t];this.move(r[t],n)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function Ym(t,e,r){if(t.length>0){let n=t[t.length-1];if(0===n.type&&0===e.type&&Zm.equal(n.path,r))return void Object.assign(n.props,e.props)}t.push({...e,path:r})}var Zm,Km=class extends Vm{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(""!==t)throw new Error("");this._current=e}push(t,e,r,n){Ym(this.ts,e,t),Ym(this.actual,r,t),Ym(this.reverse,n,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Jm(t,e,r){return r instanceof _m?new $m(t,e,r):r instanceof wm?new Xm(t,e,r):r instanceof pm?new Proxy(new Gm(t,e,r),qm):null!==r&&"object"==typeof r?vm(r)?r:new Proxy(new jm(t,e,r),Wm):r}function Qm(t){let e=new Km(t);return[Jm(e,"",t),e]}function tf(t,e){let[r,n]=Qm(t);return e(r),n.result()}function ef(t){return t instanceof $m||t instanceof Xm?t._current:null!==t&&"object"==typeof t?t[Fm]:t}function rf(t,e){let r=[];if(!(e.length<=t.length))return null;for(var n=0;n<e.length;){if("*"===e[n])r.push(t[n]);else if(t[n]!==e[n])return null;n+=1}return r}(t=>{function e(t,e){return(t instanceof _m||t instanceof $m)&&"string"==typeof e||(t instanceof wm||t instanceof Xm)&&"string"==typeof e?t.data(e):"number"==typeof e&&Array.isArray(t)||"string"==typeof e&&"object"==typeof t&&null!==t?t[e]:void 0}function r(t,r,n=0){for(;n<r.length&&void 0!==t;)t=e(t,r[n]),n+=1;return t}t.equal=function(t,e){if(e.length!==t.length)return!1;for(var r=0;r<t.length;){if(t[r]!==e[r])return!1;r+=1}return!0},t.removeOverridden=function(t,e,n){let i=r(n,t);if(void 0!==i&&"object"==typeof i&&null!==i){let t={...e};return Object.keys(i).forEach((e=>{delete t[e]})),t}return e},t.zoomOnce=e,t.zoom=r})(Zm||(Zm={}));var nf,af=class{},of=class extends af{constructor(t){super(),this.id=t}},sf=class extends af{constructor(t){super(),this.data=t}};try{nf=new TextDecoder}catch{}var lf,cf,hf,df,pf,uf,mf,ff=0,gf=[],vf=gf,bf=0,yf={},xf=0,_f=0,wf=[],Sf={useRecords:!1,mapsAsObjects:!0},Ef=class{},Mf=new Ef;Mf.name="MessagePack 0xC1";var Af=!1,Tf=class{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(lf)return Jf((()=>(Qf(),this?this.unpack(t,e):Tf.prototype.unpack.call(Sf,t,e))));cf=e>-1?e:t.length,ff=0,bf=0,_f=0,df=null,vf=gf,pf=null,lf=t;try{mf=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){throw lf=null,t instanceof Uint8Array?e:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof Tf){if(yf=this,this.structures)return hf=this.structures,Pf();(!hf||hf.length>0)&&(hf=[])}else yf=Sf,(!hf||hf.length>0)&&(hf=[]);return Pf()}unpackMultiple(t,e){let r,n=0;try{Af=!0;let i=t.length,a=this?this.unpack(t,i):rg.unpack(t,i);if(!e){for(r=[a];ff<i;)n=ff,r.push(Pf());return r}for(e(a);ff<i;)if(n=ff,!1===e(Pf()))return}catch(t){throw t.lastPosition=n,t.values=r,t}finally{Af=!1,Qf()}}_mergeStructures(t,e){for(let e=0,r=(t=t||[]).length;e<r;e++){let r=t[e];r&&(r.isShared=!0,e>=32&&(r.highByte=e-32>>5))}t.sharedLength=t.length;for(let r in e||[])if(r>=0){let n=t[r],i=e[r];i&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[r]=n),t[r]=i)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function Pf(){try{if(!yf.trusted&&!Af){let t=hf.sharedLength||0;t<hf.length&&(hf.length=t)}let t=kf();if(ff==cf)hf.restoreStructures&&Cf(),hf=null,lf=null,uf&&(uf=null);else{if(ff>cf){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}if(!Af)throw new Error("Data read, but end of buffer not reached")}return t}catch(t){throw hf.restoreStructures&&Cf(),Qf(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function Cf(){for(let t in hf.restoreStructures)hf[t]=hf.restoreStructures[t];hf.restoreStructures=null}function kf(){let t=lf[ff++];if(t<160){if(t<128){if(t<64)return t;{let e=hf[63&t]||yf.getStructures&&Of()[63&t];return e?(e.read||(e.read=Lf(e,63&t)),e.read()):t}}if(t<144){if(t-=128,yf.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[Xf()]=kf();return e}{let e=new Map;for(let r=0;r<t;r++)e.set(kf(),kf());return e}}{t-=144;let e=new Array(t);for(let r=0;r<t;r++)e[r]=kf();return e}}if(t<192){let e=t-160;if(_f>=ff)return df.slice(ff-xf,(ff+=e)-xf);if(0==_f&&cf<140){let t=e<16?Hf(e):Gf(e);if(null!=t)return t}return If(e)}{let e;switch(t){case 192:return null;case 193:return pf?(e=kf(),e>0?pf[1].slice(pf.position1,pf.position1+=e):pf[0].slice(pf.position0,pf.position0-=e)):Mf;case 194:return!1;case 195:return!0;case 196:return Wf(lf[ff++]);case 197:return e=mf.getUint16(ff),ff+=2,Wf(e);case 198:return e=mf.getUint32(ff),ff+=4,Wf(e);case 199:return qf(lf[ff++]);case 200:return e=mf.getUint16(ff),ff+=2,qf(e);case 201:return e=mf.getUint32(ff),ff+=4,qf(e);case 202:if(e=mf.getFloat32(ff),yf.useFloat32>2){let t=tg[(127&lf[ff])<<1|lf[ff+1]>>7];return ff+=4,(t*e+(e>0?.5:-.5)>>0)/t}return ff+=4,e;case 203:return e=mf.getFloat64(ff),ff+=8,e;case 204:return lf[ff++];case 205:return e=mf.getUint16(ff),ff+=2,e;case 206:return e=mf.getUint32(ff),ff+=4,e;case 207:return yf.int64AsNumber?(e=4294967296*mf.getUint32(ff),e+=mf.getUint32(ff+4)):e=mf.getBigUint64(ff),ff+=8,e;case 208:return mf.getInt8(ff++);case 209:return e=mf.getInt16(ff),ff+=2,e;case 210:return e=mf.getInt32(ff),ff+=4,e;case 211:return yf.int64AsNumber?(e=4294967296*mf.getInt32(ff),e+=mf.getUint32(ff+4)):e=mf.getBigInt64(ff),ff+=8,e;case 212:if(e=lf[ff++],114==e)return Yf(63&lf[ff++]);{let t=wf[e];if(t)return t.read?(ff++,t.read(kf())):t.noBuffer?(ff++,t()):t(lf.subarray(ff,++ff));throw new Error("Unknown extension "+e)}case 213:return e=lf[ff],114==e?(ff++,Yf(63&lf[ff++],lf[ff++])):qf(2);case 214:return qf(4);case 215:return qf(8);case 216:return qf(16);case 217:return e=lf[ff++],_f>=ff?df.slice(ff-xf,(ff+=e)-xf):Nf(e);case 218:return e=mf.getUint16(ff),_f>=(ff+=2)?df.slice(ff-xf,(ff+=e)-xf):zf(e);case 219:return e=mf.getUint32(ff),_f>=(ff+=4)?df.slice(ff-xf,(ff+=e)-xf):Ff(e);case 220:return e=mf.getUint16(ff),ff+=2,Bf(e);case 221:return e=mf.getUint32(ff),ff+=4,Bf(e);case 222:return e=mf.getUint16(ff),ff+=2,Vf(e);case 223:return e=mf.getUint32(ff),ff+=4,Vf(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}var Df=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Lf(t,e){function r(){if(r.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map((t=>Df.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"}}")(kf);return 0===t.highByte&&(t.read=Rf(e,t.read)),r()}let n={};for(let e=0,r=t.length;e<r;e++){n[t[e]]=kf()}return n}return r.count=0,0===t.highByte?Rf(e,r):r}var Rf=(t,e)=>function(){let r=lf[ff++];if(0===r)return e();let n=t<32?-(t+(r<<5)):t+(r<<5),i=hf[n]||Of()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=Lf(i,t)),i.read()};function Of(){let t=Jf((()=>(lf=null,yf.getStructures())));return hf=yf._mergeStructures(t,hf)}var If=Uf,Nf=Uf,zf=Uf,Ff=Uf;function Uf(t){let e;if(t<16&&(e=Hf(t)))return e;if(t>64&&nf)return nf.decode(lf.subarray(ff,ff+=t));let r=ff+t,n=[];for(e="";ff<r;){let t=lf[ff++];if(0==(128&t))n.push(t);else if(192==(224&t)){let e=63&lf[ff++];n.push((31&t)<<6|e)}else if(224==(240&t)){let e=63&lf[ff++],r=63&lf[ff++];n.push((31&t)<<12|e<<6|r)}else if(240==(248&t)){let e=(7&t)<<18|(63&lf[ff++])<<12|(63&lf[ff++])<<6|63&lf[ff++];e>65535&&(e-=65536,n.push(e>>>10&1023|55296),e=56320|1023&e),n.push(e)}else n.push(t);n.length>=4096&&(e+=jf.apply(String,n),n.length=0)}return n.length>0&&(e+=jf.apply(String,n)),e}function Bf(t){let e=new Array(t);for(let r=0;r<t;r++)e[r]=kf();return e}function Vf(t){if(yf.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[Xf()]=kf();return e}{let e=new Map;for(let r=0;r<t;r++)e.set(kf(),kf());return e}}var jf=String.fromCharCode;function Gf(t){let e=ff,r=new Array(t);for(let n=0;n<t;n++){let t=lf[ff++];if((128&t)>0)return void(ff=e);r[n]=t}return jf.apply(String,r)}function Hf(t){if(t<4){if(t<2){if(0===t)return"";{let t=lf[ff++];return(128&t)>1?void(ff-=1):jf(t)}}{let e=lf[ff++],r=lf[ff++];if((128&e)>0||(128&r)>0)return void(ff-=2);if(t<3)return jf(e,r);let n=lf[ff++];return(128&n)>0?void(ff-=3):jf(e,r,n)}}{let e=lf[ff++],r=lf[ff++],n=lf[ff++],i=lf[ff++];if((128&e)>0||(128&r)>0||(128&n)>0||(128&i)>0)return void(ff-=4);if(t<6){if(4===t)return jf(e,r,n,i);{let t=lf[ff++];return(128&t)>0?void(ff-=5):jf(e,r,n,i,t)}}if(t<8){let a=lf[ff++],o=lf[ff++];if((128&a)>0||(128&o)>0)return void(ff-=6);if(t<7)return jf(e,r,n,i,a,o);let s=lf[ff++];return(128&s)>0?void(ff-=7):jf(e,r,n,i,a,o,s)}{let a=lf[ff++],o=lf[ff++],s=lf[ff++],l=lf[ff++];if((128&a)>0||(128&o)>0||(128&s)>0||(128&l)>0)return void(ff-=8);if(t<10){if(8===t)return jf(e,r,n,i,a,o,s,l);{let t=lf[ff++];return(128&t)>0?void(ff-=9):jf(e,r,n,i,a,o,s,l,t)}}if(t<12){let c=lf[ff++],h=lf[ff++];if((128&c)>0||(128&h)>0)return void(ff-=10);if(t<11)return jf(e,r,n,i,a,o,s,l,c,h);let d=lf[ff++];return(128&d)>0?void(ff-=11):jf(e,r,n,i,a,o,s,l,c,h,d)}{let c=lf[ff++],h=lf[ff++],d=lf[ff++],p=lf[ff++];if((128&c)>0||(128&h)>0||(128&d)>0||(128&p)>0)return void(ff-=12);if(t<14){if(12===t)return jf(e,r,n,i,a,o,s,l,c,h,d,p);{let t=lf[ff++];return(128&t)>0?void(ff-=13):jf(e,r,n,i,a,o,s,l,c,h,d,p,t)}}{let u=lf[ff++],m=lf[ff++];if((128&u)>0||(128&m)>0)return void(ff-=14);if(t<15)return jf(e,r,n,i,a,o,s,l,c,h,d,p,u,m);let f=lf[ff++];return(128&f)>0?void(ff-=15):jf(e,r,n,i,a,o,s,l,c,h,d,p,u,m,f)}}}}}function Wf(t){return yf.copyBuffers?Uint8Array.prototype.slice.call(lf,ff,ff+=t):lf.subarray(ff,ff+=t)}function qf(t){let e=lf[ff++];if(wf[e])return wf[e](lf.subarray(ff,ff+=t));throw new Error("Unknown extension type "+e)}var $f=new Array(4096);function Xf(){let t=lf[ff++];if(!(t>=160&&t<192))return ff--,kf();if(t-=160,_f>=ff)return df.slice(ff-xf,(ff+=t)-xf);if(!(0==_f&&cf<180))return If(t);let e,r=4095&(t<<5^(t>1?mf.getUint16(ff):t>0?lf[ff]:0)),n=$f[r],i=ff,a=ff+t-3,o=0;if(n&&n.bytes==t){for(;i<a;){if(e=mf.getUint32(i),e!=n[o++]){i=1879048192;break}i+=4}for(a+=3;i<a;)if(e=lf[i++],e!=n[o++]){i=1879048192;break}if(i===a)return ff=i,n.string;a-=3,i=ff}for(n=[],$f[r]=n,n.bytes=t;i<a;)e=mf.getUint32(i),n.push(e),i+=4;for(a+=3;i<a;)e=lf[i++],n.push(e);let s=t<16?Hf(t):Gf(t);return n.string=null!=s?s:If(t)}var Yf=(t,e)=>{var r=kf();let n=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,r.highByte=e);let i=hf[t];return i&&i.isShared&&((hf.restoreStructures||(hf.restoreStructures=[]))[t]=i),hf[t]=r,r.read=Lf(r,n),r.read()},Zf="object"==typeof self?self:global;wf[0]=()=>{},wf[0].noBuffer=!0,wf[101]=()=>{let t=kf();return(Zf[t[0]]||Error)(t[1])},wf[105]=t=>{let e=mf.getUint32(ff-4);uf||(uf=new Map);let r,n=lf[ff];r=n>=144&&n<160||220==n||221==n?[]:{};let i={target:r};uf.set(e,i);let a=kf();return i.used?Object.assign(r,a):(i.target=a,a)},wf[112]=t=>{let e=mf.getUint32(ff-4),r=uf.get(e);return r.used=!0,r.target},wf[115]=()=>new Set(kf());var Kf=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((t=>t+"Array"));function Jf(t){let e=cf,r=ff,n=bf,i=xf,a=_f,o=df,s=vf,l=uf,c=pf,h=new Uint8Array(lf.slice(0,cf)),d=hf,p=hf.slice(0,hf.length),u=yf,m=Af,f=t();return cf=e,ff=r,bf=n,xf=i,_f=a,df=o,vf=s,uf=l,pf=c,lf=h,Af=m,(hf=d).splice(0,hf.length,...p),yf=u,mf=new DataView(lf.buffer,lf.byteOffset,lf.byteLength),f}function Qf(){lf=null,uf=null,hf=null}wf[116]=t=>{let e=t[0],r=Kf[e];if(!r)throw new Error("Could not find typed array for code "+e);return new Zf[r](Uint8Array.prototype.slice.call(t,1).buffer)},wf[120]=()=>{let t=kf();return new RegExp(t[0],t[1])},wf[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],r=ff;ff+=e-4,(pf=[kf(),kf()]).position0=0,pf.position1=0;let n=ff;ff=r;try{return kf()}finally{ff=n}},wf[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");var tg=new Array(147);for(let t=0;t<256;t++)tg[t]=+("1e"+Math.floor(45.15-.30103*t));var eg,rg=new Tf({useRecords:!1}),ng=(rg.unpack,rg.unpackMultiple,rg.unpack,new Float32Array(1));new Uint8Array(ng.buffer,0,4);try{eg=new TextEncoder}catch{}var ig,ag,og,sg,lg,cg=typeof Buffer<"u",hg=cg?Buffer.allocUnsafeSlow:Uint8Array,dg=cg?Buffer:Uint8Array,pg=cg?4294967296:2144337920,ug=0,mg=null,fg=/[\u0080-\uFFFF]/,gg=Symbol("record-id"),vg=class extends Tf{constructor(t){super(t),this.offset=0;let e,r,n,i,a,o=0,s=dg.prototype.utf8Write?function(t,e,r){return og.utf8Write(t,e,r)}:!(!eg||!eg.encodeInto)&&function(t,e){return eg.encodeInto(t,og.subarray(e)).written},l=this;t||(t={});let c=t&&t.sequential,h=t.structures||t.saveStructures,d=t.maxSharedStructures;if(null==d&&(d=h?32:0),d>8160)throw new Error("Maximum maxSharedStructure is 8160");let p=t.maxOwnStructures;null==p&&(p=h?32:64),c&&!t.saveStructures&&(this.structures=[]);let u=d>32||p+d>64,m=d+64,f=d+p+64;if(f>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,b=0;this.pack=this.encode=function(t,s){if(og||(og=new hg(8192),sg=new DataView(og.buffer,0,8192),ug=0),(lg=og.length-10)-ug<2048?(og=new hg(og.length),sg=new DataView(og.buffer,0,og.length),lg=og.length-10,ug=0):ug=ug+7&2147483640,e=ug,a=l.structuredClone?new Map:null,l.bundleStrings?(mg=["",""],og[ug++]=214,og[ug++]=98,mg.position=ug-e,ug+=4):mg=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let t=r.sharedLength||0;if(t>d)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let e=0;e<t;e++){let t=r[e];if(!t)continue;let n,i=r.transitions;for(let e=0,r=t.length;e<r;e++){let r=t[e];n=i[r],n||(n=i[r]=Object.create(null)),i=n}i[gg]=e+64}o=t}c||(r.nextId=t+64)}n&&(n=!1),i=r||[];try{if(y(t),mg){sg.setUint32(mg.position+e,ug-mg.position-e);let t=mg;mg=null,y(t[0]),y(t[1])}if(l.offset=ug,a&&a.idsToInsert){(ug+=6*a.idsToInsert.length)>lg&&_(ug),l.offset=ug;let t=function(t,e){let r,n=6*e.length,i=t.length-n;for(e.sort(((t,e)=>t.offset>e.offset?1:-1));r=e.pop();){let e=r.offset,a=r.id;t.copyWithin(e+n,e,i),n-=6;let o=e+n;t[o++]=214,t[o++]=105,t[o++]=a>>24,t[o++]=a>>16&255,t[o++]=a>>8&255,t[o++]=255&a,i=e}return t}(og.subarray(e,ug),a.idsToInsert);return a=null,t}return s&Pg?(og.start=e,og.end=ug,og):og.subarray(e,ug)}finally{if(r){if(b<10&&b++,v>1e4)r.transitions=null,b=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let t=0,e=g.length;t<e;t++)g[t][gg]=0;g=[]}if(n&&l.saveStructures){let n=r.sharedLength||d;r.length>n&&(r=r.slice(0,n));let i=og.subarray(e,ug);return!1===l.saveStructures(r,o)?(l._mergeStructures(l.getStructures()),l.pack(t)):(o=n,i)}}s&Cg&&(ug=e)}};let y=t=>{ug>lg&&(og=_(ug));var r,n=typeof t;if("string"===n){let e,n=t.length;if(mg&&n>=8&&n<4096){let e=fg.test(t);return mg[e?0:1]+=t,og[ug++]=193,void y(e?-n:n)}e=n<32?1:n<256?2:n<65536?3:5;let i=3*n;if(ug+i>lg&&(og=_(ug+i)),n<64||!s){let i,a,o,s=ug+e;for(i=0;i<n;i++)a=t.charCodeAt(i),a<128?og[s++]=a:a<2048?(og[s++]=a>>6|192,og[s++]=63&a|128):55296==(64512&a)&&56320==(64512&(o=t.charCodeAt(i+1)))?(a=65536+((1023&a)<<10)+(1023&o),i++,og[s++]=a>>18|240,og[s++]=a>>12&63|128,og[s++]=a>>6&63|128,og[s++]=63&a|128):(og[s++]=a>>12|224,og[s++]=a>>6&63|128,og[s++]=63&a|128);r=s-ug-e}else r=s(t,ug+e,i);r<32?og[ug++]=160|r:r<256?(e<2&&og.copyWithin(ug+2,ug+1,ug+1+r),og[ug++]=217,og[ug++]=r):r<65536?(e<3&&og.copyWithin(ug+3,ug+2,ug+2+r),og[ug++]=218,og[ug++]=r>>8,og[ug++]=255&r):(e<5&&og.copyWithin(ug+5,ug+3,ug+3+r),og[ug++]=219,sg.setUint32(ug,r),ug+=4),ug+=r}else if("number"===n)if(t>>>0===t)t<64?og[ug++]=t:t<256?(og[ug++]=204,og[ug++]=t):t<65536?(og[ug++]=205,og[ug++]=t>>8,og[ug++]=255&t):(og[ug++]=206,sg.setUint32(ug,t),ug+=4);else if(t>>0===t)t>=-32?og[ug++]=256+t:t>=-128?(og[ug++]=208,og[ug++]=t+256):t>=-32768?(og[ug++]=209,sg.setInt16(ug,t),ug+=2):(og[ug++]=210,sg.setInt32(ug,t),ug+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let r;if(og[ug++]=202,sg.setFloat32(ug,t),e<4||(r=t*tg[(127&og[ug])<<1|og[ug+1]>>7])>>0===r)return void(ug+=4);ug--}og[ug++]=203,sg.setFloat64(ug,t),ug+=8}else if("object"===n)if(t){if(a){let r=a.get(t);if(r){if(!r.id){let t=a.idsToInsert||(a.idsToInsert=[]);r.id=t.push(r)}return og[ug++]=214,og[ug++]=112,sg.setUint32(ug,r.id),void(ug+=4)}a.set(t,{offset:ug-e})}let n=t.constructor;if(n===Object)x(t,!0);else if(n===Array){(r=t.length)<16?og[ug++]=144|r:r<65536?(og[ug++]=220,og[ug++]=r>>8,og[ug++]=255&r):(og[ug++]=221,sg.setUint32(ug,r),ug+=4);for(let e=0;e<r;e++)y(t[e])}else if(n===Map){(r=t.size)<16?og[ug++]=128|r:r<65536?(og[ug++]=222,og[ug++]=r>>8,og[ug++]=255&r):(og[ug++]=223,sg.setUint32(ug,r),ug+=4);for(let[e,r]of t)y(e),y(r)}else{for(let e=0,r=ig.length;e<r;e++){if(t instanceof ag[e]){let r=ig[e];if(r.write)return r.type&&(og[ug++]=212,og[ug++]=r.type,og[ug++]=0),void y(r.write.call(this,t));let n,i=og,a=sg,o=ug;og=null;try{n=r.pack.call(this,t,(t=>(og=i,i=null,(ug+=t)>lg&&_(ug),{target:og,targetView:sg,position:ug-t})),y)}finally{i&&(sg=a,ug=o,lg=(og=i).length-10)}return void(n&&(n.length+ug>lg&&_(n.length+ug),ug=xg(n,og,ug,r.type)))}}x(t,!t.hasOwnProperty)}}else og[ug++]=192;else if("boolean"===n)og[ug++]=t?195:194;else if("bigint"===n){if(t<BigInt(1)<<BigInt(63)&&t>=-(BigInt(1)<<BigInt(63)))og[ug++]=211,sg.setBigInt64(ug,t);else if(t<BigInt(1)<<BigInt(64)&&t>0)og[ug++]=207,sg.setBigUint64(ug,t);else{if(!this.largeBigIntToFloat)throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");og[ug++]=203,sg.setFloat64(ug,Number(t))}ug+=8}else if("undefined"===n)this.encodeUndefinedAsNil?og[ug++]=192:(og[ug++]=212,og[ug++]=0,og[ug++]=0);else{if("function"!==n)throw new Error("Unknown type: "+n);y(this.writeFunction&&this.writeFunction())}},x=!1===this.useRecords?this.variableMapSize?t=>{let e,r=Object.keys(t),n=r.length;n<16?og[ug++]=128|n:n<65536?(og[ug++]=222,og[ug++]=n>>8,og[ug++]=255&n):(og[ug++]=223,sg.setUint32(ug,n),ug+=4);for(let i=0;i<n;i++)y(e=r[i]),y(t[e])}:(t,r)=>{og[ug++]=222;let n=ug-e;ug+=2;let i=0;for(let e in t)(r||t.hasOwnProperty(e))&&(y(e),y(t[e]),i++);og[n+++e]=i>>8,og[n+e]=255&i}:t=>{let e,r=Object.keys(t),a=i.transitions||(i.transitions=Object.create(null)),o=0;for(let t=0,n=r.length;t<n;t++){let n=r[t];e=a[n],e||(e=a[n]=Object.create(null),o++),a=e}let s=a[gg];if(s)s>=96&&u?(og[ug++]=96+(31&(s-=96)),og[ug++]=s>>5):og[ug++]=s;else{s=i.nextId,s||(s=64),s<m&&this.shouldShareStructure&&!this.shouldShareStructure(r)?(s=i.nextOwnId,s<f||(s=m),i.nextOwnId=s+1):(s>=f&&(s=m),i.nextId=s+1);let t=r.highByte=s>=96&&u?s-96>>5:-1;a[gg]=s,i[s-64]=r,s<m?(r.isShared=!0,i.sharedLength=s-63,n=!0,t>=0?(og[ug++]=96+(31&s),og[ug++]=t):og[ug++]=s):(t>=0?(og[ug++]=213,og[ug++]=114,og[ug++]=96+(31&s),og[ug++]=t):(og[ug++]=212,og[ug++]=114,og[ug++]=s),o&&(v+=b*o),g.length>=p&&(g.shift()[gg]=0),g.push(a),y(r))}for(let e=0,n=r.length;e<n;e++)y(t[r[e]])},_=t=>{let r;if(t>16777216){if(t-e>pg)throw new Error("Packed buffer would be larger than maximum buffer size");r=Math.min(pg,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else r=1+(Math.max(t-e<<2,og.length-1)>>12)<<12;let n=new hg(r);return sg=new DataView(n.buffer,0,r),og.copy?og.copy(n,0,e,t):n.set(og.slice(e,t)),ug-=e,e=0,lg=n.length-10,og=n}}useBuffer(t){og=t,sg=new DataView(og.buffer,og.byteOffset,og.byteLength),ug=0}};function bg(t,e,r,n){let i=t.byteLength;if(i+1<256){var{target:a,position:o}=r(4+i);a[o++]=199,a[o++]=i+1}else if(i+1<65536){var{target:a,position:o}=r(5+i);a[o++]=200,a[o++]=i+1>>8,a[o++]=i+1&255}else{var{target:a,position:o,targetView:s}=r(7+i);a[o++]=201,s.setUint32(o,i+1),o+=4}a[o++]=116,a[o++]=e,a.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function yg(t,e){let r=t.byteLength;var n,i;if(r<256){var{target:n,position:i}=e(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=e(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=255&r}else{var{target:n,position:i,targetView:a}=e(r+5);n[i++]=198,a.setUint32(i,r),i+=4}n.set(t,i)}function xg(t,e,r,n){let i=t.length;switch(i){case 1:e[r++]=212;break;case 2:e[r++]=213;break;case 4:e[r++]=214;break;case 8:e[r++]=215;break;case 16:e[r++]=216;break;default:i<256?(e[r++]=199,e[r++]=i):i<65536?(e[r++]=200,e[r++]=i>>8,e[r++]=255&i):(e[r++]=201,e[r++]=i>>24,e[r++]=i>>16&255,e[r++]=i>>8&255,e[r++]=255&i)}return e[r++]=n,e.set(t,r),r+=i}function _g(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");ag.unshift(t.Class),ig.unshift(t)}!function(t){t.unpack?wf[t.type]=t.unpack:wf[t.type]=t}(t)}ag=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Ef],ig=[{pack(t,e,r){let n=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296){let{target:t,targetView:r,position:i}=e(6);t[i++]=214,t[i++]=255,r.setUint32(i,n)}else if(n>0&&n<17179869184){let{target:r,targetView:i,position:a}=e(10);r[a++]=215,r[a++]=255,i.setUint32(a,4e6*t.getMilliseconds()+(n/1e3/4294967296>>0)),i.setUint32(a+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),r(this.onInvalidDate());let{target:t,targetView:n,position:i}=e(3);t[i++]=212,t[i++]=255,t[i++]=255}else{let{target:r,targetView:i,position:a}=e(15);r[a++]=199,r[a++]=12,r[a++]=255,i.setUint32(a,1e6*t.getMilliseconds()),i.setBigInt64(a+4,BigInt(Math.floor(n)))}}},{pack(t,e,r){let n=Array.from(t),{target:i,position:a}=e(this.structuredClone?3:0);this.structuredClone&&(i[a++]=212,i[a++]=115,i[a++]=0),r(n)}},{pack(t,e,r){let{target:n,position:i}=e(this.structuredClone?3:0);this.structuredClone&&(n[i++]=212,n[i++]=101,n[i++]=0),r([t.name,t.message])}},{pack(t,e,r){let{target:n,position:i}=e(this.structuredClone?3:0);this.structuredClone&&(n[i++]=212,n[i++]=120,n[i++]=0),r([t.source,t.flags])}},{pack(t,e){this.structuredClone?bg(t,16,e):yg(cg?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let r=t.constructor;r!==dg&&this.structuredClone?bg(t,Kf.indexOf(r.name),e):yg(t,e)}},{pack(t,e){let{target:r,position:n}=e(1);r[n]=193}}];var wg,Sg=new vg({useRecords:!1}),{NEVER:Eg,ALWAYS:Mg,DECIMAL_ROUND:Ag,DECIMAL_FIT:Tg}=(Sg.pack,Sg.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),Pg=512,Cg=1024,kg=new vg({structuredClone:!0});function Dg(t){if(vm(t))return t;if(Array.isArray(t))return t.map(Dg);if("object"==typeof t&&null!==t){let e={};for(let r of Object.keys(t).sort())e[r]=Dg(t[r]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}return t}_g({Class:pm.prototype.constructor,type:1,write:t=>({...t}),read:t=>(Object.setPrototypeOf(t,pm.prototype),t)}),_g({Class:wm.prototype.constructor,type:2,write:t=>[...t],read:t=>(Object.setPrototypeOf(t,wm.prototype),t)}),_g({Class:_m.prototype.constructor,type:3,write:t=>[...t],read:t=>(Object.setPrototypeOf(t,_m.prototype),t)}),_g({Class:of.prototype.constructor,type:4,write:t=>t.id,read:t=>new of(t)}),_g({Class:sf.prototype.constructor,type:5,write:t=>t.data,read:t=>new sf(t)}),_g({Class:Cm.prototype.constructor,type:6,write:t=>({...t}),read:t=>(Object.setPrototypeOf(t,Cm.prototype),t)}),(t=>{function e(t){return kg.pack(t)}t.serialize=e,t.deserialize=function(t){return kg.unpack(t)},t.checksum=function(t){return function(t){var e=0;if(0===t.length)return e;for(let r=0;r<t.length;r++)e=(e<<5)-e+t[r],e&=e;return e}(e(Dg(t))).toString()}})(wg||(wg={}));var Lg,Rg,Og,Ig,Ng,zg,Fg,Ug,Bg,Vg,jg,Gg,Hg,Wg,qg,$g,Xg,Yg,Zg,Kg="personal camera",Jg="a218fcc3-276b-49b9-b485-49037fd14f5f",Qg=5526619;function tv(t){return"string"==typeof t&&36===t.length&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)}(Rg=Lg||(Lg={})).isEqual=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Rg.lerp=function(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r]},(Ig=Og||(Og={})).isEqual=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},Ig.add=function(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]},Ig.sub=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]},Ig.div=function(t,e){return[t[0]/e[0],t[1]/e[1],t[2]/e[2]]},Ig.mul=function(t,e){return[t[0]*e[0],t[1]*e[1],t[2]*e[2]]},Ig.dist=function(t,e){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},Ig.lerp=function(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r,t[2]+(e[2]-t[2])*r]},(t=>{t.isEqual=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.lerp=function(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r,t[2]+(e[2]-t[2])*r,t[3]+(e[3]-t[3])*r]}})(Ng||(Ng={})),(Fg=zg||(zg={})).identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fg.isEqual=function(t,e){for(let r=0;r<16;r++)if(t[r]!==e[r])return!1;return!0},Fg.simplify=function(t){return t??Fg.identity},Fg.applyMatrix4=function(t,e){let r=e.slice(0);for(var n=0,i=e.length;n<i;n+=3){let i=t[3]*e[n]+t[7]*e[n+1]+t[11]*e[n+2]+t[15];r[n]=(t[0]*e[n]+t[4]*e[n+1]+t[8]*e[n+2]+t[12])/i,r[n+1]=(t[1]*e[n]+t[5]*e[n+1]+t[9]*e[n+2]+t[13])/i,r[n+2]=(t[2]*e[n]+t[6]*e[n+1]+t[10]*e[n+2]+t[14])/i}return r},(Bg=Ug||(Ug={})).isRGB=function(t){return"object"==typeof t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b},Bg.white={r:1,g:1,b:1},Bg.red={r:1,g:0,b:0},Bg.black={r:0,g:0,b:0},Bg.toRgb255a1=function(t){return{r:Math.round(255*t.r),g:Math.round(255*t.g),b:Math.round(255*t.b),a:1}},Bg.clone=function(t){return{r:t.r,g:t.g,b:t.b}},Bg.fromHex=function(t){return{r:((t=Math.floor(t))>>16&255)/255,g:(t>>8&255)/255,b:(255&t)/255}},Bg.toHex=function(t){return 65536*Math.round(255*t.r)+256*Math.round(255*t.g)+Math.round(255*t.b)},Bg.equals=function(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b},Bg.lerp=function(t,e,r){return{r:t.r+(e.r-t.r)*r,g:t.g+(e.g-t.g)*r,b:t.b+(e.b-t.b)*r}},(t=>{t.white={...Ug.white,a:1},t.transparent={...Ug.white,a:0},t.from0to1=function(t){return{r:t[0],g:t[1],b:t[2],a:t[3]}},t.fromHexAndA=function(t,e){return{...Ug.fromHex(t),a:e}},t.toRgb255a1=function(t){return{r:Math.round(255*t.r),g:Math.round(255*t.g),b:Math.round(255*t.b),a:t.a}},t.equals=function(t,e){return Ug.equals(t,e)&&t.a===e.a},t.lerp=function(t,e,r){return{r:t.r+(e.r-t.r)*r,g:t.g+(e.g-t.g)*r,b:t.b+(e.b-t.b)*r,a:t.a+(e.a-t.a)*r}}})(Vg||(Vg={})),(t=>{t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}})(jg||(jg={})),(t=>{t.defaultData={mass:1,stiffness:80,damping:10,velocity:0}})(Gg||(Gg={})),(t=>{t.defaultData={control1:[.5,0],control2:[.5,1]}})(Hg||(Hg={})),(qg=Wg||(Wg={})).linear=[0,0,1,1],qg.ease=[.25,.1,.25,1],qg.easeIn=[.42,0,1,1],qg.easeOut=[0,0,.58,1],qg.easeInOut=[.42,0,.58,1],(t=>{t.all=["PerspectiveCamera","OrthographicCamera"],t.is=function(e){return t.all.includes(e)}})($g||($g={})),(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset},t.getZoom=function(t){return"PerspectiveCamera"===t.type?t.perspective.zoom:t.orthographic.zoom}})(Xg||(Xg={})),(t=>{t.defaultData=function(t,e=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:2*Math.max(t[0],t[1]),start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[t[0]+t[0]*e,0,0]},grid:{count:[2,2,2],size:t.map((t=>t*(1+e))),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}},t.merge=function(t,e){let r={...t};if(dv.forEach((n=>{Object.assign(r,{[n]:e[n]??t[n]})})),r.radial={...t.radial},e.radial){let n=t.radial,i=e.radial;pv.forEach((t=>{Object.assign(r.radial,{[t]:i[t]??n[t]})}))}if(r.linear={...t.linear},e.linear){let n=t.linear,i=e.linear;uv.forEach((t=>{Object.assign(r.linear,{[t]:i[t]??n[t]})}))}if(r.grid={...t.grid},e.grid){let n=t.grid,i=e.grid;mv.forEach((t=>{Object.assign(r.grid,{[t]:i[t]??n[t]})}))}if(r.toObject={...t.toObject},e.toObject){let n=t.toObject,i=e.toObject;fv.forEach((t=>{Object.assign(r.toObject,{[t]:i[t]??n[t]})}))}if(r.randomnessObject={...t.randomnessObject},e.randomnessObject){let n=t.randomnessObject,i=e.randomnessObject;gv.forEach((t=>{Object.assign(r.randomnessObject,{[t]:i[t]??n[t]})}))}return r}})(Yg||(Yg={})),(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];t.toOps=function(t,r){let n=[];void 0!==t.count&&n.push({type:0,path:r,props:{count:t.count}});for(let i of e){let e=t[i];e&&Object.keys(e).length>0&&n.push({type:0,path:[...r,i],props:e})}return n}})(Zg||(Zg={}));var ev,rv,nv,iv,av,ov,sv,lv,cv,hv,dv=["count"],pv=["radius","start","end","position","scale","rotation"],uv=["position","scale","rotation"],mv=["count","size"],fv=["count","position","scale","rotation"],gv=["strength","scale","rotation","position","movement","seed","freqScale"];(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"],t.is=function(e){return t.all.includes(e)}})(ev||(ev={})),(t=>{t.defaultData=function(t){return function(t){if("PointLight"===t)return{type:t,color:Vg.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if("SpotLight"===t)return{type:t,color:Vg.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if("DirectionalLight"===t)return{type:t,color:Vg.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}(t)}})(rv||(rv={})),(t=>{t.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]}})(nv||(nv={})),(t=>{t.defaultData={castShadow:!0,receiveShadow:!0},t.equals=function(t,e){return t.castShadow===e.castShadow&&t.receiveShadow===e.receiveShadow}})(iv||(iv={})),(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0},t.equals=function(t,e){return t.flatShading===e.flatShading&&t.side===e.side&&t.wireframe===e.wireframe}})(av||(av={})),(t=>{t.defaultData={...av.defaultData,...iv.defaultData}})(ov||(ov={})),(t=>{t.getMaterialData=function(t,e){let r=[];if("material"in t){let n="string"==typeof t.material?e.materials[t.material]??e.lib.materials[t.material]?.asset:t.material;n&&r.push(n)}else if("materials"in t)for(let n of t.materials){let t="string"==typeof n?e.materials[n]??e.lib.materials[n]?.asset:n;t&&r.push(t)}return r}})(sv||(sv={})),(t=>{t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7})(lv||(lv={})),(t=>{t.is=function(t){return"texture"===t||"video"===t||"color"===t||"depth"===t||"normal"===t||"gradient"===t||"noise"===t||"fresnel"===t||"rainbow"===t||"toon"===t||"outline"===t||"transmission"===t||"matcap"===t||"displace"===t||"pattern"===t||"light"===t}})(cv||(cv={})),(t=>{t.is=function(t){return"phong"===t||"toon"===t||"lambert"===t||"physical"===t}})(hv||(hv={}));var vv,bv,yv,xv,_v=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],wv=["wrapping","image","video","name"];(t=>{t.patch=function(t,e){let{texture:r,...n}=e;if(Object.assign(t,n),r){let e=t.texture;e&&Object.assign(e,r)}},t.defaultData=function(t,e){return"light"===t&&e?function(t){let e={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(t){case"phong":return{...e,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...e,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...e,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...e,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}(e):function(t){let e={alpha:1,mode:0,isMask:!1,visible:!0};switch(t){case"texture":return{...e,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...e,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:lv.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...e,type:"color",color:Ug.fromHex(Qg)};case"depth":return{...e,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...e,type:"normal",cnormal:[1,1,1]};case"gradient":return{...e,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...e,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Ug.fromHex(6710886),a:1},colorB:{...Ug.fromHex(6710886),a:1},colorC:{...Ug.fromHex(16777215),a:1},colorD:{...Ug.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...e,type:"fresnel",color:Vg.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...e,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...e,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Vg.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...e,type:"outline",outlineColor:Vg.fromHexAndA(0,1),contourColor:Vg.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...e,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...e,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...e,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Ug.fromHex(0),a:1},colorB:{...Ug.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}(t)}})(vv||(vv={})),(t=>{function e(t,e="layer1",r="layer2"){let n=new wm;return n.push({fi:0,data:vv.defaultData("light",t),id:e}),n.push({fi:1,data:vv.defaultData("color"),id:r}),{layers:n}}t.isMergable=function(t){return!t.layers.some((t=>"texture"===t.data.type&&0!==t.data.projection||"depth"===t.data.type&&!t.data.isWorldSpace||"noise"===t.data.type||"displace"===t.data.type))},t.getHash=function(t){let e="";return t.layers.forEach((t=>{Object.entries(t.data).forEach((([t,r])=>{e+=`${t}${r}`,Array.isArray(r)?r.forEach((t=>e+=`${t}`)):"object"==typeof r?Object.values(r).forEach((t=>{e+="number"==typeof t?`${t.toFixed(4)}`:`${t}`})):e+=`${r}`}))})),e},t.defaultEmptyData=function(){return{layers:new wm}},t.defaultData=function(t="layer1",r="layer2"){return e("phong",t,r)},t.withName=function(t,e){return{...t,name:e}},t.defaultTwoLayerData=e,t.defaultTwoLayerTextureData=function(t,e="phong",r="layer1",n="layer2"){let i=vv.defaultData("texture");Object.assign(i.texture,{image:t});let a=new wm;return a.push({fi:0,data:i,id:r}),a.push({fi:1,data:vv.defaultData("light",e),id:n}),{layers:a}},t.defaultTwoLayerVideoTextureData=function(t,e="phong",r="layer1",n="layer2"){let i=vv.defaultData("video");Object.assign(i.texture,{video:t});let a=new wm;return a.push({fi:0,data:i,id:r}),a.push({fi:1,data:vv.defaultData("light",e),id:n}),{layers:a}}})(bv||(bv={})),(t=>{t.defaultData=function(){return{points:new wm,roundness:0,shapeHoles:[],isClosed:!1}}})(yv||(yv={})),(t=>{t.defaultData=function(){return{points:new wm,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}})(xv||(xv={}));var Sv,Ev={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0};(t=>{t.merge=function(t,e){let r={...t};return ub.forEach((n=>{Object.assign(r,{[n]:e[n]??t[n]})})),r}})(Sv||(Sv={}));var Mv,Av,Tv,Pv,Cv,kv,Dv,Lv,Rv,Ov,Iv,Nv,zv,Fv,Uv,Bv,Vv,jv,Gv,Hv,Wv,qv,$v,Xv,Yv,Zv,Kv,Jv,Qv,tb,eb,rb,nb,ib,ab,ob,sb,lb,cb,hb,db,pb={shape:Ev,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},ub=["depth","offset","angle","twist","startScale","endScale"];function mb(t){t.layers.forEach((t=>{if("depth"===t.type&&void 0!==t.colorA){let e=t.colorA,r=t.colorB,n=[[e.r,e.g,e.b,e.a],[r.r,r.g,r.b,r.a]],i=[0,1];for(let t=2;t<10;t++)n.push(n[1]),i.push(1);let a={...dm(ef(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:i,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if("depth"===t.type&&1===t.gradientType&&(t.near<0||t.far<0)){let e={...ef(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,e)}}))}function fb(t,e){Object.values(t.shared.materials).forEach((t=>e(t)))}function gb(t,e){t.scene.objects.traverse(((t,r)=>{"materials"in r?r.materials.forEach(((t,n)=>{void 0===t&&(r.materials[n]=bv.defaultData(),t=r.materials[n]),"string"!=typeof t&&e(t)})):"material"in r?"string"!=typeof r.material&&(void 0===r.material&&(r.material=bv.defaultData()),e(r.material)):"Mesh"===r.type&&(void 0===r.material&&(r.material=bv.defaultData()),e(r.material)),"overrides"in r&&Object.values(r.overrides).forEach((t=>{t.material&&"string"!=typeof t.material&&e(t.material)}))}))}function vb(t){void 0===t.layers&&Object.assign(t,bv.defaultTwoLayerData("lambert"))}function bb(t){!t.layers||t.layers.forEach((t=>{if("depth"===t.type&&10===t.colors.length){let e=[...t.colors];e.push(t.colors[9]);let r=[...t.steps];r.push(t.steps[9]);let n={...ef(t),colors:e,steps:r};Object.assign(t,n)}}))}function yb(t){t.scene.objects.traverse(((t,e)=>{"materials"in e?e.materials.forEach((t=>{"string"!=typeof t&&bb(t)})):"material"in e&&"string"!=typeof e.material&&bb(e.material)})),Object.values(t.shared.materials).forEach((t=>bb(t)))}function xb(t){t.layers&&t.layers.forEach((t=>{"depth"===t.type&&void 0!==t.num&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)}))}function _b(t){t.layers&&t.layers.forEach((t=>{(function(t){return"displace"!==t.type})(t)&&void 0===t.isMask&&(t.isMask=!1),("texture"===t.type||"video"===t.type)&&void 0===t.blending&&(t.blending=0),("noise"===t.type||"displace"===t.type&&"noise"===t.displacementType)&&(void 0===t.voronoiStyle&&(t.voronoiStyle=0),void 0===t.highCut&&(t.highCut=1),void 0===t.lowCut&&(t.lowCut=0),void 0===t.smoothness&&(t.smoothness=.3),void 0===t.seed&&(t.seed=0),void 0===t.quality&&(t.quality=1))}))}function wb(t){let e=t.layers.find((t=>"light"===t.type))?.data;if("basic"===e?.category){let t=vv.defaultData("light","phong"),r=e;Object.assign(r,t),r.visible=!1}}function Sb(t){fb(t,wb),gb(t,wb)}function Eb(t){t.layers.forEach((t=>{"light"===t.type&&"toon"!==t.category&&void 0===t.occlusion&&(t.occlusion=!0)}))}function Mb(t){t.layers&&t.layers.forEach((t=>{"light"===t.type&&void 0===t.bumpMapIntensity&&(t.bumpMapIntensity=5)}))}function Ab(t,e){if(e<1&&(gb(t,mb),fb(t,mb),t.schema=1),e<2&&(function(t){Object.assign(t.scene.publish,{orbitControls:{...Yv.defaultData,...ef(t.scene.publish.orbitControls)}})}(t),t.schema=2),e<3&&(function(t){function e(t){if(t.layers)for(let e of Object.values(t.layers))if(e)for(let[t,r]of Object.entries(e))if((_v.includes(t)||"boolean"==typeof r)&&delete e[t],"texture"===t)for(let[t,e]of Object.entries(r))(wv.includes(t)||"boolean"==typeof e)&&delete r[t]}t.scene.objects.traverse(((t,r)=>{r.states.forEach((t=>{let r=t;r.material?e(r.material):r.materials&&r.materials.forEach((t=>{e(t)}))}))}))}(t),t.schema=3),e<4&&(function(t){t.scene.publish.withBackground=!0}(t),t.schema=4),e<5&&(function(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}(t),t.schema=5),e<6&&(function(t){t.scene.objects.traverse(((t,e)=>{let r=e.cloner;r&&(r.radial.scale=r.radial.scale.map((t=>t+1)),r.linear.scale=r.linear.scale.map((t=>t+1)))}))}(t),t.schema=6),e<7&&(function(t){t.scene.objects.traverse(((t,e)=>{let r=e.geometry;r&&("DodecahedronGeometry"===r.type||"IcosahedronGeometry"===r.type)&&(r.detail=Math.round(r.detail))}))}(t),t.schema=7),e<8&&(t.schema=8),e<9&&(yb(t),t.schema=9),e<10&&(function(t){t.scene.objects.traverse(((t,e)=>{"Mesh"===e.type&&("BooleanGeometry"===e.geometry.type||"SubdivGeometry"===e.geometry.type)&&(e.geometry.phongAngle=35)}))}(t),t.schema=10),e<11&&(function(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse(((t,e)=>{("DirectionalLight"===e.type||"SpotLight"===e.type)&&(e.shadowResolution=1024,e.shadowRadius=1,e.depth=1e5)})),t.shared.penumbraSize=new Array(5).fill(.5)}(t),t.schema=11),e<12&&(yb(t),t.schema=12),e<13&&(function(t){t.shared.audios=Ec({},pm.prototype)}(t),t.schema=13),e<14&&(function(t){let e=t.shared.materials;Object.entries(e).forEach((([t,r])=>{if(!r.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[t]:r})}}))}(t),t.schema=14),e<15&&(function(t){Object.entries(ef(t.shared.images)).filter((t=>!1===t[1].asset)).map((t=>t[0])).forEach((e=>{delete t.shared.images[e]})),Object.entries(ef(t.shared.audios)).filter((t=>!1===t[1].asset)).map((t=>t[0])).forEach((e=>{delete t.shared.audios[e]}))}(t),t.schema=15),e<16&&(function(t){t.scene.publish.settings.web.preload=!1}(t),t.schema=16),e<17&&(gb(t,xb),fb(t,xb),t.schema=17),e<18&&(gb(t,vb),fb(t,vb),t.schema=18),e<19&&(function(t){Object.assign(t.scene.publish.settings,{video:{...Zv.defaultData.settings.video,...ef(t.scene.publish.settings.video)}})}(t),t.schema=19),e<20&&(function(t){t.shared.fonts=Ec({},pm.prototype)}(t),function(t){let e=[];t.scene.objects.traverse(((r,n)=>{let i=n;if("TextFrame"===i.type){let n=bv.defaultTwoLayerData("phong"),a="string"==typeof i.color?t.shared.colors[i.color]:i.color;n.layers[1].data.color={r:a.r,g:a.g,b:a.b},n.layers[1].data.alpha=i.alpha;let o=function(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ")}(i.font);void 0===t.shared.fonts[o]&&(t.shared.fonts[o]={name:o});let s={name:i.name,...Fv.defaultData,...Vv.defaultData,flatShading:!1,wireframe:!1,geometry:{...Tv.defaultData("TextGeometry"),width:i.width,height:i.height,font:o,depth:0,horizontalAlign:i.horizontalAlign,verticalAlign:i.verticalAlign,fontSize:1.40625*i.fontSize,lineHeight:i.lineHeight/1.40625,letterSpacing:i.letterSpacing-1,text:i.text,textTransform:i.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:n,states:ef(i.states),events:ef(i.events),visible:i.visible,raycastLock:i.raycastLock,position:i.position,rotation:i.rotation,scale:i.scale,hiddenMatrix:i.hiddenMatrix},l=ef(t.scene.objects).parent(r);t.scene.objects.insertAfter(l??null,r,[{id:r+"new",data:s,children:[]}]),e.push(r)}})),e.forEach((e=>{t.scene.objects.delete(e)}))}(t),t.schema=20),e<21&&(function(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse(((t,r)=>{r.events.forEach((t=>{if(e[Number(t.type)])if(Object.assign(t,{type:e[Number(t.type)]}),"Audio"===t.type&&"audioEvent"in t&&(Object.assign(t,{playAudio:t.audioEvent}),delete t.audioEvent),"GameControl"===t.type)Object.assign(t,{gameActions:{idle:new wm,move:new wm,jump:new wm}});else{let e=new wm;Object.assign(t,{actions:e}),("MouseDown"===t.type||"MouseUp"===t.type||"KeyDown"===t.type||"KeyUp"===t.type)&&"url"in t&&e.push({fi:0,id:Rt.generateUUID(),data:{type:"Link",url:t.url,delay:0}}),"targets"in t&&(t.targets.forEach(((t,r,n)=>{let i={easing:t.easing,duration:t.duration};6===t.easing?Object.assign(i,dm(t,"mass","stiffness","damping","velocity")):5===t.easing&&Object.assign(i,{control1:{...t.control1},control2:{...t.control2}});let a={repeat:t.repeat?-1:0,delay:t.delay,delayDirection:t.delayDirection,direction:t.cycle&&t.rewind?"pingpong-rewind":t.cycle?"pingpong":"normal"},o={state:t.state,...a,...i},s={allowSlerp:!0,type:"Transition",object:t.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new wm({fi:0,id:Rt.generateUUID(),data:{state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4}},{fi:1,id:Rt.generateUUID(),data:o})};e.push({fi:n,id:r,data:s})})),delete t.targets)}}))}))}(t),function(t){t.scene.objects.traverse(((t,e)=>{function r(t,r){let n=new wm,i=[];if(e.events.forEach(((t,e,a)=>{if("Audio"===t.type&&t.trigger===r){let r;i.push(e),"play"===t.interaction?r={...dm(t,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in t?t.after:void 0,toggle:"after"in t?t.toggle:void 0,type:"Audio"}:("pause"===t.interaction||"stop"===t.interaction)&&(r={...dm(t,"interaction","delay","object","playAudio"),type:"Audio"}),r&&n.push({fi:a,id:e,data:r})}})),i.forEach((t=>e.events.delete(t))),n.length){let r=e.events.find((e=>e.type===t))?.data;r?"actions"in r&&r.actions.insertBefore(null,n):e.events.insertBefore(null,[{id:Rt.generateUUID(),data:{type:t,actions:n}}])}}r("Start","start"),r("MouseDown","mouseDown"),r("MouseUp","mouseUp"),r("KeyDown","keyDown"),r("KeyUp","keyUp")}))}(t),t.schema=21),e<22&&(Sb(t),t.schema=22),e<23&&(function(t){t.scene.objects.traverse(((t,e)=>{"Mesh"===e.type&&"SubdivGeometry"===e.geometry.type&&(e.geometry.scaleBaked||(e.geometry.scaleBaked=[1,1,1]))}))}(t),t.schema=23),e<24&&(function(t){t.scene.objects.traverse(((t,e)=>{("Empty"===e.type||"Mesh"===e.type)&&e.cloner&&!e.cloner.randomnessObject&&!e.cloner.toObject&&!e.cloner.randomness&&(e.cloner={...e.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})}))}(t),t.schema=24),(e<25||void 0===t.shared.videos)&&(function(t){t.shared.videos=Ec({},pm.prototype)}(t),e<25&&(t.schema=25)),e<26&&(function(t){t.scene.objects.traverse(((e,r)=>{let n=t.scene.objects.unproxy().parent(e);if(n){let e=ef(t.scene.objects.data(n));e&&"Mesh"===e.type&&"BooleanGeometry"===e.geometry.type&&"Mesh"===r.type&&(r.visible=!0!==ef(r).booleanExclude)}}))}(t),t.schema=26),e<27&&(function(t){t.scene.objects.traverse(((t,e)=>{if("Mesh"===e.type){let t=e;"NonParametricGeometry"===e.geometry.type?void 0!==t.material&&delete t.material:void 0!==t.materials&&delete t.materials}}))}(t),t.schema=27),e<28&&(Sb(t),t.schema=28),e<29&&(function(t){function e(t){Object.setPrototypeOf(t,Cm.prototype),t.texture&&Object.setPrototypeOf(t.texture,Cm.prototype)}function r(t){Object.setPrototypeOf(t,Cm.prototype);for(let r in t)e(t[r])}t.scene.objects.traverse(((t,e)=>{e.states.forEach((t=>{let e=t;if(e.material){let t=ef(e.material).layers;r(t),e.material.layers=t}if(e.materials)for(let t=0;t<e.materials.length;t++){let n=e.materials[t],i=ef(n).layers;r(i),n.layers=i}}))}))}(t),t.schema=29),e<30&&(function(t){t.scene.objects.traverse(((t,e)=>{"Mesh"===e.type&&"NonParametricGeometry"===e.geometry.type&&!("material"in e)&&!("materials"in e)&&(e.material=bv.defaultTwoLayerData("phong"))}))}(t),t.schema=30),e<31&&(function(t){void 0===t.scene.publish.orbitControls.autoZoom&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse(((t,e)=>{("OrthographicCamera"===e.type||"PerspectiveCamera"===e.type)&&(void 0===e.orthographic.autoZoom&&(e.orthographic.autoZoom=!1),void 0===e.orthographic.autoZoomFrustumSize&&(e.orthographic.autoZoomFrustumSize=790))}))}(t),t.schema=31),e<33&&(function(t){t.scene.objects.traverse(((t,e)=>{void 0===e.pathSnapping&&(e.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),void 0===e.pathSnapping.offset&&(e.pathSnapping.offset=0)}))}(t),t.schema=33),e<34&&(function(t){void 0===t.scene.publish.mouseEventTarget&&(t.scene.publish.mouseEventTarget="canvas"),void 0===t.scene.publish.settings.web.hint&&(t.scene.publish.settings.web.hint=!1)}(t),t.schema=34),e<35&&(function(t){let{video:e}=t.scene.publish.settings;"gif"===e.format&&e.fps>48&&(e.fps=15)}(t),t.schema=35),e<36&&(function(t){t.scene.objects.traverse(((t,e)=>{e.events.forEach((t=>{"GameControl"===t.type&&(t.resetYPosition=Math.abs(t.resetYPosition-e.position[1]))}))}))}(t),t.schema=36),e<37&&(function(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse(((t,r)=>{e&&null===r.physics?r.collision=!1:r.collision="visibility"}))}(t),t.schema=37),e<38&&(gb(t,_b),fb(t,_b),t.schema=38),e<39&&(function(t){t.scene.objects.traverse(((t,e)=>{e.events.forEach((t=>{"GameControl"===t.type&&(t.navmesh=db.defaultDataThirdPerson.navmesh)}))}))}(t),t.schema=39),e<40&&(function(t){t.scene.styles||(t.scene.styles=Qv.defaultData())}(t),t.schema=40),e<41&&(function(t){void 0===t.scene.environment.ambientLight.occlusion&&(t.scene.environment.ambientLight.occlusion=!1),void 0===t.scene.environment.ambientLight.aoFullRes&&(t.scene.environment.ambientLight.aoFullRes=!1),void 0===t.scene.environment.ambientLight.radius&&(t.scene.environment.ambientLight.radius=256),void 0===t.scene.environment.ambientLight.bias&&(t.scene.environment.ambientLight.bias=.5),void 0===t.scene.environment.ambientLight.aoColor&&(t.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),gb(t,Eb),fb(t,Eb)}(t),t.schema=41),e<42&&(function(t){t.scene.objects.traverse(((t,e)=>{e.events.forEach((t=>{"GameControl"===t.type&&Object.assign(t.gameActions,{run:new wm})}))}))}(t),t.schema=42),e<43&&(function(t){t.scene.objects.traverse(((t,e)=>{e.events.forEach((t=>{"GameControl"===t.type&&(t.keyAssignments=[...t.keyAssignments,["run",""],["none","Ctrl"]])}))}))}(t),t.schema=43),e<99){gb(t,Mb),fb(t,Mb),null===t.scene.publish.playCamera&&(t.scene.publish.playCamera=Kg);let e=ef(t.scene.objects),r=t.scene.objects;t.scene.publish.playPage=Jg,r.insertBefore(null,null,[{id:Jg,data:{...qv.defaultData,backgroundColor:t.scene.backgroundColor,fog:t.scene.fog,postprocessing:t.scene.postprocessing,ao:dm(t.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:t.scene.publish.playCamera,gameControlObject:t.scene.publish.gameControlObject},shadow:dm(t.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...Rv.defaultData,...dm(t.scene.environment,"usePhysics","gravity")},camera:ef(t.scene.ownerCamera)??qv.defaultData.camera,name:"Scene"},children:[]}]);for(let t of e)t.id!==eb.TRASH_CAN_ID&&r.move(Jg,t.fi,t.id);let n=0,i=0;t.shared.penumbraSize&&t.scene.objects.traverse(((e,r)=>{"DirectionalLight"===r.type?(r.penumbraSize=t.shared.penumbraSize[Math.min(n,2)],n+=1):"SpotLight"===r.type&&(r.penumbraSize=t.shared.penumbraSize[3+Math.min(i,1)],i+=1),(void 0===r.physics||null===r.physics)&&"Instance"!==r.type&&(r.physics={},Object.assign(r.physics,nv.defaultData)),void 0!==r.physics&&null!==r.physics&&(r.physics.enabled=r.collision??"visibility",delete r.collision)})),t.schema=99}}function Tb(t){t.layers&&t.layers.forEach((t=>{"light"===t.type&&void 0===t.alphaOverride&&(t.alphaOverride=1)}))}(t=>{t.is2DParametricMesh=function(t){return"PolygonGeometry"===t||"RectangleGeometry"===t||"StarGeometry"===t||"TriangleGeometry"===t||"EllipseGeometry"===t},t.isParametricMesh=function(t){return"PolygonGeometry"===t||"PolygonGeometry"===t||"RectangleGeometry"===t||"StarGeometry"===t||"TriangleGeometry"===t||"EllipseGeometry"===t||"PathGeometry"===t||"VectorGeometry"===t||"ConeGeometry"===t||"CubeGeometry"===t||"CylinderGeometry"===t||"DodecahedronGeometry"===t||"HelixGeometry"===t||"IcosahedronGeometry"===t||"LatheGeometry"===t||"PyramidGeometry"===t||"SphereGeometry"===t||"PlaneGeometry"===t||"BackdropGeometry"===t||"TorusGeometry"===t||"TorusKnotGeometry"===t||"BooleanGeometry"===t||"TextGeometry"===t}})(Mv||(Mv={})),(t=>{t.merge=function(t,e){let r={...t};return Object.assign(r,e),"PathGeometry"===r.type&&"extrusion"in e&&e.extrusion&&(r.extrusion={...t.extrusion},Object.assign(r.extrusion,Sv.merge(r.extrusion,e.extrusion))),r}})(Av||(Av={})),(t=>{t.defaultData=function(t){if("RectangleGeometry"===t)return{width:320,height:320,type:t,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("PathGeometry"===t)return{type:t,width:1,height:1,depth:1,path:xv.defaultData(),extrusion:pb};if("VectorGeometry"===t)return{width:1,height:1,type:t,subdivisions:12,shape:yv.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("BooleanGeometry"===t)return{type:t,operation:2,width:0,height:0,depth:0,phongAngle:35};if("TextGeometry"===t)return{type:t,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if("SphereGeometry"===t)return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}})(Tv||(Tv={})),(t=>{t.defaultData={enabled:!1,useBackgroundColor:!1,color:Ug.white,near:.1,far:2e3}})(Pv||(Pv={})),(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(Cv||(Cv={})),(t=>{t.defaultData={softShadowQuality:"low"}})(kv||(kv={})),(t=>{t.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75}})(Dv||(Dv={})),(t=>{t.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}}})(Lv||(Lv={})),(t=>{t.defaultData={usePhysics:!1,gravity:-10}})(Rv||(Rv={})),(t=>{t.defaultData={playCamera:Kg,gameControlObject:null}})(Ov||(Ov={})),(t=>{t.defaultData={backgroundColor:Vg.fromHexAndA(2960946,1),postprocessing:Cv.defaultData,fog:Pv.defaultData,globalPhysics:Rv.defaultData,ambient:Dv.defaultData,ao:Lv.defaultData,shadow:kv.defaultData,publish:Ov.defaultData}})(Iv||(Iv={})),(t=>{t.isComponentRelated=function(t){return"Component"===t||"Instance"===t},t.isEmptyOrComponent=function(t){return"Empty"===t||"Instance"===t}})(Nv||(Nv={})),(t=>{t.identity={...jg.identity,hiddenMatrix:zg.identity},t.fromObject=function(t){return{position:t.position,rotation:t.rotation,scale:t.scale,hiddenMatrix:t.hiddenMatrix}},t.merge=function(t,e){return{position:e?.position||t.position,rotation:e?.rotation||t.rotation,scale:e?.scale||t.scale,hiddenMatrix:e?.hiddenMatrix||t.hiddenMatrix}},t.diff=function(t,e){return function(t){for(let e of Object.keys(t))void 0===t[e]&&delete t[e];return t}({position:Og.isEqual(t.position,e.position)?void 0:e.position,rotation:Og.isEqual(t.rotation,e.rotation)?void 0:e.rotation,scale:Og.isEqual(t.scale,e.scale)?null:e.scale,hiddenMatrix:zg.isEqual(t.hiddenMatrix,e.hiddenMatrix)?void 0:e.hiddenMatrix})}})(zv||(zv={})),(t=>{t.defaultData={states:new wm,events:new wm,visible:!0,raycastLock:!1,physics:nv.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...zv.identity,cloner:null}})(Fv||(Fv={})),(t=>{t.defaultData={type:"Empty",...Fv.defaultData}})(Uv||(Uv={})),(t=>{t.defaultData={type:"Component",...Fv.defaultData}})(Bv||(Bv={})),(t=>{t.defaultData={type:"Mesh",...Fv.defaultData,...ov.defaultData}})(Vv||(Vv={})),(t=>{t.defaultData={...Fv.defaultData,...zv.identity,position:[0,0,Xg.DefaultTargetOffset],...Xg.defaultData}})(jv||(jv={})),(t=>{t.defaultData=function(t){return{...Fv.defaultData,...rv.defaultData(t)}},t.defaultDirectionalLightData={...t.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(Gv||(Gv={})),(t=>{function e(t,e,r=0){for(;r<e.length;){let n=t?t[e[r]]:void 0;if(e.length===r+1)return n;if(!n)return;t=n.descendants,r+=1}}t.resolveWithDes=e,t.resolve=function(t,r,n=0){let i=e(t,r,n);if(i){let t=Object.keys(i);if(1===t.length&&"descendants"===t[0])return}return i}})(Hv||(Hv={})),(t=>{function e(t,e){return{...Fv.defaultData,...e,component:t,overrides:new Cm,physics:void 0,events:void 0,type:"Instance"}}t.rootOverrideProps=["physics","events"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"],t.ofComponent=e,t.fromComponentData=function(t){let r=zv.fromObject(t.data);return e(t.id,r)}})(Wv||(Wv={})),(t=>{t.defaultData={type:"Page",...Fv.defaultData,physics:{...nv.defaultData,fusedBody:!1},...Iv.defaultData,camera:jv.defaultData}})(qv||(qv={})),(t=>{t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:zg.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:nv.defaultData,states:new wm,events:new wm,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Xg.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...Fv.defaultData,...Vv.defaultData,geometry:Tv.defaultData("RectangleGeometry"),material:bv.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...Fv.defaultData,...Vv.defaultData,geometry:Tv.defaultData("BooleanGeometry"),material:bv.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...Fv.defaultData,...Vv.defaultData,geometry:Tv.defaultData("TextGeometry"),material:bv.defaultTwoLayerData("phong","layer1","layer2")}})($v||($v={})),(t=>{t.newEmpty=function(t,e){let r={name:e};return"Mesh"===t.type?(r.geometry={},"material"in t&&(r.material={layers:new Cm}),"materials"in t&&(r.materials=t.materials.map((t=>({layers:new Cm}))))):$g.is(t.type)&&(r.perspective={},r.orthographic={}),r},t.toOps=function(t,e){let r,n=[],i={orthographic:0,perspective:0,geometry:0};function a(t,e){for(let[r,i]of Object.entries(e.layers)){let{texture:e,...a}=i;if(void 0!==e&&Object.keys(e).length>0){let i={path:[...t,"layers",r,"texture"],props:e,type:0};n.push(i)}if(Object.keys(a).length>0){let e={path:[...t,"layers",r],props:a,type:0};n.push(e)}}}for(let[t,o]of Object.entries(e))if("name"!==t)if("cloner"===t)n.push(...Zg.toOps(o,["cloner"]));else if("pathSnapping"===t)n.push({path:[t],props:{slide:o.slide,offset:o.offset},type:0});else if("material"===t)a(["material"],o);else if("materials"===t)for(let[t,e]of Object.entries(o))a(["materials",t],e);else if(0===i[t]){if("geometry"===t&&void 0!==o.extrusion){let e={path:[t,"extrusion"],props:o.extrusion,type:0};n.push(e),o={...o},delete o.extrusion}if(Object.keys(o).length>0){let e={path:[t],props:o,type:0};n.push(e)}}else void 0===r&&(r={path:[],props:{},type:0},n.push(r)),r.props[t]=o;return n},t.patch=function(t,e){if(void 0===e)return t;let r={...t};if(Object.assign(r,zv.merge(r,e)),Object.assign(r,{pathSnapping:Object.assign({},r.pathSnapping,{slide:e.pathSnapping?.slide??r.pathSnapping?.slide??0,offset:e.pathSnapping?.offset??r.pathSnapping?.offset??0})}),$g.is(t.type)){r.orthographic={...r.orthographic},r.perspective={...r.perspective};let t=e;void 0!==t.orthographic?.zoom&&(r.orthographic.zoom=t.orthographic.zoom),void 0!==t.perspective?.zoom&&(r.perspective.zoom=t.perspective.zoom),void 0!==t.isUpVectorFlipped&&(r.isUpVectorFlipped=t.isUpVectorFlipped),void 0!==t.targetOffset&&(r.targetOffset=t.targetOffset)}else if("Mesh"===t.type)"geometry"in e&&Object.assign(r,{geometry:Av.merge(r.geometry,e.geometry)}),(e.material||e.materials)&&(r=function(t,e){if(void 0===e)return t;let r={...t};return"material"in r&&"material"in e&&e.material&&(r.material=tf(r.material,(t=>{if("string"!=typeof t)for(let[r,n]of Object.entries(e.material.layers)){let e=t.layers.data(r);e&&vv.patch(e,n)}})).data),r.materials&&e.materials&&(r.materials=tf(r.materials,(t=>{for(let n=0;n<r.materials.length;n++){let r=e.materials[n];if("string"!=typeof r)for(let[e,i]of Object.entries(r.layers)){let r=t[n]?.layers?.data(e);r&&vv.patch(r,i)}}})).data),r}(r,e)),r.cloner&&"cloner"in e&&Object.assign(r,{cloner:Yg.merge(r.cloner,e.cloner)});else if("Empty"===t.type)r.cloner&&"cloner"in e&&Object.assign(r,{cloner:Yg.merge(r.cloner,e.cloner)});else if(ev.is(t.type)){let t=e;void 0!==t.intensity&&(r.intensity=t.intensity),void 0!==t.color&&("string"==typeof t.color?r.color=t.color:r.color=Ug.clone(t.color))}return r}})(Xv||(Xv={})),(t=>{t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0}})(Yv||(Yv={})),(t=>{t.defaultData={orbitControls:Yv.defaultData,playPage:Jg,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map(((t,e)=>{let r=0,n=0;return e<5?n=-30:e<10&&(n=30),0===e||10===e||5===e?r=30:(4===e||11===e||9===e)&&(r=-30),[120,[r,n],"show"]})),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1}})(Zv||(Zv={})),(t=>{t.defaultData={id:"basic",label:"Basic",style:"None",prompt:""}})(Kv||(Kv={})),(t=>{t.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0}})(Jv||(Jv={})),(t=>{t.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...Kv.defaultData},isRandomSeed:!0,seed:t.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:Jv.defaultData}),t.generateSeed=()=>Math.round(1e5*Math.random())})(Qv||(Qv={})),(t=>{t.physicsEnabled=function(t){return void 0!==t.find((t=>"Page"===t.data.type&&t.data.globalPhysics.usePhysics))},t.traverseModuleInstances=function(t,e,r){t.scene.objects.traverseFrom(e,((e,n)=>{if("Instance"===n.type){let i=Db.getComponentData(t,n.component)?.data;i&&r(e,n,i.events)}else r(e,n,n.events)}))}})(tb||(tb={})),(t=>{function e(t={withLight:!0,withSquare:!0}){let e=[],r=$v.defaultMeshObject;!0===t.withLight&&e.push({fi:-1,data:Gv.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),!0===t.withSquare&&e.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:r,children:[]});let n=new _m;return n.push({fi:1,id:Jg,data:{...qv.defaultData,name:"Scene 1"},children:e}),n}function r(e){return{...t.defaultData,objects:Ec(e,_m.prototype)}}t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",t.defaultData={objects:e(),publish:Zv.defaultData,styles:Qv.defaultData()},t.emptyDataWithoutPage=function(){return{objects:new _m,publish:Zv.defaultData,styles:Qv.defaultData()}},t.emptyDataWithPage=function(t){return{objects:e(t),publish:Zv.defaultData,styles:Qv.defaultData()}},t.withObjs=r,t.withObj=function(t,e){return r([{id:t,data:e,children:[],fi:0}])}})(eb||(eb={})),(t=>{t.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}}})(rb||(rb={})),(t=>{t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"}})(nb||(nb={})),(t=>{function e(t){return void 0!==t.textValue}function r(t){return"boolean"==typeof t}t.isTextValue=e,t.isNumber=function(t){return"number"==typeof t},t.isBoolean=r,t.typeOfVariable=function(t){return e(t)?"string":r(t)?"boolean":"number"},t.getDisplayedValue=function(e){return t.isTextValue(e)?Array.isArray(e.textValue)?e.textValue.map((t=>t.toString().padStart(e.padding??2,"0"))).join(e.deliminator??":")+(void 0!==e.suffix?" "+e.suffix:""):e.textValue.toString():t.isBoolean(e)?e?"True":"False":t.isNumber(e)?parseFloat(e.toFixed(3)).toString():e.toString()}})(ib||(ib={})),(t=>{t.all=["images","videos","colors","audios","fonts","materials","variables"]})(ab||(ab={})),(t=>{t.all=[...ab.all,"components"]})(ob||(ob={})),(t=>{t.defaultData=function(){return{images:new pm,videos:new pm,colors:new pm,audios:new pm,fonts:new pm,materials:new pm,components:new pm,variables:new pm}}})(sb||(sb={})),(t=>{t.defaultData=function(){return{images:new pm,videos:new pm,colors:new pm,audios:new pm,fonts:new pm,materials:new pm,components:new pm,variables:new pm}}})(lb||(lb={})),(t=>{t.defaultColors=function(){let t={"89b10010-844c-11ec-a8a3-0242ac120002":{r:.5,g:.5,b:.5,a:1,name:"Default Color"}};return Ec(t,pm.prototype)},t.defaultImages=function(t){let e={};return t?.withAITexture&&(e["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...nb.emptyImage,name:"AI generated image"}),Ec(e,pm.prototype)},t.emptyData=function(){return{catelogs:new pm,materials:new pm,images:new pm,videos:new pm,colors:new pm,audios:new pm,fonts:new pm,variables:new wm,lib:lb.defaultData()}},t.defaultVariables=function(t){switch(t){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let e=[0,0,0];return{name:"Time",value:{textValue:e,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:e,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",t)}},t.getFormattedTimerTime=function(t,e){if("HH:mm:ss"===e.format){let e=Math.floor(t/3600),r=Math.floor((t-3600*e)/60);return{textValue:[e,r,Math.round(t-3600*e-60*r)]}}if("mm:ss"===e.format){let e=Math.floor(t/60);return{textValue:[e,Math.round(t-60*e)]}}return t="number"===e.format?Math.round(t):Math.round(1e3*t)/1e3}})(cb||(cb={})),(t=>{t.list=["idle","move","jump","run"]})(hb||(hb={})),(t=>{t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new wm,move:new wm,jump:new wm,run:new wm},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Vg.fromHexAndA(3728051,1)}}})(db||(db={}));var Pb=180/Math.PI;function Cb(t){t.rotation=t.rotation.slice(0,3).map((t=>t*Pb))}function kb(t){Cb(t),"Page"===t.type&&Cb(t.camera),t.states?.forEach((t=>{void 0===t.rotation||null===t.rotation||(t.rotation=t.rotation.slice(0,3).map((t=>t*Pb)))}));let e=t.geometry;e&&"SphereGeometry"===e.type&&(e.thetaLength=(e.thetaLength??180)*Pb),e&&"TorusGeometry"===e.type&&(e.arc=e.arc*Pb),e&&"PathGeometry"===e.type&&(e.extrusion.angle*=Pb,e.extrusion.twist*=Pb),"Mesh"===t.type&&"TextGeometry"===t.geometry.type&&(t.geometry.text={textValue:t.geometry.text}),Array.isArray(ef(t.events))&&t.events?.forEach((t=>{("MouseDown"===t.type||"MouseUp"===t.type||"MousePress"===t.type||"KeyDown"===t.type||"KeyUp"===t.type||"KeyPress"===t.type||"Collision"===t.type||"Trigger"===t.type)&&(t.runMode=t.toggle?"Toggle":"Once")}))}var Db,Lb=107;function Rb(t,e){e(t.data);for(let r of t.children)Rb(r,e)}function Ob(t){let e=t.schema??104;e!==Lb&&e<105&&(Rb(t.asset,kb),t.schema=105)}function Ib(t){let e=t.schema??0;if(e!==Lb){console.warn("updating from ",e,"to ",Lb),Ab(t,e),e<100&&(void 0===t.scene.publish.joystickSizeAndXYOffset&&(t.scene.publish.joystickSizeAndXYOffset=Zv.defaultData.joystickSizeAndXYOffset),t.schema=100),e<101&&(gb(t,Tb),fb(t,Tb),t.schema=101),e<102&&(function(t){t.scene.objects.traverse(((t,e)=>{let r=e.geometry;r&&"PathGeometry"===r.type&&(r.extrusion.capType="flat",r.extrusion.bevel=50,r.extrusion.bevelSides=6,"Custom"===r.extrusion.shape.type&&(r.extrusion.shape.shapeQuality="low"))}))}(t),t.schema=102),e<104&&(t.shared.catelogs=new pm,t.shared.lib=lb.defaultData(),t.schema=104),e<105&&(function(t){t.shared.variables=Ec({},pm.prototype)}(t),t.scene.objects.traverse(((t,e)=>{kb(e)})),t.schema=105);for(let e of Object.values(t.shared.lib.components))Ob(e);e<106&&(function(t){let e=ef(t.shared.variables);t.shared.variables=Ec(Object.entries(e??{}).map((([t,e],r)=>({fi:r,id:t,data:e}))),wm.prototype)}(t),t.schema=106),e<107&&(t.shared.lib.variables=lb.defaultData().variables,t.schema=107)}}(t=>{t.defaultData={schema:Lb,scene:eb.defaultData,frames:(new pm).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rb.defaultData),shared:{...cb.emptyData(),colors:cb.defaultColors()}},t.emptyDataForImports=function(t){let e=eb.emptyDataWithPage(t);return{schema:Lb,scene:e,frames:(new pm).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rb.defaultData),shared:{...cb.emptyData(),colors:cb.defaultColors(),images:cb.defaultImages(t)}}},t.emptyData=function(){return{schema:Lb,scene:eb.emptyDataWithPage(),frames:(new pm).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rb.defaultData),shared:cb.emptyData()}},t.collabHelper={...Pm,updateSchema:t=>(t.schema??0)<Lb?tf(t,Ib):(t.schema??0)-Lb},t.updateSchemaDirectly=function(e){let r=t.collabHelper.updateSchema(e);return"number"==typeof r?0===r?e:null:r.data},t.withoutLib=function(t){return{...t,shared:{...t.shared,lib:lb.defaultData()}}},t.getComponentData=function(t,e){let r=t.scene.objects.get(e);if(r&&"Component"===r.data.type)return r;{let r=t.shared.lib.components[e];if(r)return r.asset}}})(Db||(Db={}));var Nb=lc(hc()),zb=.5*(Math.sqrt(3)-1),Fb=(3-Math.sqrt(3))/6,Ub=1/6,Bb=(Math.sqrt(5),Math.sqrt(5),t=>0|Math.floor(t)),Vb=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),jb=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function Gb(t=Math.random){let e=Hb(t),r=new Float64Array(e).map((t=>Vb[t%12*2])),n=new Float64Array(e).map((t=>Vb[t%12*2+1]));return function(t,i){let a,o,s=0,l=0,c=0,h=(t+i)*zb,d=Bb(t+h),p=Bb(i+h),u=(d+p)*Fb,m=t-(d-u),f=i-(p-u);m>f?(a=1,o=0):(a=0,o=1);let g=m-a+Fb,v=f-o+Fb,b=m-1+2*Fb,y=f-1+2*Fb,x=255&d,_=255&p,w=.5-m*m-f*f;if(w>=0){let t=x+e[_];w*=w,s=w*w*(r[t]*m+n[t]*f)}let S=.5-g*g-v*v;if(S>=0){let t=x+a+e[_+o];S*=S,l=S*S*(r[t]*g+n[t]*v)}let E=.5-b*b-y*y;if(E>=0){let t=x+1+e[_+1];E*=E,c=E*E*(r[t]*b+n[t]*y)}return 70*(s+l+c)}}function Hb(t){let e=new Uint8Array(512);for(let t=0;t<256;t++)e[t]=t;for(let r=0;r<255;r++){let n=r+~~(t()*(256-r)),i=e[r];e[r]=e[n],e[n]=i}for(let t=256;t<512;t++)e[t]=e[t-256];return e}var Wb,qb=new Sr,$b=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||3!==e.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let r=0;r<t.count;r+=3){let n=1;qb.a.fromBufferAttribute(t,r),qb.b.fromBufferAttribute(t,r+1),qb.c.fromBufferAttribute(t,r+2),n*=qb.getArea(),e[r/3]=n}this.distribution=new Float32Array(t.count/3);let r=0;for(let t=0;t<e.length;t++)r+=e[t],this.distribution[t]=r;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let r=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*r);return this.sampleFace(n,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,r=0,n=e.length-1,i=-1;for(;r<=n;){let a=Math.ceil((r+n)/2);if(0===a||e[a-1]<=t&&e[a]>t){i=a;break}t<e[a]?n=a-1:r=a+1}return i}sampleFace(t,e,r){let n=this.randomFunction(),i=this.randomFunction();return n+i>1&&(n=1-n,i=1-i),qb.a.fromBufferAttribute(this.positionAttribute,3*t),qb.b.fromBufferAttribute(this.positionAttribute,3*t+1),qb.c.fromBufferAttribute(this.positionAttribute,3*t+2),e.set(0,0,0).addScaledVector(qb.a,n).addScaledVector(qb.b,i).addScaledVector(qb.c,1-(n+i)),qb.getNormal(r),this}},Xb=lc(dc()),Yb=new Be,Zb=new Be,Kb=new Be;(t=>{t.is=function(t){return t&&t.__isSPEObject}})(Wb||(Wb={}));var Jb,Qb=t=>class extends t{constructor(){super(...arguments),this.previousModelViewMatrix=new Be,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Be,this.matrixWorldRigid=new Be,this.shearScale=new Be,this.shearScaleInv=new Be}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof dr&&(t=t.uuid);let e=this;for(;e.parent;){if(e.parent.uuid===t)return!0;e=e.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let e of this.children)e.updateMatrixWorld(t)}updateWorldMatrix(t,e){let r=this.parent;if(t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),e)for(let t of this.children)t.updateWorldMatrix(!1,!0)}traverseChildren(t,e=0){for(let r of this.children)Wb.is(r)&&r.traverseObject(t,e+1)}traverseObject(t,e=0){if(!0!==t(this,e))for(let r of this.children)Wb.is(r)&&r.traverseObject(t,e+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,e=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:r,v:n,q:i}=(0,Xb.SVD)(e),a=Yb.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),o=Zb.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=Kb.copy(o).transpose();this.shearScale.makeScale(i[0],i[1],i[2]).multiply(s).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,s).copyPosition(this.matrixWorld),i.every((t=>Math.abs(i[0]-t)<.01))?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,e){this.updateWorldMatrix(!0,!1);let r=(new Be).copy(this.matrixWorld).invert();return null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),r.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Be?t.hiddenMatrix.premultiply(r):t.applyMatrix4(r),t.updateWorldMatrix(!1,!1),this.add(t),void 0!==e&&(this.children.pop(),this.children.splice(e,0,t)),this}copy(t,e=!1){return super.copy(t,e),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,e,r,n,i,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},ty=class extends(Qb(dr)){},ey=class extends ty{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,e){}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let r=this.children[t];r?.object!==e&&(r&&this.remove(r),r=new ey(e),this.add(r),this.children.splice(t,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=e.matrix,r.hiddenMatrix=e.hiddenMatrix),r.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){return void 0!==this.playModeVisible?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&!0===this.object.dataPatched.cloner?.hideBase}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return(t=>"Mesh"===t.type)(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},ry=new he,ny=new he,iy=new Be,ay=[new he(-1,1,1),new he(-1,-1,1),new he(1,-1,1),new he(1,1,1),new he(-1,1,-1),new he(-1,-1,-1),new he(1,-1,-1),new he(1,1,-1)],oy=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],sy=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],ly=(t,e,r)=>{t.updateEntityBoxSize(ry,ny),iy.copy(e).multiply(t.matrixWorld),0===ny.x&&0===ny.y&&0===ny.z?r.push(new he(ry.x,ry.y,ry.z).applyMatrix4(iy)):ay.forEach((t=>{r.push(t.clone().multiply(ny).add(ry).applyMatrix4(iy))}))},cy=class extends ue{constructor(){super(...arguments),this.matrix=new Be,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map((t=>t.clone())),this.faces=t.faces.map((t=>t.clone())),this.edges=t.edges.map((t=>t.clone())),this.centerEdges=t.centerEdges.map((t=>t.clone())),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let r=(new Be).copy(t.matrixWorld).invert();return this.expandByObjectSize(t,r,e)}expandByObjectSize(t,e,r=!1){let n=[];return!0===r?t.traverseEntity((t=>{if(t.visible||t.cloner&&t.data.visible){if(!("geometry"in t))return void n.push(new he);ly(t,e,n)}})):ly(t,e,n),this.setFromPoints(n)}getCenter(t){return(t=super.getCenter(t)).applyMatrix4(this.matrix),t}getPositionToCenter(t){return(t=super.getCenter(t)).applyMatrix4(iy.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(ny).multiplyScalar(.5),this.getCenter(ry),iy.copy(this.matrix).setPosition(ry),this.vertices=ay.map((t=>t.clone().multiply(ny).applyMatrix4(iy)))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=oy.map((([t,e])=>new Ul(this.vertices[t],this.vertices[e]))),this.centerEdges=this.edges.map((t=>t.getCenter(new he)))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=sy.map((([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5)))}},hy={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},dy=class extends ns{constructor(){super()}getPoints(t=12){let e,r=[],n=this.getCurveLengths(),i=n[n.length-1]/n.length;for(let a=0,o=this.curves;a<o.length;a++){let s=o[a],l=0===a?n[a]:n[a]-n[a-1],c=Math.ceil(t*l/i),h=s.getPoints(c);for(let t=0;t<h.length;t++){let n=h[t];e&&e.equals(n)||(r.push(n),e=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}},py=.001;function uy(t,e,r){return e.clone().sub(t).cross(e.clone().sub(r)).length()<=py}function my(t,e){let r=new he(...t.position),n=new he(...t.controlNext.position),i=new he(...e.controlPrevious.position),a=new he(...e.position);return uy(r,n,a)&&uy(r,i,a)}function fy(t){let e=t.points.map((t=>new he(...t.data.position))),r=[t.points[0]],n=new he(...r[0].data.position);for(let i=0;i<t.points.length-1;i++)uy(n,e[i],e[i+1])||(r.push(t.points[i]),n=e[i]);r.push(t.points[t.points.length-1]);let i=t.isClosed,a=r.length-(i?0:1),o=r.length,s=[];for(let e=0;e<o;e++){let n=r[e].data,a=new he(...n.position),l=new he(...n.controlPrevious.position),c=new he(...n.controlNext.position),h={position:a,baseRoundness:n.roundness,controlPrevious:l,controlNext:c};if(0===n.roundness||!t.isClosed&&(0===e||e===o-1)){s[e]={...h,removedLength:0};continue}let d=i&&e==o-1?0:e+1,p=r[i&&0==e?o-1:e-1].data,u=r[d].data,m=new he(...p.position),f=new he(...u.position),g=m.clone().sub(a).normalize(),v=f.clone().sub(a).normalize();Object.assign(h,{prevDir:g,nextDir:v});let b=my(p,n),y=my(n,u);if(b&&y){let t=g.clone().add(v).normalize(),r=t.clone().cross(g).length()/g.dot(t);s[e]={...h,tan:r,removedLength:n.roundness/r}}else s[e]={...h,removedLength:0}}for(let t=0;t<a;t++){let e=i&&t===o-1?0:t+1,r=s[t],n=s[e];if(0!==r.removedLength||0!==n.removedLength){let t=r.position.distanceTo(n.position);r.removedLength=Math.min(r.removedLength,t/2),n.removedLength=Math.min(n.removedLength,t/2)}}let l=[];for(let t=0;t<a;t++){let e=t,n=i&&t===o-1?0:t+1,a=s[e],c=s[n],h=null;if(my(r[e].data,r[n].data)){let t=a.position.clone(),e=c.position.clone();(0!==a.removedLength||0!==c.removedLength)&&(a.nextDir&&t.add(a.nextDir.clone().setLength(a.removedLength)),c.prevDir&&e.add(c.prevDir.clone().setLength(c.removedLength))),t.distanceTo(e)>py&&(h=new Zo(t,t.clone().lerp(e,.3),e.clone().lerp(t,.3),e))}else a.position.distanceTo(c.position)>py&&(h=new Zo(a.position,a.controlNext,c.controlPrevious,c.position));l[2*t+1]=h}for(let t=0;t<o;t++){let e=s[t];if(0===e.removedLength){l[2*t]=null;continue}let r=e.position,n=e.prevDir.clone().multiplyScalar(e.removedLength).add(r),i=e.nextDir.clone().multiplyScalar(e.removedLength).add(r),a=e.tan*e.removedLength,o=e.prevDir.clone().add(e.nextDir).normalize(),c=n.clone().lerp(i,.5),h=n.distanceTo(i)/2,d=o.clone().multiplyScalar(Math.sqrt(Math.pow(a,2)-Math.pow(h,2))).add(c),p=o.clone().multiplyScalar(-a).add(d),u=r.distanceTo(p)/r.distanceTo(c),m=e.prevDir.clone().multiplyScalar(u*r.distanceTo(n)).add(r),f=m.clone().lerp(p,2),g=n.clone().lerp(m,4/3),v=i.clone().lerp(f,4/3);l[2*t]=new Zo(n,g,v,i)}let c=new dy;return l.forEach((t=>{t&&c.add(t)})),c}(t=>{t.is=function(t){return t&&t.__isEntity}})(Jb||(Jb={}));var gy=t=>Jb.is(t),vy={type:"completeState",isfromEntity:!0},by=["x","y","z"],yy=new he,xy=(new he).set(0,1,0),_y=t=>class extends(Qb(t)){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new cy,this._recursiveBBox=new cy,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let e=this.children[t];if(Jb.is(e))return e}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Jb.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return"string"==typeof this.identity}get isVirtualEntity(){return"string"!=typeof this.identity}get isInstanceRoot(){return this.isConcreteEntity&&"Instance"===this.data.type}nearestInstanceSelfOrParent(){let t=this;for(;"Instance"!==t.data.type;){let e=t.parent;if(!Jb.is(e))return;t=e}return t}forInstancesRec(t){this.instances.forEach((e=>{e.disposed||t(e),e.forInstancesRec(t)}))}super_Entity(t,e){"string"==typeof t&&(this.uuid=t),this.identity=t,this.data=e,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,e,r=!1){if(0!==this.data.states.length||r){for(let t of this.data.states)Xv.toOps(this.data,t.data).forEach((t=>{let r=Am.replaceProps(t,this.data);this.dataPatched=this.data,this.updateByPatchedOp(r,this.data,e)}));if(null!==t){let r=this.data.states.data(t);r&&(this.dataPatched=Xv.patch(this.data,r),Xv.toOps(this.data,r).forEach((t=>{this.updateByPatchedOp(t,this.dataPatched,e)})))}r&&this.updateTransformState(this.dataPatched,e),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,e){t.setScalar(0),e.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((t=>{gy(t)&&t.resetBBoxNeedsUpdateSelf()})),this.traverseEntity((t=>{t.resetBBoxNeedsUpdateSelf()}))}find(t){let e;return this.traverseEntity((r=>{r.uuid===t&&(e=r)})),e}traverseSortNextHelper(){let t=this.parent;if(t){let e=t.children,r=e.indexOf(this)+1;if(Jb.is(e[r]))return e[r];if(Jb.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Jb.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let e=this;for(;t>0&&null!==e;)e=e.parent,t-=1;return e}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let e=this.parent;for(;e;){if(t===e)return!0;e=e.parent}return!1}countToAccestor(t){let e=0,r=this;for(;r!==t;){if(null===r)return-1;r=r.parent,e+=1}return e}forEachEntity(t){for(let e of this.children)gy(e)&&t(e)}traverseEntityAncestors(t){this.traverseAncestors((e=>{Jb.is(e)&&t(e)}))}traverseConcreteEntity(t,e=0){if(!0!==t(this,e))for(let r of this.children)gy(r)&&r.isConcreteEntity&&r.traverseEntity(t,e+1)}traverseEntity(t,e=0){if(!0!==t(this,e))for(let r of this.children)gy(r)&&r.traverseEntity(t,e+1)}traverseVisibleEntity(t){t(this);for(let e of this.children)gy(e)&&e.visible&&e.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,e=!1){return super.copy(t,e),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some((t=>gy(t)))}isAncestorOf(t){if(this.uuid===t)return!1;let e=!1;return this.traverseEntity((r=>{r.uuid===t&&(e=!0)})),e}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let e={position:this.position.toArray(),rotation:[this.rotation.x*Rt.RAD2DEG,this.rotation.y*Rt.RAD2DEG,this.rotation.z*Rt.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return om(e,t)}getTransformValues(t,e,r){return e[t].map(((e,n)=>r?.shared.getVariable(e,[this.uuid,t,by[n]])??e))}updateTransformState(t,e){let r=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,e)),r=!0),t.rotation&&(yy.fromArray(this.getTransformValues("rotation",t,e)).multiplyScalar(Rt.DEG2RAD),this.rotation.setFromVector3(yy),r=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,e)),r=!0),void 0!==t.hiddenMatrix&&(r=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??zg.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((t=>{t.invalidateClonerTransform(this)}))),t.position&&t.rotation&&t.scale&&void 0!==t.hiddenMatrix&&this.updateWorldMatrix(!1,!0),r}onVariableUpdate(t=!1){t?this.resetBBoxNeedsUpdate():(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((t=>{t.invalidateClonerTransform(this)})))}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Jb.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach((t=>{Jb.is(t)&&t.disposeRecursively()}))}toState(t=[]){let e={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return om(e,t)}updateByObjUpdateOp(t,e){void 0!==t&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},e,!1)}updateByOp(t,e,r,n){let i=this.data;this.data=e;let a=t,o=rf(t.path,["states","*"]);if(null!==o){if(0===t.type){let[e]=o;if(this?.stateSelection===e){let e={...t.props};if(delete e.name,Object.values(t.props).some((t=>void 0===t))){let r=this.data;if(void 0!==r){let n=Zm.zoom(r,t.path.slice(2));if(n)for(let r in t.props)void 0===t.props[r]&&r in n&&(e[r]=n[r])}}a={...t,props:e,path:t.path.slice(2)}}}}else if(0===t.type){let e=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==e){if(void 0!==t.props.name&&e.name){let{name:t,...r}=e;e=r}if(void 0!==t.props.material&&"material"in e){let{material:t,...r}=e;e=r}let r=Zm.removeOverridden(t.path,t.props,e);a={...t,props:r}}}if(this.updateByPatchedOpBase(a,Xv.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r),rf(t.path,["overrides"])){let n=[],i=[...t.path];for(n.push(i[1]),i.splice(0,2);i.length>0&&"descendants"===i[0];)n.push(i[1]),i.splice(0,2);if(void 0===n[n.length-1]){if(0===t.type)for(let e of Object.keys(t.props)){n[n.length-1]=e;let i=r.scene.findInstance([this.uuid,...n]);i&&(i.overrideData=t.props[e],i.updateState(Em.apply(i.component.data,i.overrideData),r))}}else{let a=r.scene.findInstance([this.uuid,...n]);if(a){let o=Zm.zoom(a.component.data,i);if(0===(t={...t,path:i}).type){let e=t.props;if(o)for(let[r,n]of Object.entries(t.props))void 0===n&&(e===t.props&&(e={...t.props}),e[r]=o[r]);t={...t,props:e}}a.overrideData=Hv.resolve(e.overrides,n),a.updateByOp(t,Tm.applySimple(a.data,t),r,!1)}}}else if(this.instances.length>0){let n;if(0===t.path.length&&0===t.type){let e;for(let r of Wv.rootOverrideProps)r in t.props&&(void 0===e&&(e={}),e[r]=t.props[r]);e&&(n={...t,props:e})}else for(let e of Wv.rootOverrideProps)if(rf(t.path,[e])){n=t;break}void 0!==n&&this.instances.forEach((t=>{if(t.isInstanceRoot){let e=Em.filterOp(t.overrideData,n);e&&t.updateByOp(e,Tm.applySimple(t.data,e),r,!0)}})),this.instances.forEach((n=>{if(!n.isInstanceRoot){let a=Em.filterOp(n.overrideData,t);if(a){let o;o=i===n.data&&t===a?e:Tm.applySimple(n.data,a),n.updateByOp(a,o,r,!0)}}}))}}updateByPatchedOpBase(t,e,r){if(this.dataPatched=e,0===t.path.length&&0===t.type)void 0!==t.props.type&&!$g.is(t.props.type)&&hy.changeEntityProptotype(this,e,r);else if(1===t.path.length&&"geometry"===t.path[0]&&0===t.type&&"type"in t.props){hy.changeEntityProptotype(this,e,r);for(let t of this.children)Jb.is(t)&&t.updateVisible(r.scene)}this.updateByPatchedOp(t,e,r)}updateByPatchedOp(t,e,r){if(0===t.path.length&&0===t.type&&this.updateState(t.props,r),null!==rf(t.path,["pathSnapping"])&&this.updatePathSnapping(e.pathSnapping),null!==rf(t.path,["cloner"])){let n=Tm.drop(t,1);0===n.path.length&&0===n.type&&!0===n.props.disabled?this.setFromClonerState(null,r):this.cloner?this.cloner.updateState(e.cloner,r.scene):(this.setFromClonerState(e.cloner,r),this.expandCloner(r.scene)),this.updateVisible(r.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){let e=this._updatedPathSnapping?.pathId??this.dataPatched.pathSnapping.pathId,r=this._updatedPathSnapping?.slide??this.dataPatched.pathSnapping.slide??0,n=this._updatedPathSnapping?.offset??this.dataPatched.pathSnapping.offset??0,i=this._updatedPathSnapping?.orientation??this.dataPatched.pathSnapping.orientation;if(null===e)return;let a=t.find(e);if(!a||!1===this._needApplyPathSnapping)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let s=fy(o.geometry.path),l=(r+n)%1;r+n===1&&0===l&&(l=1);let c=s.getPointAt(l),h=this.parent?this.parent?.matrixWorld:new Be;a.updateMatrixWorld();let d=(new Be).multiplyMatrices(h.clone().invert(),a.matrixWorld);c.applyMatrix4(d);let p={position:c.toArray(),rotation:o.rotation};if("tangential"===i){let t=(new Be).extractRotation(a.matrixWorld),e=s.getTangentAt(l).applyMatrix4(t).add(c),r=(new Be).lookAt(c,e,xy),n=yy.setFromEuler((new Ze).setFromRotationMatrix(r)).multiplyScalar(Rt.RAD2DEG);p={...p,rotation:n.toArray()}}this.updateTransformState(p),this.traverseEntity((t=>{t._cameraType&&t.dispatchEvent(vy)}))}updateVisible(t){if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||!0!==this.dataPatched.cloner?.hideBase),!t)return;let e=!1;this.traverseEntity((t=>{if("Splat"===t.data.type)return e=!0,!0})),e&&t.reloadSplats()}updateState_Entity(t,e){void 0!==t.name&&(this.name=t.name),void 0!==t.raycastLock&&(this.raycastLock=t.raycastLock),void 0!==t.visible&&(this.updateVisible(e?.scene),this.resetBBoxNeedsUpdate()),e&&"cloner"in t&&void 0!==t.cloner&&(this.setFromClonerState(t.cloner,e),this.updateVisible(e.scene)),this.updateTransformState(t,e)}get attachedSurfaceCloners(){return this.children.filter((t=>t instanceof hy.Cloner&&"toObject"===t.parameters.type))}setFromClonerState(t,e){this.disposed||(null===t||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):void 0===this.cloner?(this.cloner=new hy.Cloner(this,t),e.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,e.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}};function wy(t,e,r){r.x=t.x*e.x,r.y=t.y,r.z=t.x*e.y}function Sy(t){return new Ot(t.y,-t.x)}var Ey=class extends qr{constructor(t,e,r,n,i,a,o,s,l,c,h,d,p=!1){super(),this.type="RoundedCylinderBufferGeometry",t=void 0!==t?t:1,e=void 0!==e?e:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI,a&&(l=0,c=0);let u=[],m=[],f=[],g=[],v=0,b=r/2,y=new he,x=new he;p&&0==t&&(t=l),p&&0==e&&(e=c);let _=new Ot(t,b),w=new Ot(e,-b),S=null,E=null,M=null,A=null,T=_.clone().sub(w),P=0,C=0,k=0;d>0&&(P=Math.min(t,e)*(1-d),C=t-P,k=e-P);let D=_.clone();D.x-=P;let L=Math.PI-T.angle(),R=T.angle(),O=Math.tan(R/2),I=Math.tan(L/2),N=O+I,z=d?N:I,F=d?N:O;if(l=Math.min(l,(t-C)/z,T.length()/N),c=Math.min(c,(e-k)/F,T.length()/N),l>0){let t=l/O;S=_.clone().sub(new Ot(t,l)),d&&(M=S.clone(),M.x-=P-N*l),_.sub(T.clone().setLength(t))}if(c>0){let t=c/I;E=w.clone().sub(new Ot(t,-c)),w.add(T.clone().setLength(t)),d&&(A=E.clone(),A.x-=P-N*c,D.sub(T.clone().setLength(t)))}T=_.clone().sub(w);let U=T.length()<.5,B=[];for(let h=0;h<=n;h++){let p=[],u=h/n,b=u*s+o,_=new Ot(Math.sin(b),Math.cos(b));if(A&&E?(V(p,u,_,L,c,A,-1,!0),V(p,u,_,R,c,E,-1,!1)):E?(j(p,_,E.x,0,-1),V(p,u,_,R,c,E,-1,!1)):a||j(p,_,e,k,-1),wy(Sy(T).normalize(),_,y),!U)for(let t=0;t<=i;t++){let e=t/i;wy(T.clone().multiplyScalar(e).add(w),_,x),m.push(x.x,x.y,x.z),f.push(y.x,y.y,y.z),g.push(u,.5+x.y/r),p.push(v++)}if(M&&S?(V(p,u,_,L,l,S,1,!1),V(p,u,_,R,l,M,1,!0)):S?(V(p,u,_,L,l,S,1,!1),j(p,_,S.x,0,1)):a||j(p,_,t,C,1),d&&!U){wy(Sy(T).multiplyScalar(-1).normalize(),_,y);for(let t=0;t<=i;t++){let e=t/i;wy(T.clone().multiplyScalar(-e).add(D),_,x),m.push(x.x,x.y,x.z),f.push(y.x,y.y,y.z),g.push(u,.5+x.y/r),p.push(v++)}}d&&!a&&p.push(p[0]),B.push(p)}for(let t=0;t<B.length-1;t++)for(let e=0;e<B[0].length-1;e++){if(a&&d&&e==i)continue;let r=B[t][e],n=B[t+1][e],o=B[t+1][e+1],s=B[t][e+1],l=m[3*o+0],c=m[3*o+2];u.push(r,n,s),(0!=l||0!=c)&&u.push(n,o,s)}function V(t,e,n,i,a,o,s,l){for(let c=0;c<h+1;c++){let d=c/h,p=s<0?d:1-d;l&&(p-=1),p*=i;let u=new Ot(Math.sin(p),Math.cos(p)*s);wy(u.clone().multiplyScalar(a).add(o),n,x),m.push(x.x,x.y,x.z),wy(u,n,y),f.push(y.x,y.y,y.z),g.push(e,.5+x.y/r),t.push(v++)}}function j(t,e,r,n,i){let a=new he,o=new Ot,s=[r,n];i<0&&s.reverse();for(let r of s)o.set(r,b*i),wy(o,e,a),m.push(a.x,a.y,a.z),f.push(0,i,0),g.push(.5,.5),t.push(v++)}function G(r,n,i){let a=new Ot(Math.sin(i),Math.cos(i)),o=new Ot(-Math.cos(i),Math.sin(i)),s=new he,l=r<0?(t,e,r)=>u.push(t,e,r):(t,e,r)=>u.push(t,r,e);wy(new Ot((t+e+C+k)/4,0),a,s),m.push(s.x,s.y,s.z),f.push(o.x,0,o.y),g.push(.5,.5);let c=v++;for(let t of n){let e=m.slice(3*t,3*t+3);m.push(...e),f.push(o.x,0,o.y);let r=g.slice(2*t,2*t+2);g.push(...r),v++}for(let t=c+1;t<v-1;t++)l(c,t,t+1);l(c,v-1,c+1)}s<2*Math.PI&&(G(-1,B[0],o),G(1,B[B.length-1],o+s)),this.setIndex(u),this.setAttribute("position",new Fr(m,3)),this.setAttribute("normal",new Fr(f,3)),this.setAttribute("uv",new Fr(g,2))}},My=Math.PI/2,Ay=class extends qr{constructor(t=1,e=1,r=1,n=1,i=1,a=1,o=0,s=4){super(),this.type="BoxGeometry";let l=this;n=Math.floor(n),i=Math.floor(i),a=Math.floor(a),s=Math.floor(s),o=Math.min(o,t/2,e/2,r/2);let c=[],h=[],d=[],p=[],u=0,m=0;function f(t,e,r,n,i,a,s,f,g,v,b){let y=(a-2*o)/g,x=(s-2*o)/v,_=a/2-o,w=s/2-o,S=f/2,E=g+1,M=v+1,A=0,T=0,P=new he;for(let a=0;a<M;a++){let o=a*x-w;for(let s=0;s<E;s++){let l=s*y-_;P[t]=l*n,P[e]=o*i,P[r]=S,h.push(P.x,P.y,P.z),P[t]=0,P[e]=0,P[r]=f>0?1:-1,d.push(P.x,P.y,P.z),p.push(s/g),p.push(1-a/v),A+=1}}for(let t=0;t<v;t++)for(let e=0;e<g;e++){let r=u+e+E*t,n=u+e+E*(t+1),i=u+(e+1)+E*(t+1),a=u+(e+1)+E*t;c.push(r,n,a),c.push(n,i,a),T+=6}l.addGroup(m,T,b),m+=T,u+=A}function g(t,e,r,n,i,a,f,g,v,b,y){let x=(f-2*o)/b,_=f/2-o,w=g/2-o,S=v/2,E=b+1,M=0,A=0,T=new he,P=new he;for(let l=0;l<s+1;l++){let c=l/s*My,u=Math.sin(c)*o,m=(1-Math.cos(c))*o,f=Math.sin(c),g=Math.cos(c);T[e]=(w+u)*i,T[r]=(S-m)*a,P[t]=0,P[e]=f*Math.sign(T[e]),P[r]=g*Math.sign(T[r]);for(let e=0;e<E;e++){let r=e*x-_;T[t]=r*n,h.push(T.x,T.y,T.z),d.push(P.x,P.y,P.z),p.push(e/b),p.push(0),M+=1}}for(let t=0;t<s;t++)for(let e=0;e<b;e++){let r=u+e+E*t,n=u+e+E*(t+1),i=u+(e+1)+E*(t+1),a=u+(e+1)+E*t;c.push(r,n,a),c.push(n,i,a),A+=6}l.addGroup(m,A,y),m+=A,u+=M}function v(n,i,a){let l=new he,m=new he(t/2,e/2,r/2);m.subScalar(o);let f=[],g=n*i*a>0?(t,e,r)=>c.push(t,e,r):(t,e,r)=>c.push(t,r,e);for(let t=0;t<=s;t++){let e=[],r=My*(1-t/s),c=Math.cos(r),g=Math.sin(r),v=0;for(let r=0;r<=t;r++){let r=Math.cos(v),s=Math.sin(v);l.x=c*r,l.y=g,l.z=c*s;let f=m.clone().addScaledVector(l,o);h.push(n*f.x,i*f.y,a*f.z),d.push(n*l.x,i*l.y,a*l.z),p.push(0,0),e.push(u++),v+=My/t}f.push(e)}let v=f.length-1;for(let t=0;t<v;t++){let e=f[t],r=f[t+1],n=e.length-1;g(e[0],r[1],r[0]);for(let t=1;t<=n;t++)g(e[t-1],e[t],r[t]),g(e[t],r[t+1],r[t])}}f("z","y","x",-1,-1,r,e,t,a,i,0),f("z","y","x",1,-1,r,e,-t,a,i,1),f("x","z","y",1,1,t,r,e,n,a,2),f("x","z","y",1,-1,t,r,-e,n,a,3),f("x","y","z",1,-1,t,e,r,n,i,4),f("x","y","z",-1,-1,t,e,-r,n,i,5),o>0&&(g("z","y","x",-1,-1,1,r,e,t,a,0),g("z","y","x",1,-1,-1,r,e,t,a,1),g("z","y","x",-1,1,-1,r,e,t,a,1),g("z","y","x",1,1,1,r,e,t,a,0),g("x","y","z",-1,-1,-1,t,e,r,n,0),g("x","y","z",1,-1,1,t,e,r,n,1),g("x","y","z",-1,1,1,t,e,r,n,0),g("x","y","z",1,1,-1,t,e,r,n,1),g("y","x","z",-1,-1,1,e,t,r,i,0),g("y","x","z",1,-1,-1,e,t,r,i,1),g("y","x","z",1,1,1,e,t,r,i,1),g("y","x","z",-1,1,-1,e,t,r,i,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new Fr(h,3)),this.setAttribute("normal",new Fr(d,3)),this.setAttribute("uv",new Fr(p,2))}},Ty=class extends qr{constructor(t=[],e=[],r="",n=1,i=.2,a=4){super(),this.type="PolyhedronGeometryRound";let o=[],s=[],l=[];return function(){0==(i=Math.min(.99999,i))&&(a=0);let s={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],c=new he,h=c.clone(),d=new Sr,p=i*n,u=n-p,m=a+1,f=new he,g=(t,e)=>f.subVectors(t,e).normalize(),v=(t,e)=>Array(t).fill(void 0).map(e),b=v(t.length/3,((e,r)=>(new he).fromArray(t,3*r).setLength(n))),y=[],x=1e6;for(let t=0;t<b.length;t++){let r,n,i,a=b[t],o=[],s=1e10,l=-1;for(;-1!=(l=e.indexOf(t,l+1));){let t=l-l%3;r=e[t+(l+1)%3],n=e[t+(l+2)%3],i=a.distanceToSquared(b[r]),s=Math.min(s,i),o.push([r,n,i])}s+=1e-6;let c=[],h=0,d=o.length;for(let e=0;e<d;e++){[r,n,i]=o[h];let e=1==y[r]?.includes(t);i<=s&&c.push(r+ +e*x),h=o.findIndex((t=>t[0]==n))}y.push(c)}let _=[];{let t,e,r=0,n=0,i=3==s;for(let o=0;o<=a;o++){t=o*(o+1)/2,e=(o+1)*(o+2)/2;for(let s=0;s<a-o;s++)[r,n]=[t+s+o+2,e+s+o+3],_.push(t,e,...i?[n,t]:[r,e],n,r),[t,e]=[r,n];_.push(t,e,t+a+2)}}let w=c.clone(),S=c.clone(),E=c.clone(),M=c.clone(),A=c.clone(),T=[],P=v(b.length,(()=>v(s,(()=>c.clone()))));for(let t=0;t<b.length;t++){c.copy(b[t]).normalize(),w.copy(c).multiplyScalar(u);let e=y[t];for(let r=0;r<e.length;r++){let n=e[r],i=e[(r+1)%s];d.setFromPointsAndIndices(b,t,n%x,i%x),d.b.sub(d.a).setLength(1e10).add(d.a),d.c.sub(d.a).setLength(1e10).add(d.a),d.closestPointToPoint(w,P[t][r])}let r=[],n=[],i=[],v=new he;0==a&&[...P[t]].reduce(((t,e)=>t.add(e)),v).multiplyScalar(1/s);for(let e=0;e<s;e++){let o=[],l=(e-1+s)%s,d=P[t][l],b=P[t][e];c.copy(d).sub(w),h.copy(b).sub(w);let y=w.angleTo(c),x=c.angleTo(h),_=Math.cos(y)*p;0==a?S.copy(v):S.copy(w).setLength(u+_),n.push(_);let T=[S,d,b];for(let t=0;t<2;t++){let e=T[t],n=T[t+1];M.subVectors(e,w),A.subVectors(n,w),E.crossVectors(M,A).normalize();for(let n=0;n<m;n++){let i=[y,x][t]*n/m;c.copy(M).applyAxisAngle(E,i).add(w),r.push(c.clone()),t&&(g(c,w),o.push([0==n?e:c.clone(),f.clone()]))}t&&(g(n,w),o.push([n,f.clone()]))}i.push(o)}T.push(i);let C=2*m,k=2;for(let t=0;t<s;t++){let e=C*t,i=C*((t+1)%s),a=[r[e]];for(let o=1;o<m;o++){M=r[e+o],A=r[i+o],a.push(M);for(let e=1,r=o-k+1;e<=r;e++)c.lerpVectors(M,A,e/(r+1)),c.sub(w).setLength(n[t]).add(w),a.push(c.clone());a.push(A)}for(let t=0;t<m;t++)a.push(r[t+m+e]);a.push(r[i+m]);let h=_.map((t=>a[t]));o.push(...h.map((t=>[t.x,t.y,t.z])).flat()),l.push(...h.map((t=>(g(t,w),[f.x,f.y,f.z]))).flat())}}let C=[];for(let t=0;t<y.length;t++)for(let e=0;e<s;e++){let r=y[t][e];if(r<x){let n=y[r].findIndex((e=>e%x==t)),i=T[t][e],a=T[r][n];for(let t=0;t<m;t++){let e=i[t],r=a[m-t],n=i[t+1];[e,r,n,n,r,a[m-(t+1)]].forEach((t=>{o.push(t[0].x,t[0].y,t[0].z),l.push(t[1].x,t[1].y,t[1].z)}))}C.push(i[0][0],a[m][0],i[m][0],a[0][0])}}for(;C.length;){let t,e,r,n;[t,e]=C.splice(0,2);let i=[t];for(;t!=e;)i.push(e),r=C.indexOf(e),n=r%2,e=C.splice(r-n,2)[1-n];f.subVectors(i[0],i[1]).cross(c.subVectors(i[0],i[2])).normalize();let a=f.dot(i[0])<0;a&&f.negate();for(let t=1;t<=i.length-2;t++)[i[t+ +a],i[t+1-+a],i[0]].forEach((t=>{o.push(t.x,t.y,t.z),l.push(f.x,f.y,f.z)}))}}(),function(){let t=new he;for(let e=0;e<o.length;e+=3){t.x=o[e+0],t.y=o[e+1],t.z=o[e+2];let r=d(t)/2/Math.PI+.5,n=p(t)/Math.PI+.5;s.push(r,1-n)}let e=new he,r=new he,n=new he,i=new he,a=new Ot,l=new Ot,c=new Ot,h=(t,e,r,n)=>{n<0&&1===t.x&&(s[e]=t.x-1),0===r.x&&0===r.z&&(s[e]=n/2/Math.PI+.5)};for(let t=0,p=0;t<o.length;t+=9,p+=6){e.set(o[t+0],o[t+1],o[t+2]),r.set(o[t+3],o[t+4],o[t+5]),n.set(o[t+6],o[t+7],o[t+8]),a.set(s[p+0],s[p+1]),l.set(s[p+2],s[p+3]),c.set(s[p+4],s[p+5]),i.copy(e).add(r).add(n).divideScalar(3);let u=d(i);h(a,p+0,e,u),h(l,p+2,r,u),h(c,p+4,n,u)}for(let t=0;t<s.length;t+=6){let e=s[t+0],r=s[t+2],n=s[t+4],i=Math.max(e,r,n),a=Math.min(e,r,n);i>.9&&a<.1&&(e<.2&&(s[t+0]+=1),r<.2&&(s[t+2]+=1),n<.2&&(s[t+4]+=1))}function d(t){return Math.atan2(t.z,-t.x)}function p(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}}(),this.setAttribute("position",new Fr(o,3)),this.setAttribute("normal",new Fr(l,3)),void this.setAttribute("uv",new Fr(s,2))}static fromJSON(t){return new Ty(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},Py=class extends Ty{constructor(t=1,e=.2,r=4){let n=(1+Math.sqrt(5))/2,i=1/n,a="DodecahedronGeometry";super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,t,e,r),this.type=a}static fromJSON(t){return new Py(t.radius,t.corner,t.cornerSides)}},Cy=1e-12,ky=class{constructor(t){this.position=new Ot,this.startPosition=new Ot,this.uuid=Rt.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new ky(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},Dy=class extends ky{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new Dy(this.parent).copy(this)}},Ly=class extends ky{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new Dy(this),new Dy(this))}static create(t,e){let r=new Ly(t,new Ot(...e.position));return r.controls[0].position.set(...e.controlPrevious.position),r.controls[1].position.set(...e.controlNext.position),r.roundness=e.roundness,r.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,r}getOppositeControl(t){let e=this.controls.indexOf(t);return 0===e?this.controls[1]:1===e?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let r=0,n=this.controls.length;r<n;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=e?n.position.copy(this.position):n.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new Ly(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){let t=this.curveBefore?.getTangentAt(1),e=this.curveAfter?.getTangentAt(0);return[t,e]}computeNormals(t=new Ot,e=new Ot){let[r,n]=this.computeTangents();return r&&n&&(Ry(r,t),Ry(n,e)),[t,e]}computeTangent(t=new Ot){let[e,r]=this.computeTangents();return e&&r&&t.copy(e).add(r).normalize(),t}computeNormal(t=new Ot){let[e,r]=this.computeNormals();return t.copy(e).add(r).normalize(),t}};function Ry(t,e=new Ot){let r=t.length();return e.set(-t.y/r,t.x/r)}var Oy=new Ot,Iy=new Ot,Ny=new Ot,zy=new Ot,Fy=new Ot,Uy=new Ot,By=new he,Vy=new he;function jy(t){let e=new Ot;e.addVectors(t.v0,Oy.subVectors(t.v1,t.v0).multiplyScalar(2/3));let r=new Ot;return r.addVectors(t.v2,Iy.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new Yo(t.v0,e,r,t.v2)}function Gy(t,e,r=Number.EPSILON){return Math.abs(t-e)<r}function Hy(t,e,r=Number.EPSILON){return t.distanceTo(e)<r}function Wy(t,e,r=Number.EPSILON){return t.distanceTo(e)<r}function qy(t,e,r){let n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),i=Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2)),a=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2));return Math.acos((i*i+n*n-a*a)/(2*i*n))}function $y(t,e,r){return Qy(t,e)&&Qy(e,r)&&Xy(t.position,e.position,r.position)}function Xy(t,e,r){return 0===Oy.copy(e).sub(t).cross(Iy.copy(r).sub(t))}function Yy(t,e,r,n,i){let a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,s=(t.x+e.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(t.y-e.y)/a,c=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(e.x-t.x)/a;return n.set(s+l,o+c),i.set(s-l,o-c),[n,i]}function Zy(t,e,r){return t.distanceTo(r)<e.distanceTo(r)?e:t}function Ky(t,e,r,n,i,a){let o,s=e.x-t.x,l=e.y-t.y,c=r.x-t.x,h=r.y-t.y,d=Math.sqrt((s+c)*(s+c)+(l+h)*(l+h));return qy(e,t,r)>Math.PI&&(d*=-1),o=Gy(h,l)?(l+h)*(n/d-.5)*8/3/(s-c):(s+c)*(n/d-.5)*8/3/(h-l),i.set(e.x-o*l,e.y+o*s),a.set(r.x+o*h,r.y-o*c),[i,a]}function Jy(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function Qy(t,e){return Xy(t.position,t.controls[1].position,e.position)&&Xy(t.position,e.controls[0].position,e.position)}function tx(t,e=12,r=!1){let n=[];for(let i=0,a=t.length;i<a;i++){let a=t[i],o=0;if(r&&void 0!==a.roundedCurveCorner){let t=.5*ex(a.roundedCurveCorner,e);i>0&&(n[i-1]+=t),o+=t}void 0!==a.curveAfter&&(o+=ex(a.curveAfter,e)),n.push(o)}return t.length>0&&r&&void 0!==t[0].roundedCurveCorner&&(n[t.length-1]+=.5*ex(t[0].roundedCurveCorner,e)),n}function ex(t,e=12){return t&&t instanceof Bo?2*e:t&&(t instanceof Ko||t instanceof Jo)?1:t&&t instanceof es?e*t.points.length:e}var rx,nx,ix=new Ot,ax=new Ot,ox=new Ot,sx=new Ot,lx=new Ot,cx=new Ot,hx=class extends hs{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Pn(new he(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Rt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,r){let n=new hx;return n.isClosed=t.isClosed,n.points=t.points.map((t=>Ly.create(t.id,t.data))),"number"==typeof t.roundness&&(n.roundness=t.roundness),n.shapeHoles=t.shapeHoles.map((t=>hx.createFromState(t))),void 0!==e&&void 0!==r&&n.applySize(e,r),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,r=this.points.length;e<r;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map((t=>this.getPointIndexById(t))).filter((t=>t>=0))}getPointIndexById(t){let e=this.points.length,r=this.points.findIndex((e=>e.uuid===t));if(r<0){let r=e;for(let e=0,n=this.shapeHoles.length;e<n;e++){let n=this.shapeHoles[e],i=n.points.length,a=n.getPointIndexById(t);if(!(a<0))return a+r;r+=i}}return r}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let r=0,n=this.shapeHoles.length;r<n;r++){let n=this.shapeHoles[r],i=t-e;if(i<=n.points.length-1)return n.points[i];e+=n.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let r=0,n=this.shapeHoles.length;r<n;r++){let n=this.shapeHoles[r],i=n.points.indexOf(t);if(i>=0)return e+i;e+=n.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map((t=>t.points)));return[...this.points,...t]}applySize(t,e){0===t&&(t=.001),0===e&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let r=ix.set(t,e);for(let t=0,e=this.points.length;t<e;t++){let e=this.points[t];e.position.multiply(r),e.controls[0].position.multiply(r),e.controls[1].position.multiply(r)}for(let r=0,n=this.shapeHoles.length;r<n;r++)this.shapeHoles[r].applyScale(t,e);this._update()}createPoint(t,e=0,r=Rt.generateUUID()){let n;n=t instanceof Ot?t:new Ot(t,e);let i=new Ly(r,n);return i.roundness=this.roundness,i}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,r=this.points.length;e<r;e++){let r=this.points[e];if(r.uuid===t)return r}for(let e=0,r=this.shapeHoles.length;e<r;e++){let r=this.shapeHoles[e].getPointByUuid(t);if(r)return r}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find((e=>e.uuid===t));e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,r=!1){this.subdivision=e,void 0===this.curveDivisions&&this.computeCurveDivisions(e);let n=r?this.roundedCurveDivisions:this.curveDivisions;return function(t,e,r=12,n=!0){let i,a=Vy.set(0,0,0),o=0,s=[];for(let n=0;n<e.length;n++){let l=e[n],c=Oy,h=ex(l,r);s.push(h);for(let e=0;e<=h;e++)if(l instanceof Yo||l instanceof Qo||l instanceof Ko){if(l.getPoint(e/h,c),a.set(c.x,c.y,0),void 0!==i&&Wy(i,a))continue;void 0===i&&(i=By),i.copy(a),t.setXYZ(o,a.x,a.y,a.z),o++}}n&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++)}(t,r?this.roundedCurves:this.curves,e,this.autoClose),n.reduce(((t,e)=>t+e),0)+1}computeCurveDivisions(t=12){return this.curveDivisions=tx(this.points,t,!1),this.roundedCurveDivisions=tx(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,r=12){return 2*function(t,e,r,n=12,i=!0){let a=Vy.set(0,0,0),o=0,s=[];for(let i=0;i<e.length;i++){if(!1===r[i])continue;let l,c=e[i],h=Oy,d=ex(c,n);s.push(d);for(let e=0;e<=d;e++)if(c instanceof Yo||c instanceof Qo||c instanceof Ko){if(c.getPoint(e/d,h),a.set(h.x,h.y,0),l?.equals(a))continue;void 0===l?l=By:(t.setXYZ(o,l.x,l.y,l.z),o++,t.setXYZ(o,a.x,a.y,a.z),o++),l.copy(a)}}return i&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),s}(t,this.curves,e,r,this.autoClose).reduce(((t,e)=>t+e),0)}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,void 0===this.curveDivisions&&this.computeCurveDivisions(e),function(t,e,r=12,n=!0){let i,a=0;for(let n=0;n<e.length;n++){let o=e[n],s=ex(o,r),l=Oy;for(let e=0;e<=s;e++)if(o instanceof Yo||o instanceof Qo||o instanceof Ko){if(o.getPoint(e/s,l),void 0!==i&&Hy(i,l,Cy))continue;void 0===i&&(i=Iy),i.copy(l),t.push(l.x,l.y),a++}}return Gy(t[0],t[t.length-2],Cy)&&Gy(t[1],t[t.length-1],Cy)&&(t.pop(),t.pop()),n&&a>1&&!(Gy(t[a-1],t[1],Cy)&&Gy(t[a-2],t[0],Cy))&&(t.push(t[0],t[1]),a++),t}(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let r=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);let n=e?this.roundedCurveDivisions:this.curveDivisions,i=0;e&&void 0!==this.points[0].roundedCurveCorner&&(i=.5*ex(this.points[0].roundedCurveCorner,this.subdivision));let a=t-i;a<0&&(a+=n.reduce(((t,e)=>t+e),0));for(let t=0,e=n.length;t<e;t++){let e=n[t];if(a<r+e)return[t,(a-r+1)/e];r+=e}return[0,1]}getCurveT(t,e,r){let n=this.points[t],i=this.points[t>=this.points.length-1?0:t+1],a=this.curveDivisions,o=a[t];if(Jy(n,i)){let t=n.position.distanceTo(i.position);return n.position.distanceTo(ix.set(r.x,r.y))/t}let s=0;for(let e=0;e<t;e++)s+=a[e];return(e-s)/o}dispose(){}_applyCurveForPoint(t,e){Jy(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let r=this.curves[this.curves.length-1];t.curveBefore=r,e.curveAfter=r;let n=r.clone();t.roundedCurveBefore=n,e.roundedCurveAfter=n,t.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,e=this.points.length;t<e;t++){let e=this.points[t];if(0===t)this.moveTo(e.position.x,e.position.y);else{let r=this.points[t-1];this._applyCurveForPoint(e,r)}}let t=this.getLastPoint();if(t?.curveAfter&&(t.curveAfter=void 0),this.isClosed){let t=this.points[0],e=this.points[this.points.length-1];this._applyCurveForPoint(t,e)}if(this.points.length>2){let t=0;for(let e=0,r=this.points.length;e<r;e++){let r=this.points[e],n=this.points[e-1]??this.points[this.points.length-1],i=this.points[e+1]??this.points[0],a=r.roundness,o=n&&i&&$y(n,r,i);if(!r.controlsMoved()&&a>0&&!o){let n=r.curveBefore,i=r.curveAfter;if(void 0===n||void 0===i)continue;let o,s=r.roundedCurveBefore,l=r.roundedCurveAfter,c=n.getLength(),h=i.getLength(),d=Math.min(a,.499*c),p=Math.min(a,.499*h),u=Math.min(d,p),m=1-u/c,f=u/h,g=n.getPointAt(m,ix),v=i.getPointAt(f,ax);if(this._subSplitCurve(n,s,m,g,void 0),this._subSplitCurve(i,l,f,void 0,v),this.useCubicForRoundedCorners){let t=qy(g,r.position,v)/2,e=Math.tan(t)*g.distanceTo(r.position),[n,i]=Yy(g,v,e,ox,sx),a=Zy(n,i,r.position),[s,l]=Ky(a,g,v,e,lx,cx);o=new Yo(g.clone(),s.clone(),l.clone(),v.clone())}else o=new Qo(g.clone(),r.position.clone(),v.clone());r.roundedCurveCorner=o,this.roundedCurves.splice(e+t,0,o),t++}}}}_subSplitCurve(t,e,r,n,i){if(!(t instanceof Ko)){let a=t,o=e,s=a.getUtoTmapping(r,0),l=function(t,e,r,n,i=.5){let a=Oy.subVectors(e,t).multiplyScalar(i).add(t),o=Iy.subVectors(r,e).multiplyScalar(i).add(e),s=Ny.subVectors(n,r).multiplyScalar(i).add(r),l=a,c=zy.subVectors(o,a).multiplyScalar(i).add(a),h=Fy.subVectors(s,o).multiplyScalar(i).add(o),d=s,p=Uy.subVectors(h,c).multiplyScalar(i).add(c);return[t.x,t.y,l.x,l.y,c.x,c.y,p.x,p.y,h.x,h.y,d.x,d.y,n.x,n.y]}(a.v0,a.v1,a.v2,a.v3,s);return void 0!==n&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),void 0!==i&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return void 0!==n&&e.v2.copy(n),void 0!==i&&e.v1.copy(i),e}clone(){let t=new hx(this._width,this._height);return t.points=this.points.map((t=>t.clone())),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map((t=>t.clone())),t}toJSON(){return{points:this.points.reduce(((t,e)=>t.concat(e.toJSON())),[]),shapeHoles:this.shapeHoles.map((t=>t.toJSON())),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let r=0;r<e;r++){let e=7*r,n=t.points[e+0],i=t.points[e+1],a=t.points[e+2],o=t.points[e+3],s=t.points[e+4],l=t.points[e+5],c=t.points[e+6],h=new Ly(Rt.generateUUID(),new Ot(n,i));h.controls[0].position.set(a,o),h.controls[1].position.set(s,l),h.roundness=c,this.points.push(h)}return this.shapeHoles=t.shapeHoles?.length?t.shapeHoles.map((t=>{let e=new hx;return e.fromJSON(t),e})):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t,e=!1){this.isText=e;let r=(t,e)=>{e instanceof Yo&&e.v3.equals(t.position)&&t.controls[0].position.copy(e.v2)};return this.points=(t=>{let e,n,i=[];for(e=0,n=t.length;e<n;e++)t[e]instanceof Qo&&(t[e]=jy(t[e]));for(e=0,n=t.length;e<n;e++){let n,a=t[e],o=e>0?t[e-1]:null;a instanceof Yo?(n=this.createPoint(a.v0),n.controls[1].position.copy(a.v1)):a instanceof Ko&&(n=this.createPoint(a.v1)),void 0!==n&&(null!==o&&r(n,o),i.push(n))}let a=t[t.length-1],o=!1;return a instanceof Yo?a.v3.equals(i[0].position)&&(i[0].controls[0].position.copy(a.v2),o=!0):a instanceof Ko&&a.v2.equals(i[0].position)&&(o=!0),this.isClosed=o,i})(t.curves),t instanceof hs&&(this.shapeHoles=t.holes.map((t=>{let e=new hx;return e.fromShape(t),e}))),this.update(),this}updatePoint(t,e){let r=this.getPointByUuid(t);r&&(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.roundness&&(r.roundness=e.roundness),void 0!==e.areControlsDirectionsMirrored&&(r.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){let r=this.getPointByUuid(t)?.controls[0];r&&(e.position&&r.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){let r=this.getPointByUuid(t)?.controls[1];r&&(e.position&&r.position.fromArray(e.position),this.needsUpdate=!0)}},dx=2*Math.PI;function px({x:t,y:e},r,n,i,a){return{x:t*r+i,y:e*n+a}}function ux(t,e){let r=1.5707963267948966===e?.551915024494:-1.5707963267948966===e?-.551915024494:1.3333333333333333*Math.tan(e/4),n=Math.cos(t),i=Math.sin(t),a=Math.cos(t+e),o=Math.sin(t+e);return[{x:n-i*r,y:i+n*r},{x:a+o*r,y:o-a*r},{x:a,y:o}]}function mx(t,e,r,n){let i=t*n-e*r<0?-1:1,a=Math.min(1,Math.max(-1,t*r+e*n));return i*Math.acos(a)}function fx({px:t,py:e,cx:r,cy:n,rx:i,ry:a,largeArcFlag:o,sweepFlag:s}){let l=[];if(0===i||0===a)return[];let c=(t-r)/2,h=(e-n)/2;if(0===c&&0===h)return[];i=Math.abs(i),a=Math.abs(a);let d=Math.pow(c,2)/Math.pow(i,2)+Math.pow(h,2)/Math.pow(a,2);d>1&&(i*=Math.sqrt(d),a*=Math.sqrt(d));let p=function(t,e,r,n,i,a,o,s,l,c){let h=Math.pow(i,2),d=Math.pow(a,2),p=Math.pow(o,2),u=Math.pow(s,2),m=h*d-h*u-d*p;m<0&&(m=0),m/=h*u+d*p,m=Math.sqrt(m)*(l===c?-1:1);let f=m*i/a*s,g=m*-a/i*o,v=f+(t+r)/2,b=g+(e+n)/2,y=(o-f)/i,x=(s-g)/a,_=(-o-f)/i,w=(-s-g)/a,S=mx(1,0,y,x),E=mx(y,x,_,w);return!c&&E>0&&(E-=dx),c&&E<0&&(E+=dx),{centerx:v,centery:b,ang1:S,ang2:E}}(t,e,r,n,i,a,c,h,o,s),{ang1:u,ang2:m}=p,{centerx:f,centery:g}=p,v=Math.abs(m)/(dx/4);Math.abs(1-v)<1e-7&&(v=1);let b=Math.max(Math.ceil(v),1);m/=b;for(let t=0;t<b;t++)l.push(ux(u,m)),u+=m;return l.map((t=>{let{x:e,y:r}=px(t[0],i,a,f,g),{x:n,y:o}=px(t[1],i,a,f,g),{x:s,y:l}=px(t[2],i,a,f,g);return{x1:e,y1:r,x2:n,y2:o,x:s,y:l}}))}function gx(t,e){if(!t)throw e||"Assertion Failed!"}!function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"}(rx||(rx={})),function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(nx||(nx={}));var vx=function(){function t(){}return t.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},t.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},t.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},t.edgeEval=function(e,r,n){gx(t.vertLeq(e,r)&&t.vertLeq(r,n));var i=r.s-e.s,a=n.s-r.s;return i+a>0?i<a?r.t-e.t+(e.t-n.t)*(i/(i+a)):r.t-n.t+(n.t-e.t)*(a/(i+a)):0},t.edgeSign=function(e,r,n){gx(t.vertLeq(e,r)&&t.vertLeq(r,n));var i=r.s-e.s,a=n.s-r.s;return i+a>0?(r.t-n.t)*i+(r.t-e.t)*a:0},t.transEval=function(e,r,n){gx(t.transLeq(e,r)&&t.transLeq(r,n));var i=r.t-e.t,a=n.t-r.t;return i+a>0?i<a?r.s-e.s+(e.s-n.s)*(i/(i+a)):r.s-n.s+(n.s-e.s)*(a/(i+a)):0},t.transSign=function(e,r,n){gx(t.transLeq(e,r)&&t.transLeq(r,n));var i=r.t-e.t,a=n.t-r.t;return i+a>0?(r.s-n.s)*i+(r.s-e.s)*a:0},t.vertCCW=function(t,e,r){return t.s*(e.t-r.t)+e.s*(r.t-t.t)+r.s*(t.t-e.t)>=0},t.interpolate=function(t,e,r,n){return(t=t<0?0:t)<=(r=r<0?0:r)?0===r?(e+n)/2:e+t/(t+r)*(n-e):n+r/(t+r)*(e-n)},t.intersect=function(e,r,n,i,a){var o,s,l;t.vertLeq(e,r)||(l=e,e=r,r=l),t.vertLeq(n,i)||(l=n,n=i,i=l),t.vertLeq(e,n)||(l=e,e=n,n=l,l=r,r=i,i=l),t.vertLeq(n,r)?t.vertLeq(r,i)?((o=t.edgeEval(e,n,r))+(s=t.edgeEval(n,r,i))<0&&(o=-o,s=-s),a.s=t.interpolate(o,n.s,s,r.s)):((o=t.edgeSign(e,n,r))+(s=-t.edgeSign(e,i,r))<0&&(o=-o,s=-s),a.s=t.interpolate(o,n.s,s,i.s)):a.s=(n.s+r.s)/2,t.transLeq(e,r)||(l=e,e=r,r=l),t.transLeq(n,i)||(l=n,n=i,i=l),t.transLeq(e,n)||(l=e,e=n,n=l,l=r,r=i,i=l),t.transLeq(n,r)?t.transLeq(r,i)?((o=t.transEval(e,n,r))+(s=t.transEval(n,r,i))<0&&(o=-o,s=-s),a.t=t.interpolate(o,n.t,s,r.t)):((o=t.transSign(e,n,r))+(s=-t.transSign(e,i,r))<0&&(o=-o,s=-s),a.t=t.interpolate(o,n.t,s,i.t)):a.t=(n.t+r.t)/2},t}(),bx=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},yx=function(){function t(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),t}(),xx=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},_x=function(){function t(){var t=new xx,e=new bx,r=new yx(0),n=new yx(1);t.next=t.prev=t,t.anEdge=null,e.next=e.prev=e,r.next=r,r.Sym=n,n.next=n,n.Sym=r,this.vHead=t,this.fHead=e,this.eHead=r,this.eHeadSym=n}return t.prototype.makeEdge_=function(t){var e=new yx(0),r=new yx(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return r.next=n,n.Sym.next=e,e.next=t,t.Sym.next=r,e.Sym=r,e.Onext=e,e.Lnext=r,e.Org=null,e.Lface=null,e.winding=0,e.activeRegion=null,r.Sym=e,r.Onext=r,r.Lnext=e,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,e},t.prototype.splice_=function(t,e){var r=t.Onext,n=e.Onext;r.Sym.Lnext=e,n.Sym.Lnext=t,t.Onext=n,e.Onext=r},t.prototype.makeVertex_=function(t,e,r){var n=t;gx(n,"Vertex can't be null!");var i=r.prev;n.prev=i,i.next=n,n.next=r,r.prev=n,n.anEdge=e;var a=e;do{a.Org=n,a=a.Onext}while(a!==e)},t.prototype.makeFace_=function(t,e,r){var n=t;gx(n,"Face can't be null");var i=r.prev;n.prev=i,i.next=n,n.next=r,r.prev=n,n.anEdge=e,n.trail=null,n.marked=!1,n.inside=r.inside;var a=e;do{a.Lface=n,a=a.Lnext}while(a!==e)},t.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var e=t.next,r=t.Sym.next;e.Sym.next=r,r.Sym.next=e},t.prototype.killVertex_=function(t,e){var r=t.anEdge,n=r;do{n.Org=e,n=n.Onext}while(n!==r);var i=t.prev,a=t.next;a.prev=i,i.next=a},t.prototype.killFace_=function(t,e){var r=t.anEdge,n=r;do{n.Lface=e,n=n.Lnext}while(n!==r);var i=t.prev,a=t.next;a.prev=i,i.next=a},t.prototype.makeEdge=function(){var t=new xx,e=new xx,r=new bx,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(e,n.Sym,this.vHead),this.makeFace_(r,n,this.fHead),n},t.prototype.splice=function(t,e){var r=!1,n=!1;if(t!==e){if(e.Org!==t.Org&&(n=!0,this.killVertex_(e.Org,t.Org)),e.Lface!==t.Lface&&(r=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(e,t),!n){var i=new xx;this.makeVertex_(i,e,t.Org),t.Org.anEdge=t}if(!r){var a=new bx;this.makeFace_(a,e,t.Lface),t.Lface.anEdge=t}}},t.prototype.delete=function(t){var e=t.Sym,r=!1;if(t.Lface!==t.Rface&&(r=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!r){var n=new bx;this.makeFace_(n,t,t.Lface)}e.Onext===e?(this.killVertex_(e.Org,null),this.killFace_(e.Lface,null)):(t.Lface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),this.killEdge_(t)},t.prototype.addEdgeVertex=function(t){var e=this.makeEdge_(t),r=e.Sym;this.splice_(e,t.Lnext),e.Org=t.Dst;var n=new xx;return this.makeVertex_(n,r,e.Org),e.Lface=r.Lface=t.Lface,e},t.prototype.splitEdge=function(t){var e=this.addEdgeVertex(t).Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,e),t.Dst=e.Org,e.Dst.anEdge=e.Sym,e.Rface=t.Rface,e.winding=t.winding,e.Sym.winding=t.Sym.winding,e.idx=t.idx,e.Sym.idx=t.Sym.idx,e},t.prototype.connect=function(t,e){var r=!1,n=this.makeEdge_(t),i=n.Sym;if(e.Lface!==t.Lface&&(r=!0,this.killFace_(e.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(i,e),n.Org=t.Dst,i.Org=e.Org,n.Lface=i.Lface=t.Lface,t.Lface.anEdge=i,!r){var a=new bx;this.makeFace_(a,n,t.Lface)}return n},t.prototype.zapFace=function(t){var e,r,n,i,a,o=t.anEdge;r=o.Lnext;do{r=(e=r).Lnext,e.Lface=null,null===e.Rface&&(e.Onext===e?this.killVertex_(e.Org,null):(e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev)),(n=e.Sym).Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e))}while(e!=o);i=t.prev,(a=t.next).prev=i,i.next=a},t.prototype.countFaceVerts_=function(t){var e=t.anEdge,r=0;do{r++,e=e.Lnext}while(e!==t.anEdge);return r},t.prototype.mergeConvexFaces=function(t){var e,r,n,i,a;for(e=this.fHead.next;e!==this.fHead;e=e.next)if(e.inside)for(a=(r=e.anEdge).Org;n=r.Lnext,(i=r.Sym)&&i.Lface&&i.Lface.inside&&(this.countFaceVerts_(e)+this.countFaceVerts_(i.Lface)-2<=t&&vx.vertCCW(r.Lprev.Org,r.Org,i.Lnext.Lnext.Org)&&vx.vertCCW(i.Lprev.Org,i.Org,r.Lnext.Lnext.Org)&&(n=i.Lnext,this.delete(i),r=null,i=null)),!r||r.Lnext.Org!==a;)r=n;return!0},t.prototype.check=function(){var t,e,r,n,i,a,o=this.fHead,s=this.vHead,l=this.eHead;for(e=o,e=o;(t=e.next)!==o;e=t){gx(t.prev===e),i=t.anEdge;do{gx(i.Sym!==i),gx(i.Sym.Sym===i),gx(i.Lnext.Onext.Sym===i),gx(i.Onext.Sym.Lnext===i),gx(i.Lface===t),i=i.Lnext}while(i!==t.anEdge)}for(gx(t.prev===e&&null===t.anEdge),n=s,n=s;(r=n.next)!==s;n=r){gx(r.prev===n),i=r.anEdge;do{gx(i.Sym!==i),gx(i.Sym.Sym===i),gx(i.Lnext.Onext.Sym===i),gx(i.Onext.Sym.Lnext===i),gx(i.Org===r),i=i.Onext}while(i!==r.anEdge)}for(gx(r.prev===n&&null===r.anEdge),a=l,a=l;(i=a.next)!==l;a=i)gx(i.Sym.next===a.Sym),gx(i.Sym!==i),gx(i.Sym.Sym===i),gx(null!==i.Org),gx(null!==i.Dst),gx(i.Lnext.Onext.Sym===i),gx(i.Onext.Sym.Lnext===i);gx(i.Sym.next===a.Sym&&i.Sym===this.eHeadSym&&i.Sym.Sym===i&&null===i.Org&&null===i.Dst&&null===i.Lface&&null===i.Rface)},t}(),wx=function(){this.handle=null},Sx=function(){this.key=null,this.node=0},Ex=function(){function t(t,e){this.leq=e,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var r=0;r<t+1;r++)this.nodes[r]=new wx,this.handles[r]=new Sx;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(t){var e,r,n,i=this.nodes,a=this.handles;for(e=i[t].handle;;){if((n=t<<1)<this.size&&this.leq(a[i[n+1].handle].key,a[i[n].handle].key)&&++n,gx(n<=this.max),r=i[n].handle,n>this.size||this.leq(a[e].key,a[r].key)){i[t].handle=e,a[e].node=t;break}i[t].handle=r,a[r].node=t,t=n}},t.prototype.floatUp_=function(t){var e,r,n,i=this.nodes,a=this.handles;for(e=i[t].handle;;){if(r=i[n=t>>1].handle,0===n||this.leq(a[r].key,a[e].key)){i[t].handle=e,a[e].node=t;break}i[t].handle=r,a[r].node=t,t=n}},t.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(t){var e,r;if(2*(e=++this.size)>this.max){var n,i;for(this.max*=2,i=this.nodes.length,this.nodes.length=this.max+1,n=i;n<this.nodes.length;n++)this.nodes[n]=new wx;for(i=this.handles.length,this.handles.length=this.max+1,n=i;n<this.handles.length;n++)this.handles[n]=new Sx}return 0===this.freeList?r=e:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[e].handle=r,this.handles[r].node=e,this.handles[r].key=t,this.initialized&&this.floatUp_(e),r},t.prototype.extractMin=function(){var t=this.nodes,e=this.handles,r=t[1].handle,n=e[r].key;return this.size>0&&(t[1].handle=t[this.size].handle,e[t[1].handle].node=1,e[r].key=null,e[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),n},t.prototype.delete=function(t){var e,r=this.nodes,n=this.handles;gx(t>=1&&t<=this.max&&null!==n[t].key),r[e=n[t].node].handle=r[this.size].handle,n[r[e].handle].node=e,--this.size,e<=this.size&&(e<=1||this.leq(n[r[e>>1].handle].key,n[r[e].handle].key)?this.floatDown_(e):this.floatUp_(e)),n[t].key=null,n[t].node=this.freeList,this.freeList=t},t}(),Mx=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},Ax=function(){this.key=null,this.next=null,this.prev=null},Tx=function(){function t(t,e){this.frame=t,this.leq=e,this.head=new Ax,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(t){return this.insertBefore(this.head,t)},t.prototype.search=function(t){var e=this.head;do{e=e.next}while(null!==e.key&&!this.leq(this.frame,t,e.key));return e},t.prototype.insertBefore=function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq(this.frame,t.key,e));var r=new Ax;return r.key=e,r.next=t.next,t.next.prev=r,r.prev=t,t.next=r,r},t.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},t}(),Px=function(){function t(){}return t.regionBelow=function(t){return t.nodeUp.prev.key},t.regionAbove=function(t){return t.nodeUp.next.key},t.debugEvent=function(t){},t.addWinding=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},t.edgeLeq=function(t,e,r){var n=t.event,i=e.eUp,a=r.eUp;return i.Dst===n?a.Dst===n?vx.vertLeq(i.Org,a.Org)?vx.edgeSign(a.Dst,i.Org,a.Org)<=0:vx.edgeSign(i.Dst,a.Org,i.Org)>=0:vx.edgeSign(a.Dst,n,a.Org)<=0:a.Dst===n?vx.edgeSign(i.Dst,n,i.Org)>=0:vx.edgeEval(i.Dst,n,i.Org)>=vx.edgeEval(a.Dst,n,a.Org)},t.deleteRegion=function(t,e){e.fixUpperEdge&&gx(0===e.eUp.winding),e.eUp.activeRegion=null,t.dict.delete(e.nodeUp)},t.fixUpperEdge=function(t,e,r){gx(e.fixUpperEdge),t.mesh.delete(e.eUp),e.fixUpperEdge=!1,e.eUp=r,r.activeRegion=e},t.topLeftRegion=function(e,r){var n,i=r.eUp.Org;do{r=t.regionAbove(r)}while(r.eUp.Org===i);if(r.fixUpperEdge){if(null===(n=e.mesh.connect(t.regionBelow(r).eUp.Sym,r.eUp.Lnext)))return null;t.fixUpperEdge(e,r,n),r=t.regionAbove(r)}return r},t.topRightRegion=function(e){var r=e.eUp.Dst;do{e=t.regionAbove(e)}while(e.eUp.Dst===r);return e},t.addRegionBelow=function(t,e,r){var n=new Mx;return n.eUp=r,n.nodeUp=t.dict.insertBefore(e.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,r.activeRegion=n,n},t.isWindingInside=function(t,e){switch(t.windingRule){case rx.ODD:return 0!=(1&e);case rx.NONZERO:return 0!==e;case rx.POSITIVE:return e>0;case rx.NEGATIVE:return e<0;case rx.ABS_GEQ_TWO:return e>=2||e<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,r){r.windingNumber=t.regionAbove(r).windingNumber+r.eUp.winding,r.inside=t.isWindingInside(e,r.windingNumber)},t.finishRegion=function(e,r){var n=r.eUp,i=n.Lface;i.inside=r.inside,i.anEdge=n,t.deleteRegion(e,r)},t.finishLeftRegions=function(e,r,n){for(var i,a=null,o=r,s=r.eUp;o!==n;){if(o.fixUpperEdge=!1,(i=(a=t.regionBelow(o)).eUp).Org!=s.Org){if(!a.fixUpperEdge){t.finishRegion(e,o);break}i=e.mesh.connect(s.Lprev,i.Sym),t.fixUpperEdge(e,a,i)}s.Onext!==i&&(e.mesh.splice(i.Oprev,i),e.mesh.splice(s,i)),t.finishRegion(e,o),s=a.eUp,o=a}return s},t.addRightEdges=function(e,r,n,i,a,o){var s,l,c,h,d=!0;c=n;do{gx(vx.vertLeq(c.Org,c.Dst)),t.addRegionBelow(e,r,c.Sym),c=c.Onext}while(c!==i);for(null===a&&(a=t.regionBelow(r).eUp.Rprev),l=r,h=a;(c=(s=t.regionBelow(l)).eUp.Sym).Org===h.Org;)c.Onext!==h&&(e.mesh.splice(c.Oprev,c),e.mesh.splice(h.Oprev,c)),s.windingNumber=l.windingNumber-c.winding,s.inside=t.isWindingInside(e,s.windingNumber),l.dirty=!0,!d&&t.checkForRightSplice(e,l)&&(t.addWinding(c,h),t.deleteRegion(e,l),e.mesh.delete(h)),d=!1,l=s,h=c;l.dirty=!0,gx(l.windingNumber-c.winding===s.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(t,e,r){t.mesh.splice(e,r)},t.vertexWeights=function(t,e,r){var n=vx.vertL1dist(e,t),i=vx.vertL1dist(r,t),a=.5*i/(n+i),o=.5*n/(n+i);t.coords[0]+=a*e.coords[0]+o*r.coords[0],t.coords[1]+=a*e.coords[1]+o*r.coords[1],t.coords[2]+=a*e.coords[2]+o*r.coords[2]},t.getIntersectData=function(e,r,n,i,a,o){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,t.vertexWeights(r,n,i),t.vertexWeights(r,a,o)},t.checkForRightSplice=function(e,r){var n=t.regionBelow(r),i=r.eUp,a=n.eUp;if(vx.vertLeq(i.Org,a.Org)){if(vx.edgeSign(a.Dst,i.Org,a.Org)>0)return!1;vx.vertEq(i.Org,a.Org)?i.Org!==a.Org&&(e.pq.delete(i.Org.pqHandle),t.spliceMergeVertices(e,a.Oprev,i)):(e.mesh.splitEdge(a.Sym),e.mesh.splice(i,a.Oprev),r.dirty=n.dirty=!0)}else{if(vx.edgeSign(i.Dst,a.Org,i.Org)<0)return!1;t.regionAbove(r).dirty=r.dirty=!0,e.mesh.splitEdge(i.Sym),e.mesh.splice(a.Oprev,i)}return!0},t.checkForLeftSplice=function(e,r){var n,i=t.regionBelow(r),a=r.eUp,o=i.eUp;if(gx(!vx.vertEq(a.Dst,o.Dst)),vx.vertLeq(a.Dst,o.Dst)){if(vx.edgeSign(a.Dst,o.Dst,a.Org)<0)return!1;t.regionAbove(r).dirty=r.dirty=!0,n=e.mesh.splitEdge(a),e.mesh.splice(o.Sym,n),n.Lface.inside=r.inside}else{if(vx.edgeSign(o.Dst,a.Dst,o.Org)>0)return!1;r.dirty=i.dirty=!0,n=e.mesh.splitEdge(o),e.mesh.splice(a.Lnext,o.Sym),n.Rface.inside=r.inside}return!0},t.checkForIntersect=function(e,r){var n,i,a=t.regionBelow(r),o=r.eUp,s=a.eUp,l=o.Org,c=s.Org,h=o.Dst,d=s.Dst,p=new xx;if(gx(!vx.vertEq(d,h)),gx(vx.edgeSign(h,e.event,l)<=0),gx(vx.edgeSign(d,e.event,c)>=0),gx(l!==e.event&&c!==e.event),gx(!r.fixUpperEdge&&!a.fixUpperEdge),l===c||Math.min(l.t,h.t)>Math.max(c.t,d.t))return!1;if(vx.vertLeq(l,c)){if(vx.edgeSign(d,l,c)>0)return!1}else if(vx.edgeSign(h,c,l)<0)return!1;return t.debugEvent(e),vx.intersect(h,l,d,c,p),gx(Math.min(l.t,h.t)<=p.t),gx(p.t<=Math.max(c.t,d.t)),gx(Math.min(d.s,h.s)<=p.s),gx(p.s<=Math.max(c.s,l.s)),vx.vertLeq(p,e.event)&&(p.s=e.event.s,p.t=e.event.t),n=vx.vertLeq(l,c)?l:c,vx.vertLeq(n,p)&&(p.s=n.s,p.t=n.t),vx.vertEq(p,l)||vx.vertEq(p,c)?(t.checkForRightSplice(e,r),!1):!vx.vertEq(h,e.event)&&vx.edgeSign(h,e.event,p)>=0||!vx.vertEq(d,e.event)&&vx.edgeSign(d,e.event,p)<=0?d===e.event?(e.mesh.splitEdge(o.Sym),e.mesh.splice(s.Sym,o),r=t.topLeftRegion(e,r),o=t.regionBelow(r).eUp,t.finishLeftRegions(e,t.regionBelow(r),a),t.addRightEdges(e,r,o.Oprev,o,o,!0),!0):h===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(o.Lnext,s.Oprev),a=r,r=t.topRightRegion(r),i=t.regionBelow(r).eUp.Rprev,a.eUp=s.Oprev,s=t.finishLeftRegions(e,a,null),t.addRightEdges(e,r,s.Onext,o.Rprev,i,!0),!0):(vx.edgeSign(h,e.event,p)>=0&&(t.regionAbove(r).dirty=r.dirty=!0,e.mesh.splitEdge(o.Sym),o.Org.s=e.event.s,o.Org.t=e.event.t),vx.edgeSign(d,e.event,p)<=0&&(r.dirty=a.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(o.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,o),o.Org.s=p.s,o.Org.t=p.t,o.Org.pqHandle=e.pq.insert(o.Org),t.getIntersectData(e,o.Org,l,h,c,d),t.regionAbove(r).dirty=r.dirty=a.dirty=!0,!1)},t.walkDirtyRegions=function(e,r){for(var n,i,a=t.regionBelow(r);;){for(;a.dirty;)r=a,a=t.regionBelow(a);if(!r.dirty&&(a=r,null===(r=t.regionAbove(r))||!r.dirty))return;if(r.dirty=!1,n=r.eUp,i=a.eUp,n.Dst!==i.Dst&&t.checkForLeftSplice(e,r)&&(a.fixUpperEdge?(t.deleteRegion(e,a),e.mesh.delete(i),i=(a=t.regionBelow(r)).eUp):r.fixUpperEdge&&(t.deleteRegion(e,r),e.mesh.delete(n),n=(r=t.regionAbove(a)).eUp)),n.Org!==i.Org)if(n.Dst===i.Dst||r.fixUpperEdge||a.fixUpperEdge||n.Dst!==e.event&&i.Dst!==e.event)t.checkForRightSplice(e,r);else if(t.checkForIntersect(e,r))return;n.Org===i.Org&&n.Dst===i.Dst&&(t.addWinding(i,n),t.deleteRegion(e,r),e.mesh.delete(n),r=t.regionAbove(a))}},t.connectRightVertex=function(e,r,n){var i,a=n.Onext,o=t.regionBelow(r),s=r.eUp,l=o.eUp,c=!1;s.Dst!==l.Dst&&t.checkForIntersect(e,r),vx.vertEq(s.Org,e.event)&&(e.mesh.splice(a.Oprev,s),r=t.topLeftRegion(e,r),a=t.regionBelow(r).eUp,t.finishLeftRegions(e,t.regionBelow(r),o),c=!0),vx.vertEq(l.Org,e.event)&&(e.mesh.splice(n,l.Oprev),n=t.finishLeftRegions(e,o,null),c=!0),c?t.addRightEdges(e,r,n.Onext,a,a,!0):(i=vx.vertLeq(l.Org,s.Org)?l.Oprev:s,i=e.mesh.connect(n.Lprev,i),t.addRightEdges(e,r,i,i.Onext,i.Onext,!1),i.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,r))},t.connectLeftDegenerate=function(e,r,n){var i,a,o,s,l;return i=r.eUp,vx.vertEq(i.Org,n)?(gx(!1),void t.spliceMergeVertices(e,i,n.anEdge)):vx.vertEq(i.Dst,n)?(gx(!1),r=t.topRightRegion(r),a=s=(o=(l=t.regionBelow(r)).eUp.Sym).Onext,l.fixUpperEdge&&(gx(a!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=a.Oprev),e.mesh.splice(n.anEdge,o),vx.edgeGoesLeft(a)||(a=null),void t.addRightEdges(e,r,o.Onext,s,a,!0)):(e.mesh.splitEdge(i.Sym),r.fixUpperEdge&&(e.mesh.delete(i.Onext),r.fixUpperEdge=!1),e.mesh.splice(n.anEdge,i),void t.sweepEvent(e,n))},t.connectLeftVertex=function(e,r){var n,i,a,o,s,l,c=new Mx;if(c.eUp=r.anEdge.Sym,n=e.dict.search(c).key,i=t.regionBelow(n)){if(o=n.eUp,s=i.eUp,0===vx.edgeSign(o.Dst,r,o.Org))return void t.connectLeftDegenerate(e,n,r);if(a=vx.vertLeq(s.Dst,o.Dst)?n:i,n.inside||a.fixUpperEdge){if(a===n)l=e.mesh.connect(r.anEdge.Sym,o.Lnext);else l=e.mesh.connect(s.Dnext,r.anEdge).Sym;a.fixUpperEdge?t.fixUpperEdge(e,a,l):t.computeWinding(e,t.addRegionBelow(e,n,l)),t.sweepEvent(e,r)}else t.addRightEdges(e,n,r.anEdge,r.anEdge,null,!0)}},t.sweepEvent=function(e,r){e.event=r,t.debugEvent(e);for(var n=r.anEdge;null===n.activeRegion;)if((n=n.Onext)===r.anEdge)return void t.connectLeftVertex(e,r);var i=t.topLeftRegion(e,n.activeRegion);gx(null!==i);var a=t.regionBelow(i),o=a.eUp,s=t.finishLeftRegions(e,a,null);s.Onext===o?t.connectRightVertex(e,i,s):t.addRightEdges(e,i,s.Onext,o,o,!0)},t.addSentinel=function(t,e,r,n){var i=new Mx,a=t.mesh.makeEdge();a.Org.s=r,a.Org.t=n,a.Dst.s=e,a.Dst.t=n,t.event=a.Dst,i.eUp=a,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=t.dict.insert(i)},t.initEdgeDict=function(e){e.dict=new Tx(e,t.edgeLeq);var r=e.bmax[0]-e.bmin[0],n=e.bmax[1]-e.bmin[1],i=e.bmin[0]-r,a=e.bmax[0]+r,o=e.bmin[1]-n,s=e.bmax[1]+n;t.addSentinel(e,i,a,o),t.addSentinel(e,i,a,s)},t.doneEdgeDict=function(e){for(var r,n=0;null!==(r=e.dict.min().key);)r.sentinel||(gx(r.fixUpperEdge),gx(1==++n)),gx(0===r.windingNumber),t.deleteRegion(e,r)},t.removeDegenerateEdges=function(e){var r,n,i,a=e.mesh.eHead;for(r=a.next;r!==a;r=n)n=r.next,i=r.Lnext,vx.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(t.spliceMergeVertices(e,i,r),e.mesh.delete(r),i=(r=i).Lnext),i.Lnext===r&&(i!==r&&((i===n||i===n.Sym)&&(n=n.next),e.mesh.delete(i)),(r===n||r===n.Sym)&&(n=n.next),e.mesh.delete(r))},t.initPriorityQ=function(t){var e,r,n,i=0;for(r=(n=t.mesh.vHead).next;r!==n;r=r.next)i++;for(i+=8,e=t.pq=new Ex(i,vx.vertLeq),r=(n=t.mesh.vHead).next;r!==n;r=r.next)r.pqHandle=e.insert(r);return r===n&&(e.init(),!0)},t.donePriorityQ=function(t){t.pq=null},t.removeDegenerateFaces=function(e,r){var n,i,a;for(n=r.fHead.next;n!==r.fHead;n=i)i=n.next,gx((a=n.anEdge).Lnext!==a),a.Lnext.Lnext===a&&(t.addWinding(a.Onext,a),e.mesh.delete(a));return!0},t.computeInterior=function(e,r){var n,i;if(void 0===r&&(r=!0),t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);null!==(n=e.pq.extractMin());){for(;null!==(i=e.pq.min())&&vx.vertEq(i,n);)i=e.pq.extractMin(),t.spliceMergeVertices(e,n.anEdge,i.anEdge);t.sweepEvent(e,n)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),!!t.removeDegenerateFaces(e,e.mesh)&&(r&&e.mesh.check(),!0)},t}(),Cx=function(){function t(){this.mesh=new _x,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=rx.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.prototype.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!e)throw"Zero-size vector!";e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},t.prototype.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},t.prototype.computeNormal_=function(t){var e,r,n,i,a,o,s=[0,0,0],l=[0,0,0],c=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],u=[null,null,null],m=this.mesh.vHead;e=m.next;for(var f=0;f<3;++f)i=e.coords[f],l[f]=i,u[f]=e,s[f]=i,p[f]=e;for(e=m.next;e!==m;e=e.next)for(var g=0;g<3;++g)(i=e.coords[g])<l[g]&&(l[g]=i,u[g]=e),i>s[g]&&(s[g]=i,p[g]=e);var v=0;if(s[1]-l[1]>s[0]-l[0]&&(v=1),s[2]-l[2]>s[v]-l[v]&&(v=2),l[v]>=s[v])return t[0]=0,t[1]=0,void(t[2]=1);for(o=0,r=u[v],n=p[v],c[0]=r.coords[0]-n.coords[0],c[1]=r.coords[1]-n.coords[1],c[2]=r.coords[2]-n.coords[2],e=m.next;e!==m;e=e.next)h[0]=e.coords[0]-n.coords[0],h[1]=e.coords[1]-n.coords[1],h[2]=e.coords[2]-n.coords[2],d[0]=c[1]*h[2]-c[2]*h[1],d[1]=c[2]*h[0]-c[0]*h[2],d[2]=c[0]*h[1]-c[1]*h[0],(a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2])>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(c)]=1)},t.prototype.checkOrientation_=function(){for(var t,e,r=this.mesh.fHead,n=this.mesh.vHead,i=0,a=r.next;a!==r;a=a.next)if(!((e=a.anEdge).winding<=0))do{i+=(e.Org.s-e.Dst.s)*(e.Org.t+e.Dst.t),e=e.Lnext}while(e!==a.anEdge);if(i<0){for(t=n.next;t!==n;t=t.next)t.t=-t.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var t,e,r=this.mesh.vHead,n=[0,0,0],i=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),i=!0),t=this.sUnit,e=this.tUnit;var a=this.longAxis_(n);t[a]=0,t[(a+1)%3]=1,t[(a+2)%3]=0,e[a]=0,e[(a+1)%3]=0,e[(a+2)%3]=n[a]>0?1:-1;for(var o=r.next;o!==r;o=o.next)o.s=this.dot_(o.coords,t),o.t=this.dot_(o.coords,e);i&&this.checkOrientation_();for(var s=!0,l=r.next;l!==r;l=l.next)s?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,s=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},t.prototype.addWinding_=function(t,e){t.winding+=e.winding,t.Sym.winding+=e.Sym.winding},t.prototype.tessellateMonoRegion_=function(t,e){var r,n;if((r=e.anEdge).Lnext===r||r.Lnext.Lnext===r)throw"Mono region invalid";for(;vx.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;vx.vertLeq(r.Org,r.Dst);r=r.Lnext);n=r.Lprev;for(;r.Lnext!==n;)if(vx.vertLeq(r.Dst,n.Org)){for(;n.Lnext!==r&&(vx.edgeGoesLeft(n.Lnext)||vx.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)n=t.connect(n.Lnext,n).Sym;n=n.Lprev}else{for(;n.Lnext!==r&&(vx.edgeGoesRight(r.Lprev)||vx.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)r=t.connect(r,r.Lprev).Sym;r=r.Lnext}if(n.Lnext===r)throw"Mono region invalid";for(;n.Lnext.Lnext!==r;)n=t.connect(n.Lnext,n).Sym;return!0},t.prototype.tessellateInterior_=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)if(e=r.next,r.inside&&!this.tessellateMonoRegion_(t,r))return!1;return!0},t.prototype.discardExterior_=function(t){for(var e,r=t.fHead.next;r!==t.fHead;r=e)e=r.next,r.inside||t.zapFace(r)},t.prototype.setWindingNumber_=function(t,e,r){for(var n,i=t.eHead.next;i!==t.eHead;i=n)n=i.next,i.Rface.inside!==i.Lface.inside?i.winding=i.Lface.inside?e:-e:r?t.delete(i):i.winding=0},t.prototype.getNeighbourFace_=function(t){return t.Rface&&t.Rface.inside?t.Rface.n:-1},t.prototype.outputPolymesh_=function(t,e,r,n){var i,a,o=0,s=0;r>3&&t.mergeConvexFaces(r);for(var l=t.vHead.next;l!==t.vHead;l=l.next)l.n=-1;for(var c=t.fHead.next;c!==t.fHead;c=c.next)if(c.n=-1,c.inside){i=c.anEdge,a=0;do{-1===(l=i.Org).n&&(l.n=s,s++),a++,i=i.Lnext}while(i!==c.anEdge);if(a>r)throw"Face vertex greater that support polygon";c.n=o,++o}this.elementCount=o,e===nx.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*r,this.vertexCount=s,this.vertices=[],this.vertices.length=s*n,this.vertexIndices=[],this.vertexIndices.length=s;for(l=t.vHead.next;l!==t.vHead;l=l.next)if(-1!==l.n){var h=l.n*n;this.vertices[h+0]=l.coords[0],this.vertices[h+1]=l.coords[1],n>2&&(this.vertices[h+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var d=0;for(c=t.fHead.next;c!==t.fHead;c=c.next)if(c.inside){i=c.anEdge,a=0;do{l=i.Org;this.elements[d++]=l.n,a++,i=i.Lnext}while(i!==c.anEdge);for(var p=a;p<r;++p)this.elements[d++]=-1;if(e===nx.CONNECTED_POLYGONS){i=c.anEdge;do{this.elements[d++]=this.getNeighbourFace_(i),i=i.Lnext}while(i!==c.anEdge);for(var u=a;u<r;++u)this.elements[d++]=-1}}},t.prototype.outputContours_=function(t,e){var r,n,i=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=r=o.anEdge;do{this.vertexCount++,r=r.Lnext}while(r!==n);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*e,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var s=0,l=0,c=0;i=0;for(o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=r=o.anEdge;do{this.vertices[s++]=r.Org.coords[0],this.vertices[s++]=r.Org.coords[1],e>2&&(this.vertices[s++]=r.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,a++,r=r.Lnext}while(r!==n);this.elements[c++]=i,this.elements[c++]=a,i+=a}},t.prototype.addContour=function(t,e){null===this.mesh&&(this.mesh=new _x),t<2&&(t=2),t>3&&(t=3);for(var r=null,n=0;n<e.length;n+=t)null===r?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=e[n+0],r.Org.coords[1]=e[n+1],r.Org.coords[2]=t>2?e[n+2]:0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},t.prototype.tesselate=function(t,e,r,n,i,a){if(void 0===t&&(t=rx.ODD),void 0===e&&(e=nx.POLYGONS),void 0===a&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,i&&(this.normal[0]=i[0],this.normal[1]=i[1],this.normal[2]=i[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),Px.computeInterior(this,a);var o=this.mesh;return e===nx.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),e===nx.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,e,r,n),!0},t}();function kx(t){var e=t.windingRule,r=void 0===e?rx.ODD:e,n=t.elementType,i=void 0===n?nx.POLYGONS:n,a=t.polySize,o=void 0===a?3:a,s=t.vertexSize,l=void 0===s?2:s,c=t.normal,h=void 0===c?[0,0,1]:c,d=t.contours,p=void 0===d?[]:d,u=t.strict,m=void 0===u||u,f=t.debug,g=void 0!==f&&f;if(!p&&m)throw new Error("Contours can't be empty");if(p){var v=new Cx;t.edgeCreateCallback&&(v.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(v.vertexIdCallback=t.vertexIdCallback);for(var b=0;b<p.length;b++)v.addContour(l||2,p[b]);return v.tesselate(r,i,o,l,h,m),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}rx.ODD,rx.NONZERO,rx.POSITIVE,rx.NEGATIVE,rx.ABS_GEQ_TWO,nx.POLYGONS,nx.CONNECTED_POLYGONS,nx.BOUNDARY_CONTOURS;var Dx=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let r=t*Dx.eSize;this.buffer=new ArrayBuffer(r);let n=Float32Array.BYTES_PER_ELEMENT,i=0;this.positions=new Float32Array(this.buffer,i*n,3*t),i+=3*t,this.normals=new Float32Array(this.buffer,i*n,3*t),i+=3*t,this.uvs=new Float32Array(this.buffer,i*n,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let r=t*Dx.eSize,n=new ArrayBuffer(r),i=Float32Array.BYTES_PER_ELEMENT,a=0,o=new Float32Array(n,a*i,3*t);a+=3*t;let s=new Float32Array(n,a*i,3*t);a+=3*t;let l=new Float32Array(n,a*i,2*t);e?(o.set(this.positions.subarray(0,3*this.size)),s.set(this.normals.subarray(0,3*this.size)),l.set(this.uvs.subarray(0,2*this.size))):(o.set(this.positions),s.set(this.normals),l.set(this.uvs)),this.buffer=n,this.positions=o,this.normals=s,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let t=this.capacity;for(;e>t;)t*=2;this.realloc(t)}let r=this.size;return this.size=e,r}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},Lx=Dx;Lx.eSize=8*Float32Array.BYTES_PER_ELEMENT;var Rx=lc(uc()),Ox={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Ix={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Nx={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},zx=(t,e)=>([r,n])=>(n<r&&(n+=e),(t>=r?t:t+e)<=n),Fx=class extends qr{constructor(t,e,r=0,n=12,i=3,a=rx.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._curveSegments=n,this._bevelSegmentsInput=i;let s,l,c,h=this._shape.extractShapePointsToFlatArray([],n),d=this._shape.shapeHoles.map((t=>{let e=t.extractShapePointsToFlatArray([],n),r=[];for(let t=e.length-1;t>=1;t-=2){let n=e[t-1],i=e[t-0];r.push(n,i)}return r})),p=[],u=[];for(let t=0;t<h.length;t+=2)u.push([h[t],h[t+1]]);p.push(u);for(let t=0;t<d.length;t++){let e=d[t],r=[];for(let t=0;t<e.length;t+=2)r.push([e[t],e[t+1]]);p.push(r)}s=t.isText?.1*(new Nl).setFromPoints(t.points.map((t=>t.position))).getSize(new Ot).length():0===p[0].length?r:(0,Rx.default)(p).distance,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,s,e/2),this._bevelSegments=Math.floor(i));try{l=kx({windingRule:a,elementType:nx.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[h]})}catch{l=Ox}try{c=kx({windingRule:rx.ODD,elementType:nx.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...d]})}catch{c=Ix}if(!l)throw new Error("error generating geometry");let m=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let t=0;t<c.elements.length;t++){let e=c.elements[t],r=t%2==0?l.vertexCount:0;l.elements.push(e+r)}for(let t=0;t<c.vertexIndices.length;t++){let e=c.vertexIndices[t],r=l.vertexCount;l.vertexIndices.push(e+r)}for(let t=0;t<c.vertices.length;t++){let e=c.vertices[t];l.vertices.push(e)}}let f=1/0,g=-1/0,v=1/0,b=-1/0;for(let t=0,e=l.vertexCount;t<e;t++){let e=2*t,r=l.vertices[e+0],n=l.vertices[e+1];r<f&&(f=r),r>g&&(g=r),n<v&&(v=n),n>b&&(b=n)}this._minX=f,this._minY=v,this._width=g-f,this._height=b-v,this._buffer=new Lx(this._computeBufferEstimatedSize(l));let y=[],x=[];for(let t=l.elementCount-1;t>=0;t--){let e=t>=m,r=2*t,i=l.elements[r+0],a=l.elements[r+1],c=i+a,h={start:i,count:a,normals:[],continuous:[],concave:[]},p=i,u=c-1,f=i+1,g=this._shape.roundedCurves.length;do{let t=p-i,r=l.vertices[2*u+0],n=l.vertices[2*u+1],o=l.vertices[2*p+0],s=l.vertices[2*p+1],d=l.vertices[2*f+0],m=l.vertices[2*f+1],v=o-r,b=s-n,y=Math.sqrt(v*v+b*b);v/=y,b/=y;let x=o-d,_=s-m,w=Math.sqrt(x*x+_*_);x/=w,_/=w,h.normals[2*t+0]=-_,h.normals[2*t+1]=x,h.concave[t]=v*_-b*x>0;let S=l.vertexIndices[p];if(Array.isArray(S))h.continuous[t]=!1;else{let[e,r]=this._shape.getCurveIndexFromVertexId(S-1,!0);if(r>0&&r<1)h.continuous[t]=!0;else{let n=1===r?e+1:e-1;n=(n+g)%g;let i=1===r?0:1,a=this._shape.roundedCurves[e].getTangent(r),o=this._shape.roundedCurves[n].getTangent(i);h.continuous[t]=a.dot(o)>.95}}e&&(h.normals[2*t+0]*=-1,h.normals[2*t+1]*=-1),[u,p,f]=[p,f,f+1],f>=c&&(f-=a)}while(f!==i+1);let v=[];v.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(2*i,2*c),vertexCount:a,vertexIndices:new Array(a).fill(!0).map(((t,e)=>[e,e])),elements:[0,a],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(2*i,2*c)});let b=0;for(let t=1;t<=this._bevelSegments;t++){let r=t/this._bevelSegments*Math.PI/2,i=(1-Math.cos(r))*this._bevel,o=[],s=[],c=[],d=[],p=0;for(let t=0;t<a;t++){let r=2*t,u=(t-1+a)%a*2,m=l.vertices[2*h.start+r+0],f=l.vertices[2*h.start+r+1],g=-h.normals[u+0]*i,v=-h.normals[u+1]*i,b=-h.normals[r+0]*i,y=-h.normals[r+1]*i;if(h.concave[t]||!h.concave[t]&&e){let r=Math.atan2(v,g),a=Math.atan2(y,b);a>r&&(a-=2*Math.PI);let s=a-r;if(h.continuous[t]||e){let n=r+s/2,a=Math.cos(n)*i,l=Math.sin(n)*i;o[2*p+0]=m+a*(e?-1:1),o[2*p+1]=f+l*(e?-1:1),d[p]=t,p++}else{let e=Math.max(1,Math.floor(n/4*Math.abs(s)/Math.PI));for(let n=0;n<=e;n++){let a=r+s*(n/e),l=Math.cos(a)*i,c=Math.sin(a)*i;o[2*p+0]=m+l,o[2*p+1]=f+c,d[p]=t,p++}}}else o[2*p+0]=m+g,o[2*p+1]=f+v,d[p]=t,s[t]=p,p++,o[2*p+0]=m,o[2*p+1]=f,d[p]=t,p++,o[2*p+0]=m+b,o[2*p+1]=f+y,d[p]=t,c[t]=p,p++}let u=kx({windingRule:rx.POSITIVE,elementType:nx.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o],edgeCreateCallback:t=>{let e=t.Org.idx,r=d[e],n=d[(e+1)%d.length];t.idx=[r,n],t.Sym.idx=[n,r]},vertexIdCallback:t=>{let e=t.Lprev.idx;return[e?e[1]:0,t.idx?t.idx[0]:0]}});if(!u)throw console.log("Error"),new Error(`error generating bevel geometry for ${t}'th loop`);if(!u.vertexCount){let e=(t-1)/this._bevelSegments*Math.PI/2;b=(1-Math.sin(e))*this._bevel;break}for(let t=0;t<u.vertexIndices.length;t++){let[e,r]=u.vertexIndices[t];if(e===r)continue;let n=r;r<e&&(n+=a);for(let i=e;i<n;i++){let n=i%a,o=(i+1)%a;if(!h.continuous[n]||!h.continuous[o]){u.vertexIndices[t]=[e,n],u.vertexIndices.splice(t+1,0,[o,r]),u.vertices.splice(2*(t+1),0,u.vertices[2*t],u.vertices[2*t+1]);break}}}v.push({bevelI:t,angle:r,size:i,boundary:u,reverseMap:d,insetPoints:o})}let _=(t,e,r)=>{let n=0,i=t.boundary.vertexIndices.length;for(;n<i&&r(t.boundary.vertexIndices[e]);)e=(e+1)%i,n++;return n},w=y.length;for(let t=1;t<v.length;t++){let e=v[t-1],r=v[t],n=e.boundary.vertexIndices.length,i=r.boundary.vertexIndices.length;if(!n||!i)break;let s=h.concave.length,l=0,c=zx(l,a);for(;!e.boundary.vertexIndices.filter(c).length||!r.boundary.vertexIndices.filter(c).length;)l++,c=zx(l,a);let d=e.boundary.vertexIndices.findIndex(c),p=r.boundary.vertexIndices.findIndex(c);do{d=(d+1)%n}while(c(e.boundary.vertexIndices[d]));do{p=(p+1)%i}while(c(r.boundary.vertexIndices[p]));l=(l+1)%a;let u,m,f=l,g=0,b=this._buildBevelVert(h,e,(d-1+n)%n,void 0,g),x=this._buildBevelVert(h,r,(p-1+i)%i,void 0,g),w=!1;do{g=(l||s)/s,c=zx(l,a);let t=_(e,d,c),f=_(r,p,c),v=w;if(w=!1,t&&!f){for(let r=0;r<t;r++)u=this._buildBevelVert(h,e,(d+r)%n,r/(t-1),g),y.push(b.topN,u.topP,x.topN),!1===o&&y.push(u.bottomP,b.bottomN,x.bottomN),b=u;w=!0}else if(!t&&f)for(let t=0;t<f;t++)m=this._buildBevelVert(h,r,(p+t)%i,t/(f-1),g),y.push(x.topN,b.topP,m.topP),!1===o&&y.push(b.bottomP,x.bottomN,m.bottomP),x=m;else if(t&&f)if(u=this._buildBevelVert(h,e,d,0,g),m=this._buildBevelVert(h,r,p,0,g),v?(y.push(b.topN,m.topP,x.topN),y.push(b.topN,u.topP,m.topP),!1===o&&(y.push(m.bottomP,b.bottomN,x.bottomN),y.push(m.bottomP,u.bottomP,b.bottomN))):(y.push(x.topN,b.topN,u.topP),y.push(x.topN,u.topP,m.topP),!1===o&&(y.push(u.bottomP,b.bottomN,x.bottomN),y.push(u.bottomP,x.bottomN,m.bottomP))),b=u,x=m,t===f)for(let a=1;a<t;a++)u=this._buildBevelVert(h,e,(d+a)%n,a/(t-1),g),m=this._buildBevelVert(h,r,(p+a)%i,a/(f-1),g),y.push(b.topN,u.topP,x.topN),y.push(x.topN,u.topP,m.topP),!1===o&&(y.push(u.bottomP,b.bottomN,x.bottomN),y.push(u.bottomP,x.bottomN,m.bottomP)),b=u,x=m;else if(t>f){let a=t/f,s=0;for(let l=1;l<t;l++)u=this._buildBevelVert(h,e,(d+l)%n,l/(t-1),g),y.push(b.topN,u.topP,x.topN),!1===o&&y.push(u.bottomP,b.bottomN,x.bottomN),b=u,l>(s+1)*a&&(s++,m=this._buildBevelVert(h,r,(p+s)%i,s/(f-1),g),y.push(x.topN,u.topP,m.topP),!1===o&&y.push(u.bottomP,x.bottomN,m.bottomP),x=m)}else{let a=f/t,s=0;for(let l=1;l<f;l++)m=this._buildBevelVert(h,r,(p+l)%i,l/(f-1),g),y.push(x.topN,u.topP,m.topP),!1===o&&y.push(u.bottomP,x.bottomN,m.bottomP),x=m,l>(s+1)*a&&(s++,u=this._buildBevelVert(h,e,(d+s)%n,s/(t-1),g),y.push(b.topN,u.topP,x.topN),!1===o&&y.push(u.bottomP,b.bottomN,x.bottomN),b=u)}d=(d+t)%n,p=(p+f)%i,l=(l+1)%s}while(l!==f)}if(!1===o&&this._depth>2*this._bevel&&this._buildWall(v,h,y),e){let t=[];for(let e=y.length-1;e>=w+2;e-=3){let r=y[e-2],n=y[e-1],i=y[e-0];t.push(i,n,r)}y.splice(w,y.length-w,...t)}if(e){let t=[];for(let e=v[v.length-1].boundary.vertices.length-1;e>=1;e-=2){let r=v[v.length-1].boundary.vertices[e-1],n=v[v.length-1].boundary.vertices[e-0];t.push(r,n)}x.push(t)}if(!e){let t,e=v[v.length-1];try{t=kx({windingRule:v.length>1?rx.POSITIVE:rx.ODD,elementType:nx.POLYGONS,vertexSize:2,strict:!0,contours:[e.insetPoints,...x]})}catch{t=Nx}if(!t)throw new Error("Error generating geometry for surface");0===d.length&&this._bevel<s&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let e=0;e<3*t.elementCount;e+=3){let r=this._buildSurfaceVert(t,t.elements[e+0],b),n=this._buildSurfaceVert(t,t.elements[e+1],b),i=this._buildSurfaceVert(t,t.elements[e+2],b);y.push(r.top,n.top,i.top),!1===o&&y.push(i.bottom,n.bottom,r.bottom)}}this.vertexCache={}}this._buffer.shrink();let _=new Ir(Uint32Array.from(y),1),w=new Ir(this._buffer.positions,3),S=new Ir(this._buffer.normals,3),E=new Ir(this._buffer.uvs,2);w.needsUpdate=!0,S.needsUpdate=!0,E.needsUpdate=!0,_.needsUpdate=!0,this.setAttribute("position",w),this.setAttribute("normal",S),this.setAttribute("uv",E),this.setIndex(_)}_computeBufferEstimatedSize(t){return 2*t.vertexCount*(2+this._bevelSegments)}_buildWall(t,e,r){let n=t[0];for(let t=0,i=n.boundary.vertexCount;t<i;t++){let a=this._buildBevelVert(e,n,t),o=this._buildBevelVert(e,n,(t+1)%i);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(t,e,r){let n=e.toString();if(n in this.vertexCache)return this.vertexCache[n];let i=t.vertices[2*e+0],a=t.vertices[2*e+1],o=(i-this._minX)/this._width,s=(a-this._minY)/this._height;this.forPathBevel&&(s=1);let l=this._buffer.get(this.forPathBevel?1:2),c=3*l,h=2*l,d={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=i,this._buffer.positions[c+1]=a,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[h+0]=o,this._buffer.uvs[h+1]=s,!1===this.forPathBevel&&(this._buffer.positions[c+3]=i,this._buffer.positions[c+4]=a,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[h+2]=o,this._buffer.uvs[h+3]=s),this.vertexCache[n]=d,d}_buildBevelVert(t,e,r,n=1,i){let a=`${e.bevelI}:${r}`;if(a in this.vertexCache&&0!==i&&1!==i&&(!i||i===this.vertexCache[a].pathBevelUCoord))return this.vertexCache[a];let o,s,l,c,[h,d]=e.boundary.vertexIndices[r];h!==d?(s=h,o=d,c=!1,l=t.continuous[s]&&t.continuous[o]):(o=h,s=(o-1+t.count)%t.count,c=t.concave[o]&&e.bevelI>0,l=t.continuous[o]||c);let p=Math.cos(e.angle),u=Math.sin(e.angle),m=2*r,f=2*o,g=2*s,v=e.boundary.vertices[m+0],b=e.boundary.vertices[m+1],y=(1-u)*this._bevel,x=(v-this._minX)/this._width,_=(b-this._minY)/this._height;this.forPathBevel&&(void 0!==i&&(x=i),_=1);let w=t.normals[f+0],S=t.normals[f+1],E=t.normals[g+0],M=t.normals[g+1];if(c){w+=(E-w)*(1-n),S+=(M-S)*(1-n);let t=Math.sqrt(w*w+S*S);w/=t,S/=t}let A=this.forPathBevel?this._buffer.get(l?1:2):this._buffer.get(l?2:4),T=3*A,P=2*A,C={i:r,fi:o,topP:A+0,topN:A+0,bottomP:A+1,bottomN:A+1,pathBevelUCoord:i};return this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=b,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-y,this._buffer.normals[T+0]=w*p,this._buffer.normals[T+1]=S*p,this._buffer.normals[T+2]=u,this._buffer.uvs[P+0]=x,this._buffer.uvs[P+1]=_,!1===this.forPathBevel&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=b,this._buffer.positions[T+5]=y,this._buffer.normals[T+3]=w*p,this._buffer.normals[T+4]=S*p,this._buffer.normals[T+5]=-u,this._buffer.uvs[P+2]=_,this._buffer.uvs[P+3]=x),l||(this.forPathBevel?(A+=1,T+=3,P+=2):(A+=2,T+=6,P+=4),C.topP=A+0,C.bottomP=A+1,this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=b,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-y,this._buffer.normals[T+0]=E*p,this._buffer.normals[T+1]=M*p,this._buffer.normals[T+2]=u,this._buffer.uvs[P+0]=x,this._buffer.uvs[P+1]=_,!1===this.forPathBevel&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=b,this._buffer.positions[T+5]=y,this._buffer.normals[T+3]=E*p,this._buffer.normals[T+4]=M*p,this._buffer.normals[T+5]=-u,this._buffer.uvs[P+2]=_,this._buffer.uvs[P+3]=x)),this.vertexCache[a]=C,C}clone(){let t=new Fx(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=ku(this.userData),t}},Ux=class extends qr{constructor(t,e=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=rx.ODD,this.elementType=nx.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:rx.ODD,elementType:nx.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let n,i,a,o=this._shape.extractShapePointsToFlatArray([],this._curveSegments),s=this._shape.shapeHoles.map((t=>t.extractShapePointsToFlatArray([],this._curveSegments))),l=!0,c=!0;for(let t=0,e=o.length/2;t<e;t++){let e=2*t,r=o[e+0],n=o[e+1];if(void 0!==i&&r!==i&&(l=!1),void 0!==a&&n!==a&&(c=!1),i=r,a=n,!l&&!c)break}if(!l&&!c)try{n=kx({contours:[o,...s],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{n=Ox}let h=n?.vertexCount??1,d=n?.elementCount??1;if(this._positionAttribute=new Ir(new Float32Array(3*h),3),this._normalAttribute=new Ir(new Float32Array(3*h),3),this._uvAttribute=new Ir(new Float32Array(2*h),2),this._indexAttribute=new Ir(new Uint32Array(3*d),1),n){let t=1/0,e=-1/0,r=1/0,i=-1/0;for(let a=0,o=h;a<o;a++){let o=2*a,s=n.vertices[o+0],l=n.vertices[o+1];s<t&&(t=s),s>e&&(e=s),l<r&&(r=l),l>i&&(i=l)}let a=e-t,o=i-r;for(let e=0,i=h;e<i;e++){let i=2*e,s=n.vertices[i+0],l=n.vertices[i+1],c=(s-t)/a,h=(l-r)/o;this._positionAttribute.setXYZ(e,s,l,0),this._normalAttribute.setXYZ(e,0,0,1),this._uvAttribute.setXY(e,c,h)}for(let t=0,e=d;t<e;t++){let e=3*t,r=n.elements[e+0],i=n.elements[e+1],a=n.elements[e+2];this._indexAttribute.setX(e+0,r),this._indexAttribute.setX(e+1,i),this._indexAttribute.setX(e+2,a)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,3*(n?.elementCount??1))}clone(){let t=new Ux(this._shape,this._curveSegments);return t.userData=ku(this.userData),t}},Bx=class extends Fx{constructor(t,e,r=0,n=12,i=3,a=rx.ODD){super(t,e,r,n,i,a),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return 2*t.vertexCount*(2+this._bevelSegments)}_buildWall(t,e,r){let n=t[0];for(let t=0,i=n.boundary.vertexCount;t<i;t++){let a=this._buildBevelVert(e,n,t),o=this._buildBevelVert(e,n,(t+1)%i);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let t=new Bx(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=ku(this.userData),t}},Vx=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:rx.ODD},t.parameters),n=Math.abs(r.width),i=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=t.shape??e?.shape,s=o?.roundness??r.roundness;void 0!==o&&(o instanceof hx?(o.width!==n||o.height!==i)&&o.applySize(n,i):o=new hx(n,i).fromJSON(o),void 0!==t.parameters?.roundness&&t.parameters?.roundness>0&&o.update());let l=o??new hx(n,i);return{parameters:Object.assign(r,{width:n,height:i,depth:a,roundness:s}),shape:l}}static build(t){let e,{depth:r,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:a,roundness:o,windingRule:s}=t.parameters;return t.shape.roundness=o,e=r<=0?new Ux(t.shape,a,{windingRule:s}):new Bx(t.shape,r,n,a,i,s),Object.assign(e,{userData:{...t,type:"VectorGeometry"}})}},jx=2*Math.PI,Gx=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return r.angle=Rt.clamp(r.angle,0,360),{shape:t.shape&&t.shape instanceof hx?t.shape:new hx,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(t){let e,{width:r,height:n,spikes:i,angle:a,innerRadius:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,d=function(t,e,r,n,i,a){if(n>=jx)return i>30||i%4==0?(function(t,e,r,n=0,i=0,a=0){let o=.5522847498,s=e*o,l=r*o;t.addPoint(qx(i-e,a,i-e,a-l,i-e,a+l)),t.addPoint(qx(i,a+r,i-s,a+r,i+s,a+r)),t.addPoint(qx(i+e,a,i+e,a+l,i+e,a-l)),t.addPoint(qx(i,a-r,i+s,a-r,i-s,a-r)),n>0&&Xx(t,e,r,n)}(t,e,r,a),Math.round(i/4)):Hx(t,n,i,e,r,a);n=Math.max(n,.001);let o={x:0,y:r},s=n+.5*Math.PI,l={x:Math.cos(s)*e,y:Math.sin(s)*r},c=fx({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:r,largeArcFlag:n>Math.PI,sweepFlag:!0});return i>30||i%c.length==0?function(t,e,r,n,i,a,o,s){let l=Math.round(i/n.length);t.addPoint(Wx(e,r));for(let e=0,r=n.length;e<r;e++){let r=n[e],i=t.points[e],a=Wx(r.x,r.y);i.controls[1].position.set(r.x1,r.y1),a.controls[0].position.set(r.x2,r.y2),t.addPoint(a)}return s>0?$x(t,a,o,s):t.addPoint(Wx(0,0)),l}(t,o.x,o.y,c,i,e,r,a):Hx(t,n,i,e,r,a)}(h,.5*r,.5*n,a*Math.PI/180,i,o);return h.isClosed=!0,h.update(),0===a?(e=new qr,e.setAttribute("position",new Fr([],3))):e=Vx.create({shape:h,parameters:{subdivisions:d,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}}),Object.assign(e,{userData:{...t,type:"EllipseGeometry"}})}};function Hx(t,e,r,n,i,a){let o=-e/r;for(let e=0;e<=r;e++){let r=o*e,a=Math.sin(r)*n,s=Math.cos(r)*i;t.addPoint(Wx(a,s))}return e<jx?a>0?$x(t,n,i,a):t.addPoint(Wx(0,0)):(t.removePoint(t.points[t.points.length-1]),a>0&&Xx(t,n,i,a)),1}function Wx(t,e){return new Ly(Rt.generateUUID(),new Ot(t,e))}function qx(t,e,r,n,i,a){let o=Wx(t,e);return o.controls[0].position.set(r,n),o.controls[1].position.set(i,a),o}function $x(t,e,r,n){Yx(t,e,r,n).forEach((e=>t.addPoint(e)))}function Xx(t,e,r,n){let i=Yx(t,e,r,n),a=new hx;i.forEach((t=>a.addPoint(t))),a.isClosed=!0,t.shapeHoles.push(a)}function Yx(t,e,r,n){let i=n*e/100,a=i*(Math.abs(r)/Math.abs(e)),o=new Ot(i/e,a/r),s=t.points.map((t=>{let e=t.clone();return e.uuid=Rt.generateUUID(),e})).reverse();return s.forEach((t=>{t.position.multiply(o);let e=t.controls[0].position.clone().multiply(o),r=t.controls[1].position.clone().multiply(o);t.controls[0].position.copy(r),t.controls[1].position.copy(e)})),s}var Zx=new zr([0,0,0],1),Kx=class extends qr{constructor(t=!0,e=1,r=1,n=1,i=1,a=1,o=1,s=1,l=1,c=1,h=1,d=1){if(super(),0===a)return;let p=t&&1===a;p&&(d=0),h>100&&(h=100),0===h&&(d=0);let u,m,f,g,v,b,y,x,_=()=>new he,w=new he,S=_(),E=_(),M=_(),A=_(),T=_(),P=_(),C=_(),k=_(),D=_(),L=_(),R=_(),O=r-2*s+.001,I=O/a,N=Math.ceil(o*a),z=N+1,F=O/N,U=-O/2,B=c+1,V=2*Math.PI/c,j=Math.PI/2/d,G=Math.min((1-h/100)*s,s-.01),H=s-G,W=0,q=2*d+2,$=B*q/2,X=$+B*z,Y=Math.max(0,B*(z+q)),[Z,K,J]=[3,3,2].map((t=>Array(Y*t).fill(0))),Q=[],tt=i-s;function et(e,r){let n=Math.PI/2;b=r*F,x=2*Math.PI*(b%I)/I+n,b+=U,y=Math.sin(x)*tt,v=Math.cos(x)*tt,t?e.set(v,y,b):e.set(v,b,y)}et(w,-1e-10),et(S,0),A.copy(w),et(w,1);let rt=w.distanceTo(S),nt=p?0:H+G,it=rt*N+2*nt,at=G,ot=it-nt;for(let e=0;e<=N;e++){et(E,e),R.subVectors(E,A).normalize(),A.copy(E),D.copy(E).setComponent(+t+1,0).normalize(),L.crossVectors(R,D).normalize();let r=0===e,n=e===N,i=r?3*Math.PI/2:j,a=r?at:ot,o=r?B:X,l=r?0:Y-B,h=R.clone().multiplyScalar(r?-H:H).add(E),u=R.clone().multiplyScalar(r?-1:1).normalize();for(let t=0;t<B;t++){let m=t*V;if(T.addVectors(w.copy(D).multiplyScalar(s*Math.cos(m)),S.copy(L).multiplyScalar(s*Math.sin(m))),P.copy(T).normalize(),r||n){p||(W=l+t,[0,1,2].forEach((t=>{Z[3*W+t]=h.getComponent(t),K[3*W+t]=u.getComponent(t)})),J[2*W]=+n,J[2*W+1]=t/c),S.copy(P).multiplyScalar(G),M.addVectors(E,S);for(let e=0;e<d;e++){let n=e*j+i;C.addVectors(w.copy(R).multiplyScalar(H*Math.sin(n)),S.copy(P).multiplyScalar(H*Math.cos(n))),k.copy(C).normalize(),S.addVectors(M,C),C.normalize(),W=o+e*B+t,[0,1,2].forEach((t=>{Z[3*W+t]=S.getComponent(t),K[3*W+t]=k.getComponent(t)}));let s=+r+Math.sin(n);J[2*W]=(a+H*s)/it,J[2*W+1]=t/c}}S.addVectors(E,T),W=$+e*B+t,[0,1,2].forEach((t=>{Z[3*W+t]=S.getComponent(t),K[3*W+t]=P.getComponent(t)})),J[2*W]=(nt+e*rt)/it,J[2*W+1]=t/c}}let st=z+2*d+2,[lt,ct]=[+p,st-1];for(let t=lt;t<=ct-1;t++){let e=p&&t===ct-1;for(let r=0;r<B-1;r++)u=t*B+r,m=u+1,f=(e?r:u)+B,g=(e?r+1:m)+B,0===t?Q.push(m,g,f):t===st-2?Q.push(u,m,f):Q.push(u,m,f,m,g,f)}this.setIndex(Q),this.setAttribute("position",new Fr(Z,3)),this.setAttribute("normal",new Fr(K,3)),this.setAttribute("uv",new Fr(J,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let t,e,r,n,i=this.userData.parameters,a=Math.ceil(i.tubularSegments),o=i.radialSegments+1,s=Array.from(this.getIndex().array),l=6*(a-1)*i.radialSegments,c=a,h=c===a;for(let a=0;a<i.radialSegments;a++)t=c*o+a,e=t+1,r=(h?a:t)+o,n=(h?a+1:e)+o,s[l++]=t,s[l++]=e,s[l++]=r,s[l++]=e,s[l++]=n,s[l++]=r;return s.length=l,Zx.array=s,Zx.count=s.length,Zx}},Jx=class extends Ty{constructor(t=1,e=.2,r=4){let n=(1+Math.sqrt(5))/2,i="IcosahedronGeometry";super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],i,t,e,r),this.type=i}static fromJSON(t){return new Jx(t.radius,t.corner,t.cornerSides)}},Qx=new Be,t_=new dr,e_=new he,r_=class extends xt{constructor(){super(),this.uuid=Rt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=(new It).getNormalMatrix(t);for(let e=0,r=this.vertices.length;e<r;e++)this.vertices[e].applyMatrix4(t);for(let t=0,r=this.faces.length;t<r;t++){let r=this.faces[t];r.normal.applyMatrix3(e).normalize();for(let t=0,n=r.vertexNormals.length;t<n;t++)r.vertexNormals[t].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return Qx.makeRotationX(t),this.applyMatrix4(Qx),this}rotateY(t){return Qx.makeRotationY(t),this.applyMatrix4(Qx),this}rotateZ(t){return Qx.makeRotationZ(t),this.applyMatrix4(Qx),this}translate(t,e,r){return Qx.makeTranslation(t,e,r),this.applyMatrix4(Qx),this}scale(t,e,r){return Qx.makeScale(t,e,r),this.applyMatrix4(Qx),this}lookAt(t){return t_.lookAt(t),t_.updateMatrix(),this.applyMatrix4(t_.matrix),this}fromBufferGeometry(t){let e=this,r=null!==t.index?t.index:void 0,n=t.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let i=n.position,a=n.normal,o=n.color,s=n.uv,l=n.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let t=0;t<i.count;t++)e.vertices.push((new he).fromBufferAttribute(i,t)),void 0!==o&&e.colors.push((new Pr).fromBufferAttribute(o,t));function c(t,r,n,i){let c=void 0===o?[]:[e.colors[t].clone(),e.colors[r].clone(),e.colors[n].clone()],h=void 0===a?[]:[(new he).fromBufferAttribute(a,t),(new he).fromBufferAttribute(a,r),(new he).fromBufferAttribute(a,n)],d=new i_(t,r,n,h,c,i);e.faces.push(d),void 0!==s&&e.faceVertexUvs[0].push([(new Ot).fromBufferAttribute(s,t),(new Ot).fromBufferAttribute(s,r),(new Ot).fromBufferAttribute(s,n)]),void 0!==l&&e.faceVertexUvs[1].push([(new Ot).fromBufferAttribute(l,t),(new Ot).fromBufferAttribute(l,r),(new Ot).fromBufferAttribute(l,n)])}let h=t.groups;if(h.length>0)for(let t=0;t<h.length;t++){let e=h[t],n=e.start;for(let t=n,i=n+e.count;t<i;t+=3)void 0!==r?c(r.getX(t),r.getX(t+1),r.getX(t+2),e.materialIndex):c(t,t+1,t+2,e.materialIndex)}else if(void 0!==r)for(let t=0;t<r.count;t+=3)c(r.getX(t),r.getX(t+1),r.getX(t+2));else for(let t=0;t<i.count;t+=3)c(t,t+1,t+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(e_).negate(),this.translate(e_.x,e_.y,e_.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,r=0===e?1:1/e,n=new Be;return n.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let t=new he,e=new he;for(let r=0,n=this.faces.length;r<n;r++){let n=this.faces[r],i=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];t.subVectors(o,a),e.subVectors(i,a),t.cross(e),t.normalize(),n.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let t=0,r=this.vertices.length;t<r;t++)e[t]=new he;if(t){let t=new he,r=new he;for(let n=0,i=this.faces.length;n<i;n++){let i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,o),r.subVectors(a,o),t.cross(r),e[i.a].add(t),e[i.b].add(t),e[i.c].add(t)}}else{this.computeFaceNormals();for(let t=0,r=this.faces.length;t<r;t++){let r=this.faces[t];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let t=0,r=this.vertices.length;t<r;t++)e[t].normalize();for(let t=0,r=this.faces.length;t<r;t++){let r=this.faces[t],n=r.vertexNormals;3===n.length?(n[0].copy(e[r.a]),n[1].copy(e[r.b]),n[2].copy(e[r.c])):(n[0]=e[r.a].clone(),n[1]=e[r.b].clone(),n[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let e=this.faces[t],r=e.vertexNormals;3===r.length?(r[0].copy(e.normal),r[1].copy(e.normal),r[2].copy(e.normal)):(r[0]=e.normal.clone(),r[1]=e.normal.clone(),r[2]=e.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,e=this.faces.length;t<e;t++){let e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,r=e.vertexNormals.length;t<r;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}let t=new r_;t.faces=this.faces;for(let e=0,r=this.morphTargets.length;e<r;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let t=this.morphNormals[e].faceNormals,r=this.morphNormals[e].vertexNormals;for(let e=0,n=this.faces.length;e<n;e++){let e=new he,n={a:new he,b:new he,c:new he};t.push(e),r.push(n)}}let r=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let t=0,e=this.faces.length;t<e;t++){let e=this.faces[t],n=r.faceNormals[t],i=r.vertexNormals[t];n.copy(e.normal),i.a.copy(e.vertexNormals[0]),i.b.copy(e.vertexNormals[1]),i.c.copy(e.vertexNormals[2])}}for(let t=0,e=this.faces.length;t<e;t++){let e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ue),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new De),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,r=0){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let n,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,c=this.colors,h=t.colors;void 0!==e&&(n=(new It).getNormalMatrix(e));for(let t=0,r=o.length;t<r;t++){let r=o[t].clone();void 0!==e&&r.applyMatrix4(e),a.push(r)}for(let t=0,e=h.length;t<e;t++)c.push(h[t].clone());for(let t=0,e=l.length;t<e;t++){let e,a,o=l[t],c=o.vertexNormals,h=o.vertexColors,d=new i_(o.a+i,o.b+i,o.c+i);d.normal.copy(o.normal),void 0!==n&&d.normal.applyMatrix3(n).normalize();for(let t=0,r=c.length;t<r;t++)e=c[t].clone(),void 0!==n&&e.applyMatrix3(n).normalize(),d.vertexNormals.push(e);d.color.copy(o.color);for(let t=0,e=h.length;t<e;t++)a=h[t],d.vertexColors.push(a.clone());d.materialIndex=o.materialIndex+r,s.push(d)}for(let e=0,r=t.faceVertexUvs.length;e<r;e++){let r=t.faceVertexUvs[e];void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]);for(let t=0,n=r.length;t<n;t++){let n=r[t],i=[];for(let t=0,e=n.length;t<e;t++)i.push(n[t].clone());this.faceVertexUvs[e].push(i)}}}mergeMesh(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)}mergeVertices(t=4){let e={},r=[],n=[],i=Math.pow(10,t);for(let t=0,a=this.vertices.length;t<a;t++){let a=this.vertices[t],o=Math.round(a.x*i)+"_"+Math.round(a.y*i)+"_"+Math.round(a.z*i);void 0===e[o]?(e[o]=t,r.push(this.vertices[t]),n[t]=r.length-1):n[t]=n[e[o]]}let a=[];for(let t=0,e=this.faces.length;t<e;t++){let e=this.faces[t];e.a=n[e.a],e.b=n[e.b],e.c=n[e.c];let r=[e.a,e.b,e.c];for(let e=0;e<3;e++)if(r[e]===r[(e+1)%3]){a.push(t);break}}for(let t=a.length-1;t>=0;t--){let e=a[t];this.faces.splice(e,1);for(let t=0,r=this.faceVertexUvs.length;t<r;t++)this.faceVertexUvs[t].splice(e,1)}let o=this.vertices.length-r.length;return this.vertices=r,o}setFromPoints(t){this.vertices=[];for(let e=0,r=t.length;e<r;e++){let r=t[e];this.vertices.push(new he(r.x,r.y,r.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let r=0;r<e;r++)t[r]._id=r;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));let r,n,i=this.faceVertexUvs[0],a=this.faceVertexUvs[1];i&&i.length===e&&(r=[]),a&&a.length===e&&(n=[]);for(let o=0;o<e;o++){let e=t[o]._id;r&&r.push(i[e]),n&&n.push(a[e])}r&&(this.faceVertexUvs[0]=r),n&&(this.faceVertexUvs[1]=n)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){let e=this.parameters;for(let r in e)void 0!==e[r]&&(t[r]=e[r]);return t}let e=[];for(let t=0;t<this.vertices.length;t++){let r=this.vertices[t];e.push(r.x,r.y,r.z)}let r=[],n=[],i={},a=[],o={},s=[],l={};for(let t=0;t<this.faces.length;t++){let e=this.faces[t],n=!0,i=!1,a=void 0!==this.faceVertexUvs[0][t],o=e.normal.length()>0,s=e.vertexNormals.length>0,l=1!==e.color.r||1!==e.color.g||1!==e.color.b,u=e.vertexColors.length>0,m=0;if(m=c(m,0,0),m=c(m,1,n),m=c(m,2,i),m=c(m,3,a),m=c(m,4,o),m=c(m,5,s),m=c(m,6,l),m=c(m,7,u),r.push(m),r.push(e.a,e.b,e.c),r.push(e.materialIndex),a){let e=this.faceVertexUvs[0][t];r.push(p(e[0]),p(e[1]),p(e[2]))}if(o&&r.push(h(e.normal)),s){let t=e.vertexNormals;r.push(h(t[0]),h(t[1]),h(t[2]))}if(l&&r.push(d(e.color)),u){let t=e.vertexColors;r.push(d(t[0]),d(t[1]),d(t[2]))}}function c(t,e,r){return r?t|1<<e:t&~(1<<e)}function h(t){let e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==i[e]||(i[e]=n.length/3,n.push(t.x,t.y,t.z)),i[e]}function d(t){let e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==o[e]||(o[e]=a.length,a.push(t.getHex())),o[e]}function p(t){let e=t.x.toString()+t.y.toString();return void 0!==l[e]||(l[e]=s.length/2,s.push(t.x,t.y)),l[e]}return t.data={},t.data.vertices=e,t.data.normals=n,a.length>0&&(t.data.colors=a),s.length>0&&(t.data.uvs=[s]),t.data.faces=r,t}clone(){return(new r_).copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let t=0,r=e.length;t<r;t++)this.vertices.push(e[t].clone());let r=t.colors;for(let t=0,e=r.length;t<e;t++)this.colors.push(r[t].clone());let n=t.faces;for(let t=0,e=n.length;t<e;t++)this.faces.push(n[t].clone());for(let e=0,r=t.faceVertexUvs.length;e<r;e++){let r=t.faceVertexUvs[e];void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]);for(let t=0,n=r.length;t<n;t++){let n=r[t],i=[];for(let t=0,e=n.length;t<e;t++){let e=n[t];i.push(e.clone())}this.faceVertexUvs[e].push(i)}}let i=t.morphTargets;for(let t=0,e=i.length;t<e;t++){let e={};if(e.name=i[t].name,void 0!==i[t].vertices){e.vertices=[];for(let r=0,n=i[t].vertices.length;r<n;r++)e.vertices.push(i[t].vertices[r].clone())}if(void 0!==i[t].normals){e.normals=[];for(let r=0,n=i[t].normals.length;r<n;r++)e.normals.push(i[t].normals[r].clone())}this.morphTargets.push(e)}let a=t.morphNormals;for(let t=0,e=a.length;t<e;t++){let e={};if(void 0!==a[t].vertexNormals){e.vertexNormals=[];for(let r=0,n=a[t].vertexNormals.length;r<n;r++){let n=a[t].vertexNormals[r],i={};i.a=n.a.clone(),i.b=n.b.clone(),i.c=n.c.clone(),e.vertexNormals.push(i)}}if(void 0!==a[t].faceNormals){e.faceNormals=[];for(let r=0,n=a[t].faceNormals.length;r<n;r++)e.faceNormals.push(a[t].faceNormals[r].clone())}this.morphNormals.push(e)}let o=t.skinWeights;for(let t=0,e=o.length;t<e;t++)this.skinWeights.push(o[t].clone());let s=t.skinIndices;for(let t=0,e=s.length;t<e;t++)this.skinIndices.push(s[t].clone());let l=t.lineDistances;for(let t=0,e=l.length;t<e;t++)this.lineDistances.push(l[t]);let c=t.boundingBox;null!==c&&(this.boundingBox=c.clone());let h=t.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=(new n_).fromGeometry(this),e=new qr,r=new Float32Array(3*t.vertices.length);if(e.setAttribute("position",l_.call(new Ir(r,3),t.vertices)),t.normals.length>0){let r=new Float32Array(3*t.normals.length);e.setAttribute("normal",l_.call(new Ir(r,3),t.normals))}if(t.colors.length>0){let r=new Float32Array(3*t.colors.length);e.setAttribute("color",o_.call(new Ir(r,3),t.colors))}if(t.uvs.length>0){let r=new Float32Array(2*t.uvs.length);e.setAttribute("uv",s_.call(new Ir(r,2),t.uvs))}if(t.uvs2.length>0){let r=new Float32Array(2*t.uvs2.length);e.setAttribute("uv2",s_.call(new Ir(r,2),t.uvs2))}e.groups=t.groups;for(let r in t.morphTargets){let n=[],i=t.morphTargets[r];for(let t=0,e=i.length;t<e;t++){let e=i[t],r=new Fr(3*e.data.length,3);r.name=e.name,n.push(l_.call(r,e.data))}e.morphAttributes[r]=n}if(t.skinIndices.length>0){let r=new Fr(4*t.skinIndices.length,4);e.setAttribute("skinIndex",c_.call(r,t.skinIndices))}if(t.skinWeights.length>0){let r=new Fr(4*t.skinWeights.length,4);e.setAttribute("skinWeight",c_.call(r,t.skinWeights))}return null!==t.boundingSphere&&(e.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new qr,r=t.geometry;if(t.isPoints||t.isLine){let t=new Fr(3*r.vertices.length,3),n=new Fr(3*r.colors.length,3);if(e.setAttribute("position",l_.call(t,r.vertices)),e.setAttribute("color",o_.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let t=new Fr(r.lineDistances.length,1);e.setAttribute("lineDistance",a_.call(t,r.lineDistances))}null!==r.boundingSphere&&(e.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(e.boundingBox=r.boundingBox.clone())}else t.isMesh&&(e=r.toBufferGeometry());return e}};r_.prototype.isGeometry=!0;var n_=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e,r,n,i=[],a=t.faces;for(r=0;r<a.length;r++){let t=a[r];t.materialIndex!==n&&(n=t.materialIndex,void 0!==e&&(e.count=3*r-e.start,i.push(e)),e={start:3*r,materialIndex:n})}void 0!==e&&(e.count=3*r-e.start,i.push(e)),this.groups=i}fromGeometry(t){let e,r=t.faces,n=t.vertices,i=t.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=t.morphTargets,l=s.length;if(l>0){e=[];for(let t=0;t<l;t++)e[t]={name:s[t].name,data:[]};this.morphTargets.position=e}let c,h=t.morphNormals,d=h.length;if(d>0){c=[];for(let t=0;t<d;t++)c[t]={name:h[t].name,data:[]};this.morphTargets.normal=c}let p=t.skinIndices,u=t.skinWeights,m=p.length===n.length,f=u.length===n.length;n.length>0&&0===r.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let t=0;t<r.length;t++){let g=r[t];this.vertices.push(n[g.a],n[g.b],n[g.c]);let v=g.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{let t=g.normal;this.normals.push(t,t,t)}let b=g.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{let t=g.color;this.colors.push(t,t,t)}if(!0===a){let e=i[0][t];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",t),this.uvs.push(new Ot,new Ot,new Ot))}if(!0===o){let e=i[1][t];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",t),this.uvs2.push(new Ot,new Ot,new Ot))}for(let t=0;t<l;t++){let r=s[t].vertices;e[t].data.push(r[g.a],r[g.b],r[g.c])}for(let e=0;e<d;e++){let r=h[e].vertexNormals[t];c[e].data.push(r.a,r.b,r.c)}m&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]),f&&this.skinWeights.push(u[g.a],u[g.b],u[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}},i_=class{constructor(t,e,r,n,i,a=0){this.a=t,this.b=e,this.c=r,this.normal=n&&n.isVector3?n:new he,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new Pr,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=a}clone(){return(new this.constructor).copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function a_(t){return this.array.set(t),this}function o_(t){let e=this.array,r=0;for(let n=0,i=t.length;n<i;n++){let i=t[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),i=new Pr),e[r++]=i.r,e[r++]=i.g,e[r++]=i.b}return this}function s_(t){let e=this.array,r=0;for(let n=0,i=t.length;n<i;n++){let i=t[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),i=new Ot),e[r++]=i.x,e[r++]=i.y}return this}function l_(t){let e=this.array,r=0;for(let n=0,i=t.length;n<i;n++){let i=t[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),i=new he),e[r++]=i.x,e[r++]=i.y,e[r++]=i.z}return this}function c_(t){let e=this.array,r=0;for(let n=0,i=t.length;n<i;n++){let i=t[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),i=new ie),e[r++]=i.x,e[r++]=i.y,e[r++]=i.z,e[r++]=i.w}return this}var h_=["a","b","c"];function d_(t,e){switch(e){case"c":return t.c;case"b":return t.b;default:return t.a}}function p_(t,e,r){let n=Math.min(t,e)+"_"+Math.max(t,e);return r.get(n)}function u_(t,e,r,n,i,a){let o,s=Math.min(t,e),l=Math.max(t,e),c=s+"_"+l;if(n.has(c))o=n.get(c);else{o={a:r[s],b:r[l],newEdge:null,faces:[]},n.set(c,o)}o.faces.push(i),a[t].edges.push(o),a[e].edges.push(o)}function m_(t,e,r,n,i){t.push(new i_(e,r,n,void 0,void 0,i))}function f_(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function g_(t,e,r,n){t.push([e.clone(),r.clone(),n.clone()])}var v_=class{constructor(t=1){this.subdivisions=t}modify(t){(t=t instanceof qr?(new r_).fromBufferGeometry(t):t.clone()).mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e,r,n,i,a,o=new he,s=t.vertices,l=t.faces,c=t.faceVertexUvs[0],h=void 0!==c&&c.length>0,d=[],p=new Map;!function(t,e,r,n){let i,a,o;for(i=0,a=t.length;i<a;i++)r[i]={edges:[]};for(i=0,a=e.length;i<a;i++)o=e[i],u_(o.a,o.b,t,n,o,r),u_(o.b,o.c,t,n,o,r),u_(o.c,o.a,t,n,o,r)}(s,l,d,p);let u,m,f,g,v,b,y,x=[];for(let t of Array.from(p.keys())){for(m=p.get(t),f=new he,v=3/8,b=1/8,y=m.faces.length,2!=y&&(v=.5,b=0),f.addVectors(m.a,m.b).multiplyScalar(v),o.set(0,0,0),i=0;i<y;i++){for(g=m.faces[i],a=0;a<3&&(u=s[d_(g,h_[a])],u===m.a||u===m.b);a++);u&&o.add(u)}o.multiplyScalar(b),f.add(o),m.newEdge=x.length,x.push(f)}let _,w,S,E,M,A,T,P=[];for(r=0,n=s.length;r<n;r++){for(A=s[r],M=d[r].edges,e=M.length,3==e?_=3/16:e>3&&(_=3/(8*e)),w=1-e*Number(_),S=_,e<=2&&(2==e&&(w=3/4,S=1/8)),T=A.clone().multiplyScalar(w),o.set(0,0,0),i=0;i<e;i++)E=M[i],u=E.a!==A?E.a:E.b,o.add(u);o.multiplyScalar(Number(S)),T.add(o),P.push(T)}let C,k,D,L,R,O,I,N=P.concat(x),z=P.length,F=[],U=[],B=new Ot,V=new Ot,j=new Ot;for(r=0,n=l.length;r<n;r++)g=l[r],C=Number(p_(g.a,g.b,p).newEdge)+z,k=Number(p_(g.b,g.c,p).newEdge)+z,D=Number(p_(g.c,g.a,p).newEdge)+z,m_(F,C,k,D,g.materialIndex),m_(F,g.a,C,D,g.materialIndex),m_(F,g.b,k,C,g.materialIndex),m_(F,g.c,D,k,g.materialIndex),h&&(L=c[r],R=L[0],O=L[1],I=L[2],B.set(f_(R.x,O.x),f_(R.y,O.y)),V.set(f_(O.x,I.x),f_(O.y,I.y)),j.set(f_(R.x,I.x),f_(R.y,I.y)),g_(U,B,V,j),g_(U,R,B,j),g_(U,O,V,B),g_(U,I,j,V));t.vertices=N,t.faces=F,h&&(t.faceVertexUvs[0]=U)}},b_=new he,y_=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof hx?t.shape:new hx,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(t){let{width:e,height:r,spikes:n,cornerRadius:i,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}=t.parameters,l=t.shape,c=.5*e,h=.5*r,d=2*Math.PI/n;for(let t=0;t<n;t++){let e=d*t,r=0+Math.sin(e)*c,n=0+Math.cos(e)*h;l.addPoint(l.createPoint(r,n))}l.isClosed=!0;for(let t=0,e=l.points.length;t<e;t++)l.points[t].roundness=i;l.roundness=i,l.update();let p=Vx.create({shape:l,parameters:{roundness:i,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}});return Object.assign(p,{userData:{...t,type:"PolygonGeometry"}})}};function x_(t,e,r){r.x=t.x*e.x,r.y=t.y,r.z=t.x*e.y}function __(t,e,r,n,i,a){let o=e.clone().sub(t),s=r.clone().sub(t),l=o.angleTo(s);if(o.normalize(),s.normalize(),n===i){let e=o.add(s).normalize();a.copy(t).addScaledVector(e,n/Math.sin(l/2))}else{let e=o.angleTo(s);a.copy(t),a.addScaledVector(o,i/Math.sin(e)),a.addScaledVector(s,n/Math.sin(e))}}function w_(t,e,r){let n=t.clone().sub(e),i=r.clone().sub(e);return n.projectOnVector(i),n.add(e)}var S_=class extends qr{constructor(t=.5,e=1,r=4,n=1,i=!1,a=0,o=4){super(),r=Math.floor(Math.max(3,r)),n=Math.floor(n),o=Math.floor(o);let s,l=[],c=[],h=[],d=[],p=0,u=e/2,m=Math.PI/r,f=t*Math.cos(Math.PI/r),g=2*Math.PI/r,v=(r-2)*Math.PI/r,b=Math.PI-v,y=new he(0,-u,0),x=new he(0,u,0),_=new Ot(t,-u),w=new Ot(f,-u),S=new Ot(0,x.y).sub(w),E=new Ot(0,x.y).sub(_),M=new Ot(S.y,-S.x).normalize(),A=new Ot(E.y,-E.x).normalize(),T=t*Math.cos(Math.PI/r)*Math.tan((Math.PI-S.angle())/2)-1e-8;a=Math.min(a,T);{let t=new he(M.x,M.y,0),e=new he(Math.cos(g)*t.x,t.y,Math.sin(g)*t.x);s=t.angleTo(e)}let P=a/Math.tan((Math.PI-S.angle())/2),C=a/Math.tan((Math.PI-s)/2),k=new he;if(!i){c.push(y.x,y.y,y.z),h.push(0,-1,0),d.push(0,0);let t=p++,e=[],n=_.clone(),i=P/Math.cos(Math.PI/r);n.x-=i;for(let t=0;t<r;t++){let i=t/r*Math.PI*2+m;x_(n,new Ot(Math.sin(i),Math.cos(i)),k),c.push(k.x,k.y,k.z),h.push(0,-1,0),d.push(0,0),e.push(p++)}for(let r=0;r<e.length;r++)l.push(e[r],t,e[(r+1)%e.length])}let D=[];{let t=new he,e=new he,n=new he,i=new he,u=new he,f=new he;for(let g=0;g<r;g++){let v=g/r*Math.PI*2+m,b=(g+.5)/r*Math.PI*2+m,w=(g+1)/r*Math.PI*2+m,E=new Ot(Math.sin(v),Math.cos(v)),T=new Ot(Math.sin(b),Math.cos(b)),k=new Ot(Math.sin(w),Math.cos(w));x_(_,E,e),x_(_,k,n),x_(M,T,t),__(x,e,n,C,C,i),c.push(i.x,i.y,i.z),__(e,x,n,C,P,u),c.push(u.x,u.y,u.z),__(n,e,x,P,C,f),c.push(f.x,f.y,f.z),h.push(t.x,t.y,t.z),h.push(t.x,t.y,t.z),h.push(t.x,t.y,t.z),d.push(0,0),d.push(0,0),d.push(0,0);let O=p++,I=p++,N=p++;if(l.push(O,I,N),a>0){{let t=e.clone().add(n).multiplyScalar(.5),r=x.clone().sub(t).normalize(),i=y.clone().sub(t).normalize().add(r).normalize().multiplyScalar(-1);L(t,f.clone().sub(u),i,S.angle())}let m,g;{let t=new he;x_(A,k,t);let e=f.clone().add(i).multiplyScalar(.5);e=w_(e,n,x);let r=f.clone().sub(i);[m,g]=L(e,r,t,s,i.y)}{let t=m,e=t.clone().setY(0).normalize(),r=new he(0,-1,0),n=e.clone().cross(r);R(t,e,r,n)}D.concat(g);{let e=S.angle(),n=Math.PI-e,i=x.clone();i.y-=a/Math.sin(e-Math.PI/2);let s=new he,u=[];for(let e=0;e<o;e++){let l=[],m=Math.PI/2-n*e/o,f=Math.cos(m),g=Math.sin(m),v=b;for(let n=0;n<=e;n++){let n=Math.cos(v),o=Math.sin(v);t.x=f*o,t.y=g,t.z=f*n,s.copy(i).addScaledVector(t,a),c.push(s.x,s.y,s.z),h.push(t.x,t.y,t.z),d.push(0,0),l.push(p++),v+=2*Math.PI/e/r}u.push(l)}g.reverse(),u.push(g);let m=u.length-1;for(let t=0;t<m;t++){let e=u[t],r=u[t+1],n=e.length-1;l.push(r[1],e[0],r[0]);for(let t=1;t<=n;t++)l.push(e[t],e[t-1],r[t]),l.push(r[t+1],e[t],r[t])}}}}}function L(t,e,r,n,i){let s=-n/2,u=(Math.PI-n)/2,m=e.clone().normalize().cross(r);t.addScaledVector(r,-a/Math.sin(u));let f=new he,g=new he,v=p,b=[];for(let l=0;l<=o;l++){let u=s+l/o*n;g.set(0,0,0),g.addScaledVector(m,Math.sin(u)),g.addScaledVector(r,Math.cos(u));for(let r=0;r<=1;r++){let n=r/1-.5;if(f.copy(t),f.addScaledVector(e,n),f.addScaledVector(g,a),null!=i){let t=Math.max(0,f.y-i);f.addScaledVector(e,-t/e.y)}c.push(f.x,f.y,f.z),h.push(g.x,g.y,g.z),d.push(0,0),0===r&&b.push(p),p++}}for(let t=0;t<o;t++)for(let e=0;e<1;e++){let r=v+e+2*t,n=r+2,i=n+1,a=r+1;l.push(r,n,a),l.push(n,i,a)}return[t.clone().addScaledVector(e,.5),b]}function R(t,e,r,n){let i=Math.PI/2,s=E.angle()-i,u=[],m=new he,f=new he;for(let l=0;l<=o;l++){let g=[],v=l/o;for(let o=0;o<=l;o++){let u=((l?o/l:0)-.5)*b,y=Math.cos(u),x=Math.sin(u),_=(i+Math.atan(Math.tan(s)*y))*v,w=Math.cos(_),S=Math.sin(_);m.set(0,0,0),m.addScaledVector(e,S*y),m.addScaledVector(r,w),m.addScaledVector(n,S*x),f.copy(t).addScaledVector(m,a),c.push(f.x,f.y,f.z),h.push(m.x,m.y,m.z),d.push(0,0),g.push(p++)}u.push(g)}let g=u.length-1;for(let t=0;t<g;t++){let e=u[t],r=u[t+1],n=e.length-1;l.push(e[0],r[1],r[0]);for(let t=1;t<=n;t++)l.push(e[t-1],e[t],r[t]),l.push(e[t],r[t+1],r[t])}}this.setIndex(l),this.setAttribute("position",new Fr(c,3)),this.setAttribute("normal",new Fr(h,3)),this.setAttribute("uv",new Fr(d,2))}},E_=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),n=Object.assign(e?.ui??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof hx?t.shape:new hx,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:n}}static build(t){let e=t.shape,{width:r,height:n,cornerRadius:i,cornerType:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=t.parameters,c={x:.5*r,y:.5*n},h={x:-c.x,y:-c.y},d={x:c.x,y:c.y};function p(t,e,i){return e>r&&i>n?Math.min(t*r/e,t*n/i):e>r?t*r/e:i>n?t*n/i:t}let u=[];u[0]=0===i[0]?0:p(i[0],i[0]+i[3],i[0]+i[1]),u[1]=0===i[1]?0:p(i[1],i[1]+i[2],i[1]+i[0]),u[2]=0===i[2]?0:p(i[2],i[2]+i[1],i[2]+i[3]),u[3]=0===i[3]?0:p(i[3],i[3]+i[0],i[3]+i[2]);let m=h.x,f=d.x,g=d.y,v=h.y;e.addPoint(e.createPoint(m,g)),e.addPoint(e.createPoint(f,g)),e.addPoint(e.createPoint(f,v)),e.addPoint(e.createPoint(m,v)),e.isClosed=!0;let b=!0;for(let t=0,r=e.points.length;t<r;t++)e.points[t].roundness=u[t],t>0&&u[t]!==u[t-1]&&(b=!1);b&&(e.roundness=u[0]),e.useCubicForRoundedCorners=1!==a,e.update();let y=Vx.create({shape:e,parameters:{depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}});return Object.assign(y,{userData:{...t,type:"RectangleGeometry"}})}},M_=class extends qr{constructor(t=1,e=1,r=1,n=90,i=10,a=24){super(),this.type="BackdropGeometry";let o=[],s=[],l=[],c=.001;0==i&&(a=1),a=Math.max(1,Math.floor(a)),i=Math.min(i,100),n=Math.min(180-c,n),n*=Math.PI/180;let h=[],d=Math.PI/2,p=(t=0,e=0,r=0)=>new he(t,e,r),u=p(),m=p(),[f,g,v]=[e/2,t/2,r/2],b=-g,y=+g,[x,_,w]=[p(b,-f,+v),p(b,-f,-v),p(b,+f,-v)],S=(t,e=!1)=>Math.sin(t-Math.PI/(+e+1)),E=(t,e=!1)=>Math.cos(t-Math.PI/(+e+1));w.y=Math.sin(n)*e-f;let M=Math.cos(n)*e-v,A=x.z-c;n<=d?(w.z=Math.min(M,A),w.z==A&&(w.y-=(M-A)/Math.tan(d-n))):_.z=Math.min(_.z-M-v,x.z-c),u.subVectors(x,_),m.subVectors(w,_);let T=Math.min(u.length(),m.length())*i/100,P=T*Math.tan(n/2),C=T/Math.cos(n/2),k=u.clone().normalize().add(m.normalize()).setLength(C).add(_);u.set(0,S(n,!0),E(n,!0)),h.push([w,u.clone()]);let D=(Math.PI-n)/a;for(let t=0;t<=a;t++){let e=d+n+t*D;u.set(0,Math.sin(e)*P,Math.cos(e)*P),u.add(k),m.set(0,S(e),E(e)),h.push([u.clone(),m.clone()])}h.push([x,p(0,1,0)]);let L=Math.sin(D/2)*P*2,R=h.length-1,O=h[0][0].distanceTo(h[1][0]),I=O+L*a+h[R-1][0].distanceTo(h[R][0]);h[0].push(1);for(let t=0;t<=a;t++)h[t+1].push(1-(O+t*L)/I);h[R].push(0);let N,z,F,[U,B,V]=h[0];for(let t=1;t<h.length;t++)[N,z,F]=h[t],o.push(b,U.y,U.z,b,N.y,N.z,y,U.y,U.z,y,U.y,U.z,b,N.y,N.z,y,N.y,N.z),s.push(0,B.y,B.z,0,z.y,z.z,0,B.y,B.z,0,B.y,B.z,0,z.y,z.z,0,z.y,z.z),l.push(0,V,0,F,1,V,1,V,0,F,1,F),[U,B,V]=[N,z,F];this.setAttribute("position",new Fr(o,3)),this.setAttribute("normal",new Fr(s,3)),this.setAttribute("uv",new Fr(l,2))}},A_=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof hx?t.shape:new hx,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(t){let{width:e,height:r,innerRadiusPercent:n,spikes:i,cornerRadius:a,angle:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,d=.5*e,p=.5*r,u=o*Math.PI/360/i,m=Math.PI/2*3*-1,f=d*n/100,g=p*n/100;if(3===i&&50===n){u=2*Math.PI/i;for(let t=0;t<i;t++){let e=u*t,r=0+Math.sin(e)*d,n=0+Math.cos(e)*p;h.addPoint(h.createPoint(r,n))}}else for(let t=0;t<i;t++){let t=0+Math.cos(m)*d,e=0+Math.sin(m)*p;h.addPoint(h.createPoint(t,e)),m+=u,t=0+Math.cos(m)*f,e=0+Math.sin(m)*g,h.addPoint(h.createPoint(t,e)),m+=u}h.isClosed=!0;for(let t=0,e=h.points.length;t<e;t++)h.points[t].roundness=a;h.roundness=a,h.update();let v=Vx.create({shape:h,parameters:{roundness:a,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(v,{userData:{...t,type:"StarGeometry"}})}};var T_=new Be,P_=new Be;var C_=class extends qr{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&1===this.inputs.parameters.extrusion.depth}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&1===t.depth&&function(t,e){let r=2*Math.PI;return(t%r+r)%r==(e%r+r)%r}(t.twist,0)&&t.startScale===t.endScale)}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:r,offset:n}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1));let i=this.inputs.path.isClosed?t.length:t.length-1,a=Math.floor(n*i),o=this.inputs.path.isClosed?Math.ceil((r+n)*i):Math.ceil(Math.min(1,r+n)*i),s=Math.min(Math.max(2,o-a+1),i+2),l=[],c=[];for(let r=0;r<s;r++){let n=this.inputs.path.isClosed?(r+a)%t.length:Math.min(r+a,t.length-1);l.push(t[n].clone()),c.push(e[n].clone())}let h=(t,e,r)=>{l[t]=l[t].clone().lerp(l[e],r),c[t]=function(t,e,r){let n=[new he,new he,new he],i=[new he,new he,new he];return t.extractBasis(n[0],n[1],n[2]),e.extractBasis(i[0],i[1],i[2]),n.forEach(((t,e)=>{let n=i[e],a=Rt.lerp(t.length(),n.length(),r);t.lerp(n,r).setLength(a)})),(new Be).makeBasis(n[0],n[1],n[2])}(c[t],c[e],r)},d=0,p=n*i%1;(!this.inputs.path.isClosed||r<=1)&&(p||0===n)&&(d=p,h(0,1,d));let u=0,m=(n+r)*i%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&n+r<1)&&m&&(u=m,h(l.length-1,l.length-2,1-u)),0===r){let t=l.length-1;l[t].copy(l[0]),c[t].copy(c[0])}this._applyPathModifiers(c,d,u);let{bevel:f,bevelSides:g}=this.inputs.parameters.extrusion,v=f>0?this.inputs.parameters.extrusion.capType:"flat",b=5;"Custom"===this.inputs.parameters.extrusion.shape.type&&(b="low"===this.inputs.parameters.extrusion.shape.shapeQuality?5:12);let y,{regions:x,infos:_,vertices:w}=this._computeShapePoints(b),S=0;"round"===v&&(y=new Fx(this.inputs.shapeData,2*f,f,b,g,void 0,!0),S=y.getAttribute("position").count);let E=0,M=0;_.sort(((t,e)=>t.start-e.start)),_.forEach((t=>{t.verticesStart=E,t.verticesCount=t.continuous.reduce(((t,e,r)=>t+(0!==r&&e?1:2)),0),M+=t.verticesCount,E=M}));let A,T=M*s,P=0;if(this._isOpenEnded()&&"flat"===v){try{A=kx({windingRule:rx.ODD,elementType:nx.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{A=Nx}P=A.vertexCount}let C=T+2*P+2*S,k=T+2*P,D={positions:new Float32Array(3*C),normals:new Float32Array(3*C),uvs:new Float32Array(2*C)},L=[];if(_.forEach((t=>{this._extrudeRegion(t,w,c,l,D,L,this._isGeometryClosed()&&!this._isOpenEnded())})),A&&(this._closeEnd(A,T,L,D,c[0],l[0],!1),this._closeEnd(A,T+P,L,D,c[c.length-1],l[l.length-1],!0)),y){D.positions.set(y.getAttribute("position").array,3*k),D.normals.set(y.getAttribute("normal").array,3*k),D.uvs.set(y.getAttribute("uv").array,2*k);let t=L.length;L.push(...y.getIndex().array.map((t=>t+k))),k+=S,D.positions.set(y.getAttribute("position").array,3*k),D.normals.set(y.getAttribute("normal").array,3*k),D.uvs.set(y.getAttribute("uv").array,2*k);let e=L.length;L.push(...y.getIndex().array.map((t=>t+k))),this.setAttribute("position",new Ir(D.positions,3)),this.setAttribute("normal",new Ir(D.normals,3)),this.setAttribute("uv",new Ir(D.uvs,2)),this.setIndex(L);let r=T_;r.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(r,k,C),r.copy(c[0]).setPosition(l[0]).multiply(P_.makeScale(1,1,-1)),this.applyMatrix4OnRange(r,k-S,k),this.reverseIndicesOnRange(t,e)}else this.setAttribute("position",new Ir(D.positions,3)),this.setAttribute("normal",new Ir(D.normals,3)),this.setAttribute("uv",new Ir(D.uvs,2)),this.setIndex(L)}_extractPathPoints(){let t=fy(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach((t=>{e[e.length-1].distanceToSquared(t)>.001&&e.push(t)})),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],r=t.length,n=this.inputs.path.isClosed,i=new he,a=new he,o=new he,s=new he,l=new he(0,1,0);for(let c=0;c<r;c++){let h,d,p=t[c];h=0===c?n?t[t.length-2]:p.clone().multiplyScalar(2).sub(t[1]):t[c-1],d=c===r-1?n?t[1]:p.clone().multiplyScalar(2).sub(t[c-1]):t[c+1];let u=p.clone().sub(h).normalize(),m=d.clone().sub(p).normalize(),f=u.clone().add(m).normalize();o.copy(f),0===c&&(f.equals(l)||f.clone().negate().equals(l))&&l.set(0,0,1);let g=l.clone().cross(f).normalize(),v=f.clone().cross(g).normalize();l.copy(v),s.copy(g),0===c&&(i.copy(v),a.copy(f));let b=(new Be).makeBasis(g,v,f);e.push(b)}let c=n?a:o,h=n?i:new he(0,1,0),d=c.clone().cross(s).normalize(),p=Math.acos(h.dot(d));if(isNaN(p))return e;let u=h.clone().cross(d);c.dot(u)>0&&(p*=-1);for(let t=1;t<e.length;t++){let r=(new Be).makeRotationZ(p*t/e.length);e[t].multiply(r)}return e}_applyPathModifiers(t,e,r){let n=t.length,{angle:i,twist:a,startScale:o,endScale:s}=this.inputs.parameters.extrusion,l=new Be,c=new Be;return t.forEach(((t,h)=>{let d=0===h?0:h===n-1?1:(h-e)/(n-(0===r?0:1)-(e+(1-r)));l.makeRotationZ(Rt.lerp(i,i+a,d)*Rt.DEG2RAD);let p=Rt.lerp(o,s,d);c.makeScale(p,p,p),t.multiply(l).multiply(c)})),t}_computeShapePoints(t=12,e=rx.ODD){let r,n,i=this.inputs.shapeData,a=i.extractShapePointsToFlatArray([],t),o=i.shapeHoles.map((e=>{let r=e.extractShapePointsToFlatArray([],t),n=[];for(let t=r.length-1;t>=1;t-=2){let e=r[t-1],i=r[t-0];n.push(e,i)}return n}));try{r=kx({windingRule:e,elementType:nx.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a]})}catch{r=Ox}try{n=kx({windingRule:rx.ODD,elementType:nx.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...o]})}catch{n=Ix}if(!r)throw new Error("error generating geometry");let s=r.elementCount;if(n){r.elementCount+=n.elementCount;for(let t=0;t<n.elements.length;t++){let e=n.elements[t],i=t%2==0?r.vertexCount:0;r.elements.push(e+i)}for(let t=0;t<n.vertexIndices.length;t++){let e=n.vertexIndices[t],i=r.vertexCount;r.vertexIndices.push(e+i)}for(let t=0;t<n.vertices.length;t++){let e=n.vertices[t];r.vertices.push(e)}}let l=1/0,c=-1/0,h=1/0,d=-1/0;for(let t=0,e=r.vertexCount;t<e;t++){let e=2*t,n=r.vertices[e+0],i=r.vertices[e+1];n<l&&(l=n),n>c&&(c=n),i<h&&(h=i),i>d&&(d=i)}let p=[];for(let t=r.elementCount-1;t>=0;t--){let e=t>=s,n=2*t,a=r.elements[n+0],o=r.elements[n+1],l=a+o,c={start:a,count:o,normals:[],isHole:e,continuous:[],verticesStart:0,verticesCount:0};p.push(c);let h=a,d=l-1,u=a+1,m=i.roundedCurves.length;do{let t=h-a,n=r.vertices[2*d+0],s=r.vertices[2*d+1],p=r.vertices[2*h+0],f=r.vertices[2*h+1],g=r.vertices[2*u+0],v=r.vertices[2*u+1],b=p-n,y=f-s,x=Math.sqrt(b*b+y*y);b/=x,y/=x;let _=p-g,w=f-v,S=Math.sqrt(_*_+w*w);_/=S,w/=S,c.normals[2*t+0]=-w,c.normals[2*t+1]=_;let E=r.vertexIndices[h];if(Array.isArray(E))c.continuous[t]=!1;else{let[e,r]=i.getCurveIndexFromVertexId(E-1,!0);if(r>0&&r<1)c.continuous[t]=!0;else{let n=1===r?e+1:e-1;n=(n+m)%m;let a=1===r?0:1,o=i.roundedCurves[e].getTangent(r),s=i.roundedCurves[n].getTangent(a);c.continuous[t]=o.dot(s)>.95}}e&&(c.normals[2*t+0]*=-1,c.normals[2*t+1]*=-1),[d,h,u]=[h,u,u+1],u>=l&&(u-=o)}while(u!==a+1)}return{regions:[a,...o],infos:p,vertices:r.vertices}}_insertVertex(t,e,r,n,i){let a=2*e,o=3*e;t.positions[o+0]=r.x,t.positions[o+1]=r.y,t.positions[o+2]=r.z,t.normals[o+0]=n.x,t.normals[o+1]=n.y,t.normals[o+2]=n.z,t.uvs[a+0]=i.x,t.uvs[a+1]=i.y}_extrudeRegion(t,e,r,n,i,a,o){let s=new he,l=new he,c=new he,h=new he,d=new Ot;r.forEach(((a,o)=>{let p=n[o],u=t.verticesStart*r.length+t.verticesCount*o;for(let n=0;n<t.count;n++){let m=2*(t.start+n);if(s.set(e[m+0],e[m+1],0),c.copy(s).applyMatrix4(a).add(p),t.continuous[n])h.set(t.normals[2*n+0],t.normals[2*n+1],0);else{let r=0===n?2*(t.start+t.count-1):m-2;l.set(e[r+0],e[r+1],0),h.copy(s).sub(l),h.set(-h.y,h.x,0),t.isHole||h.negate()}if(h.applyMatrix4(a).normalize(),d.set(0===n?1:n/t.count,o/(r.length-1)),this._insertVertex(i,u,c,h,d),u++,!t.continuous[n]||0===n){if(0===n)h.set(t.normals[2*n+0],t.normals[2*n+1],0),d.set(0,o/(r.length-1));else{let r=n===t.count-1?2*t.start:m+2;l.set(e[r+0],e[r+1],0),h.copy(l).sub(s),h.set(-h.y,h.x,0),t.isHole||h.negate()}h.applyMatrix4(a).normalize(),this._insertVertex(i,u,c,h,d),u++}}}));let p=r.length-1;for(let e=0;e<p;e++){let n=t.verticesStart*r.length+t.verticesCount*e,i=t.verticesStart*r.length+t.verticesCount*(e+1),o=0;for(let e=0;e<t.count;e++){(!t.continuous[e]||0===e)&&o++;let r=e===t.count-1?0:o+1,s=n+o,l=n+r,c=i+r,h=i+o;t.isHole?a.push(s,c,l,s,h,c):a.push(s,l,c,s,c,h),o++}}}_closeEnd(t,e,r,n,i,a,o){let s=t.vertexCount,l=new he(0,0,o?-1:1).applyMatrix4(i),c=new he,h=new Ot;for(let r=0;r<s;r++){let o=2*r;c.set(t.vertices[o+0],t.vertices[o+1],0).applyMatrix4(i).add(a),this._insertVertex(n,e+r,c,l,h)}let d=t.elements;for(let n=0;n<t.elementCount;n++){let t=3*n,i=d[t+0]+e,a=d[t+(o?1:2)]+e,s=d[t+(o?2:1)]+e;r.push(i,a,s)}}applyMatrix4OnRange(t,e,r){let n,i,a,o,s=t.elements,l=(new It).getNormalMatrix(t).elements,c=this.attributes.position,h=this.attributes.normal;if(!c||!h)return;let d=c.array,p=h.array,u=c.itemSize;for(let t=e*u,c=r*u;t<c;t+=u)n=d[t+0],i=d[t+1],a=d[t+2],o=1/(s[3]*n+s[7]*i+s[11]*a+s[15]),d[t+0]=(s[0]*n+s[4]*i+s[8]*a+s[12])*o,d[t+1]=(s[1]*n+s[5]*i+s[9]*a+s[13])*o,d[t+2]=(s[2]*n+s[6]*i+s[10]*a+s[14])*o,n=p[t+0],i=p[t+1],a=p[t+2],p[t+0]=l[0]*n+l[3]*i+l[6]*a,p[t+1]=l[1]*n+l[4]*i+l[7]*a,p[t+2]=l[2]*n+l[5]*i+l[8]*a;c.needsUpdate=!0,h.needsUpdate=!0}reverseIndicesOnRange(t,e){let r=this.index;if(r){for(let n=t;n<e;n+=3){let t=r.getX(n),e=r.getX(n+1),i=r.getX(n+2);r.setXYZ(n,i,e,t)}r.needsUpdate=!0}}};function k_(){let t=new qr;return t.setAttribute("position",new Ir(new Float32Array([]),3)),t.setIndex(new Ir(new Uint16Array([]),1)),t}var D_=k_().attributes,L_=class extends qr{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,D_),this.userData={parameters:t,type:"TextGeometry"};let r=e.getFont(t.font);r?.isLoaded?(this.font=r,this.update(t)):this.updateFont(t.font,e).then((()=>{this.update(t),e?.requestRender()}))}async updateFont(t,e){let r=e.getFont(t);r&&(this.font=r,await r.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!e?.isLoaded)return void console.warn("Cannot update text because its font is not loaded");let{width:r,height:n,depth:i,extrudeBevelSize:a,extrudeBevelSegments:o,text:s,textTransform:l}=t,c=ib.getDisplayedValue(s),h=function(t,e,r){let n=[""],i="";for(let a of r)i+=a," "===a||"\n"===a?(n[n.length-1]+=i,i="","\n"===a&&n.push("")):e.getTextWidth(n[n.length-1]+i,t)>t.width&&(n[n.length-1].length&&n.push(""),e.getTextWidth(n[n.length-1]+i,t)>t.width&&(1===i.length?(n[n.length-1]+=i,i=""):(n[n.length-1]+=i.slice(0,-1),i=i[i.length-1],n.push(""))));return n[n.length-1]+=i,n}(t,e,2===l?c.toUpperCase():3===l?c.toLowerCase():c),{shapes:d,charWidths:p,charCoords:u}=e.generateShapes(h,t),m=.5*("number"==typeof r?r:1),f=.5*("number"==typeof n?n:1),g=d.map((t=>(new hx).fromShape(t,!0)));this.vectorShapes=g;let v=g.map((t=>Vx.create({shape:t,parameters:{depth:i,extrudeBevelSegments:o,extrudeBevelSize:a,windingRule:i<=0?rx.NONZERO:rx.ODD,subdivisions:this.isLowResolution&&i>0?1:12}}))),b=v.length?tc(v):k_();b.translate(-m,f,0),this.dispose(),this.wrappedText=h,this.charCoords=u,this.charWidths=p,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach((([t,e])=>{this.setAttribute(t,e)})),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let t=Ec(new qr,L_.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach((([t,e])=>{this.setAttribute(t,e)})),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};var R_=new Promise((t=>{t}));function O_(t,e,r,n){let i,a,o;"PathGeometry"===t.type?(a=JSON.parse(JSON.stringify(t)),o=[[],["extrusion"]]):(a={...t},o=[[]]);for(let t of o){let r=a;for(let e of t)r=r[e];for(i in r){let a=r[i];tv(a)&&(r[i]=e.getVariable(a,[n.uuid,"geometry",...t,i]))}}let s,l={parameters:a,type:a.type};if("PathGeometry"===a.type)l.path=a.path;else if("VectorGeometry"===a.type){let t=hx.createFromState(a.shape,a.width,a.height);l.shape=t}else if("NonParametricGeometry"===a.type)a.data.groups&&a.data.groups?.forEach((t=>t.materialIndex=Math.max(t.materialIndex??0,0))),l.geometry=(new Ml).parse(a);else{if("SubdivGeometry"===a.type){let e=new G_(a,r);return e.data=t,e}if("TextGeometry"===a.type)return new L_(a,e)}try{s=hw(l)}catch(t){console.error(t)}if(!s){let t=hx.createFromState(yv.defaultData(),100,100);l.shape=t,s=hw(l)}return s}var I_=new Be;function N_(t,e,r,n){let i,a,o,s=t.position.array,l=t.normal.array,c=I_.makeScale(e,r,n).invert().elements;for(var h=0,d=s.length;h<d;h+=3)s[h]*=e,s[h+1]*=r,s[h+2]*=n,i=l[h],a=l[h+1],o=l[h+2],l[h]=c[0]*i+c[4]*a+c[8]*o,l[h+1]=c[1]*i+c[5]*a+c[9]*o,l[h+2]=c[2]*i+c[6]*a+c[10]*o;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var z_,F_=new ue,U_=new he;R_.then((t=>{z_=t}));var B_=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),V_=new Uint32Array([0,1,2,3]),j_=new Uint8Array([4]),G_=class extends qr{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let r=this.data.scaleBaked,n=Og.div(e,r);this.subdividedGeometry&&N_(this.subdividedGeometry.attributes,...n),this.originalGeometry&&N_(this.originalGeometry.attributes,...n),this.data=t;let i=this.userData.parameters;this.userData.parameters={width:i.width*n[0],height:i.height*n[1],depth:i.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(U_.fromArray(n));let a=U_.set(i.width,i.height,i.depth).length();this.originalGeometry.boundingSphere.radius=a/2}ensureSubdivPointer(){return 0===this.subdivPointer&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,r;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:r}=G_.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new un(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let n=this.subdividedGeometry??this.originalGeometry;Object.assign(this,n),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(G_.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;null===t.boundingSphere&&(t.boundingSphere=new De,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,r=t.boundingSphere.center;F_.setFromBufferAttribute(e),F_.getCenter(r),t.boundingSphere.radius=r.distanceTo(F_.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),F_.getSize(U_);let n={width:U_.x,height:U_.y,depth:U_.z};return this.userData.parameters=n,n}static build(t,e,r,n){let i,a,o,s=t?.phongAngle??35;!1===r&&(s=-1),e&&(z_.free_bvh(e),z_.free_subdivision_surface(e));try{i=G_.allocate(t,n)}catch(e){console.error(e,t),i=G_.allocate({positionWASM:B_,indexWASM:V_,verticesPerFaceWASM:j_},n)}if(z_.set_destination_refinement_level(i,0),a=G_.buildLevel(i,!0,s),t.subdivisions>0)try{z_.set_destination_refinement_level(i,t.subdivisions),o=G_.buildLevel(i,!1,s)}catch{try{z_.set_destination_refinement_level(i,t.subdivisions-1),o=G_.buildLevel(i,!1,s)}catch{o=null}}else o=null;return{subdivPointer:i,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(t,e,r){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),"DodecahedronGeometry"===t.type&&(t.detail=0);let n,i,a,o,s,l,c=void 0!==t.shape||void 0!==t.path?e.geometry:O_(t,r,!1);if(n="TorusGeometry"===t.type&&t.arc===2*Math.PI?c.getClosedTorusIndicesForBooleanOrSubdiv():c.getIndex(),({positions:i,triIndices:s}=W_(c.getAttribute("position"),n)),"CylinderGeometry"===t.type&&0===t.cornerRadius&&0===t.hollow&&!1===t.openEnded){let e=t.radialSegments*t.heightSegments*3*2;l=[e,e+3*t.radialSegments]}return({indices:a,verticesPerFace:o}=Z_(i,s,c,l)),{positions:i,indices:a,verticesPerFace:o}}static allocate(t,e){let r,n,i,a=[],o=[];t.positionWASM&&t.positionWASM.length>0?(r=t.positionWASM,n=t.indexWASM,i=t.verticesPerFaceWASM):(r=B_,n=V_,i=j_);let s,l=r.length,c=n.length,h=i.length,d=r.length+a.length+o.length,p=n.length+i.length,u=d*Float32Array.BYTES_PER_ELEMENT+p*Uint32Array.BYTES_PER_ELEMENT,m=d*Float32Array.BYTES_PER_ELEMENT,f=(Uint32Array.BYTES_PER_ELEMENT,z_._malloc(u)),g=new Float32Array(z_.HEAPF32.buffer,f,d),v=new Uint32Array(z_.HEAPU32.buffer,f+m,p);g.set(r,0),g.set(a,r.length),g.set(o,r.length+a.length),v.set(n,0),v.set(i,n.length),t?.scaleBaked?.some((t=>1!==t))&&(s=(new Be).makeScale(...t.scaleBaked)),e&&(s?s.premultiply(e):s=e);let b=s?z_.alloc_subdivision_surface2(f,l,f+m,c,f+m+n.length*Uint32Array.BYTES_PER_ELEMENT,h,s.elements):z_.alloc_subdivision_surface(f,l,f+m,c,f+m+n.length*Uint32Array.BYTES_PER_ELEMENT,h);return z_._free(f),b}static buildLevel(t,e,r,n,i){let a=i?z_.get_mesh_data2(t,e?z_.Level.CONTROL:z_.Level.REFINED,r,i.elements):z_.get_mesh_data(t,e?z_.Level.CONTROL:z_.Level.REFINED,r),o=z_.HEAPU32.subarray(a>>2,8+(a>>2)),s=o.subarray(4,8),l=0,c=z_.HEAPU32[o[l]>>2],h=z_.HEAPF32.subarray(c>>2,(c>>2)+s[l]);l++;let d=z_.HEAPU32[o[l]>>2],p=z_.HEAPF32.subarray(d>>2,(d>>2)+s[l]);l++;let u=z_.HEAPU32[o[l]>>2],m=z_.HEAPU32.subarray(u>>2,(u>>2)+s[l]);l++;let f=z_.HEAPU32[o[l]>>2],g=z_.HEAPU32.subarray(f>>2,(f>>2)+s[l]);if(l++,void 0===n){let t=new qr;if(t.setIndex(new zr(g,1)),t.setAttribute("position",new Fr(h,3)),t.setAttribute("normal",new Fr(p,3)),e){t.setAttribute("faceMap",new zr(m,1));let e=new Float32Array(p.length/3*4).fill(0);t.setAttribute("color",new Ir(e,4))}return z_.free_mesh_data(a),t.userData.type="SubdivGeometry",t}n.getAttribute("position").copyArray(h),n.getAttribute("normal").copyArray(p),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,z_.free_mesh_data(a)}static freeSubdivPointer(t){z_.free_bvh(t),z_.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,r){let n=z_.get_wireframe_data_for_base_level(t),i=z_.HEAPU32.subarray(n>>2,4+(n>>2)),a=i.subarray(2,4),o=0,s=z_.HEAPU32[i[o]>>2],l=z_.HEAPF32.subarray(s>>2,(s>>2)+a[o]);o++;let c=z_.HEAPU32[i[o]>>2],h=z_.HEAPU32.subarray(c>>2,(c>>2)+a[o]);if(void 0===e){let t=new qr;t.setAttribute("position",new Fr(l,3));let e=new Float32Array(l.length);for(let t=0,n=l.length;t<n;)e[t++]=r.r,e[t++]=r.g,e[t++]=r.b;return t.setAttribute("color",new Ir(e,3)),t.setIndex(new zr(h,1)),z_.free_wireframe_data_for_base_level(n),t}e.getAttribute("position").copyArray(l),e.attributes.position.needsUpdate=!0,z_.free_wireframe_data_for_base_level(n)}static updateCollabMesh(t,e,r){let n=0===e;n||z_.set_destination_refinement_level(t,e);let i=r?z_.get_topological_data2(t,n?z_.Level.CONTROL:z_.Level.REFINED,r.elements):z_.get_topological_data(t,n?z_.Level.CONTROL:z_.Level.REFINED),a=z_.HEAPU32.subarray(i>>2,6+(i>>2)),o=a.subarray(3,6),s=0,l=z_.HEAPU32[a[s]>>2],c=new Float32Array(z_.HEAPF32.subarray(l>>2,(l>>2)+o[s]));s++;let h=z_.HEAPU32[a[s]>>2],d=new Uint32Array(z_.HEAPU32.subarray(h>>2,(h>>2)+o[s]));s++;let p=z_.HEAPU32[a[s]>>2],u=new Uint8Array(z_.HEAPU32.subarray(p>>2,(p>>2)+o[s]));return z_.free_topological_data(i),{positions:c,indices:d,verticesPerFace:u}}},H_=["getX","getY","getZ"];function W_(t,e){let r={},n=e?e.count:t.count,i=0,a=[],o=[];for(let s=0;s<n;s++){let n=e?e.getX(s):s,l="";for(let e=0;e<3;e++)l+=~~(1e4*t[H_[e]](n))+",";if(l in r)a.push(r[l]);else{for(let e=0;e<3;e++)o.push(t[H_[e]](n));r[l]=i,a.push(i),i++}}let s=[];for(let t=0;t<a.length;t+=3)a[t]===a[t+1]||a[t]===a[t+2]||a[t+1]===a[t+2]||s.push(a[t],a[t+1],a[t+2]);return{positions:o,triIndices:s}}var q_=new he,$_=new he,X_=new he,Y_=new he;function Z_(t,e,r,n){let i=[],a=[];if(void 0!==r.userData.shape&&0===r.userData.parameters.depth&&0===r.userData.shape.shapeHoles.length){let e=r.userData.shape.extractShapePointsToFlatArray([]),n=r.userData.parameters.spikes;if("EllipseGeometry"===r.userData.type&&n<=24&&n%4==0&&r.userData.parameters.angle>=360){let t=e.length/2/n;e=e.filter(((e,r)=>Math.floor(r/2)%t==0))}let o=0;for(let t=0;t<e.length;t+=2)o+=(e[t]-e[(0===t?e.length:t)-2])*(e[t+1]+e[(0===t?e.length:t)-1]);t.length=0;let s=0;if(o<0)for(let r=0;r<e.length;r+=2)t.push(e[r],e[r+1],0),i.push(s++);else for(let r=e.length-2;r>=0;r-=2)t.push(e[r],e[r+1],0),i.push(s++);return a.push(s),{indices:i,verticesPerFace:a}}let o=new Float32Array([r.userData.parameters.depth])[0],s=0;for(;s<e.length;){if(r.useNgonForTopBottomFaceDuringBake){let r=0;if((t[3*e[s]+2]===o||0===t[3*e[s]+2])&&r++,(t[3*e[s+1]+2]===o||0===t[3*e[s+1]+2])&&r++,(t[3*e[s+2]+2]===o||0===t[3*e[s+2]+2])&&r++,3===r)break}if(e[s+1]===e[s+3]&&e[s+2]===e[s+5]||e[s+0]===e[s+3]&&e[s+2]===e[s+4]){q_.set(t[3*e[s]],t[3*e[s]+1],t[3*e[s]+2]),$_.set(t[3*e[s+1]],t[3*e[s+1]+1],t[3*e[s+1]+2]),X_.set(t[3*e[s+4]],t[3*e[s+4]+1],t[3*e[s+4]+2]),Y_.set(t[3*e[s+5]],t[3*e[s+5]+1],t[3*e[s+5]+2]),$_.sub(q_).normalize(),X_.sub(q_).normalize(),Y_.sub(q_).normalize();let r=$_.cross(X_).dot(Y_);Math.abs(r)>.005||n&&n.some(((t,e)=>e%2!=1&&(s>=n[e]&&s<n[e+1])))?(i.push(e[s],e[s+1],e[s+2]),a.push(3),s+=3):(i.push(e[s],e[s+1],e[s+4],e[s+5]),a.push(4),s+=6)}else i.push(e[s],e[s+1],e[s+2]),a.push(3),s+=3}if(r.useNgonForTopBottomFaceDuringBake){let e=[],n=[],s=0;for(let r=0,i=0;r<t.length;r+=3,i++)0===t[r+2]&&(e.push(i),s++),t[r+2]===o&&n.push(i);if(0===r.userData.parameters.extrudeBevelSize){let t=n[0];n[0]=n[1],n[1]=t}e.reverse(),i.push(...e,...n),a.push(s,s)}return{indices:i,verticesPerFace:a}}var K_={};((t,e)=>{for(var r in e)rc(t,r,{get:e[r],enumerable:!0})})(K_,{calcBoolean:()=>iw,calcBooleanTopological:()=>nw,freeMeshSet:()=>lw,getMeshSet:()=>aw,hasOpenEdges:()=>ow,transformMeshSet:()=>sw});var J_,Q_,tw=new Promise((t=>{t}));function ew(t){let e=t.length,r=e*Uint32Array.BYTES_PER_ELEMENT,n=e*Float32Array.BYTES_PER_ELEMENT,i=Number.isInteger(t[0])?r:n,a=J_._malloc(i);return(Number.isInteger(t[0])?new Uint32Array(J_.HEAPU32.buffer,a,e):new Float32Array(J_.HEAPF32.buffer,a,e)).set(t,0),a}function rw(t){switch(t){case 0:return J_.OP.UNION;case 1:return J_.OP.INTERSECTION;case 2:return J_.OP.A_MINUS_B;case 3:return J_.OP.B_MINUS_A;case 4:return J_.OP.SYMMETRIC_DIFFERENCE;case 5:return J_.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function nw(t,e){void 0===Q_&&(Q_=J_.init_csg());let r=ew(t),n=J_.csg_calc_topological(Q_,r,t.length,rw(e));J_._free(r);let i=J_.HEAPU32.subarray(n>>2,6+(n>>2)),a=i.subarray(3,6),o=0,s=J_.HEAPU32[i[o]>>2],l=new Float32Array(J_.HEAPF32.subarray(s>>2,(s>>2)+a[o]));o++;let c=J_.HEAPU32[i[o]>>2],h=new Uint32Array(J_.HEAPU32.subarray(c>>2,(c>>2)+a[o]));o++;let d=J_.HEAPU32[i[o]>>2],p=new Uint8Array(J_.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return J_.free_mesh_data(n),{positions:l,indices:h,verticesPerFace:p}}function iw(t,e,r,n){void 0===Q_&&(Q_=J_.init_csg());let i=ew(t),a=J_.csg_calc(Q_,i,t.length,n,rw(e));J_._free(i);let o=J_.HEAPU32.subarray(a>>2,5+(a>>2)),s=o.subarray(2,5),l=0,c=J_.HEAPU32[o[l]>>2],h=J_.HEAPF32.subarray(c>>2,(c>>2)+s[l]);l++;let d=J_.HEAPU32[o[l]>>2],p=J_.HEAPF32.subarray(d>>2,(d>>2)+s[l]);l++;let u=s[l];r.setAttribute("position",new Fr(h,3)),r.setAttribute("normal",new Fr(p,3));let m=J_.HEAPF32.subarray(5+(a>>2),5+(a>>2)+6);return null===r.boundingSphere&&(r.boundingSphere=new De),r.boundingSphere.radius=-1,r.userData.parameters={width:2*m[3],height:2*m[4],depth:2*m[5]},J_.free_mesh_data(a),u}function aw(t,e,r){if(void 0===J_)return-1;let n,i,a;if(e&&void 0!==t.userData.positions){let e=t.userData;a=e.verticesPerFace.length,n=e.positions,i=Array(e.verticesPerFace.reduce(((t,e)=>t+e),0)+a);for(let t=0,r=0,n=0;t<e.verticesPerFace.length;t++){i[n++]=e.verticesPerFace[t];for(let a=0;a<e.verticesPerFace[t];a++)i[n++]=e.indices[r++]}}else({positions:n,faceIndices:i,nFaces:a}=function(t,e,r){let n,i;i="TorusGeometry"===t.userData.parameters.type&&t.userData.parameters.arc===2*Math.PI?t.getClosedTorusIndicesForBooleanOrSubdiv():t.getIndex();let a,{positions:o,triIndices:s}=W_(t.getAttribute("position"),i);if(e&&r){let{indices:e,verticesPerFace:r}=Z_(o,s,t);a=r.length,n=[];for(let t=0,i=0;t<a;t++){n.push(r[t]);for(let a=0;a<r[t];a++)n.push(e[i++])}}else{let t=s.length;n=Array(t+t/3),a=0;for(let t=0,e=0;e<n.length;)n[e++]=3,a++,n[e++]=s[t++],n[e++]=s[t++],n[e++]=s[t++]}return{positions:o,faceIndices:n,nFaces:a}}(t,e,r));let o=n.length,s=i.length,l=n.length,c=i.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,d=l*Float32Array.BYTES_PER_ELEMENT,p=(Uint32Array.BYTES_PER_ELEMENT,J_._malloc(h)),u=new Float32Array(J_.HEAPF32.buffer,p,l),m=new Uint32Array(J_.HEAPU32.buffer,p+d,c);return u.set(n,0),m.set(i,0),J_.get_csg_mesh(p,o,p+d,s,a)}function ow(t){return J_.has_open_edges(t)}function sw(t,e){try{J_.transform_csg_mesh(t,e.elements)}catch(t){console.error(t)}}function lw(t){J_.free_csg_mesh(t)}tw.then((t=>J_=t));var cw={ConeGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return r.thetaLength=Rt.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let e,{width:r,depth:n,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c,cornerRadiusTop:h,cornerRadiusBottom:d,cornerSegments:p}=t.parameters;return 0===c?(e=new qr,e.setAttribute("position",new Fr([],3))):e=h>0||d>0||c<360?new Ey(0,r/2,i,a,o,s,l,c*Math.PI/180,h,d,p,0,!0):new ss(r/2,i,a,o,s),e.scale(1,1,n/r),Object.assign(e,{userData:{...t,type:"ConeGeometry"}})}},CubeGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let e,{width:r,height:n,depth:i,widthSegments:a,heightSegments:o,depthSegments:s,cornerRadius:l,cornerSegments:c}=t.parameters;return e=0==l?new un(r,n,i,a,o,s):new Ay(r,n,i,a,o,s,l,c),Object.assign(e,{userData:{...t,type:"CubeGeometry"}})}},CylinderGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters);r.thetaLength=Rt.clamp(r.thetaLength,0,360);let n=r.width/2,i=r.radiusTop??n,a=r.radiusBottom??n;return i===a?(i=n,a=n):i>a?(i=n,a=a*n/i):(i=i*n/a,a=n),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:i,radiusBottom:a})}}static build(t){let e,{width:r,depth:n,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c,radiusTop:h,radiusBottom:d,cornerRadius:p,cornerSegments:u,hollow:m}=t.parameters;return 0===c?(e=new qr,e.setAttribute("position",new Fr([],3))):e=p||m?new Ey(h,d,i,a,o,s,l,c*Math.PI/180,p,p,u,m):new os(h,d,i,a,o,s,l,c*Math.PI/180),e.scale(1,1,n/r),Object.assign(e,{userData:{...t,type:"CylinderGeometry"}})}},DodecahedronGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let{width:e,height:r,depth:n,detail:i,corner:a,cornerSides:o}=t.parameters,s=0===i&&0!==a?new Py(.5*e,a,o):new cs(.5*e,i);return s.scale(1,r/e,n/e),Object.assign(s,{userData:{...t,type:"DodecahedronGeometry"}})}},EllipseGeometry:Gx,HelixGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),n=Math.abs(r.width),i=Math.abs(r.height??n),a=Math.abs(r.depth??n),o=Math.abs(Math.min(n,a))/2;return{parameters:Object.assign(r,{width:n,height:i,depth:a,radius:o,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(t){let{width:e,height:r,depth:n,radius:i,revolutions:a,segments:o,pathRadius:s,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:d}=t.parameters,p=new Kx(!1,e,r,n,i,a,o,s,l,c,h,d);return Object.assign(p,{userData:{...t,type:"HelixGeometry"}})}},IcosahedronGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let{width:e,height:r,depth:n,detail:i,corner:a,cornerSides:o}=t.parameters,s=0===i&&0!==a?new Jx(.5*e,a,o):new Us(.5*e,i);return s.scale(1,r/e,n/e),Object.assign(s,{userData:{...t,type:"IcosahedronGeometry"}})}},LatheGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){(t.parameters?.points??[]).forEach((t=>{Array.isArray(t)&&(t.x=t[0],t.y=t[1])}));let r=Object.assign({},e?.parameters??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let{points:e,segments:r,verticalSegments:n}=t.parameters,i=new hs;i.moveTo(e[0].x,e[0].y),i.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let a=new as(i.extractPoints(n).shape,r);return a.rotateZ(Math.PI),Object.assign(a,{userData:{...t,type:"LatheGeometry"}})}},NonParametricGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r,n=t.geometry??e?.geometry??(new qr).copy(new un(100,100,100));void 0===e?(n.computeBoundingBox(),n.boundingBox.getSize(b_),r={width:b_.x,height:b_.y,depth:b_.z,subdivisions:0}):r=e.parameters;let i={...r,...t.parameters};return{parameters:{width:Math.abs(i.width),height:Math.abs(i.height),depth:Math.abs(i.depth),subdivisions:Math.abs(i.subdivisions)},geometry:n}}static build(t){let{width:e,height:r,depth:n,subdivisions:i}=t.parameters,a=t.geometry??(new qr).copy(new un(100,100,100)),o=a.userData.parameters;void 0===o?(a.computeBoundingBox(),a.boundingBox.getSize(b_)):b_.set(o.width,o.height,o.depth),(e!==b_.x||r!==b_.y||n!==b_.z)&&a.scale(0===b_.x?1:e/b_.x,0===b_.y?1:r/b_.y,0===b_.z?1:n/b_.z);let s=a.originalGeometry;try{i>0?(void 0===s||o?.subdivisions!==i)&&(void 0===s&&(s=a),a=new v_(i).modify(s).toBufferGeometry()):(void 0!==s&&(a=s),s=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals())}catch{void 0!==s&&(a=s),s=void 0,void 0===a.getAttribute("normal")&&a.computeVertexNormals()}return void 0!==s&&Object.assign(a,{originalGeometry:s}),delete t.geometry,Object.assign(a,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,r){new Ml(r).load(t,(t=>{let r=this.normalizeInputs({geometry:t});t.boundingBox.getSize(b_);let n=100/b_.x;Object.assign(r.parameters,{width:100,height:b_.y*n,depth:b_.z*n}),e(this.build(r))}))}},PolygonGeometry:y_,PyramidGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let{width:e,height:r,depth:n,radialSegments:i,heightSegments:a,openEnded:o,cornerRadius:s,cornerSegments:l}=t.parameters,c=new S_(.5*e,r,i,a,o,s,l);return c.scale(1,1,n/e),Object.assign(c,{userData:{...t,type:"PyramidGeometry"}})}},RectangleGeometry:E_,SphereGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},t.parameters);return r.thetaLength=Rt.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let e,{width:r=100,height:n=r,depth:i=r,widthSegments:a=64,heightSegments:o=64,phiStart:s,phiLength:l,thetaStart:c,thetaLength:h}=t.parameters;return 0===h?(e=new qr,e.setAttribute("position",new Fr([],3))):e=new Bs(.5*r,a,o,s,l,c,h*Rt.DEG2RAD),e.scale(1,n/r,i/r),Object.assign(e,{userData:{...t,type:"SphereGeometry"}})}},PlaneGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(t){let{width:e=100,height:r=e,widthSegments:n=8,heightSegments:i=8}=t.parameters,a=new On(e,r,n,i);return a.scale(1,1,1),Object.assign(a,{userData:{...t,type:"PlaneGeometry"}})}},BackdropGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(t){let{width:e,height:r,depth:n,angle:i,cornerRadius:a,cornerSegments:o}=t.parameters,s=new M_(e,r,n,i,a,o);return Object.assign(s,{userData:{...t,type:"BackdropGeometry"}})}},StarGeometry:A_,TextFrameGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(t){let{width:e,height:r}=t.parameters,n=new On(e,r);return Object.assign(n,{userData:{...t,type:"TextFrameGeometry"}})}},TorusGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},t.parameters),n=Math.abs(r.width),i=Math.abs(r.height??r.width),a=Math.round(Math.abs(r.depth??.25*r.width));return{parameters:Object.assign(r,{width:n,height:i,depth:a})}}static build(t){let{width:e,height:r,depth:n,radialSegments:i,tubularSegments:a,arc:o,cornerRadius:s,cornerSegments:l}=t.parameters,c=function(t,e,r,n,i,a,o,s,l,c,h){[e,r]=[r,e],o=e/2;let d=Rt.clamp(i/360,0,1);if(0===d){let t=new qr;return t.setAttribute("position",new Fr([],3)),t}return 1===d&&(c=0),new Kx(!0,t,e,r,n,d,a,o,s,l,c,h)}(e,r,n,.5*e,o,a,0,0,i,s,l);return c.scale(1,r/e,1),Object.assign(c,{userData:{...t,type:"TorusGeometry"}})}},TorusKnotGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??.125*r.width})}}static build(t){let{width:e,tube:r,tubularSegments:n,radialSegments:i,p:a,q:o}=t.parameters,s=.5*e;s!==r&&(s-=r);let l=new Vs(s,r,n,i,a,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},TriangleGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof hx?t.shape:new hx,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(t){let{width:e=100,height:r,cornerRadius:n,depth:i,extrudeBevelSize:a,extrudeBevelSegments:o,isRect:s}=t.parameters,l=t.shape,c=.5*e,h=.5*r;s?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let t=0,e=l.points.length;t<e;t++)l.points[t].roundness=n;l.roundness=n,l.update();let d=Vx.create({shape:l,parameters:{roundness:n,depth:i,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(d,{userData:{...t,type:"TriangleGeometry"}})}},PathGeometry:class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let r=Object.assign({},e?.parameters??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),n=Math.abs(r.width),i=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=e?.shapeData??Gx.create({parameters:Ev}).userData.shape;return{path:t.path??xv.defaultData(),parameters:Object.assign(r,{width:n,height:i,depth:a,extrusion:{...pb,...r.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new C_(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}return Object.assign(new qr,{userData:{...t,type:"PathGeometry"}})}},VectorGeometry:Vx},hw=t=>cw[t.type].create(t);function dw(t){return null!==t&&"booleanOp"in t}var pw=class extends(_y(dn)){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Be}updateVisible(t){super.updateVisible(t),this.visible=!dw(this.parent)&&this.visible,dw(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){-1!==this.booleanMeshSetAddress&&(K_.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),dw(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof pw&&(t.freeBooleanPointer(),dw(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t,e){let r=super.updateTransformState(t,e);return r&&dw(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(t=!1){super.onVariableUpdate(t),dw(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},uw=new ue;function mw(t,e=0,r=t.count,n,i){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,h=-1/0;for(let n=e;n<r;n++){let e=t.getX(n),r=t.getY(n),i=t.getZ(n);e<a&&(a=e),r<o&&(o=r),i<s&&(s=i),e>l&&(l=e),r>c&&(c=r),i>h&&(h=i)}uw.min.set(a,o,s),uw.max.set(l,c,h),uw.getCenter(n),uw.getSize(i).multiplyScalar(.5)}var fw=new qr,gw=new Lr,vw=class extends pw{constructor(t,e){super(fw,gw),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let r=this.geometry.getAttribute("position");void 0!==r?mw(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,t,e):super.updateEntityBoxSize(t,e)}},bw=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},yw=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=Rt.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,r){return r=r??{},this.analyze(t,r),this.flow(t,e,r)}flow(t,e,r){r=r??{},t.addFlow(r.slot,r.cache,r.context);let n={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),n}build(t,e,r){e=e??this.getType(t,e);let n=t.getNodeData(r??this);return t.analyzing&&this.appendDepsNode(t,n,e),-1===t.nodes.indexOf(this)&&t.nodes.push(this),void 0!==this.updateFrame&&-1===t.updaters.indexOf(this)&&t.updaters.push(this),this.generate(t,e,r)}updateFrame(t){}generateReadonly(t,e,r,n,i,a){return""}generate(t,e,r,n,i){return""}parse(t,e,r,n){}appendDepsNode(t,e,r){e.deps=(e.deps||0)+1;let n=t.getTypeLength(r);(n>(e.outputMax||0)||this.getType(t,r))&&(e.outputMax=n,e.output=r)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return"sampler2D"===e||"samplerCube"===e?e:this.type}getHash(){let t,e,r="{";for(t in this)e=this[t],e instanceof yw&&(r+='"'+t+'":'+e.getHash()+",");if(this.hashProperties)for(let n=0;n<this.hashProperties.length;n++)t=this.hashProperties[n],e=this[t],r+='"'+t+'":"'+String(e)+'",';return r+='"id":"'+this.uuid+'"}',r}},xw=new class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,r){r=void 0===r||r,this.keywords[t]={callback:e,cache:r}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return void 0!==this.nodes[t]}containsKeyword(t){return void 0!==this.keywords[t]}},_w=class extends yw{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=void 0===e.shared||e.shared,this.unique=void 0!==e.unique&&e.unique}build(t,e,r,n){if(e=e??this.getType(t),this.getShared(t,e)){let i=this.getUnique(t,e);i&&void 0===this.uuid&&(this.uuid=Rt.generateUUID()),r=t.getUUID(r??this.getUUID(),!i);let a=t.getNodeData(r),o=a.output||this.getType(t);if(t.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,a,e),this.generate(t,e,r)):super.build(t,e,r);if(i)return a.name=a.name||super.build(t,e,r),a.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||1===a.deps))return super.build(t,e,r);r=this.getUUID(!1);let s=this.getTemp(t,r);if(s)return t.format(s,o,e);{s=super.generate(t,e,r,a.output,n);let i=this.generate(t,o,r);return t.addNodeCode(s+" = "+i+";"),t.format(s,o,e)}}return super.build(t,e,r)}getShared(t,e){return"sampler2D"!==e&&"samplerCube"!==e&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return"string"==typeof this.scope&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let r=t.getVars()[e];return r?r.name:void 0}generate(t,e,r,n,i){return this.getShared(t,e)||console.error("TempNode is not shared"),r=r??this.uuid,t.getTempVar(r,n??this.getType(t),i,this.getLabel()).name}},ww=class extends _w{constructor(t,e){(e=e??{}).shared=void 0!==e.shared&&e.shared,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,r,n,i,a){r=t.getUUID(r??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(r);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(t,e,r,n,i,a):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,i,a,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,i,a,this.getLabel())),t.format(o.fragment.name,n,e))}},Sw=class extends ww{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof Ot?t:new Ot(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,r,n,i,a){return t.format("vec2("+this.value.x+", "+this.value.y+")",n,e)}},Ew=class extends ww{constructor(t=0,e,r){super("v3"),this.nodeType="Vector3",this.value=t instanceof he?t:new he(t,e,r)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,r,n,i,a){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",n,e)}},Mw=class extends Pr{constructor(t,e,r,n){super(t,e,r),this.isColorA=!0,this.a=n}setRGBA(t,e,r,n){super.setRGB(t,e,r),this.a=n}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let r;if("transparent"===t)return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let n,i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a="rgba"===i?parseFloat(n[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a="hsla"===i?parseFloat(n[4]):1,super.setStyle(t,e)}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Aw=class extends ww{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof Mw?t:new Mw(t.r,t.g,t.b,t.a)}generateReadonly(t,e,r,n,i,a){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,e)}},Tw=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,Pw=/[a-z_0-9]+/gi,Cw=class extends _w{constructor(t,e,r,n,i){super(i),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=void 0===i,this.isInterface=!1,this.parse(t,e,r,n)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,r,n,i){let a,o=0,s=this.src;if(this.includes)for(let e=0;e<this.includes.length;e++)t.include(this.includes[e],this);for(let e in this.extensions)t.extensions[e]=!0;let l=[];for(;a=Pw.exec(this.src);)l.push(a);for(let e=0;e<l.length;e++){let r=l[e],n=r[0],i=!this.isMethod||!this.getInputByName(n),a=n;if(this.keywords[n]||this.useKeywords&&i&&xw.containsKeyword(n)){let e=this.keywords[n];if(!e){let r=xw.getKeywordData(n);r.cache&&(e=t.keywords[n]),e=e||xw.getKeyword(n,t),r.cache&&(t.keywords[n]=e)}a=e.build(t)}n!==a&&"."!==s[r.index+o-1]&&(s=s.substring(0,r.index+o)+a+s.substring(r.index+n.length+o),o+=a.length-n.length),void 0===this.getIncludeByName(a)&&xw.contains(a)&&t.include(xw.get(a))}return"source"===e?s:this.isMethod?(this.isInterface||t.include(this,void 0,s),this.name):t.format("( "+s+" )",this.getType(t),e)}parse(t,e,r,n){if(this.src=t||"",this.includes=e??[],this.extensions=r??{},this.keywords=n??{},this.isMethod){let t=Tw.exec(this.src);if(this.inputs=[],t&&4==t.length){this.type=t[1],this.name=t[2];let e=t[3].match(Pw);if(e){let t=0;for(;t<e.length;){let r,n=e[t++];"in"===n||"out"===n||"inout"===n?r=e[t++]:(r=n,n="");let i=e[t++];this.inputs.push({name:i,type:r,qualifier:n})}}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},kw=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Dw=class extends _w{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||Dw.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,r,n,i){this.src=t||"";let a,o,s="",l=kw.exec(t);this.useDefine=i??"#"===this.src.charAt(0),l&&l.length>1?(o=l[1],a=l[2],s=l[3]):(a=this.src,o="f"),this.name=a,this.type=o,this.value=s}build(t,e){if("source"===e){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,r,n,i){return t.format(this.name,this.getType(t),e)}},Lw=Dw;Lw.PI="PI",Lw.PI2="PI2",Lw.RECIPROCAL_PI="RECIPROCAL_PI",Lw.RECIPROCAL_PI2="RECIPROCAL_PI2",Lw.LOG2="LOG2",Lw.EPSILON="EPSILON";var Rw=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),Ow=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Iw=class extends _w{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,r,n,i){return"source"===e?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=Rw.exec(t);if(e){let t,r=e[2];for(;t=Ow.exec(r);)this.inputs.push({type:t[1],name:t[2]});this.name=e[1]}else this.name="";this.type=this.name}},Nw=class extends _w{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",n=t.isShader("vertex")?"uv"+r:"vUv"+r;return t.format(n,this.getType(t),e)}};xw.addKeyword("uv",(function(){return new Nw})),xw.addKeyword("uv2",(function(){return new Nw(1)}));var zw=class extends _w{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??zw.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case nt:return["Linear"];case it:return["sRGB"];default:return[]}}generate(t,e){let r=this.input.build(t,"v4"),n=this.getType(t),i=zw.Nodes[this.method],a=t.include(i);if(a===zw.LINEAR_TO_LINEAR)return t.format(r,n,e);if(2===i.inputs?.length){let i=this.factor.build(t,"f");return t.format(a+"( "+r+", "+i+" )",n,e)}return t.format(a+"( "+r+" )",n,e)}fromEncoding(t){let e=zw.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=zw.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},Fw=zw;Fw.Nodes={LinearToLinear:new Cw(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),sRGBToLinear:new Cw(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new Cw(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n"))},Fw.LINEAR_TO_LINEAR="LinearToLinear",Fw.SRGB_TO_LINEAR="sRGBToLinear",Fw.LINEAR_TO_SRGB="LinearTosRGB";var Uw=class extends Cw{constructor(t="",e,r,n,i){super(t,i,n,r,e),this.nodeType="Expression"}},Bw=class extends ww{constructor(t=new ne,e,r,n){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new Nw,this.bias=r,this.project=void 0!==n&&n}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if("sampler2D"===e)return this.getTexture(t,e);let r,n,i=this.getTexture(t,e),a=this.uv.build(t,this.project?"v4":"v2"),o=this.bias?this.bias.build(t,"f"):void 0;void 0===o&&t.context.bias&&(o=t.context.bias.setTexture(this).build(t,"f")),r=this.project?"texture2DProj":o?"tex2DBias":"tex2D",n=o?r+"( "+i+", "+a+", "+o+" )":r+"( "+i+", "+a+" )";let s={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(s),this.colorSpace=this.colorSpace??new Fw(new Uw("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(t,l),t.removeContext(),t.format(n,l,e)}},Vw=class extends ww{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,r,n,i,a){return t.format(this.value+(this.value%1?"":".0"),n,e)}},jw=class extends _w{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,r,n,i){n=this.getType(t);let a=this.value,o=a.build(t,e)+"( ",s=[];if(a.inputs){for(let e=0;e<a.inputs.length;e++){let r=a.inputs[e],n=this.inputs[e]||this.inputs[r.name];s.push(n.build(t,t.getTypeByFormat(r.type)))}o+=s.join(", ")+" )"}return t.format(o,n,e)}},Gw=class extends _w{constructor(t,e,r=Gw.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=r}getType(t){let e=this.a.getType(t),r=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(r)>t.getTypeLength(e)?r:e}generate(t,e){let r=this.getType(t);this.type=r;let n=this.a.build(t,r),i=this.b.build(t,r);return t.format("( "+n+" "+this.op+" "+i+" )",r,e)}},Hw=Gw;Hw.ADD="+",Hw.SUB="-",Hw.MUL="*",Hw.DIV="/";var Ww=class extends _w{constructor(t,e=Ww.ABS,r,n){super(),this.nodeType="Math",this.a=t,"string"!=typeof e?this.b=e:n=e,"string"!=typeof r?this.c=r:n=r,this.method=n,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case Ww.MIX:case Ww.CLAMP:case Ww.REFRACT:case Ww.SMOOTHSTEP:case Ww.FACEFORWARD:return 3;case Ww.MIN:case Ww.MAX:case Ww.MOD:case Ww.STEP:case Ww.REFLECT:case Ww.DISTANCE:case Ww.DOT:case Ww.CROSS:case Ww.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),r=this.b?t.getTypeLength(this.b.getType(t)):0,n=this.c?t.getTypeLength(this.c.getType(t)):0;return e>r&&e>n?this.a.getType(t):r>n?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case Ww.LENGTH:case Ww.DISTANCE:case Ww.DOT:return"f";case Ww.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let r,n,i,a=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,s=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),c=this.getType(t);switch(this.type=c,this.method){case Ww.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case Ww.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case Ww.CROSS:r=this.a.build(t,"v3"),n=this.b.build(t,"v3");break;case Ww.STEP:r=this.a.build(t,1===a?"f":l),n=this.b.build(t,l);break;case Ww.MIN:case Ww.MAX:case Ww.MOD:r=this.a.build(t,l),n=this.b.build(t,1===o?"f":l);break;case Ww.REFRACT:r=this.a.build(t,l),n=this.b.build(t,l),i=this.c.build(t,"f");break;case Ww.MIX:r=this.a.build(t,l),n=this.b.build(t,l),i=this.c.build(t,1===s?"f":l);break;default:r=this.a.build(t,l),this.b&&(n=this.b.build(t,l)),this.c&&(i=this.c.build(t,l))}let h=[];h.push(r),n&&h.push(n),i&&h.push(i);let d=this.getNumInputs(t);if(h.length!==d)throw Error(`Arguments not match used in "${this.method}". Require ${d}, currently ${h.length}.`);return t.format(this.method+"( "+h.join(", ")+" )",c,e)}},qw=Ww;qw.RAD="radians",qw.DEG="degrees",qw.EXP="exp",qw.EXP2="exp2",qw.LOG="log",qw.LOG2="log2",qw.SQRT="sqrt",qw.INV_SQRT="inversesqrt",qw.FLOOR="floor",qw.CEIL="ceil",qw.NORMALIZE="normalize",qw.FRACT="fract",qw.SATURATE="saturate",qw.SIN="sin",qw.COS="cos",qw.TAN="tan",qw.ASIN="asin",qw.ACOS="acos",qw.ARCTAN="atan",qw.ABS="abs",qw.SIGN="sign",qw.LENGTH="length",qw.NEGATE="negate",qw.INVERT="invert",qw.MIN="min",qw.MAX="max",qw.MOD="mod",qw.STEP="step",qw.REFLECT="reflect",qw.DISTANCE="distance",qw.DOT="dot",qw.CROSS="cross",qw.POW="pow",qw.MIX="mix",qw.CLAMP="clamp",qw.REFRACT="refract",qw.SMOOTHSTEP="smoothstep",qw.FACEFORWARD="faceforward";var $w=class extends _w{constructor(t,e,r){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=r}bilinearCubeUV(t,e,r,n){let i=new jw($w.Nodes.bilinearCubeUV,[e,r,n]);this.colorSpaceTL=this.colorSpaceTL??new Fw(new Uw("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(i.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Fw(new Uw("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(i.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Fw(new Uw("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(i.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Fw(new Uw("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(i.build(t)+".br");let a={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(a),this.colorSpaceTLExp=new Uw(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new Uw(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new Uw(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new Uw(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new Uw("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=i,o}generate(t,e){if(t.isShader("fragment")){let r=this.uv,n=this.bias||t.context.roughness,i=new jw($w.Nodes.roughnessToMip,[n]),a=new qw(i,$w.Nodes.m0,$w.Nodes.cubeUV_maxMipLevel,qw.CLAMP),o=new qw(a,qw.FLOOR),s=new qw(a,qw.FRACT),l=this.bilinearCubeUV(t,this.value,r,o),c=this.bilinearCubeUV(t,this.value,r,new Hw(o,new Vw(1).setReadonly(!0),Hw.ADD)),h=new qw(l,c,s,qw.MIX);return t.format(h.build(t),"v4",e)}return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},Xw=$w;Xw.Nodes=function(){let t=new Iw("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),e=new Lw("float cubeUV_maxMipLevel 8.0",!0),r=new Lw("float cubeUV_minMipLevel 4.0",!0),n=new Lw("float cubeUV_maxTileSize 256.0",!0),i=new Lw("float cubeUV_minTileSize 16.0",!0),a=new Cw("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");a.useKeywords=!1;let o=new Cw("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");o.useKeywords=!1;let s=new Cw("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[t,a,o,e,r,n,i]);s.useKeywords=!1;let l=new Lw("float r0 1.0",!0),c=new Lw("float v0 0.339",!0),h=new Lw("float m0 -2.0",!0),d=new Lw("float r1 0.8",!0),p=new Lw("float v1 0.276",!0),u=new Lw("float m1 -1.0",!0),m=new Lw("float r4 0.4",!0),f=new Lw("float v4 0.046",!0),g=new Lw("float m4 2.0",!0),v=new Lw("float r5 0.305",!0),b=new Lw("float v5 0.016",!0),y=new Lw("float m5 3.0",!0),x=new Lw("float r6 0.21",!0),_=new Lw("float v6 0.0038",!0),w=new Lw("float m6 4.0",!0);return{bilinearCubeUV:s,roughnessToMip:new Cw("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,c,h,d,p,u,m,f,g,v,b,y,x,_,w]),m0:h,cubeUV_maxMipLevel:e}}();var Yw=class extends _w{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Yw.VIEW}getShared(){return this.scope===Yw.WORLD}build(t,e,r,n){let i=t.context[this.scope+"Normal"];return i?i.build(t,e,r,n):super.build(t,e,r)}generate(t,e,r,n,i){let a;switch(this.scope){case Yw.VIEW:a=t.isShader("vertex")?"transformedNormal":"geometryNormal";break;case Yw.LOCAL:t.isShader("vertex")?a="objectNormal":(t.requires.normal=!0,a="vObjectNormal");break;case Yw.WORLD:t.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,a="vWNormal")}return t.format(a,this.getType(t),e)}},Zw=Yw;Zw.LOCAL="local",Zw.WORLD="world",Zw.VIEW="view",Zw.NORMAL="normal",xw.addKeyword("viewNormal",(function(){return new Zw(Zw.VIEW)})),xw.addKeyword("localNormal",(function(){return new Zw(Zw.NORMAL)})),xw.addKeyword("worldNormal",(function(){return new Zw(Zw.WORLD)}));var Kw=class extends _w{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??Kw.LOCAL}getType(){return this.scope===Kw.PROJECTION?"v4":this.type}getShader(){switch(this.scope){case Kw.LOCAL:case Kw.WORLD:return!1}return!0}generate(t,e,r,n,i){let a;switch(this.scope){case Kw.LOCAL:t.isShader("vertex")?a="transformed":(t.requires.position=!0,a="vPosition");break;case Kw.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,a="vWPosition";break;case Kw.VIEW:a=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Kw.PROJECTION:a=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return t.format(a,this.getType(),e)}},Jw=Kw;Jw.LOCAL="local",Jw.WORLD="world",Jw.VIEW="view",Jw.PROJECTION="projection",xw.addKeyword("position",(function(){return new Jw})),xw.addKeyword("worldPosition",(function(){return new Jw(Jw.WORLD)})),xw.addKeyword("viewPosition",(function(){return new Jw(Jw.VIEW)}));var Qw=class extends _w{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??Qw.CUBE}getUnique(t){return!t.context.viewNormal}getType(){return this.scope===Qw.SPHERE?"v2":this.type}generate(t,e){let r=this.getUnique(t);if(t.isShader("fragment")){let n;switch(this.scope){case Qw.VECTOR:{let e=new Zw(Zw.VIEW),i=t.context.roughness,a=e.build(t,"v3"),o=new Jw(Jw.VIEW).build(t,"v3"),s=i?i.build(t,"f"):void 0,l=`reflect( -normalize( ${o} ), ${a} )`;s&&(l=`normalize( mix( ${l}, ${a}, ${s} * ${s} ) )`);let c=`inverseTransformDirection( ${l}, viewMatrix )`;r?(t.addNodeCode(`vec3 reflectVec = ${c};`),n="reflectVec"):n=c;break}case Qw.CUBE:{let e=new Qw(Qw.VECTOR).build(t,"v3"),i="vec3( -"+e+".x, "+e+".yz )";r?(t.addNodeCode(`vec3 reflectCubeVec = ${i};`),n="reflectCubeVec"):n=i;break}case Qw.SPHERE:{let e="normalize( ( viewMatrix * vec4( "+new Qw(Qw.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(t.addNodeCode(`vec2 reflectSphereVec = ${e};`),n="reflectSphereVec"):n=e;break}}return t.format(n,this.getType(),e)}return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},tS=Qw;tS.CUBE="cube",tS.SPHERE="sphere",tS.VECTOR="vector";var eS=class extends _w{constructor(t=new Bw,e,r){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new Xw(this.value,e??new tS(tS.VECTOR),r),this.irradianceNode=new Xw(this.value,new Zw(Zw.WORLD),new Vw(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),("irradiance"===t.slot?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},rS=class extends ww{constructor(t=new Sn,e,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new tS,this.bias=r}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){if("samplerCube"===e)return this.getTexture(t,e);let r,n=this.getTexture(t,e),i=this.uv?.build(t,"v3"),a=this.bias?this.bias.build(t,"f"):void 0;void 0===a&&t.context.bias&&(a=t.context.bias.setTexture(this).build(t,"f")),r=a?"texCubeBias( "+n+", "+i+", "+a+" )":"texCube( "+n+", "+i+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},s=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new Fw(new Uw("",s)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(t,s),t.removeContext(),t.format(r,s,e)}},nS=["x","y","z","w"],iS=["float","vec2","vec3","vec4"],aS={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},oS={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},sS=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function t(t,e){return t.deps.length-e.deps.length}return function(e,r){let n=this.getIncludes(e,r);if(!n)return"";let i="";n=n.sort(t);for(let t=0;t<n.length;t++)n[t].src&&(i+=n[t].src+"\n");return i}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.addVertexParsCode("\nuniform int frameIndex;\nuniform vec2 resolution;\nuniform mat4 previousModelViewMatrix;\nuniform mat4 previousProjectionMatrix;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n"),this.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n\nuniform int frameIndex;\nuniform vec2 resolution;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\n\n// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso\nfloat getNoiseInterleavedGradient(vec2 screenPos) {\n    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);\n    return fract(magic.z * fract(dot(screenPos, magic.xy)));\n}\n\n"),this.buildShader("vertex",t),this.buildShader("fragment",e);for(let t=0;t<this.requires.uv.length;t++)if(this.requires.uv[t]){let e=t>0?t+1:"";this.addVaryCode("varying vec2 vUv"+e+";"),t>0&&this.addVertexParsCode("attribute vec2 uv"+e+";"),this.addVertexFinalCode("vUv"+e+" = uv"+e+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode("\n// TODO: This could be generated CPU side and passed to the shader every frame\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\n// TODO: Pass correct view size\nvec2 offset = haltonSequence[frameIndex];\noffset.x /= resolution.x;\noffset.y /= resolution.y;\n\nvec4 currentPosition = gl_Position;\nvec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);\n\n// We want to calculate the velocity with unjittered positions\n// so that things that are not moving get a velocity = 0\nvCurrentPosition = currentPosition;\nvPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);\n#ifdef OUTLINE_COMPENSATION\nvPreviousPosition.xy += OUTLINE_COMPENSATION;\n#endif\ngl_Position = currentPositionJittered;\n\n"),this.addFragmentFinalCode("\nvec2 oldPos = vPreviousPosition.xy;\n    oldPos /= vPreviousPosition.w;\n    oldPos.xy = (oldPos.xy+1.)/2.0;\n\nvec2 newPos = vCurrentPosition.xy;\n    newPos /= vCurrentPosition.w;\n    newPos.xy = (newPos.xy+1.)/2.0;\n\nvec2 velocity = (newPos - oldPos);\n\n// Discard fully transparent pixels \nif (gl_FragColor.a <= 0.0) discard;\n\ngVelocity = vec4(velocity, 0.0, 1.0);\n")),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,r){return this.addSlot(t).addCache(e).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){void 0===this.fragmentVariables[t]&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){void 0===this.fragmentParsVariables[t]&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){void 0===this.vertexParsVariables[t]&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+"\n"}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+"\n"}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+"\n"}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+"\n"}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return-1!==this.caches.indexOf(t)}isSlot(t){return-1!==this.slots.indexOf(t)}define(t,e){this.defines[t]=void 0===e?1:e}require(t){this.requires[t]=!0}isDefined(t){return void 0!==this.defines[t]}getVar(t,e,r,n="varying",i="V",a=""){let o=this.getVars(n),s=o[t];if(!s){let n=o.length;s={name:r||"node"+i+n+(a?"_"+a:""),type:e},o.push(s),o[t]=s}return s}getTempVar(t,e,r,n){return this.getVar(t,e,r,this.shader,"T",n)}getAttribute(t,e){if(!this.attributes[t]){let r=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(r.name+" = "+t+";"),this.attributes[t]={varying:r,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join("\n")}getVarListCode(t,e){e=e??"";let r="";for(let n=0,i=t.length;n<i;++n){let i=t[n],a=i.type,o=i.name,s=i.size,l=this.getFormatByType(a);if(void 0===l)throw new Error("Node pars "+l+" not found.");l.includes("[]")?r+=e+" "+l.substring(0,l.length-2)+" "+o+`[${s}];\n`:r+=e+" "+l+" "+o+";\n"}return r}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof yw?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,r,n,i,a){if(e.includes("[]")){let o=this.inputs.arrayUniforms,s=o.list.length,l=new bw({type:e,size:r.size,name:n||"nodeUA"+s+(a?"_"+a:""),node:r,needsUpdate:i});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}{let o=this.inputs.uniforms,s=o.list.length,l=new bw({type:e,name:n||"nodeU"+s+(a?"_"+a:""),node:r,needsUpdate:i});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,r,n,i){return this.createUniform("vertex",t,e,r,n,i)}createFragmentUniform(t,e,r,n,i){return this.createUniform("fragment",t,e,r,n,i)}include(t,e,r){let n;if(t="string"==typeof t?xw.get(t):t,!1===this.context.include)return t.name;t instanceof Cw?n=this.includes.functions:t instanceof Lw?n=this.includes.consts:t instanceof Iw&&(n=this.includes.structs);let i=n[this.shader]=n[this.shader]||[];if(t){let n=i[t.name];if(n||(n=i[t.name]={node:t,deps:[]},i.push(n),n.src=t.build(this,"source")),t instanceof Cw&&e&&i[e.name]&&-1===i[e.name].deps.indexOf(t)&&(i[e.name].deps.push(t),t.includes?.length)){let r=0;do{this.include(t.includes[r++],e)}while(r<t.includes.length)}return r&&(n.src=r),t.name}throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return iS[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return"f"===t?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return 1===t?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let r=t[e];if(r?.isNode)return r}}resolve(...t){for(let e=0;e<arguments.length;e++){let r=t[e];if(void 0!==r){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case S:case E:return new rS(r);case T:return new eS(new Bw(r));default:return new Bw(r)}else{if(r.isVector2)return new Sw(r);if(r.isVector3)return new Ew(r);if(r.isVector4)return new Aw(r)}}}}format(t,e,r){switch(this.colorToVector(r+" <- "+e)){case"f <- v2":case"f <- v3":case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return aS[t]||t}getFormatByType(t){return oS[t]||t}getUUID(t,e){return(e=void 0===e||e)&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return nS[t]}getIndexByElement(t){return nS.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=nt,e===nt&&this.context.gamma&&(e=it),e}},lS=class extends ww{constructor(t=0,e,r,n){super("c"),this.nodeType="Color",this.value=t instanceof Mw?t:new Mw(t||0,e,r,n)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,r,n,i,a){r=t.getUUID(r??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(r),s=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){let e=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${e};`)}return s?this.generateReadonly(t,e,r,n,i,a):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,i,a,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,i,a,this.getLabel())),t.format(o.fragment.name,n,e))}generateReadonly(t,e,r,n,i,a){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,e)}},cS=class extends ww{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,r,n,i,a){return t.format(this.value.toString(),n,e)}},hS=class extends ww{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,r,n){return t.format(this.value?"true":"false",n,e)}},dS=class extends ww{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:"number"==typeof e?new Array(t).fill(e):new Array(t).fill(0)}},pS=class extends ww{},uS=class extends pS{constructor(t){super("v3"),this.image=t,this._value=new he}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},mS=class extends pS{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},fS=class extends ww{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new It}generateReadonly(t,e,r,n,i,a){return t.format("mat3("+this.value.elements.join(", ")+")",n,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},gS=class extends ww{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new Be}generateReadonly(t,e,r,n,i,a){return t.format("mat4("+this.value.elements.join(", ")+")",n,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function vS(t,e,r){t.setUvTransform(r[0],r[1],e[0],e[1],0,0,0)}var bS=class extends fS{constructor(t,e){super(new It),this.repeat=t,this.offset=e,vS(this.value,t,e)}updateMatrix(){vS(this.value,this.repeat,this.offset)}},yS=class extends ww{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof ie?new Array(t).fill(e):new Array(t).fill(new ie(0))}},xS=class extends _w{constructor(t,e,r,n){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=r,this.mode=n}generate(t,e){if(t.isShader("fragment")){let r=[];return r.push(this.a.build(t,"c")),r.push(this.b.build(t,"c")),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),t.format("spe_blend("+r.join(",")+")",this.getType(t),e)}return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},_S=class extends _w{constructor(t,e){super("v3"),this.nodeType="CustomColor",this.color=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let r=t.include(_S.Nodes.customColor);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.build(t,"v3")})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("CustomColorNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},wS=_S;wS.Nodes={customColor:new Cw("vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color;\n\t\t\t}")};var SS=class extends _w{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let r=t.include(SS.Nodes.customNormal);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(t,"v3")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},ES=SS;ES.Nodes={customNormal:new Cw("vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var MS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h,d){super("v3"),this.nodeType="CustomTexture",this.texture=t,this.textureSize=e,this.crop=r,this.projection=n,this.axis=i,this.side=a,this.size=o,this.blending=s,this.mat=l,this.isMask=d,this.alpha=c,this.mode=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let r,n=`g${this.uuid.toString().replace(/-/g,"")}`;switch(this.projection.value){case 3:r=t.include(MS.Nodes.cylindrical);break;case 2:r=t.include(MS.Nodes.spherical);break;case 1:let e=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],i=["zy","xz","xy"][this.axis.value],a=new Cw(`\n\t\tvec3 ${n}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 projected = (1. + (position.${i})) / 2.;\n\t\t\t\tvec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\t${2===this.side.value?"":`lalpha *= step(0.0, ${1===this.side.value?"-1.0 * ":""}dot(vObjectNormal, ${e}));`}\n\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}`);r=t.include(a);break;case 4:r=t.include(MS.Nodes.triplanar);break;default:r=t.include(MS.Nodes.uv)}t.addFragmentVariable(this.calpha,"float");let i=[];if(i.push("normal"),i.push(this.texture.generate(t,"t")),i.push(this.textureSize.build(t,"v2")),i.push(this.crop.build(t,"f")),i.push(this.mat.build(t,"mat3")),i.push(this.size.build(t,"v2")),i.push(this.blending.build(t,"f")),i.push(this.isMask.build(t,"b")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),4===this.projection.value){let e=`${n}_writeUvs`,r=e+"0",a=e+"1",o=e+"2",s=`${n}_triplanarWeights`;t.addFragmentVariable(r,"vec2"),t.addFragmentVariable(a,"vec2"),t.addFragmentVariable(o,"vec2"),t.addFragmentVariable(s,"vec3"),i.push(r),i.push(a),i.push(o),i.push(s)}else{let e=`${n}_writeUvs`;t.addFragmentVariable(e,"vec2"),i.push(e)}return t.format(r+"("+i.join(",")+")",this.getType(t),e)}},AS=MS;AS.Nodes={cylindrical:new Cw("\nvec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(position);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float scaledHeight = position.y / (size.y * 0.5);\n                float v =  (scaledHeight / 2.) + .5;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\t\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),spherical:new Cw("\nvec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(vPosition);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float v = 0.5 + asin(posN.y) / 3.1415;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),uv:new Cw("vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"),triplanar:new Cw("vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {\n\t\t\t\tvec3 p = position;\n\t\t\t\tvec2 uv0 = (1.0 + p.xy) / 2.0;     \n\t\t\t\tvec2 uv1 = (1.0 + p.zy) / 2.0;\t\t\n\t\t\t\tvec2 uv2 = (1.0 + p.xz) / 2.0;\t\t\n\t\n\t\t\t\tuv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\n\t\t\t\t// Write out all sets of UVs that we generated\n\t\t\t\twriteUvs0 = uv0;\n\t\t\t\twriteUvs1 = uv1;\n\t\t\t\twriteUvs2 = uv2;\n\t\t\t\twriteWeights = weights;\n\n\t\t\t\t// Derivatives for LOD\n\t\t\t\tvec2 df0 = fwidth(uv0);\n\t\t\t\tvec2 df1 = fwidth(uv1);\n\t\t\t\tvec2 df2 = fwidth(uv2);\n\t\t\t\tif (df0.x > 0.5) df0.x = 0.0;\n\t\t\t\tif (df1.x > 0.5) df1.x = 0.0;\n\t\t\t\tif (df2.x > 0.5) df2.x = 0.0;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                \tvec4 tmp = \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#else\n                \tvec4 tmp = \n\t\t\t\t\t\ttextureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttextureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttextureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\n\t\t\t\t// Apply cropping across all 3 planes\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;//n * 0.5 + 0.5;\n\t\t\t}\t\t\t\n\t\t\t")};var TS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h,d){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=r,this.far=n,this.isVector=i,this.isWorldSpace=a,this.origin=o,this.direction=s,this.colors=l,this.steps=c,this.isMask=d,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let r=`g${this.uuid.toString().replace(/-/g,"")}`,n=new Cw(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {\n               vec4 color = colors[0];\n               #ifdef ${r}_IS_VECTOR\n                   #ifdef ${r}_LINEAR\n                       #ifdef ${r}_WORLDSPACE\n                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);\n                       #else\n                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);\n                       #endif\n                   #else\n                       #ifdef ${r}_WORLDSPACE\n                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);\n                       #else\n                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);\n                       #endif\n                   #endif\n               #else\n                   float dist = length(vWPosition - cameraPosition);\n\t\t\t       float depth = ( dist - near ) / ( far - near );\n               #endif\n\n\n              float p;\n              #ifdef ${r}_SMOOTH\n\t\t\t\tfor ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {\n\t\t\t\t\t\tp = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n              #else\n                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {\n                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);\n                   color = mix(color, colors[i], p);\n                 }\n              #endif\n\n               float lalpha = alpha * color.a * mask;\n               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t   \n               return color.rgb;\n\t\t\t}`,[TS.Nodes.vectorLinearWorldSpaceDepth,TS.Nodes.vectorLinearObjectSpaceDepth,TS.Nodes.vectorSphericalObjectSpaceDepth,TS.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${r}_SMOOTH`),this.isVector.value>.5&&t.define(`${r}_IS_VECTOR`),0===this.gradientType.value&&t.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${r}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let i=t.include(n),a=[];return a.push(this.near.build(t,"f")),a.push(this.far.build(t,"f")),a.push(this.origin.build(t,"v3")),a.push(this.direction.build(t,"v3")),a.push(this.colors.build(t,"v4[]")),a.push(this.steps.build(t,"f[]")),a.push(this.isMask.build(t,"b")),a.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),a.push(this.alpha.build(t,"f")),a.push(this.calpha),t.format(i+"("+a.join(",")+")",this.getType(t),e)}return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},PS=TS;PS.Nodes={vectorLinearWorldSpaceDepth:new Cw("float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorLinearObjectSpaceDepth:new Cw("float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalWorldSpaceDepth:new Cw("float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(vWPosition - origin);\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalObjectSpaceDepth:new Cw("float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(position - origin);\n               return ( dist - near ) / ( far - near );\n            }")};var CS=class extends _w{constructor(t,e,r,n,i,a,o,s){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=r,this.intensity=n,this.factor=i,this.isMask=s,this.alpha=a,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let r=new Cw("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );\n\n\t\t\t\t\tfloat lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn color;\n\t\t\t\t}"),n=t.include(r),i=[];return i.push(this.color.build(t,"c")),i.push(this.bias.build(t,"f")),i.push(this.scale.build(t,"f")),i.push(this.intensity.build(t,"f")),i.push(this.factor.build(t,"f")),i.push(this.isMask.build(t,"b")),i.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},kS=class extends _w{constructor(t,e,r,n,i,a,o,s,l){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=r,this.steps=n,this.offset=i,this.morph=a,this.angle=o,this.isMask=l,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let r=t.include(kS.Nodes.gradient),n=[];return n.push(this.gradientType.build(t,"i")),n.push(this.smooth.build(t,"b")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.offset.build(t,"v2")),n.push(this.morph.build(t,"v2")),n.push(this.angle.build(t,"f")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},DS=kS;DS.Nodes={gradient:new Cw("vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( gradientType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( gradientType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\n\t\t\t\tfloat p;\n\t\t\t\tif (smoothed) {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], p);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\n\t\t\t\treturn color.xyz;\n\t\t\t}")};var LS=class extends _w{constructor(t,e,r,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.isMask=n,this.alpha=e,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let r=t.include(LS.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let n=[];return n.push(this.texture.generate(t,"t")),n.push("normal"),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},RS=LS;RS.Nodes={matcap:new Cw("vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tvec3 viewDir = normalize( vViewPosition );\n\t\t\t\t\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\t\t\t\t\tvec3 y = cross( viewDir, x );\n\t\t\t\t\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\t\t\t\t\tvec4 matcapColor = texture2D( matcapTex, uv );\n\n\t\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\t\n\t\t\t\t\treturn matcapColor.rgb;\n            \t}")};var OS,IS=((OS=IS||{}).SIMPLEX="simplex3d",OS.SIMPLEX_FRACTAL="simplex3dFractal",OS.ASHIMA="simplexAshima",OS.FBM="fbm",OS.PERLIN="perlin",OS.VORONOI="voronoi",OS),NS=function(){let t=new Cw("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),e=new Cw("float simplex3d(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[t]);e.keywords.F3=new Lw("float F3 0.3333333"),e.keywords.G3=new Lw("float G3 0.1666667");let r=new Cw("float simplex3dFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplex3d(m * rot1)\n\t\t\t\t + 0.2666667 * simplex3d(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplex3d(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplex3d(8.0 * m);\n\t\t}",[e]),n=new Cw("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),i=new Cw("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new Cw("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[n,i]),o=new Cw("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),s=new Cw("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new Cw("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[s]),c=new Cw("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[l]);c.keywords.NUM_OCTAVES=new Lw("int NUM_OCTAVES 5");let h=new Cw("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new Cw("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[n,i,h]),p=new Cw("float hashwithoutsine13(vec3 p3)\n\t\t{\n\t\t\tp3  = fract(p3 * .1031);\n\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t}"),u=new Cw("vec3 hashwithoutsine33(vec3 p3)\n\t\t{\n\t\t\tp3 = fract(p3 * vec3(.1031, .1030, .0973));\n\t\t\tp3 += dot(p3, p3.yxz+33.33);\n\t\t\treturn fract((p3.xxy + p3.yxx)*p3.zyx);\n\t\t}"),m=new Cw("float metric(in vec3 p)\n\t\t{\n\t\t\t// L2 \n\t\t\treturn length(p);\n\n\t\t\t// Chebyshev \n\t\t\t// vec3 a = abs(p);\n\t\t\t// return max(a.x, max(a.y, a.z));\n\t\t}"),f=new Cw("float smin( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(b, a, h) - correction;\n\t\t}"),g=new Cw("float smax( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(a, b, h) + correction;\n\t\t}"),v=new Cw("float remap(float value, float input_min, float input_max, float output_min, float output_max) {\n\t\t\t// Compute width of each interval\n\t\t\tfloat input_width = input_max - input_min;\n\t\t\tfloat output_width = output_max - output_min;\n\t\t\n\t\t\t// Convert input range into a 0-1 range \n\t\t\tfloat scaled = (value - input_min) / input_width;\n\t\t\n\t\t\t// Convert the 0-1 range into a value in output range\n\t\t\treturn output_min + (scaled * output_width);\n\t\t}");return{simplex:e,simplexFractal:r,simplexAshima:a,fbm:c,perlin:d,voronoi:new Cw('float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) \n\t\t{\n\t\t\t// Integer and fractional parts of this point\'s coordinates\n\t\t\tivec3 p = ivec3(floor(x));\n\t\t\tvec3 f = fract(x);\n\n\t\t\t// Different variables that we will use to construct noise:\n\t\t\t//\n\t\t\t// f1: distance to the closest feature point\n\t\t\t// f2: distance to the second closest feature point\n\t\t\t// e: distance to the closest edge (cell boundary)\n\t\t\t//\n\t\t\t// We also compute "smooth" versions of all of the above quantites, essentially\n\t\t\t// replacing "hard" minimums with "smooth" minimums (described by IQ)\n\t\t\tfloat f1_smooth = 8.0;\n\t\t\tfloat f1 = 8.0;\n\t\t\tfloat f2_smooth = 8.0;\n\t\t\tfloat f2 = 8.0;\n\t\t\tfloat e_smooth = 8.0;\n\t\t\tfloat e = 8.0;\n\n\t\t\t// Variables stored from closest cell\n\t\t\tivec3 mb;\n\t\t\tvec3 mr; \n\n\t\t\tint steps = quality;\n\t\t\t\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d = length(r);\n\t\t\t\t\n\t\t\t\tf1_smooth = smin(d, f1_smooth, smoothness);\n\n\t\t\t\t// Store un-smoothed distances too \n\t\t\t\tif (d < f1) \n\t\t\t\t{\n\t\t\t\t\tf2 = f1;\n\t\t\t\t\tf1 = d;\n\n\t\t\t\t\tmb = ivec3(x, y, z);\n\t\t\t\t\tmr = r;\n\t\t\t\t} \n\t\t\t\telse if (d < f2) \n\t\t\t\t{\n\t\t\t\t\tf2 = d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\tfloat id = hashwithoutsine13(vec3(p + mb) + seed);\n\n\t\t\t// Second pass for edge distance  \n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\t// Start search at the cell that contains the closest point to "x" (found in 1st pass)\n\t\t\t\tivec3 b = mb + ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d1 = dot(0.5 * (mr + r), (r - mr)); \t\t\t\t// IQ normalizes "r - mr" but that breaks things for the smooth version?\n\t\t\t\tfloat d2 = dot(0.5 * (mr + r), normalize(r - mr));\n\n\t\t\t\te_smooth = smin(d1, e_smooth, smoothness);\n\n\t\t\t\te = min(e, d2);\n\n\t\t\t\t// Also compute a smooth version of F2 in this pass\n\t\t\t\t{\n\t\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\t\tif (b != mb) \n\t\t\t\t\t{\n\t\t\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\t\t\tfloat d = length(r);\n\n\t\t\t\t\t\tf2_smooth = smin(d, f2_smooth, smoothness);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Different visualization modes \n\t\t\tif (style == 0) \n\t\t\t{\n\t\t\t\treturn f1_smooth;\n\t\t\t}\n\t\t\tif (style == 1) \n\t\t\t{\n\t\t\t\treturn f2_smooth;\n\t\t\t}\n\t\t\tif (style == 2) \n\t\t\t{\n\t\t\t\treturn f2_smooth - f1_smooth;\n\t\t\t\t\n\t\t\t\t// "Pebbles" also cool\n\t\t\t\t//return step(0.2, f2_smooth - f1_smooth);\n\t\t\t}\n\t\t\tif (style == 3) \n\t\t\t{\n\t\t\t\t// This one is really good for rock / stone effects\n\t\t\t\tfloat a = f1; \n\t\t\t\tfloat b = f2;\n\t\t\t\tfloat k = 3.0;\n\t\t\t\tfloat h = max(k - abs(a - b), 0.0) / k;\n\t\t\t\tfloat final = min(a, b) - h * h * k * (1.0 / 4.0);\n\t\t\t\treturn final;\n\t\t\t}\n\t\t\tif (style == 4) \n\t\t\t{\n\t\t\t\t// Some random adjustments to make this style stand out more \n\t\t\t\treturn exp(5.0 * e_smooth);\n\t\t\t}\n\t\t\tif (style == 5) \n\t\t\t{\n\t\t\t\treturn pow(f1_smooth, 3.0);\n\t\t\t}\n\t\t\tif (style == 6) \n\t\t\t{\t\t\t\t\n\t\t\t\tconst float eps = 0.0125;\n\n\t\t\t\t// Thicker lines as the user increases the smoothness slider\n\t\t\t\tfloat thickness = smoothness * 0.25 + eps;\n\n\t\t\t\t// Blurrier lines as the user increases the smoothness slider\n\t\t\t\tfloat blur = pow(smoothness, 3.0) * 0.25 + eps;\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\tthickness - thickness * blur, \n\t\t\t\t\tthickness + thickness * blur, \n\t\t\t\t\te\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (style == 7) \n\t\t\t{\n\t\t\t\treturn hashwithoutsine13(vec3(p + mb) + seed);\n\t\t\t}\n\t\t}\n\t',[p,u,m,f,g,v])}}(),zS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f,g,v,b){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=r,this.fA=n,this.fB=i,this.distortion=a,this.colorA=o,this.colorB=s,this.colorC=l,this.colorD=c,this.noiseType=d,this.voronoiStyle=u,this.highCut=m,this.lowCut=f,this.smoothness=g,this.seed=v,this.quality=b,this.isMask=p,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,r,n,i){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let a=Object.values(IS)[this.noiseType.value],o=new Cw(`vec3 ${a}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) \n\t\t\t{\n                // Prevent scale of zero \n\t\t\t\tscale = max(abs(scale), 0.001);\n\n\t\t\t\tvec3 st = position / size;\n\t\t\t\tst /= scale;\n\n\t\t\t\t${"voronoi"==a?`\n\t\tfloat v = ${a}(st + move, voronoiStyle, smoothness, seed, quality);\n\n\t\t// Apply clipping to colors\n\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t// Note that the voronoi mode only uses colors "A" and "C" from the UI \n\t\tvec4 color = mix(colorA, colorC, v); \n\t\t`:`\n\t\tvec3 q = vec3(${a}(st),\n\t\t\t\t\t   ${a}(st + vec3(1.0)),\n\t\t\t\t\t   ${a}(st + vec3(1.0)));\n\t\tvec3 r = vec3(${a}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t  ${a}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t  ${a}(st * q));\n\t\tfloat f = ${a}(st + r);\n\t\tvec4 color;\n\t\tcolor = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\tcolor = mix(color, colorC, clamp(length(q), 0.0, 1.0));\n\t\tcolor = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));\n\t\t`}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t}`,[NS.simplex,NS.simplexFractal,NS.simplexAshima,NS.fbm,NS.perlin,NS.voronoi]),s=t.include(o),l=[];return l.push(this.scale.build(t,"f")),l.push(this.size.build(t,"v3")),l.push(this.move.build(t,"f")),l.push(this.fA.build(t,"v2")),l.push(this.fB.build(t,"v2")),l.push(this.distortion.build(t,"v2")),l.push(this.colorA.build(t,"v4")),l.push(this.colorB.build(t,"v4")),l.push(this.colorC.build(t,"v4")),l.push(this.colorD.build(t,"v4")),l.push(this.voronoiStyle.build(t,"i")),l.push(this.highCut.build(t,"f")),l.push(this.lowCut.build(t,"f")),l.push(this.smoothness.build(t,"f")),l.push(this.seed.build(t,"f")),l.push(this.quality.build(t,"i")),l.push(this.isMask.build(t,"b")),l.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),l.push(this.alpha.build(t,"f")),l.push(this.calpha),t.format(s+"("+l.join(",")+")",this.getType(t),e)}};zS.numOctaves=5;var FS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=r,this.contourWidth=n,this.contourThreshold=i,this.outlineThreshold=a,this.contourFrequency=o,this.outlineSmoothing=s,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=d,this.normalMap=p,this.depthMap=u,this.pixelRatio=m,this.alpha=f,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.compensation.value&&t.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let e=this.outlineWidth.build(t,"f"),n=this.resolution.build(t,"v2"),i=this.compensation.build(t,"b"),a=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(e,"uniform float"),t.addVertexParsVariable(n,"uniform vec2"),t.addVertexParsVariable(i,"uniform bool"),t.addVertexParsVariable(a,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float"),t.addVertexFinalCode(`\n                vID = randomColor.r;\n                vec2 ${r}_offset = vec2(0.0);\n                if (${i}) {\n                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));\n                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the\n                    // normals face the camera directly. So we hackily fix this by offsetting the normal\n                    // by a tiny amount.\n                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;\n                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${e} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};\n                    ${r}_clipPosition.xy += ${r}_offset;\n                    // TODO(MAX): To handle multiple outline layers, we only want to extrude\n                    // if this offset is the biggest of all the potential offsets\n                    gl_Position = ${r}_clipPosition;\n                }\n            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let r=t.include(FS.Nodes.outline),n=[];return n.push(this.outlineColor.build(t,"c")),n.push(this.contourColor.build(t,"c")),n.push(this.outlineWidth.build(t,"f")),n.push(this.contourWidth.build(t,"f")),n.push(this.contourThreshold.build(t,"f")),n.push(this.outlineThreshold.build(t,"f")),n.push(this.contourFrequency.build(t,"f")),n.push(this.outlineSmoothing.build(t,"f")),n.push(this.contourDirection.build(t,"v3")),n.push(this.positionalLines.build(t,"b")),n.push(this.resolution.build(t,"v2")),n.push(this.normalMap.getTexture(t,"t")),n.push(this.depthMap.getTexture(t,"t")),n.push(this.pixelRatio.build(t,"f")),n.push(this.compensation.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},US=FS;US.Nodes=function(){let t=new Cw("\nfloat sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)\n{\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    vec2 texelSize = (vec2(1.0) / resolution);\n    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;\n\n    vec2 uvSamples[9];\n    vec4 normalSamples[9];\n\n\tuvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);\n\tuvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);\n\tuvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);\n\tuvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);\n\tuvSamples[4] = uv;\n\tuvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);\n\tuvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);\n\tuvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);\n\tuvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);\n\n\n    normalSamples[0] = texture2D(t, uvSamples[0]);\n    normalSamples[1] = texture2D(t, uvSamples[1]);\n    normalSamples[2] = texture2D(t, uvSamples[2]);\n    normalSamples[3] = texture2D(t, uvSamples[3]);\n    normalSamples[4] = texture2D(t, uvSamples[4]);\n    normalSamples[5] = texture2D(t, uvSamples[5]);\n    normalSamples[6] = texture2D(t, uvSamples[6]);\n    normalSamples[7] = texture2D(t, uvSamples[7]);\n    normalSamples[8] = texture2D(t, uvSamples[8]);\n\n    float depthBias = 0.0001;\n    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!\n    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n\n    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);\n  \tvec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);\n\n    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));\n    return edgeNormal;\n}\n");return{outline:new Cw("vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {\n                vec3 result = outlineColor;\n                float resultAlpha = 0.0;\n\n                vec3 N = normalize(vWNormal);\n                vec2 nuv = (gl_FragCoord.xy / resolution);\n                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);\n                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);\n\n                //resultAlpha = 1.0;\n                //result = vec3(sobelSample);\n\n                float t = 1.0 - contourThreshold;\n                if(positionalLines) {\n                    vec3 NDir = position * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float f  = fract(NT * contourFrequency * 0.01);\n                    float df = fwidth(NT * contourFrequency);\n\n                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);\n                    if (g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0;\n                    }\n                 }\n                 else {\n                    vec3 NDir = N * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float df = fwidth(NT * contourThreshold);\n                    float f = sin(NT * 1.0 * contourFrequency);\n                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);\n\n                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0 - g;\n                    }\n                 }\n\n                 float lalpha = alpha * resultAlpha * mask;\n                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\t \n                 return result;\n             }",[t])}}();var BS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h,d,p,u,m,f,g,v){super("v3"),this.nodeType="Pattern",this.style=t,this.projection=e,this.axis=r,this.blending=n,this.offset=i,this.colorA=a,this.colorB=o,this.frequency=s,this.size=l,this.variation=c,this.smoothness=h,this.zigzag=d,this.rotation=p,this.vertical=u,this.horizontal=m,this.sides=f,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let r;switch(t.require("position"),t.require("uv"),t.requires.uv=[!0],t.require("normal"),t.requires.normal=!0,t.addFragmentVariable(this.calpha,"float"),this.style.value){case 0:default:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave"}let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new Cw("float hashwithoutsine12(vec2 p)\n\t\t\t\t{\n\t\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * .1031);\n\t\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t\t}"),a=new Cw("vec2 rotate_uv(in vec2 uv, float a, bool repeat) \n\t\t\t\t{\n\t\t\t\t\tconst float mid = 0.5;\n\t\t\t\t\tfloat radians = a * (PI / 180.0);\n\t\t\t\t\tvec2 rotated = vec2(\n\t\t\t\t\t\tcos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,\n\t\t\t\t\t\tcos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid\n\t\t\t\t\t);\n\t\t\t\t\treturn repeat ? fract(rotated): rotated;\n\t\t\t\t}"),o="";if(4===this.projection.value){o=`\n\t\t\t\tvec3 p = position;\n\t\t\t\tfloat factor = 0.0125;\n\t\t\t\tvec2 uv0 = fract(p.xy * factor);\n\t\t\t\tvec2 uv1 = fract(p.zy * factor);\n\t\t\t\tvec2 uv2 = fract(p.xz * factor);\n\t\t\t\t\n\t\t\t\tuv0 = rotate_uv(uv0 + offset, rotation, true);\n\t\t\t\tuv1 = rotate_uv(uv1 + offset, rotation, true);\n\t\t\t\tuv2 = rotate_uv(uv2 + offset, rotation, true);\n\t\n\t\t\t\tfloat d0 = ${2===this.style.value?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\tfloat d1 = ${2===this.style.value?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\tfloat d2 = ${2===this.style.value?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\t\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\t\t\t\td0 *= weights.z;\n\t\t\t\td1 *= weights.x;\n\t\t\t\td2 *= weights.y;\n\t\t\t\tfloat draw = d0 + d1 + d2;\n\t\n\t\t\t\tvec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;\n\t\t\t\t`}else{let t=2===this.style.value?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,e="";0===this.axis.value?e="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.z);\n\t\t\t\t\tfloat phi = acos(p.x / radius);":1===this.axis.value?e="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.x, p.z);\n\t\t\t\t\tfloat phi = acos(p.y / radius);":(this.axis.value,e="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.x);\n\t\t\t\t\tfloat phi = acos(p.z / radius);");let n="";switch(this.projection.value){case 0:n="custom_uv = vUv.st;";break;case 1:case 3:default:break;case 2:n=`\n\t\t\t\t\t\t\tvec3 p = position;\n\t\t\t\t\t\t\t${e}\n\t\t\t\t\t\t\tcustom_uv = vec2(theta, phi);\n\t\t\t\t\t\t\tcustom_uv /= PI;\n\t\t\t\t\t\t\t`}o=`\n\t\t\t\tvec2 custom_uv;\n\t\t\t\t${n}\n\t\n\t\t\t\tcustom_uv += offset;\n\t\t\t\tcustom_uv = fract(custom_uv);\n\t\t\t\tcustom_uv = rotate_uv(custom_uv, rotation, true);\n\t\n\t\t\t\tfloat draw = ${t};\n\t\t\t\t`}let s=new Cw(`vec3 ${n}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\t\tconst float TWO_PI = PI * 2.0;\n\t\t\t\t\tfloat smoothness_remapped = pow(smoothness, 5.0);\t\n\n\t\t\t\t\t${o}\n\n\t\t\t\t\t// Construct final output color\n\t\t\t\t\tvec4 color = mix(colorA, colorB, draw);\n\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t// Apply cuts\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(vertical.x, custom_uv.y) * \n\t\t\t\t\t\tstep(custom_uv.y, vertical.y);\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(horizontal.x, abs(custom_uv.x)) * \n\t\t\t\t\t\tstep(abs(custom_uv.x), horizontal.y);\n\n\t\t\t\t\t// Accumulate alpha \n\t\t\t\t\tfloat lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t\t}`,[a,i,BS.DrawFunctions.circle,BS.DrawFunctions.ring,BS.DrawFunctions.polygon,BS.DrawFunctions.cross,BS.DrawFunctions.diamond,BS.DrawFunctions.checkerboard,BS.DrawFunctions.line,BS.DrawFunctions.wave]),l=t.include(s),c=[];return c.push("normal"),c.push(this.blending.build(t,"f")),c.push(this.style.build(t,"i")),c.push(this.offset.build(t,"v2")),c.push(this.colorA.build(t,"v4")),c.push(this.colorB.build(t,"v4")),c.push(this.frequency.build(t,"v2")),c.push(this.size.build(t,"f")),c.push(this.variation.build(t,"f")),c.push(this.smoothness.build(t,"f")),c.push(this.zigzag.build(t,"f")),c.push(this.rotation.build(t,"f")),c.push(this.vertical.build(t,"v2")),c.push(this.horizontal.build(t,"v2")),c.push(this.sides.build(t,"i")),c.push(this.isMask.build(t,"b")),c.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),c.push(this.alpha.build(t,"f")),c.push(this.calpha),t.format(l+"("+c.join(",")+")",this.getType(t),e)}return console.warn("PatterNode is not compatible with "+t.shader+" shader."),t.format("vec3(0.0)",this.getType(t),e)}},VS=BS;VS.DrawFunctions=function(){let t=new Cw("float hashwithoutsine12(vec2 p) {\n\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * 0.1031);\n\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t}"),e=new Cw("vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {\n                // Create tiles in UV-space\n                uv *= frequency;\n\n                // Integer coords\n                vec2 i = floor(uv);\n\n                // Offset every other row based on zigzag param, then compute fractional coords\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = fract(uv);\n\n\t\t\t\t// Rotate the tile itself:\n\t\t\t\t// const float mid = 0.5;\n\t\t\t\t// f = vec2(\n\t\t\t\t// \tcos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,\n\t\t\t\t// \tcos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid\n\t\t\t\t// );\n\t\t\t\t// f = fract(f);\n\n                f = f * 2.0 - 1.0;\n\n\t\t\t\t// Recompute integer coords after shifting - then, random value per tile \n\t\t\t\ti = floor(uv);\n\t\t\t\tfloat rand = (hashwithoutsine12(i) * 5.0 + 1.0);\n\t\t\t\tfloat jitter = mix(1.0, rand, variation);\n\t\t\t\tf *= jitter;\n\n                return f;\n            }",[t]);return{tileAndCenter:e,circle:new Cw("float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(\n                    -smoothness, \n                     smoothness, \n                     length(f) - size\n                );\n            }",[e]),ring:new Cw("float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\n\t\t\t\tfloat d = length(f);\n                const float inner_width = 0.5;\n\n                float outer = smoothstep(-smoothness, smoothness, d - size);\n                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);\n\t\t\t\treturn outer + (1.0 - inner);   \n            }",[e]),polygon:new Cw("float sdf_ngon(in vec2 p, in float r, in int n) {\n                float an = (PI * 2.0) / float(n);\n                float he = r * tan(0.5 * an);\n                \n                // Rotate to first sector\n                p = -p.yx; \n                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);\n                vec2  cs = vec2(cos(bn), sin(bn));\n                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;\n            \n                // Side of polygon\n                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);\n            }\n            \n            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));\n            }",[e]),cross:new Cw("float sdf_cross(in vec2 p, in vec2 b, float r ) {\n                p = abs(p); \n\t\t\t\tp = (p.y > p.x) ? p.yx : p.xy;\n                vec2  q = p - b;\n                float k = max(q.y, q.x);\n                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n                return sign(k) * length(max(w, 0.0)) + r;\n            }\n            \n            // Avoid namespace conflicts \n            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));\n            }",[e]),diamond:new Cw("float ndot(vec2 a, vec2 b) { \n                return a.x*b.x - a.y*b.y; \n            }\n            \n            float sdf_diamond(in vec2 p, in vec2 b) {\n                p = abs(p);\n                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);\n                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);\n            }\n\n            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\t            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));\n            }",[e]),checkerboard:new Cw("float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                uv *= frequency;\n                vec2 i = floor(uv);\n\n                float offset = mod(i.y, 2.0);\n\n                uv.x += offset + zigzag * offset;\n                float x = floor(uv.x);\n                \n                return mod(x, 2.0);\n            }"),line:new Cw("float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);\n\t\t\t\t\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat row = floor(uv * frequency).y;\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(row));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\ts - smoothness, \n\t\t\t\t\ts + smoothness, \n\t\t\t\t\tabs(f.y)\n\t\t\t\t);\n            }",[e]),wave:new Cw("// Uses bisection \n            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {\n                // Convert all data to a primitive cosine wave\n                p = c * (p - vec2(d, a));\n                \n                const float TWO_PI = PI * 2.0;\n\n                // Reduce to principal half cycle\n                p.x = mod(p.x, TWO_PI); \n                if (p.x > PI) {\n                    p.x = TWO_PI - p.x;\n                }\n            \n                // Find zero of derivative (minimize distance)\n                float xa = 0.0;\n                float xb = TWO_PI;\n\n                // 24 bit precision\n                for (int i = 0; i < 24; i++) {\n                    float x = 0.5 * (xa + xb);\n                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));\n                    if (y < 0.0) xa = x; \n                    else xb = x;\n                }\n                float x = 0.5 * (xa + xb);\n                \n                // Compute distance    \n                vec2 q = vec2(x, b * c * cos(x));\n                return length(p - q) / c;\n            }\n\n            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                float repeat = frequency.x;\n                uv *= repeat;\n                vec2 i = floor(uv);\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = vec2(uv.x, fract(uv.y));\n\n                // Generalized cosine: y(x) = a + b * cos(cx + d)\n                const float amplitude = 0.125;\n                float wave_frequency = frequency.y * 0.1;\n                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);\n\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(i.y));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);\n            }")}}();var jS=class extends _w{constructor(t,e,r,n,i,a,o,s){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=r,this.noiseStrength=n,this.noiseScale=i,this.offset=a,this.isMask=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let r=t.include(jS.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(t,"f")),n.push(this.movement.build(t,"f")),n.push(this.wavelengths.build(t,"v3")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.offset.build(t,"v3")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},GS=jS;GS.Nodes=function(){let t=new Cw("vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {\n                 vec3 st = position / noiseScale;\n\t\t\t\t vec3 q = vec3(simplex3d(st),\n\t\t\t\t\t\t\t  simplex3d(st + vec3(1.0)),\n\t\t\t\t\t\t\t  simplex3d(st + vec3(1.0)));\n\n\t\t\t\t vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),\n\t\t\t\t\t\t\t  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),\n\t\t\t\t\t\t\t  simplex3d(st * q));\n\n                 float noise = simplex3d(st + r);\n\n                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);\n             }",[NS.simplex]);return{rainbow:new Cw("vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);\n\n\t\t\t\tfloat rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);\n\n\t\t\t\tfloat lalpha = alpha * rainbowContribution * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn res;\n             }",[t])}}();var HS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=r,this.source=n,this.isWorldSpace=i,this.noiseStrength=a,this.noiseScale=o,this.shadowColor=s,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let r=t.include(HS.Nodes.toon),n=[];return n.push(this.positioning.build(t,"i")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.source.build(t,"v3")),n.push(this.isWorldSpace.build(t,"b")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.shadowColor.build(t,"v4")),n.push(this.offset.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},WS=HS;WS.Nodes=function(){let t=new Cw("float rand(float n) {\n\t\t\t\treturn fract(sin(n) * 43758.5453123);\n\t\t\t}"),e=new Cw("float hash1(float p) { \n\t\t\t\tp = fract(p * 0.011); \n\t\t\t\tp *= p + 7.5; \n\t\t\t\tp *= p + p; \n\t\t\t\treturn fract(p); \n\t\t\t}"),r=new Cw("float valueNoise(vec3 x) {\n\t\t\t\tconst vec3 step = vec3(110, 241, 171);\n\t\t\t\n\t\t\t\tvec3 i = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\t\t\t \n\t\t\t\t// For performance, compute the base input to a 1D hash from the integer part of the argument and the \n\t\t\t\t// incremental change to the 1D based on the 3D -> 1D wrapping\n\t\t\t\tfloat n = dot(i, step);\n\t\t\t\n\t\t\t\tvec3 u = f * f * (3.0 - 2.0 * f);\n\t\t\t\treturn mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n\t\t\t\t\t\t   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n\t\t\t}",[e]),n=new Cw("vec3 hash3(vec3 x) {\n\t\t\t\tx = vec3(dot(x,vec3(127.1, 311.7, 74.7)),\n\t\t\t\t\t\t dot(x,vec3(269.5, 183.3, 246.1)),\n\t\t\t\t\t\t dot(x,vec3(113.5, 271.9, 124.6)));\n\t\t\t\n\t\t\t\treturn fract(sin(x)*43758.5453123);\n\t\t\t}"),i=new Cw('vec3 voronoiNoise(in vec3 x)\n\t\t\t{\n\t\t\t\tvec3 p = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\n\t\t\t\tfloat id = 0.0;\n\t\t\t\tvec2 res = vec2(100.0);\n\n\t\t\t\tfor(int k=-1; k<=1; k++)\n\t\t\t\tfor(int j=-1; j<=1; j++)\n\t\t\t\tfor(int i=-1; i<=1; i++)\n\t\t\t\t{\n\t\t\t\t\tvec3 b = vec3(float(i), float(j), float(k));\n\n\t\t\t\t\t// Comment out the "+ hash(p + b);" part below to get "square" cells\n\t\t\t\t\tvec3 r = vec3(b) - f + hash3(p + b);\n\t\t\t\t\tfloat d = dot(r, r);\n\n\t\t\t\t\tif (d < res.x)\n\t\t\t\t\t{\n\t\t\t\t\t\tid = dot(p + b, vec3(1.0, 57.0, 113.0));\n\t\t\t\t\t\tres = vec2(d, res.x);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse if (d < res.y)\n\t\t\t\t\t{\n\t\t\t\t\t\tres.y = d;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn vec3(sqrt(res), abs(id));\n\t\t\t}\n\t\t\t',[n]);return{toon:new Cw('vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat t = 0.0;\n\t\t\t\tfloat shadow = 1.0;\n\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\t// Can\'t do this mode if lighting is "none"\n\t\t\t\t\t#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))\n\n\t\t\t\t\t\t// Algorithm from Chapter 10 of Graphics Shaders\n\t\t\t\t\t\tconst vec3 weights = vec3(0.2125, 0.7154, 0.0721);\n\t\t\t\t\t\tvec3 lpos;\n\t\t\t\t\t\tvec3 l;\n\t\t\t\t\t\tfloat dproduct;\n\n\t\t\t\t\t\t#if (NUM_POINT_LIGHTS > 0)\n\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tPointLightShadow pointLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_POINT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Light positions are in view-space for some reason?\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// TODO: we want to use "intensity" but it isn\'t available in the shader code\n\t\t\t\t\t\t\t\t//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);\n\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tpointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getPointShadow( \n\t\t\t\t\t\t\t\t\t\t\tpointShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowRadius,\n\t\t\t\t\t\t\t\t\t\t\tvPointShadowCoord[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraNear, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraFar);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_DIR_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tDirectionalLightShadow directionalLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Use the direction vector for directional lights instead\n\t\t\t\t\t\t\t\tl = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;\n\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tdirectionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow( \n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tdirectionalShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tSpotLightShadow spotLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_SPOT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tspotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow(\n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tspotShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvSpotLightCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tt = clamp(t, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\t#endif\n\n\t\t\t\t} else if (positioning == 1) {\n\t\t\t\t\t\n\t\t\t\t\tvec3 origin = mix(position, worldPosition, float(isWorldSpace));\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvec3 origin = worldPosition;\n\t\t\t\t\tvec3 source = cameraPosition - offset;\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (noiseStrength > 0.0) {\n\t\t\t\t\t// Distort with noise\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\t\n\t\t\t\t\t// Voronoi "smooth" noise\n\t\t\t\t\tfloat noise = 1.0 - voronoiNoise(st).x;\n\n\t\t\t\t\t// Voronoi cellular noise\n\t\t\t\t\t//float noise = 1.0 - rand(voronoiNoise(st).z);\n\n\t\t\t\t\t// Position warp noise\n\t\t\t\t\t// vec3 offset = vec3(\n\t\t\t\t\t// \tsimplex3d(st),\n\t\t\t\t\t// \tsimplex3d(st + vec3(111.1, 143.89, 217.19)),\n\t\t\t\t\t// \tsimplex3d(st + vec3(171.1, 247.89, 117.23))\n\t\t\t\t\t// );\n\t\t\t\t\t// st += offset;\n\t\t\t\t\t// float noise = valueNoise(st);\n\n\t\t\t\t\tt += noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tt = clamp(t, 0.0, 1.0);\n\n\t\t\t\t// Compute ramp color\n\t\t\t\tfloat p;\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tfor (int i = 1; i < COLORS_MAX; i++) {\n\t\t\t\t\tp = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);\n\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t}\n\n\t\t\t\t// Incorporate custom shadow color\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\tvec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);\n\t\t\t\t\tcolor.rgb = mix(blendedShadow, color.rgb, shadow);\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// Accumulate alpha as usual\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\n            }',[NS.simplex,t,r,i])}}();var qS={textureBicubic:new Cw("float w0( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n        }\n    \n        float w1( float a ) {\n            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n        }\n    \n        float w2( float a ){\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n        }\n    \n        float w3( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * a * a );\n        }\n    \n        // g0 and g1 are the two amplitude functions\n        float g0( float a ) {\n            return w0( a ) + w1( a );\n        }\n    \n        float g1( float a ) {\n            return w2( a ) + w3( a );\n        }\n    \n        // h0 and h1 are the two offset functions\n        float h0( float a ) {\n            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n        }\n    \n        float h1( float a ) {\n            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n        }\n    \n        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n            uv = uv * texelSize.zw + 0.5;\n    \n            vec2 iuv = floor( uv );\n            vec2 fuv = fract( uv );\n    \n            float g0x = g0( fuv.x );\n            float g1x = g1( fuv.x );\n            float h0x = h0( fuv.x );\n            float h1x = h1( fuv.x );\n            float h0y = h0( fuv.y );\n            float h1y = h1( fuv.y );\n    \n            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n    \n            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + \n                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n        }\n\n        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n            vec2 fLodSizeInv = 1.0 / fLodSize;\n            vec2 cLodSizeInv = 1.0 / cLodSize;\n            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n            return mix( fSample, cSample, fract( lod ) );\n        }")};var $S=class extends _w{constructor(t,e,r,n,i,a,o,s){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=r,this.transmissionSamplerSize=n,this.transmissionSamplerMap=i,this.transmissionDepthMap=a,this.aspectRatio=o,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",6),t.define("BLUR_SLOD",Math.pow(2,JS.transmissionLod.value)),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let r=t.include($S.Nodes.transmission),n=[];return n.push(this.thickness.build(t,"f")),n.push(this.ior.build(t,"f")),n.push(this.roughness.build(t,"f")),n.push(this.transmissionSamplerSize.build(t,"v2")),n.push(this.transmissionSamplerMap.getTexture(t,"t")),n.push(this.transmissionDepthMap.getTexture(t,"t")),n.push(this.aspectRatio.build(t,"v2")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},XS=$S;XS.Nodes=function(){let t=new Cw("vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {\n                // Slightly modified version of this:\n                // https://www.shadertoy.com/view/ltScRG\n\n\t\t\t\t// Special case for blur == 0.0\n\t\t\t\tif (lod == 0.0) {\n\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\treturn texture2DLodEXT( sp, U, 0.0).rgb;\n\t\t\t\t\t#else\n\t\t\t\t\treturn textureLod( sp, U, 0.0).rgb;\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec2 texelSize = vec2(1.0) / resolution;\n                vec2 halton = haltonSequence[frameIndex];\n                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n                float temporalAngle  = temporalOffset * PI2;\n\t\t\t\tvec3 res = vec3(0.0);\n                vec2 uv = vec2(0.0);\n                vec2 offset = vec2(0.0);\n                vec2 vogelSample = vec2(0.0);\n                for (int i = 0; i < NUM_SAMPLES; i++) {\n                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;\n                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20\n                    uv = U + offset;\n                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));\n                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {\n                        uv = unrefractedU;\n                        lod = lod > 4.0 ? lod : lod / 2.0;\n                    }\n                    res += textureLod(sp, uv, lod).rgb;\n                }\n                return res / float(NUM_SAMPLES);\n            }"),e=new Cw("vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\t        // Direction of refracted light.\n\t\t        vec3 refractionVector = refract( -v,  n, 1.0 / ior );\n\t\t        \n\t\t\t\t// Compute rotation-independant scaling of the model matrix.\n\t\t        vec3 modelScale;\n\t\t        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\t        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\t        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t        // The thickness is specified in local space\n\t\t        return normalize( refractionVector ) * thickness * modelScale;\n\t        }"),r=new Cw("float applyIorToRoughness( float roughness, float ior ) {\n\t\t\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\t\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t\t\t}"),n=new Cw('vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {\n\t\t\t\t// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see\n\t\t\t\t// also the code in convertTransmission.ts, which runs during export\n\t\t\t\t#ifdef IS_THREEJS_EXPORT\n\t\t\t\t\tfloat lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);\n\t\t\t\t\treturn textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;\n\t\t\t\t#else\n\t\t\t\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t\t\t\tfloat lod = applyIorToRoughness(roughness, ior);\n\t\t\t\t\treturn blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);\n\t\t\t\t#endif\n\t\t\t}',[qS.textureBicubic,r,t]),i=new Cw("vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\n\t\t\t\tvec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );\n\t\t\t\tvec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;\n\t\t\t\tunrefractedCoords += 1.0;\n\t\t\t\tunrefractedCoords /= 2.0;\n\n\t\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\t\treturn getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );\n    \t\t}",[n,e]);return{transmission:new Cw("vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {\n                vec3 v = vec3(0.);\n                if (isOrthographic) {\n                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n                } else {\n                    v = normalize(vWPosition - cameraPosition);\n                }\n                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );\n                \n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn transmission;\n            }",[i])}}();var YS=(t=>(t.NOISE="noise",t.MAP="map",t))(YS||{}),ZS=class extends _w{constructor(t,e,r,n,i,a,o,s,l,c,h){super("v3"),this.displacementTypeIndex=new cS(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,"map"===Object.values(YS)[this.displacementTypeIndex.value]&&(this.mat=new fS(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=h,this.voronoiStyle=n,this.smoothness=i,this.seed=a,this.highCut=o,this.lowCut=s,this.quality=l}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let r,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(YS)[this.displacementTypeIndex.value]){case"map":r=t.include(ZS.Nodes.map),n.push(this.movementOrTexture.getTexture(t,"t")),n.push("uv"),n.push(this.cropOrOffset.build(t,"f")),this.mat&&n.push(this.mat.build(t,"mat3"));break;case"noise":{let e=Object.values(IS)[this.noiseFunctionIndex.value],i=new Cw("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),a=new Cw(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {\n\t\t\t\t\t\t\t${"voronoi"==e?`\n\t\t\t\t\tfloat v = ${e}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);\n\t\t\t\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\t\t\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\t\t\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t\t\t\treturn p + n * v * intensity;\n\t\t\t\t\t`:`\n\t\t\t\t\treturn p + n * ${e}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t`}\n\t\t\t\t\t\t}`,[NS.simplex,NS.simplexFractal,NS.simplexAshima,NS.fbm,NS.perlin,NS.voronoi]),o=new Cw("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\n                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.\n                            // This caused some small oval/circular visual artifacts in the lighting.\n                            // For now, simply using neighbors further away betters the problem,\n                            // but we should figure out the underlying cause when we have some time.\n                            // Maybe its related to how we calculate the tangent and bitangent?\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[a,i]);r=t.include(o),n.push(this.scale.build(t,"f")),n.push(this.cropOrOffset.build(t,"v3")),n.push(this.movementOrTexture.build(t,"f")),n.push(this.voronoiStyle.build(t,"i")),n.push(this.smoothness.build(t,"f")),n.push(this.seed.build(t,"f")),n.push(this.highCut.build(t,"f")),n.push(this.lowCut.build(t,"f")),n.push(this.quality.build(t,"i"));break}}return n.push(this.intensity.build(t,"f")),n.push("displaced_normal"),t.format(r+"("+n.join(",")+")",this.getType(t),e)}return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},KS=ZS;KS.Nodes=function(){let t=new Cw("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),e=new Cw("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new Cw("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[t,e])}}();var JS={normalRenderTarget:new Bw,normalRenderTargetDepth:new Bw,transmissionRenderTarget:new Bw,aspectRatio:new Sw,transmissionSize:new Sw(2048,2048),transmissionRenderTargetDepth:new Bw,aoRenderTarget:new Bw,aoEnabled:new hS,pixelRatioNode:new Vw(1),resolution:new Sw,penumbraSize:new dS(5,.5),frameIndex:new cS(0),transmissionLod:new cS(2)};for(let t of Object.values(JS))t.isRenderGlobal=!0;var QS,tE=class extends yw{constructor(){super("basic"),this.nodeType="Basic",this.color=new lS(Qg),this.shadingAlpha=new Vw(1),this.shadingBlend=new cS(0),this.previousModelViewMatrix=new gS,this.previouseProjectionMatrix=new gS}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({resolution:JS.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(vn.merge([Nn.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join("\n")}else{void 0===this.color&&(this.color=new lS(Qg)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let r=this.color.flow(t,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(t,"f"):void 0,i=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=void 0!==n,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join("\n"));let o=["#include <normal_fragment_begin>",r.code];n&&o.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),a?o.push(a.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${r.result};`);let s="1.0";this.mask&&(this.mask.analyze(t),s=`luminance(${this.mask.flow(t,"v3").result})`),n?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${n.result} * ${s} );`):o.push("gl_FragColor = vec4("+r.result+", 1.0 );"),i&&o.push(`gl_FragColor.a *= ${i.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),e=o.join("\n")}return e}},eE=class extends yw{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new lS(Qg),this.emissive=new lS(0),this.emissiveIntensity=new Vw(1),this.previousModelViewMatrix=new gS,this.previouseProjectionMatrix=new gS,this.shadingAlpha=new Vw(1),this.shadingBlend=new cS(0),this.occlusion=new hS(!0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({resolution:JS.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(vn.merge([Nn.fog,Nn.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t"),n.push("\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\tvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\tvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\t\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join("\n")}else{t.mergeUniform({penumbraSize:JS.penumbraSize}),t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({aoMap:JS.aoRenderTarget}),t.mergeUniform({aoEnabled:JS.aoEnabled}),void 0===this.color&&(this.color=new lS(Qg)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let r=this.color.flow(t,"c",{slot:"color"}),n=this.emissive.flow(t,"c",{slot:"emissive"}),i=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),a=this.occlusion.flow(t,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(t,"f"),s=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=void 0!==c,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let d=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx, viewdy));\n\t\t\t\tbool isFrontFacing = (dot(normal, faceNormal) >= 0.0);\n\t\t\t\t","#include <clipping_planes_fragment>"];d.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&d.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+i.result+";"),d.push("vec3 ao = aoEnabled && "+a.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let p="1.0";this.mask&&(this.mask.analyze(t),p=`luminance(${this.mask.flow(t,"v3").result})`),d.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${p} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${p}, ${s.result} );\n\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&d.push(`gl_FragColor.a *= ${h.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=d.join("\n")}return e}},rE={dHdxy:new Cw("vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {\n\n            // Gradient of UVs w.r.t. X coordinate (in screen-space)\n            vec2 dSTdx = dFdx(bumpMapUv);\n\n            // Gradient of UVs w.r.t. Y coordinate (in screen-space)\n            vec2 dSTdy = dFdy(bumpMapUv);\n            \n            // Forward differencing\n            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);\n            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;\n            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;\n            \n            return vec2( dBx, dBy );\n        }"),perturbNormalArb:new Cw("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n            vec3 vSigmaX = dFdx( surf_pos.xyz );\n            vec3 vSigmaY = dFdy( surf_pos.xyz );\n            vec3 vN = surf_norm; // normalized\n            \n            vN = normalize(vN);\n\n            vec3 R1 = cross( vSigmaY, vN );\n            vec3 R2 = cross( vN, vSigmaX );\n\n            R1 = normalize(R1);\n            R2 = normalize(R2);\n    \n            float fDet = dot( vSigmaX, R1 ) * faceDirection;\n    \n            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n            return normalize( abs( fDet ) * vN - vGrad );\n        }")},nE=class extends yw{constructor(){super("phong"),this.nodeType="Phong",this.color=new lS(Qg),this.specular=new lS(1118481),this.shininess=new Vw(30),this.previousModelViewMatrix=new gS,this.previouseProjectionMatrix=new gS,this.shadingAlpha=new Vw(1),this.shadingBlend=new cS(0),this.occlusion=new hS(!0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({resolution:JS.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(vn.merge([Nn.fog,Nn.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join("\n")}else{t.mergeUniform({penumbraSize:JS.penumbraSize}),t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({aoMap:JS.aoRenderTarget}),t.mergeUniform({aoEnabled:JS.aoEnabled}),void 0===this.color&&(this.color=new lS(Qg)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t);let r=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),a=this.shininess.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),s=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=void 0!==c,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let d=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tBlinnPhongMaterial material;"];if(this.bumpMap){t.include(rE.dHdxy),t.include(rE.perturbNormalArb);let e=this.bumpMap.texture.flow(t,"t"),r=this.bumpMap.flow(t,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${e.result}, uv0, ${n});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${e.result}, uv1, ${n});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${e.result}, uv2, ${n});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${e.result}, bumpMapCachedUv, ${n});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${r.result};\n\t\t\t\t\t${i}\n\t\t\t\t\t`)}d.push(n.code,"\tvec3 diffuseColor = "+n.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","\tvec3 totalEmissiveRadiance = emissive;",i.code,"\tvec3 specular = "+i.result+";",a.code,"\tfloat shininess = max( 0.0001, "+a.result+" );","\tfloat specularStrength = 1.0;"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let p="1.0";this.mask&&(this.mask.analyze(t),p=`luminance(${this.mask.flow(t,"v3").result})`),d.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${p} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${p}, ${s.result} );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&d.push(`gl_FragColor.a *= ${h.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=d.join("\n")}return e}},iE=class extends yw{constructor(){super("standard"),this.nodeType="Standard",this.color=new lS(Qg),this.roughness=new Vw(.3),this.metalness=new Vw(0),this.reflectivity=new Vw(.5),this.previousModelViewMatrix=new gS,this.previouseProjectionMatrix=new gS,this.shadingAlpha=new Vw(1),this.shadingBlend=new cS(0),this.occlusion=new hS(!0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({resolution:JS.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(vn.merge([Nn.fog,Nn.lights])),Nn.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join("\n")}else{t.mergeUniform({penumbraSize:JS.penumbraSize}),t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({aoMap:JS.aoRenderTarget}),t.mergeUniform({aoEnabled:JS.aoEnabled});let r={gamma:!0};void 0===this.color&&(this.color=new lS(Qg)),this.color.analyze(t,{slot:"color",context:r}),this.roughness.analyze(t),this.metalness.analyze(t);let n=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let i=this.color.flow(t,"c",{slot:"color",context:r}),a=this.roughness.flow(t,"f"),o=this.metalness.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),l=this.shadingBlend.flow(t,"i"),c=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(t,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,p=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=void 0!==h,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join("\n"));let u=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){t.include(rE.dHdxy),t.include(rE.perturbNormalArb);let e=this.bumpMap.texture.flow(t,"t"),r=this.bumpMap.flow(t,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${e.result}, uv0, ${n});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${e.result}, uv1, ${n});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${e.result}, uv2, ${n});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${e.result}, bumpMapCachedUv, ${n});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${r.result};\n\t\t\t\t\t${i}\n\t\t\t\t\t`)}if(u.push(i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"\tfloat metalnessFactor = "+o.result+";"),this.roughnessMap){let e=this.roughnessMap.texture.flow(t,"t"),r=this.roughnessMap.flow(t,"v3"),n="";n=4===this.roughnessMap.projection.value?`\n\t\t\t\t\tfloat roughnessChange = 1.0;\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tfloat r0 = luminance(texture(${e.result}, uv0).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r1 = luminance(texture(${e.result}, uv1).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r2 = luminance(texture(${e.result}, uv2).rgb) * roughnessScale;\n\n\t\t\t\t\t\troughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);\n\t\t\t\t\t}\n\t\t\t\t\tfloat roughnessFactor = roughnessChange * ${a.result};\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\n\t\t\t\t\tvec4 vals = texture(${e.result},  roughnessMapCachedUv);\n\t\t\t\t\tfloat roughnessFactor = luminance(vals.rgb) * ${a.result};\n\t\t\t\t\t`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${r.result};\n\n\t\t\t\t\tconst float roughnessScale = 1.0;\n\n\t\t\t\t\t${n}\n\t\t\t\t`)}else u.push(a.code,"\tfloat roughnessFactor = "+a.result+";");h&&u.push(h.code,"#ifdef ALPHATEST","\tif ( "+h.result+" <= ALPHATEST ) discard;","#endif"),u.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),u.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),p?u.push(p.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+p.result+" ) ), diffuseColor, metalnessFactor );"):u.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),u.push("#include <lights_fragment_begin>"),u.push("#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let m="1.0";this.mask&&(this.mask.analyze(t),m=`luminance(${this.mask.flow(t,"v3").result})`),u.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${m} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${m}, ${l.result} );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),c&&u.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),h?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push(`gl_FragColor.a *= ${d.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join("\n")}return e}},aE=class extends yw{constructor(){super("toon"),this.nodeType="Toon",this.color=new lS(Qg),this.specular=new lS(1118481),this.shininess=new Vw(30),this.previousModelViewMatrix=new gS,this.previouseProjectionMatrix=new gS,this.shadingAlpha=new Vw(1),this.shadingBlend=new cS(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({resolution:JS.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(vn.merge([Nn.fog,Nn.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let n=["#include <beginnormal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];r&&n.push(r.code,r.result?"displaced_position = "+r.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join("\n")}else{t.mergeUniform({penumbraSize:JS.penumbraSize}),t.mergeUniform({frameIndex:JS.frameIndex}),t.mergeUniform({aoMap:JS.aoRenderTarget}),t.mergeUniform({aoEnabled:JS.aoEnabled}),void 0===this.color&&(this.color=new lS(Qg)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let r=this.color.flow(t,"c",{slot:"color"}),n=this.specular.flow(t,"c"),i=this.shininess.flow(t,"f"),a=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),s=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=void 0!==l,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tToonMaterial material;"];if(this.bumpMap){t.include(rE.dHdxy),t.include(rE.perturbNormalArb);let e=this.bumpMap.texture.flow(t,"t"),r=this.bumpMap.flow(t,"v3"),n=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",i="";i=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${e.result}, uv0, ${n});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${e.result}, uv1, ${n});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${e.result}, uv2, ${n});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${e.result}, bumpMapCachedUv, ${n});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${r.result};\n\t\t\t\t\t${i}\n\t\t\t\t\t`)}h.push(r.code,"\tvec3 diffuseColor = "+r.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"\tvec3 specular = "+n.result+";",i.code,"\tfloat shininess = max( 0.0001, "+i.result+" );","\tfloat specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),h.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );\n\t\t\t\t}\n\t\t\t\t`),s&&h.push(s.code,`outgoingLight = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=h.join("\n")}return e}},oE=class{constructor(t=1e4){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout((()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")}),this.timeout+1e3))}has(t){return this.cache.get(t)?.data}load(t){let e=Date.now(),r=this.cache.get(t);return void 0===r?(r={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,r)):(r.time=e,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},sE=class extends oE{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}};var lE=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,0===this.refCount&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount,0}},cE=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data),0}load(t){let e=this.cache.get(t);return void 0===e&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},hE=class extends lE{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo="video"===t.type,this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let t=[1e3,1001,1002];for(let e of t){let t=this[e];t&&(t.image=this.img,t.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,"string"!=typeof t){var r=new FileReader;let e;r.readAsDataURL(new Blob([t],{type:"video/mp4"})),await new Promise((t=>{r.onloadend=r=>{e=r.target?.result,t(null)}})),this.img.src=e}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=function(t){return"string"==typeof t?t:(QS||(QS=new sE),QS.load(t))}(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let e;return e=this.isVideo?new Fo(this.img,void 0,t,t):new ne(this.img,void 0,t,t),this.loaded&&(e.needsUpdate=!0),this[t]=e,e}}disposeTextures(){this[1e3]?.dispose(),this[1e3]=void 0,this[1001]?.dispose(),this[1001]=void 0,this[1002]?.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},dE=class extends hE{};function pE(t,e){return e.color(t)}function uE(t,e){switch(t.type){case"fresnel":return function(t,e){let{bias:r,scale:n,intensity:i,factor:a,color:o}=t;return{...fE(t,e),color:pE(o,e),bias:r,scale:n,intensity:i,factor:a}}(t,e);case"gradient":return function(t,e){let{gradientType:r,smooth:n,colors:i,steps:a,angle:o,offset:s,morph:l}=t;return{...fE(t,e),gradientType:r,smooth:n,colors:i.map((t=>new ie(t[0],t[1],t[2],t[3]))),num:i.length,steps:a,offset:new Ot(...s),morph:new Ot(...l),angle:o}}(t,e);case"depth":return function(t,e){let{gradientType:r,near:n,far:i,isVector:a,isWorldSpace:o,origin:s,direction:l,colors:c,steps:h,smooth:d}=t;return{...fE(t,e),gradientType:r,near:n,far:i,isVector:a,isWorldSpace:o,origin:new he(...s),direction:l?new he(...l):new he(1,0,0),colors:c.map((t=>void 0!==t?new ie(t[0],t[1],t[2],t[3]):new ie(0,0,0,0))),steps:h.slice(0,c.length),smooth:d}}(t,e);case"normal":return function(t,e){let{cnormal:r}=t;return{...fE(t,e),cnormal:new he(r[0],r[1],r[2])}}(t,e);case"noise":return function(t,e){return{...fE(t,e),scale:t.scale,move:t.move,fA:new Ot(...t.fA),fB:new Ot(...t.fB),size:new he(...t.size),distortion:new Ot(...t.distortion),colorA:pE(t.colorA,e),colorB:pE(t.colorB,e),colorC:pE(t.colorC,e),colorD:pE(t.colorD,e),noiseType:t.noiseType,voronoiStyle:t.voronoiStyle,highCut:t.highCut,lowCut:t.lowCut,smoothness:t.smoothness,seed:t.seed,quality:t.quality}}(t,e);case"rainbow":return function(t,e){return{...fE(t,e),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new he(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new he(...t.offset)}}(t,e);case"toon":return function(t,e){return{...fE(t,e),positioning:t.positioning,colors:t.colors.map((t=>new ie(t[0],t[1],t[2],t[3]))),num:t.colors.length,steps:t.steps,source:new he(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:pE(t.shadowColor,e),offset:new he(...t.offset)}}(t,e);case"outline":return function(t,e){return{...fE(t,e),outlineColor:pE(t.outlineColor,e),contourColor:pE(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new he(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}(t,e);case"transmission":return function(t,e){return{...fE(t,e),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}(t,e);case"color":return function(t,e){return{...fE(t,e),color:pE(t.color,e)}}(t,e);case"pattern":return function(t,e){return{...fE(t,e),style:t.style,projection:t.projection,axis:t.axis,blending:t.blending,offset:new Ot(...t.offset),colorA:pE(t.colorA,e),colorB:pE(t.colorB,e),frequency:new Ot(...t.frequency),size:t.size,variation:t.variation,smoothness:t.smoothness,zigzag:t.zigzag,rotation:t.rotation,vertical:new Ot(...t.vertical),horizontal:new Ot(...t.horizontal),sides:t.sides}}(t,e)}}function mE(t){return{type:t.type}}function fE(t,e){let{alpha:r,mode:n,isMask:i}=t,a="string"==typeof r?(Number(e.getVariable(r))??100)/100:r;return{...mE(t),alpha:a,mode:n,isMask:i}}var gE=class extends Mw{},vE={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},bE={depth:["colors"]};function yE(t,e,r){if("isMask"===e)return!0;let n=vE[t.type],i=bE[t.type];if(void 0!==i){let n=t.color;if(i.includes(e)){let t=n[e]?.value?.length;if(void 0!==t&&t!==r.length)return!0}}return void 0!==n&&n.includes(e)}function xE(t,e,r){let n=r.uniforms[`f${r.id}_texture`];if(!n)return!1;let i=t;if("image"in i){let t=i.image,r=e.image(t),a=n;a.image instanceof dE||a.image.deref(),a.image=r}if("video"in i){let t=i.video,r=e.video(t),a=n;a.image instanceof dE||a.image.deref(),a.image=r}if("wrapping"in i){n.wrap=i.wrapping}if("repeat"in i||"offset"in i){let t="mat",e=r.uniforms[`f${r.id}_${t}`];"repeat"in i&&(e.repeat=i.repeat),"offset"in i&&(e.offset=i.offset),e.updateMatrix()}return!1}var _E=(t,e,r)=>Math.max(0,Math.min(1,Number(e.getVariable("number"==typeof t?100*t:t,r)??100)/100))??1,wE=class{constructor(t,e,r,n,i){this.id=t,this.uuid=e,this.data=r,this.uniforms={};for(let t in n)this.uniforms[`f${this.id}_${t}`]=n[t];for(let t in r)TE(t,this,r,i)}get type(){return this.data.type}static create(t,e,r,n){if("light"===r.type)return ME.createLigherLayer(t,e,r,n);if("texture"===r.type||"video"===r.type){let i="texture"===r.type?n.image(r.texture.image):n.video(r.texture.video),a=new mS(i,r.texture.wrapping),o=new uS(i),s=new bS(r.texture.repeat,r.texture.offset),l=new Vw(r.crop?1:0),c=new cS(r.projection??0),h=new cS(["x","y","z"].indexOf(r.axis)??0),d=new cS(r.side??0),p=new Sw(r.size?new Ot(r.size[0],r.size[1]):new Ot(100,100)),u=new Vw(r.blending??0),m=new Vw(_E(r.alpha,n)),f=new cS(r.mode??0),g=new hS(r.isMask??!1),v=new AS(a,o,l,c,h,d,p,u,s,m,f,g),b=new Uw(v.calpha,"f");return new SE(t,e,r,{texture:a,textureSize:o,crop:l,projection:c,axis:h,side:d,size:p,blending:u,mat:s,alpha:m,mode:f,isMask:g},v,f,b,g,n)}if("matcap"===r.type){let i=n.image(r.texture.image),a=new mS(i,r.texture.wrapping),o=new Vw(_E(r.alpha,n)),s=new cS(r.mode??0),l=new hS(r.isMask??!1),c=new RS(a,o,s,l),h=new Uw(c.calpha,"f");return new SE(t,e,r,{texture:a,alpha:o,mode:s,isMask:l},c,s,h,l,n)}if("displace"===r.type){if("noise"===r.displacementType){let i=new Ew(new he(...r.offset)),a=new Vw(r.scale??10),o=new Vw(r.intensity??8),s=new Vw(r.movement??1),l=new cS(r.noiseType??0),c=new cS(r.voronoiStyle??0),h=new Vw(r.smoothness??.5),d=new Vw(r.seed??0),p=new Vw(r.highCut??1),u=new Vw(r.lowCut??0),m=new cS(r.quality??1),f=new KS(o,s,i,c,h,d,p,u,m,a,l);return new EE(t,e,r,{offset:i,scale:a,intensity:o,movement:s,noiseType:l,voronoiStyle:c,smoothness:h,seed:d,highCut:p,lowCut:u,quality:m},f,n)}throw new Error}return function(t,e,r,n){let i=uE(r,n);return function(t,e,r,n,i){switch(t.type){case"color":{let a=new lS(n.color??Qg),o=AE(n),s=new wS(a,o.alpha),l=new Uw(s.calpha,"f");return new SE(e,r,t,{color:a,...o},s,o.mode,l,o.isMask,i)}case"fresnel":{let a=new lS(n.color??16777215),o=new Vw(n.bias??.1),s=new Vw(n.scale??1),l=new Vw(n.intensity??2),c=new Vw(n.factor??1),h=AE(n),d=new CS(a,o,s,l,c,h.alpha,h.mode,h.isMask),p=new Uw(d.calpha,"f");return new SE(e,r,t,{color:a,bias:o,scale:s,intensity:l,factor:c,...h},d,h.mode,p,h.isMask,i)}case"rainbow":{let a=new Vw(n.filmThickness??30),o=new Vw(n.movement??0),s=new Ew(n.wavelengths??new he(0,0,0)),l=new Vw(n.noiseStrength??0),c=new Vw(n.noiseScale??1),h=new Ew(n.offset??new he(0,0,0)),d=AE(n),p=new GS(a,o,s,l,c,h,d.alpha,d.isMask),u=new Uw(p.calpha,"f");return new SE(e,r,t,{filmThickness:a,movement:o,wavelengths:s,noiseStrength:l,noiseScale:c,offset:h,...d},p,d.mode,u,d.isMask,i)}case"transmission":{let a=new Vw(n.thickness??10),o=new Vw(n.ior??1.5),s=new Vw(n.roughness??.5),l=JS.transmissionSize,c=JS.transmissionRenderTarget,h=JS.transmissionRenderTargetDepth,d=window.innerWidth,p=window.innerHeight,u=d>=p?new Sw(p/d,1):new Sw(1,d/p),m=AE(n),f=new XS(a,o,s,l,c,h,u,m.alpha),g=new Uw(f.calpha,"f");return new SE(e,r,t,{thickness:a,ior:o,roughness:s,aspectRatio:u,...m},f,m.mode,g,m.isMask,i)}case"toon":{let a,o,s=new cS(n.positioning??0);n.colors?a=new yS(n.colors.length,n.colors):(a=new yS(10,new ie(0,0,0,1)),a.value[1]=new ie(1,1,1,1)),n.steps?o=new dS(n.steps.length,n.steps):(o=new dS(10,1),o.value[0]=0);let l=new Ew(n.source??new he(0,0,0)),c=new hS(n.isWorldSpace??!0),h=new Vw(n.noiseStrength??0),d=new Vw(n.noiseScale??1),p=new Aw(n.shadowColor),u=new Ew(n.offset??new he(0,0,0)),m=AE(n),f=new WS(s,a,o,l,c,h,d,p,u,m.alpha),g=new Uw(f.calpha,"f");return new SE(e,r,t,{positioning:s,colors:a,steps:o,source:l,isWorldSpace:c,noiseStrength:h,noiseScale:d,shadowColor:p,offset:u,...m},f,m.mode,g,m.isMask,i)}case"outline":{let a=new lS(n.outlineColor??16777215),o=new lS(n.contourColor??16777215),s=new Vw(n.outlineWidth??.1),l=new Vw(n.contourWidth??.1),c=new Vw(n.outlineThreshold??.1),h=new Vw(n.contourThreshold??.1),d=new Vw(n.outlineSmoothing??.1),p=new Vw(n.contourFrequency??.1),u=new Ew(n.contourDirection??new he(0,1,0)),m=new hS(n.positionalLines??!1),f=new hS(n.compensation??!0),g=JS.normalRenderTarget,v=JS.normalRenderTargetDepth,b=JS.pixelRatioNode,y=JS.resolution,x=AE(n),_=new US(a,o,s,l,c,h,d,p,u,m,f,y,g,v,b,x.alpha),w=new Uw(_.calpha,"f");return new SE(e,r,t,{outlineColor:a,contourColor:o,outlineWidth:s,contourWidth:l,outlineThreshold:c,contourThreshold:h,outlineSmoothing:d,contourFrequency:p,contourDirection:u,positionalLines:m,compensation:f,...x},_,x.mode,w,x.isMask,i)}case"depth":{let a,o,s=new cS(n.gradientType??0),l=new hS(n.smooth??!1),c=new Vw(n.near??50),h=new Vw(n.far??200),d=new Vw(n.isVector??1),p=new Vw(n.isWorldSpace??0),u=new Ew(n.origin??new he),m=new Ew(n.direction??new he);n.colors?a=new yS(n.colors.length,n.colors):(a=new yS(2,new ie(0,0,0,1)),a.value[1]=new ie(1,1,1,1)),n.steps?o=new dS(n.steps.length,n.steps):(o=new dS(2,1),o.value[0]=0);let f=AE(n),g=new PS(s,l,c,h,d,p,u,m,a,o,f.alpha,f.isMask),v=new Uw(g.calpha,"f");return new SE(e,r,t,{gradientType:s,smooth:l,near:c,far:h,isVector:d,isWorldSpace:p,origin:u,direction:m,colors:a,steps:o,...f},g,f.mode,v,f.isMask,i)}case"noise":{let a=new Vw(n.scale??1),o=new Ew(n.size??new he(100,100,100)),s=new Vw(n.move??1),l=new Sw(n.fA??new Ot(1.7,9.2)),c=new Sw(n.fB??new Ot(8.3,2.8)),h=new Sw(n.distortion??new Ot(1,1)),d=new Aw(n.colorA),p=new Aw(n.colorB),u=new Aw(n.colorC),m=new Aw(n.colorD),f=new cS(n.noiseType??0),g=new cS(n.voronoiStyle??0),v=new Vw(n.highCut??1),b=new Vw(n.lowCut??0),y=new Vw(n.smoothness??.5),x=new Vw(n.seed??.5),_=new cS(n.quality??1),w=AE(n),S=new zS(a,o,s,l,c,h,d,p,u,m,w.alpha,f,w.isMask,g,v,b,y,x,_),E=new Uw(S.calpha,"f");return new SE(e,r,t,{scale:a,size:o,move:s,fA:l,fB:c,distortion:h,colorA:d,colorB:p,colorC:u,colorD:m,noiseType:f,...w,voronoiStyle:g,highCut:v,lowCut:b,smoothness:y,seed:x,quality:_},S,w.mode,E,w.isMask,i)}case"normal":{let a=new Ew(n.cnormal??new he(1,1,1)),o=AE(n),s=new ES(a,o.alpha),l=new Uw(s.calpha,"f");return new SE(e,r,t,{cnormal:a,...o},s,o.mode,l,o.isMask,i)}case"gradient":{let a,o,s=new cS(n.gradientType??0),l=new hS(n.smooth??!1);n.colors?a=new yS(n.colors.length,n.colors):(a=new yS(10,new ie(0,0,0,1)),a.value[1]=new ie(1,1,1,1)),n.steps?o=new dS(n.steps.length,n.steps):(o=new dS(10,1),o.value[0]=0);let c=new Sw(n.offset??new Ot(0,0)),h=new Sw(n.morph??new Ot(0,0)),d=new Vw(n.angle??0),p=AE(n),u=new DS(s,l,a,o,c,h,d,p.alpha,p.isMask),m=new Uw(u.calpha,"f");return new SE(e,r,t,{gradientType:s,smooth:l,colors:a,steps:o,offset:c,morph:h,angle:d,...p},u,p.mode,m,p.isMask,i)}case"pattern":{let a=new cS(n.style??0),o=new cS(n.projection??0),s=new cS(["x","y","z"].indexOf(n.axis)??0),l=new Vw(n.blending??0),c=new Sw(n.offset??new Ot(0,0)),h=new Aw(n.colorA),d=new Aw(n.colorB),p=new Sw(n.frequency??new Ot(10,10)),u=new Vw(n.size??.5),m=new Vw(n.variation??0),f=new Vw(n.smoothness??.5),g=new Vw(n.zigzag??0),v=new Vw(n.rotation??0),b=new Sw(n.vertical??new Ot(0,1)),y=new Sw(n.horizontal??new Ot(0,1)),x=new cS(n.sides??6),_=AE(n),w=new VS(a,o,s,l,c,h,d,p,u,m,f,g,v,b,y,x,_.alpha,_.isMask),S=new Uw(w.calpha,"f");return new SE(e,r,t,{style:a,projection:o,axis:s,blending:l,offset:c,colorA:h,colorB:d,frequency:p,size:u,variation:m,smoothness:f,zigzag:g,rotation:v,vertical:b,horizontal:y,sides:x,..._},w,_.mode,S,_.isMask,i)}default:{let a=new lS(1,0,0,1),o=AE(n),s=new wS(a,o.alpha),l=new Uw(s.calpha,"f");return new SE(e,r,t,{color:a,...o},s,o.mode,l,o.isMask,i)}}}(r,t,e,i,n)}(t,e,r,n)}updateByOp(t,e,r){let n=t;if(void 0===n.path[0]){if(0===n.type)return"type"in n.props||"category"in n.props||"visible"in n.props?(r.scene.markNeedsUpdateRendererDirty(),!0):function(t,e,r,n){let i=!1;for(let[a,o]of Object.entries(t)){if("bumpMap"===a||"roughnessMap"===a){i=!0;continue}if(!a||void 0===o)continue;if(TE(a,r,n,e)){"visible"===a&&"light"===r.type&&(i=!0);continue}r.visible=n.visible;let t=r.uniforms[`f${r.id}_${a}`];if(t&&!(t instanceof pS))switch(i=i||yE(r,a,o),t.constructor){case lS:if("string"==typeof o){let r=e.getColor(o);r&&(t.value=r);break}{let e=o;t.value instanceof gE?t.value=new Mw(e.r,e.g,e.b,e.a):t.setRGBA(e);break}case Aw:if("string"==typeof o){let r=e.getColor(o);r&&(t.value=r);break}{let e=o;t.value instanceof gE?t.value=new Mw(e.r,e.g,e.b,e.a):t.value.setRGBA(e.r,e.g,e.b,e.a);break}case Sw:{let e=o;t.value.setX(e[0]),t.value.setY(e[1]);break}case Ew:{let e=o;t.value.setX(e[0]),t.value.setY(e[1]),t.value.setZ(e[2]);break}case Bw:xE(o,e,r);break;case yS:t.value=o.map((t=>new ie(...t)));break;default:t.value=o}}return i}(n.props,r.shared,this,e)}else if("texture"===n.path[0])return!("texture"in e)&&!("video"in e)||xE(n.props,r.shared,this);return!1}dispose(){if(function(t){let e=t instanceof wE?t.type:t;return"texture"===e||"video"===e||"displace_map"===e||"matcap"===e}(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof dE||e.image.deref()}}hasValueByKey(t){return void 0!==this.uniforms[t]}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let r=`f${this.id}_${t}`;this.hasValueByKey(r)&&void 0!==e&&(this.uniforms[r].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let r=this.getName(e);r&&t.push(r)}return t}},SE=class extends wE{constructor(t,e,r,n,i,a,o,s,l){super(t,e,r,n,l),this.params=n,this.color=i,this.mode=a,this.alpha=o,this.isMask=s}},EE=class extends wE{constructor(t,e,r,n,i,a){super(t,e,r,n,a),this.position=i}},ME=class extends wE{constructor(t,e,r,n,i,a){super(t,e,r,i,a),this.node=n}static createLigherLayer(t,e,r,n){let i,a,o=new Vw(_E(r.alpha,n)),s=new cS(r.mode),l=new Vw(r.bumpMapIntensity),c=new Vw(_E(r.alphaOverride,n));if(r.visible)if("lambert"===r.category){i=new eE;let t=new lS(n.color(r.emissive)??0),e=new hS(r.occlusion??!0);a={emissive:t,occlusion:e},i.emissive=t,i.occlusion=e}else if("toon"===r.category){i=new aE;let t=new Vw(r.shininess??30),e=new lS(n.color(r.specular)??1118481);a={shininess:t,specular:e},i.shininess=t,i.specular=e}else if("physical"===r.category){i=new iE;let t=new Vw(r.roughness??.3),e=new Vw(r.metalness??0),n=new Vw(r.reflectivity??.5),o=new hS(r.occlusion??!0);a={roughness:t,metalness:e,reflectivity:n,occlusion:o},i.roughness=t,i.metalness=e,i.reflectivity=n,i.occlusion=o}else{i=new nE;let t=new Vw(r.shininess??30),e=new lS(void 0!==r.specular?n.color(r.specular)??1118481:1118481),o=new hS(r.occlusion??!0);a={shininess:t,specular:e,occlusion:o},i.shininess=t,i.specular=e,i.occlusion=o}else i=new tE,a={};return i.alpha=new Vw(1),i.shadingAlpha=o,i.shadingBlend=s,i.bumpMapIntensity=l,i.alphaOverride=c,a.alpha=i.shadingAlpha,a.mode=i.shadingBlend,a.bumpMapIntensity=i.bumpMapIntensity,a.alphaOverride=i.alphaOverride,new ME(t,e,r,i,a,n)}get category(){return this.node.category}};function AE(t){return{alpha:new Vw(t.alpha??1),mode:new cS(t.mode??0),isMask:new hS(t.isMask??!1)}}function TE(t,e,r,n){if("displace"===r.type&&("intensity"===t||"visible"===t)){let t=e.uniforms[`f${e.id}_intensity`];return t?(t.value=r.intensity*(r.visible?1:0),t):void 0}if("displace"!==r.type&&("alpha"===t||"visible"===t)){let i=e.uniforms[`f${e.id}_alpha`];if(!i)return;if(i.value=_E(r.alpha,n)*(r.visible?1:0),"outline"===r.type&&"visible"===t){let t=e.uniforms[`f${e.id}_compensation`];t&&(t.value=r.compensation&&r.visible)}return i}}function PE(t,e){let r=0,n=t.layers.find((t=>"light"===t.data.type));if(n){let t=n.data,r=Number(e.getVariable(t.alphaOverride));if(("string"==typeof t.alphaOverride?r/100:t.alphaOverride)<1)return!0}for(let n of t.layers){if("displace"!==n.data.type&&n.data.isMask)return!0;if("displace"!==n.data.type&&"alpha"in n.data&&"light"!==n.data.type&&"fresnel"!==n.data.type&&"texture"!==n.data.type&&"matcap"!==n.data.type&&"rainbow"!==n.data.type&&"outline"!==n.data.type&&"pattern"!==n.data.type){let t=n.data.visible?n.data.alpha:0;if("string"==typeof t&&(t=Math.max(0,Math.min(1,Number(e.getVariable(t)??100)/100))),1===t&&"depth"===n.data.type||"gradient"===n.data.type){for(let e of n.data.colors)if(e[3]<1){t=e[3];break}}else if(1===t&&"noise"===n.data.type){let r=e.color(n.data.colorA).a,i=e.color(n.data.colorB).a,a=e.color(n.data.colorC).a,o=e.color(n.data.colorD).a,s=Math.min(r,Math.min(i,Math.min(a,o)));s<1&&(t=s)}r+=(1-r)*t}}return r<1}var CE=class extends bn{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},kE=class extends CE{constructor(t,e,r,n){super(),this.flatShading=t,this.side=e,this.wireframe=r,this.root=n}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(t,e,r){return this.root.getFlavor(t,e,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,r){this.root.updateByOp(t,e,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},DE=class extends CE{constructor(t,e,r=!0){super(),this.data=t,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,r){let n=r?6:(t?3:0)+e;if(0===n)return this;void 0===this.flavors&&(this.flavors=[]),n-=1;let i=this.flavors[n];return void 0===i&&(i=new kE(t,e,r,this),this.flavors[n]=i,i.flatShading=t,i.side=e,i.updateAfterBuild()),i}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){return this.lightLayer.getNode("occlusion")?.value??!1}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let r=t.layers??bv.defaultTwoLayerData("phong").layers;try{this.layers=r.map((t=>wE.create(this.layerIdGen++,t.id,t.data,e.shared)))}catch{this.layers=[]}this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(e.shared),this.transparent=PE(t,e.shared),this.saveVariableLocations(e)}onVariableUpdate(t,e,r){if("alphaOverride"===t[0])this.transparent=PE(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(e)/100,1)));else if("layer"===t[0]){let n=t[1],i=t[2];if(n&&i){let t=this.layers.find((t=>t.uuid===n));t?.hasValue(i)&&("alpha"===i?(this.transparent=PE(this.data,r.shared),t.setValue(i,Math.max(0,Math.min(Number(e)/100,1)))):t.setValue(i,e))}}}saveVariableLocations(t){if(!this.allowVariableSaves)return;let e=this.data.layers.find((t=>"light"===t.data.type));e&&t.shared.getVariable(e.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach((e=>{"alpha"in e.data&&"string"==typeof e.data.alpha&&t.shared.getVariable(e.data.alpha,["material",this.uuid,"layer",e.id,"alpha"])}))}getLayersOfType(t){return this.layers.filter((e=>e.type===t))}getLayerByUuid(t){return this.layers.find((e=>e.uuid===t))}onUpdate(t){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find((t=>t instanceof ME)),void 0===this.lightLayer&&(this.lightLayer=new ME(0,"",{...vv.defaultData("light","phong"),visible:!1},new tE,{},t)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let t=this.layers.find((t=>t instanceof ME));if(!t)return;let e=t.data,r=e.bumpMap,n=e.roughnessMap;t.node.bumpMap=void 0,t.node.roughnessMap=void 0;for(let e=0;e<this.layers.length;++e){let i=this.layers[e];i instanceof SE&&i.color instanceof AS&&(i.uuid===r&&(t.node.bumpMap=i.color),i.uuid===n&&(t.node.roughnessMap=i.color))}}updateByOp(t,e,r){if(void 0!==e?this.data=e:e=this.data,this.transparent=PE(e,r.shared),"layers"===t.path[0]){this.data=e;let n=r.shared,i=t.path[1];if(void 0===i){if(this.layers.reverse(),4===t.type){let e=wE.create(this.layerIdGen++,t.id,t.data,r.shared);this.layers.splice(t.localIndex,0,e),r.scene.markNeedsUpdateRendererDirty()}else if(5===t.type)this.layers.splice(t.localIndex,1)[0].dispose(),r.scene.markNeedsUpdateRendererDirty();else if(6===t.type){let e=this.layers.findIndex((e=>e.uuid===t.id)),n=this.layers[e];this.layers.splice(e,1),this.layers.splice(t.localIndex,0,n),r.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate(r.shared)}else{0===t.type&&void 0!==t.props.occlusion&&r.scene.markNeedsUpdateRendererDirty();let a=this.layers.find((t=>t.uuid===i));if(a){let o,s=e.layers.data(i);if(0===t.type&&("alpha"in t.props||"alphaOverride"in t.props)&&(o="alpha"in t.props?{...t.props,alpha:_E(t.props.alpha,n,["material",this.uuid,"layer",i,"alpha"])}:{...t.props,alphaOverride:_E(t.props.alphaOverride,n,["material",this.uuid,"alphaOverride"])}),a.updateByOp({...t,...o?{props:o}:{},path:t.path.slice(2)},s,r)){let t=wE.create(this.layerIdGen++,i,s,n);this.layers.splice(this.layers.findIndex((t=>t.uuid===i)),1,t),this.onUpdate(r.shared)}}}}else this.reset(e,r)}applyMasks(){for(let t=0;t<this.layers.length;++t){let e=this.layers[t];e instanceof SE?e.color.mask=void 0:e instanceof ME&&(e.node.mask=void 0)}for(let t=0;t<this.layers.length;++t){let e=this.layers[t];if(e instanceof SE&&e.isMask.value&&e.data.visible&&t>0){let r=t-1,n=this.layers[r];n instanceof ME?n.node.mask=new Hw(e.color,e.alpha,Hw.MUL):n instanceof SE&&(n.isMask.value||(n.color.mask=new Hw(e.color,e.alpha,Hw.MUL)))}}}blendColors(){let t=this.layers.findIndex((t=>t instanceof SE)),e=this.layers.findIndex((t=>t instanceof ME));if(-1!==t&&t<e){let r=this.layers[t].color;for(let n=t+1;n<e;++n){let t=this.layers[n];if(t instanceof SE){if(t.isMask.value)continue;r=new xS(r,t.color,t.alpha,t.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let t=new Uw("outgoingLight","f"),e=this.layers.findIndex((t=>t instanceof ME));if(this.layers.length>e+1){for(let r=e+1;r<this.layers.length;++r){let e=this.layers[r];if(e instanceof SE){if(e.isMask.value)continue;t=new xS(t,e.color,e.alpha,e.mode)}}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter((t=>t instanceof EE));if(t.length>0){let e=t[0].position;for(let r=1;r<t.length;++r)t[r]&&(e=new Hw(e,t[r].position,Hw.ADD),e=new Hw(e,new Vw(.5).setReadonly(!0),Hw.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=!0===this.extensions.derivatives,t.extensionFragDepth=!0===this.extensions.fragDepth,t.extensionDrawBuffers=!0===this.extensions.drawBuffers,t.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}clampUniformsForPreview(t,e){let r=(t,e,r)=>Math.min(Math.max(t,e),r);for(let n of this.layers)if("displace"===n.type){let i=r(n.uniforms[`f${n.id}_intensity`].value,t,e);n.uniforms[`f${n.id}_intensity`].value=i}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if("light"===e.type)t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let r=[...(vE[e.type]??[]).map((t=>e[t])),...(bE[e.type]??[]).map((t=>e[t]?.length??0))],n="isMask"in e&&e.isMask,i=`"${e.type}-${e.visible}-${n}"`;r.length?t+=`[${i}, "${r.join('","')}"],`:t+=i}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new sS;t.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach((t=>t.dispose())),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof SE){let e=t.params.texture;if(e instanceof mS&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(CE.prototype,{properties:{get:function(){return this.fragment.properties}}});var LE=class extends DE{constructor(t,e,r){super(t,e,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(e)}},RE=lc(mc()),OE=new Map;function IE(t){if("string"==typeof t)return t;let e=OE.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},OE.set(t,e)),e.url}var NE=class{constructor({src:t,volume:e,delay:r,loop:n}){let i;this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)},i="string"==typeof t?{src:t}:{src:IE(t),format:"wav"},this.sound=new RE.Howl(i),this.sound.on("end",this.onEnd),this.src=t,void 0!==e&&(this.volume=e),void 0!==r&&(this.delay=r),void 0!==n&&(this.loop=n)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout((()=>{this.sound.play(),this.clearDelay()}),this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout((()=>{this.sound.fade(this._volume,0,e),this.clearFade()}),t)):this.sound.fade(this._volume,0,e)}on(t,e,r){this.sound.on(t,e,r)}off(t,e,r){this.sound.off(t,e,r)}play(){"playing"===this._status||this.sound.playing()||("paused"===this._status?(0===this.sound.seek()?this.replay():this.sound.play(),this._status="playing"):"stopped"===this._status&&(this.replay(),this._status="playing"))}pause(){"playing"===this._status&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},zE=class{constructor(){this.type="ShapePath",this.color=new Pr,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new is,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath?.lineTo(t,e),this}quadraticCurveTo(t,e,r,n){return this.currentPath?.quadraticCurveTo(t,e,r,n),this}bezierCurveTo(t,e,r,n,i,a){return this.currentPath?.bezierCurveTo(t,e,r,n,i,a),this}splineThru(t){return this.currentPath?.splineThru(t),this}toShapes(){let t=0,e=1,r=2,n=3,i=4,a=5,o=6,s={loc:t,t:0};function l(e,n,i,a){let o=e.x,l=n.x,h=i.x,d=a.x,p=e.y,u=n.y,m=i.y,f=a.y,g=(d-h)*(p-m)-(f-m)*(o-h),v=(f-m)*(l-o)-(d-h)*(u-p),b=g/v,y=((l-o)*(p-m)-(u-p)*(o-h))/v;if(0===v&&0!==g||b<=0||b>=1||y<0||y>1)return null;if(0===g&&0===v){for(let h=0;h<2;h++){if(c(0===h?i:a,e,n),s.loc===t){let t=0===h?i:a;return{x:t.x,y:t.y,t:s.t}}if(s.loc===r){return{x:+(o+s.t*(l-o)).toPrecision(10),y:+(p+s.t*(u-p)).toPrecision(10),t:s.t}}}return null}for(let r=0;r<2;r++)if(c(0===r?i:a,e,n),s.loc===t){let t=0===r?i:a;return{x:t.x,y:t.y,t:s.t}}return{x:+(o+b*(l-o)).toPrecision(10),y:+(p+b*(u-p)).toPrecision(10),t:b}}function c(l,c,h){let d,p=h.x-c.x,u=h.y-c.y,m=l.x-c.x,f=l.y-c.y,g=p*f-m*u;return l.x===c.x&&l.y===c.y?(s.loc=t,void(s.t=0)):l.x===h.x&&l.y===h.y?(s.loc=e,void(s.t=1)):void(g<-Number.EPSILON?s.loc=n:g>Number.EPSILON?s.loc=i:p*m<0||u*f<0?s.loc=a:Math.sqrt(p*p+u*u)<Math.sqrt(m*m+f*f)?s.loc=o:(d=0!==p?m/p:f/u,s.loc=r,s.t=d))}function h(t,e,r){let n=new Ot;e.getCenter(n);let i=[];return r.forEach((e=>{e.boundingBox.containsPoint(n)&&function(t,e){let r=[],n=[];for(let i=1;i<t.length;i++){let a=t[i-1],o=t[i];for(let t=1;t<e.length;t++){let i=l(a,o,e[t-1],e[t]);null!==i&&void 0===r.find((t=>t.t<=i.t+Number.EPSILON&&t.t>=i.t-Number.EPSILON))&&(r.push(i),n.push(new Ot(i.x,i.y)))}}return n}(t,e.points).forEach((t=>{i.push({identifier:e.identifier,isCW:e.isCW,point:t})}))})),i.sort(((t,e)=>t.point.x-e.point.x)),i}let d=0,p=999999999,u=-999999999,m=[];this.subPaths.forEach((t=>{let e=t.getPoints(),r=-999999999,n=999999999,i=-999999999,a=999999999;for(let t=0;t<e.length;t++){let o=e[t];o.y>r&&(r=o.y),o.y<n&&(n=o.y),o.x>i&&(i=o.x),o.x<a&&(a=o.x)}u<=i&&(u=i+1),p>=a&&(p=a-1),e.length&&m.push({curves:t.curves,points:e,isCW:Ns.isClockWise(e),identifier:d++,boundingBox:new Nl(new Ot(a,n),new Ot(i,r))})}));let f=m.map((t=>function(t,e,r,n,i){(null==i||""===i)&&(i="nonzero");let a=new Ot;t.boundingBox.getCenter(a);let o=h([new Ot(r,a.y),new Ot(n,a.y)],t.boundingBox,e);o.sort(((t,e)=>t.point.x-e.point.x));let s=[],l=[];o.forEach((e=>{e.identifier===t.identifier?s.push(e):l.push(e)}));let c=s[0].point.x,d=[],p=0;for(;p<l.length&&l[p].point.x<c;)d.length>0&&d[d.length-1]===l[p].identifier?d.pop():d.push(l[p].identifier),p++;if(d.push(t.identifier),"evenodd"===i){let e=d.length%2==0,r=d[d.length-2];return{identifier:t.identifier,isHole:e,for:r}}if("nonzero"===i){let r=!0,n=null,i=null;for(let t=0;t<d.length;t++){let a=d[t];e[a]&&(r?(i=e[a].isCW,r=!1,n=a):i!==e[a].isCW&&(i=e[a].isCW,r=!0))}return{identifier:t.identifier,isHole:r,for:n}}console.warn('fill-rule: "'+i+'" is currently not implemented.')}(t,m,p,u,this.userData?.style.fillRule))),g=[];return m.forEach((t=>{let e=f[t.identifier];if(e&&!e.isHole){let e=new hs;e.curves=t.curves,f.filter((e=>e?.isHole&&e.for===t.identifier)).forEach((t=>{if(t){let r=m[t.identifier],n=new is;n.curves=r.curves,e.holes.push(n)}})),g.push(e)}})),g}},FE=new Promise((t=>{t}));var UE=new class{async load(t,e,r=(()=>{})){let{load:n}=await FE;n(t,((t,n)=>{t||!n?r(t??"Something went wrong"):e(n)}))}async parse(t){let{parse:e,Bidi:r}=await FE;try{let n=e(t),i=new r,a=t=>n.charToGlyphIndex(t.char);return i.registerModifier("glyphIndex",null,a),i.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:i}}catch(t){console.error(t)}}};async function BE(t){let e,r,n=!1;if(t.url?(e=await async function(t){return await(await fetch(t)).arrayBuffer()}(t.url),r=t.url,n=t.url.startsWith("/")):t.data&&(e=t.data.buffer.slice(t.data.byteOffset,t.data.byteOffset+t.data.byteLength)),e){let t=await UE.parse(e);if(t)return{font:t.font,url:r,intercepted:n,arr:e,bidi:t.bidi}}}function VE(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var jE=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=BE(t).then((t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)}))}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=BE(t).then((t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)}))}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,r){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(e);let i=n.tokenizer.tokens,a=[],o=0,s=r.length===i.length;for(let n=0;n<r.length;n++){let l=r[n].index,c=String.fromCharCode(r[n].unicode),h=i[o];if(VE(l,h)||s)a.push({char:c,index:l,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),o++;else{let r=h.char,n="",i=[h.state.glyphIndex],s=[],d=!1;for(;!d;)o++,n=e.charAt(o),r+=n,i.push(t.charToGlyphIndex(n)),s=t.stringToGlyphs(r),1===s.length&&s[0].index===l&&(d=!0),o>e.length&&(d=!0);a.push({char:c,index:l,replacements:i,replacementChars:Array.from(r)}),o++}}return a}generateShapes(t,e){if(!this._isLoaded)return;let r,n=this.font,i=e.fontSize/this.unitsPerEm,a=e.fontSize*e.lineHeight,o=t.map((t=>this.getTextWidth(t,e))),s=e.width,l=this.getCharWidth("\n",e),c=1===e.horizontalAlign?l:0,h=this.computeSpaceWidthForLine(t,0,e),d=this.getLineInitialOffsetX(o[0],s,e.horizontalAlign,t[0],l),p=this.getLineInitialOffsetY(a,t.length,e.height,i,e.verticalAlign),u=[],m=t.map((t=>[])),f=t.map((t=>[]));for(let g=0;g<t.length;g++){let v=t[g],b={features:{liga:!0}},y=[];try{y=n.stringToGlyphs(v,b)}catch(t){console.warn(t)}d=this.getLineInitialOffsetX(o[g],s,e.horizontalAlign,v,l);let x=[];try{x=this.reverseLigaturesTable(n,v,y)}catch(t){console.warn(t)}h=this.computeSpaceWidthForLine(t,g,e);for(let t=0;t<y.length;t++){let a=y[t],o=0===a.index?"\n":a.unicode?String.fromCharCode(a.unicode):void 0,s=x[t],l=0,v=0;0===t&&2===e.horizontalAlign&&void 0!==a.leftSideBearing&&(v=-a.leftSideBearing*i),r&&(l=n.getKerningValue(a,r)*i),d+=v+l;let b=0;if("\n"===o)b=c;else if(" "===o)b=h;else{let t=this.createPath(a,i,d,p,e);t&&(b=t.offsetX-(l+v),u.push(t.path))}if(1===s.replacements.length)f[g].push([d,p]),m[g].push(b);else{let t=s.replacements.map((t=>(n.glyphs.get(t).advanceWidth??0)*i)),e=t.reduce(((t,e)=>t+e),0),r=t.map((t=>t/e)),a=d;for(let t=0;t<r.length;t++){let e=b*r[t];f[g].push([a,p]),m[g].push(e),a+=e}}d+=b,r=a}p-=a}let g=[];for(let t=0,e=u.length;t<e;t++)g.push(...u[t].toShapes());return{shapes:g,charWidths:m,lineWidths:o,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){return this.font?.ascender??0}get descender(){return this.font?.descender??0}get familyName(){return this.font?.names.fontFamily??""}get subfamilyName(){return this.font?.names.fontSubfamily??""}get unitsPerEm(){return this.font?.unitsPerEm??1}getLineInitialOffsetX(t,e,r,n,i){return(3===r||2===r)&&n.indexOf("\n")>=0&&(t-=i),3===r?.5*e-.5*t:2===r?e-t:0}getLineInitialOffsetY(t,e,r,n,i){let a=e*t,o=t-Math.abs(this.ascender-this.descender)*n,s=-this.ascender*n-o/2;return 3===i?-(r-a-s):2===i?-(.5*r-.5*a-s):s}createPath(t,e,r,n,i){let a=t.getPath(r,-n,i.fontSize,{kerning:!1,letterSpacing:i.letterSpacing});if(!a)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");let o=new zE,s=(t.advanceWidth??1)*e;if(t)for(let t of a.commands){let e=o.currentPath?.currentPoint;if(!e||"Z"===t.type||e.x!==t.x||-e.y!==t.y)switch(t.type){case"M":o.moveTo(t.x,-t.y);break;case"L":o.lineTo(t.x,-t.y);break;case"Q":o.quadraticCurveTo(t.x1,-t.y1,t.x,-t.y);break;case"C":o.bezierCurveTo(t.x1,-t.y1,t.x2,-t.y2,t.x,-t.y)}}return o.subPaths.forEach((t=>{let e=function(t){if(t.length){let e=t[0];if(e instanceof Ko)return e.v1;if(e instanceof Yo||e instanceof Qo)return e.v0}}(t.curves);void 0!==e&&t.currentPoint.distanceTo(e)>0&&t.lineTo(e.x,e.y)})),{offsetX:s+i.fontSize*i.letterSpacing,path:o}}getCharWidth(t,e){return this.font?.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing})??0}getTextWidth(t,e){return this.font?.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing})??0}computeSpaceWidthForLine(t,e,r){let n=this.getCharWidth(" ",r),i=t[e];if(i){let a=this.countSpaces(i.trimEnd());if(4===r.horizontalAlign&&e<t.length-1&&a){return(r.width-(this.getTextWidth(i,r)-a*n))/a}}return n}countSpaces(t){return(t.match(/ /g)||[]).length}};var GE=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e,r){let n=this.objects.get(t);return void 0===n?(n=this.createObject(t,e,r),this.objects.set(t,n)):n.isShared=!0,n}forceDelete(t){let e=this.objects.get(t);e&&(this.disposeObject(e),this.objects.delete(t))}mutateIfUnique(t,e){let r=this.objects.get(t);if(r&&!0!==r.isShared)return this.objects.delete(t),this.objects.set(e,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){e===this.objects.get(t)&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach((t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)})),this.unreachable.clear()}dispose(){this.objects.forEach((t=>{this.disposeObject(t)})),this.objects.clear()}},HE=class extends GE{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e,r){let n=O_(t,e,this.flatShading,r);return n.computeBoundingSphere(),n}},WE={markNeedsUpdateRendererDirty:()=>{}},qE=class extends cE{constructor(t){super(),this.shared=t}create(t){return new hE(t,this.shared)}},$E=class{constructor(t,e={}){if(this.data=t,this.geometryCache=new HE(!0),this.geometryCache2=new HE(!1),this.imageHolderCache=new qE(this),this.thisContext={scene:WE,shared:this},this.deletedMaterial=new LE(bv.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new dE(nb.emptyImage,this),this.deletedVideo=new dE(lv.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[t,r]of Object.entries(e.images))this.addImage(t,r);if(e.videos)for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r);if(e.audios)for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r);this.reset(t)}setRequestRender(t){this._requestRender=t}setEntityOpContext(t){this.entityOpContext=t}reset(t,e=!1){this.resetLib(t.lib);for(let{id:r,data:n}of t.variables)this.addVariableHolder(r,n),e&&this.updateVariableHolder(r,n);for(let[e,r]of Object.entries(t.images))this.addImage(e,r);for(let[e,r]of Object.entries(t.videos))this.addVideo(e,r);for(let[e,r]of Object.entries(t.colors))this.addColor(e,r);for(let[e,r]of Object.entries(t.materials))this.addMaterial(e,r);for(let[e,r]of Object.entries(t.audios))this.addAudio(e,r);for(let[e,r]of Object.entries(t.fonts))this.addFont(e,r)}addMaterial(t,e){if(this.materials[t]){let r=this.materials[t];r.reset(e,this.thisContext),r.dispose()}else{let r=new LE(e,this.thisContext,t);this.materials[t]=r}}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return"string"==typeof t?this.getMaterialOrDeletedPlaceholder(t):null==t?(console.error("material is undefined or null"),this.deletedMaterial):new DE(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new dE(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return"string"==typeof t?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new dE(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return"string"==typeof t?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):(this.colors[t]=new gE(e.r,e.g,e.b,"a"in e?e.a:1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[t];return this.colors[t].r=e.r??r.r,this.colors[t].g=e.g??r.g,this.colors[t].b=e.b??r.b,this.colors[t].a=e.a??r.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if("string"!=typeof t)return new Mw(t.r,t.g,t.b,"a"in t?t.a:1);{let r=this.getColor(t);r?e=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new Mw(0,0,0,0))}return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof NE)return e;{let r=new NE({src:e.data});return this.audios[t]=r,r}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof NE&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new jE(e),this.fonts[t].loadingPromise.then((()=>this.requestRender()))}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach((t=>this.deleteMaterial(t))),this._requestRender=void 0,Object.values(this.audios).forEach((t=>{t instanceof NE&&t.dispose()})),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(t,e){return void 0===this.variables[t]?(this.variables[t]={value:e.value,locations:[]},"dynamicVariableType"in e&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0),!0):(this.variables[t].value=e.value,!1)}resetDynamicVariablePlayState(){for(let t in this.variables)void 0!==this.variables[t].dynamicVariablePlayState&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(t,e){this.updateVariable(t,e.value)}updateVariable(t,e){if(void 0===this.variables[t])return!1;this.variables[t].value=e;let r=e;for(;"string"==typeof r;)r=this.variables[r].value;let n=this.entityOpContext.scene;for(let e=this.variables[t].locations.length-1;e>=0;e--){let i=this.variables[t].locations[e];if("material"===i[0]){let t=i[1],e=r,a={scene:n,shared:this},o=i.slice(2);n.traverseMaterial((r=>{let n=r.root??r;n.uuid===t&&n.onVariableUpdate(o,e,a)}));let s=this.materials[t];s&&s.onVariableUpdate(o,e,a)}else{let a=n.find(i[0]);if(void 0===a){this.variables[t].locations.splice(e,1);continue}if("geometry"!==i[1]){for(let t=1;t<i.length-1;t++)a=a[i[t]];"rotation"===i[1]?a[i[i.length-1]]=r*Rt.DEG2RAD:a[i[i.length-1]]=r}if(a=n.find(i[0]),Jb.is(a))if("position"===i[1]||"rotation"===i[1]||"scale"===i[1])a.onVariableUpdate();else if("geometry"===i[1]){let t=a;a.component&&(t=a.component);let e=t.dataPatched;t.chooseGeoemtryCache(this).forceDelete(e.geometry),t.createGeometryDelayed(this.entityOpContext),t.onVariableUpdate(!0),t.instances.forEach((t=>{let e=t.dataPatched;t.chooseGeoemtryCache(this).forceDelete(e.geometry),t.createGeometryDelayed(this.entityOpContext),t.onVariableUpdate(!0)}))}}}return!0}deleteVariable(t){this.variables[t]&&delete this.variables[t]}getVariable(t,e){if(Array.isArray(t)){if("mouse"===t[0])return this.mouseProperty?.[t[1]]??0;if("raycast"===t[0])return this.raycastProperty?.[t[1]]??0;let e=this.entityOpContext.scene.find(t[0]);if("width"===t[1]||"height"===t[1]||"depth"===t[1])return e.geometry.userData.parameters[t[1]];for(let r=1;r<t.length;r++)e=e[t[r]];return"rotation"===t[1]&&(e*=Rt.RAD2DEG),e}for(let t in this.variables){if(void 0===e)break;let r=this.variables[t],n=r.locations?.findIndex((t=>Zm.equal(t,e)));void 0!==n&&-1!==n&&r.locations.splice(n,1)}if("string"==typeof t){let r=t,n=t;do{if(n=r,void 0===this.variables[r])break;r=this.variables[r].value}while("string"==typeof r);return e&&void 0!==this.variables[n]&&this.variables[n].locations.push(e),r}return t}getVariables(){return this.variables}getDynamicVariablePlayState(t){return this.variables[t]?.dynamicVariablePlayState}setDynamicVariablePlayState(t,e){void 0!==this.variables[t]&&(this.variables[t].dynamicVariablePlayState=e)}getDynamicVariableToggleIsForward(t){return this.variables[t]?.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(t,e){void 0!==this.variables[t]&&(this.variables[t].dynamicVariableToggleIsForward=e)}resetLib(t){for(let[e,r]of Object.entries(t.images))this.addImage(e,r.asset);for(let[e,r]of Object.entries(t.audios))this.addAudio(e,r.asset);for(let[e,r]of Object.entries(t.colors))this.addColor(e,r.asset);for(let[e,r]of Object.entries(t.fonts))this.addFont(e,r.asset);for(let[e,r]of Object.entries(t.materials))this.addMaterial(e,r.asset);for(let[e,r]of Object.entries(t.videos))this.addVideo(e,r.asset);for(let[e,r]of Object.entries(t.variables))this.addVariableHolder(e,r.asset)}updateLibByOp(t,e){"images"===t.path[0]?1===t.path.length&&1===t.type?this.addImage(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteImage(t.id):"videos"===t.path[0]?1===t.path.length&&1===t.type?this.addVideo(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteVideo(t.id):"audios"===t.path[0]?1===t.path.length&&1===t.type?this.addAudio(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteAudio(t.id):"colors"===t.path[0]?1===t.path.length&&1===t.type?this.addColor(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteColor(t.id):"materials"===t.path[0]?1===t.path.length&&1===t.type?this.addMaterial(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteMaterial(t.id):"fonts"===t.path[0]?1===t.path.length&&1===t.type?this.addFont(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteFont(t.id):"variables"===t.path[0]?1===t.path.length&&1===t.type?this.addVariableHolder(t.id,t.data.asset):1===t.path.length&&2===t.type&&this.deleteVariable(t.id):"components"===t.path[0]&&e.updateByLibOp(t,this)}updateByOp(t,e,r){this.data=e,"images"===t.path[0]?2===t.path.length&&0===t.type?t.props.data&&this.getImage(t.path[1]).updateSrc(t.props.data):1===t.path.length&&1===t.type?this.addImage(t.id,t.data):1===t.path.length&&2===t.type&&this.deleteImage(t.id):"videos"===t.path[0]?2===t.path.length&&0===t.type?t.props.data&&this.getVideo(t.path[1]).updateSrc(t.props.data):1===t.path.length&&1===t.type?this.addVideo(t.id,t.data):1===t.path.length&&2===t.type&&this.deleteVideo(t.id):"audios"===t.path[0]?2===t.path.length&&0===t.type?t.props.data&&this.addAudio(t.path[1],e.audios[t.path[1]]):1===t.path.length&&1===t.type?this.addAudio(t.id,t.data):1===t.path.length&&2===t.type&&this.deleteAudio(t.id):"colors"===t.path[0]?2===t.path.length&&0===t.type?this.updateColor(t.path[1],t.props):1===t.path.length&&1===t.type?this.addColor(t.id,t.data):1===t.path.length&&2===t.type&&this.deleteColor(t.id):"materials"===t.path[0]?1===t.path.length&&1===t.type?this.addMaterial(t.id,t.data):1===t.path.length&&2===t.type?this.deleteMaterial(t.id):t.path.length>1&&this.getMaterial(t.path[1]).updateByOp(Tm.drop(t,2),e.materials[t.path[1]],{shared:this,scene:r}):"fonts"===t.path[0]?2===t.path.length&&0===t.type?this.updateFont(t.path[1],t,r):1===t.path.length&&1===t.type?this.addFont(t.id,t.data):1===t.path.length&&2===t.type&&this.deleteFont(t.id):"variables"===t.path[0]?2===t.path.length&&0===t.type&&"value"in t.props?this.updateVariable(t.path[1],t.props.value):1===t.path.length&&4===t.type?this.addVariableHolder(t.id,t.data):1===t.path.length&&5===t.type&&this.deleteVariable(t.id):"lib"===t.path[0]&&this.updateLibByOp(Tm.drop(t,1),r)}updateFont(t,e,r){if(e.props.url){let n=this.getFont(t),i={...this.data.fonts[t],url:e.props.url};n.update(i),n.loadingPromise.then((()=>this.requestRender())),r.updateFont(t,this)}}},XE=(new $E(cb.emptyData()),class extends vw{updateByPatchedOp(t,e,r){if(super.updateByPatchedOp(t,e,r),null!==function(t,e){let r=[];if(e.length!==t.length)return null;for(var n=0;n<t.length;){if("*"===e[n])r.push(t[n]);else if(t[n]!==e[n])return null;n+=1}return r}(t.path,["materials"])&&0===t.type&&Array.isArray(this.material))for(let[e,n]of Object.entries(t.props)){let t=r.shared.material(n);this.material[Number(e)]=t}else if(rf(t.path,["material"])&&this.material instanceof CE)"material"in e&&"string"!=typeof e.material&&this.material.updateByOp(Tm.drop(t,1),e.material,r);else if(rf(t.path,["materials","*"])&&Array.isArray(this.material)){let n=t.path[1];if("materials"in e&&n<this.material.length){let i=e.materials[n];"string"!=typeof i&&this.material[n].updateByOp(Tm.drop(t,2),i,r)}}}get needsAO(){return void 0!==this.material&&(Array.isArray(this.material)?this.material[0]:this.material).hasAO}updateState(t,e){super.updateState(t,e),void 0!==t.castShadow&&(this.castShadow=t.castShadow),void 0!==t.receiveShadow&&(this.receiveShadow=t.receiveShadow);let r=this.dataPatched;if("NonParametricGeometry"!==t.geometry?.type&&"material"in t&&void 0!==t.material&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(r.flatShading,r.side,r.wireframe),e.scene.markNeedsUpdateRendererDirty()),"NonParametricGeometry"===t.geometry?.type&&("materials"in t&&void 0!==t.materials?(this.disposeMaterial(),this.material=t.materials.map((t=>e.shared.material(t).getFlavor(r.flatShading,r.side,r.wireframe))),e.scene.markNeedsUpdateRendererDirty()):"material"in t&&void 0!==t.material&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(r.flatShading,r.side,r.wireframe)],e.scene.markNeedsUpdateRendererDirty())),void 0!==t.flatShading||void 0!==t.wireframe||void 0!==t.side)if(Array.isArray(this.material))for(let t=0;t<this.material.length;t++)this.material[t]=this.material[t].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&Mc(this.material).forEach((t=>{t instanceof CE&&(t instanceof LE||t.nodeMaterialDispose())}))}dispose(){this.disposeMaterial(),super.dispose()}}),YE=new he,ZE=new ie,KE=new ie,JE=new he,QE=new Be,tM=class extends XE{constructor(t,e,r){super(t,e),this.data=e,this.isSkinnedMesh=!1,this.localGeometry=void 0,e.bindMode&&e.bindMatrix&&(this.bindMode=e.bindMode,this.bindMatrix=(new Be).fromArray(e.bindMatrix),this.bindMatrixInverse=new Be)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof qr&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(void 0!==this.localGeometry)return this.localGeometry;if(this.geometryCreateDeleyed instanceof $E){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t,this)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return Mv.is2DParametricMesh(t.type)&&0===t.depth}get is2DType(){return Mv.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return"NonParametricGeometry"===this.geometry.userData.type}updateByPatchedOp(t,e,r){super.updateByPatchedOp(t,e,r),rf(t.path,["geometry"])&&this.updateByPatchedOpGeometry(Tm.drop(t,1),e.geometry,r)}removeInteractionGeometry(){this.localGeometry?.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if("NonParametricGeometry"===r||"SubdivGeometry"===r){let r,n,i,a=t;if(void 0===this.localGeometry){let t={...this.data.geometry,...a};this.localGeometry=O_(t,e,this.data.flatShading,this)}a.scaleBaked?[r,n,i]=a.scaleBaked:({width:r,height:n,depth:i}=a);let o=this.localGeometry.userData;void 0!==o.sxPrev&&N_(this.localGeometry.attributes,r/o.sxPrev,n/o.syPrev,i/o.szPrev),o.sxPrev=r,o.syPrev=n,o.szPrev=i}else{let r={...this.data.geometry,...t};this.localGeometry?.dispose(),this.localGeometry=O_(r,e,this.data.flatShading,this)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand((()=>e.updateShape()))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,r){let n=!1;0===t.type&&0===t.path.length&&Object.keys(t.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof G_&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),n||(r.scene?.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){void 0!==t.geometry&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){Array.isArray(this.material)&&0===this.geometry.groups.length&&this.geometry.addGroup(0,Math.max(this.geometry.getIndex()?.count??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let r=this.geometry.userData.parameters;this.is2DType?t.set(0,0,.5*r.depth):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,e){this.skeleton=t,this.isSkinnedMesh=!0,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let e=new ie,r=this.geometry.attributes.skinWeight;for(let t=0,n=r.count;t<n;t++){e.fromBufferAttribute(r,t);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),r.setXYZW(t,e.x,e.y,e.z,e.w)}}boneTransform(t,e){let r=this.skeleton;if(void 0===r)return;let n=this.geometry;ZE.fromBufferAttribute(n.attributes.skinIndex,t),KE.fromBufferAttribute(n.attributes.skinWeight,t),YE.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){let n=KE.getComponent(t);if(0!==n){let i=ZE.getComponent(t);QE.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),e.addScaledVector(JE.copy(YE).applyMatrix4(QE),n)}}return e.applyMatrix4(this.bindMatrixInverse)}};function eM(t){if(Array.isArray(t.material)){for(let e of t.material)if(0===e.getLayersOfType("outline").length)return}else if(!(t.material instanceof CE)||0===t.material.getLayersOfType("outline").length)return;t instanceof tM&&t.is2DAndNoDepth?function(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,r=new Float32Array(e.length),n=new he;for(let t=0;t<e.length;t+=3)n.set(e[t],e[t+1],e[t+2]).normalize(),r[t]=n.x,r[t+1]=n.y,r[t+2]=n.z;t.geometry.setAttribute("extrudeNormal",new Fr(r,3))}(t):function(t){if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,r=t.geometry.attributes,n=r.position.array,i=r.normal.array,a=new Float32Array(n.length);for(let t=0;t<n.length;t+=3){let r=`${n[t]}_${n[t+1]}_${n[t+2]}`,a=new he(i[t],i[t+1],i[t+2]);e.has(r)?e.get(r)?.normals.push(a):e.set(r,{normals:[a],result:new he})}e.forEach(((t,e)=>{for(let e of t.normals)t.result.add(e);t.result.divideScalar(t.normals.length)}));for(let t=0;t<n.length;t+=3){let r=`${n[t]}_${n[t+1]}_${n[t+2]}`,i=e.get(r)?.result;i&&(a[t]=i.x,a[t+1]=i.y,a[t+2]=i.z)}t.geometry.setAttribute("extrudeNormal",new Fr(a,3))}(t)}function rM(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,r=new Float32Array(e.length),n=parseInt(t.uuid.replace(/\D/g,"")),i=[Rt.seededRandom(n),Rt.seededRandom(n+1e4),Rt.seededRandom(n+2e4)];for(let t=0;t<e.length;t++)r[t]=i[t%3];t.geometry.setAttribute("randomColor",new Ir(r,3))}R_.then((t=>{t}));var nM=new ue,iM=new he;var aM=class extends tM{constructor(t,e,r){super(t,e,r),this.data=e,this.hiddenMatrixOld=new Be,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return void 0!==this.localGeometry?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return void 0!==this.localGeometry?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let r=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(t){if(!0===this.skipReactionUpdate)return;let e=this.localGeometry?.uuid,{originalGeometry:r,subdividedGeometry:n,subdivPointer:i}=G_.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=i,void 0!==r&&(this.originalGeometry?.dispose(),this.originalGeometry=r),void 0!==n&&(this.subdividedGeometry?.dispose(),this.subdividedGeometry=n??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,eM(this),rM(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),void 0!==t.flatShading){let r=this.material;this.material=r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){G_.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&G_.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=G_.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=G_.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,vw.prototype.raycast.call(this,t,e),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;null===t.boundingSphere&&(t.boundingSphere=new De,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,r=t.boundingSphere.center;nM.setFromBufferAttribute(e),nM.getCenter(r),t.boundingSphere.radius=r.distanceTo(nM.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),nM.getSize(iM),this.hasNonUniformScale&&iM.divide(this.scale);let n={width:iM.x,height:iM.y,depth:iM.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(t){let e=this.originalGeometry;nM.min.set(t[0],t[2],t[4]),nM.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(nM.min.applyMatrix4(this.shearScaleInv),nM.max.applyMatrix4(this.shearScaleInv)),null===e.boundingSphere&&(e.boundingSphere=new De);let r=e.boundingSphere.center;nM.getCenter(r),e.boundingSphere.radius=r.distanceTo(nM.max)}freeSubdivPointer(){this.subdivPointer&&(G_.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,this.originalGeometry?.dispose(),this.subdividedGeometry?.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,r){super.updateByPatchedOpGeometry(t,e,r),this.localGeometry&&this.createGeometryByControls(e)}},oM={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},sM={polygon_center:0,edge:1,vertex:2},lM=(t,e)=>(r,n)=>e&&0!==r&&0!==t?t*n/100:0,cM=(t,e)=>{let r=Math.abs(e),n=-1*r;return(t- -1)*(r-n)/2+n};var hM=new he,dM=new he,pM=new he,uM=new he;function mM(t,e){let r=pM.fromArray(t),n=uM.fromArray(e);dM.copy(n).sub(r);let i=dM.length();return dM.normalize().multiplyScalar(.5*i),hM.copy(r).add(dM).toArray()}var fM=new Sr,gM=new he,vM=new he,bM=new he;var yM=t=>.5*(1-Math.cos(t*Math.PI)),xM=class{constructor(){this.perlin=new Array(4096)}noise(t,e=0,r=0){if(null==this.perlin){this.perlin=new Array(4096);for(let t=0;t<4096;t++)this.perlin[t]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),r<0&&(r=-r);let n,i,a,o,s,l=Math.floor(t),c=Math.floor(e),h=Math.floor(r),d=t-l,p=e-c,u=r-h,m=0,f=.5;for(let t=0;t<4;t++){let t=l+(c<<4)+(h<<8);n=yM(d),i=yM(p),a=this.perlin[4095&t],a+=n*(this.perlin[t+1&4095]-a),o=this.perlin[t+16&4095],o+=n*(this.perlin[t+16+1&4095]-o),a+=i*(o-a),t+=256,o=this.perlin[4095&t],o+=n*(this.perlin[t+1&4095]-o),s=this.perlin[t+16&4095],s+=n*(this.perlin[t+16+1&4095]-s),o+=i*(s-o),a+=yM(u)*(o-a),m+=a*f,f*=.5,l<<=1,d*=2,c<<=1,p*=2,h<<=1,u*=2,d>=1&&(l++,d--),p>=1&&(c++,p--),u>=1&&(h++,u--)}return m}noiseSeed(t){let e=(()=>{let t,e;return{setSeed(r){e=t=(r??4294967296*Math.random())>>>0},getSeed:()=>t,rand:()=>(e=(1664525*e+1013904223)%4294967296,e/4294967296)}})();e.setSeed(t),this.perlin=new Array(4096);for(let t=0;t<4096;t++)this.perlin[t]=e.rand()}},_M=new he,wM=new Be,SM=new Ue;var EM,MM,AM,TM,PM=class extends tM{constructor(t,e,r){super(t,e,r),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){let t=this.dataPatched;return this.font?.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign)??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){return(this.font?.ascender??1)*this.fontScale}get descender(){return(this.font?.descender??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:r}=this;if(!isNaN(t.ray.origin.x)&&0!==this.scale.x&&0!==this.scale.y&&0!==this.scale.z&&(wM.copy(r).invert(),SM.copy(t.ray).applyMatrix4(wM),SM.intersectBox(this.singleBBox,_M))){let n=_M.applyMatrix4(r),i=t.ray.origin.distanceTo(n);e.push({distance:i,point:n.clone(),object:this})}}},CM=1e-4,kM=new he,DM=new he;R_.then((t=>{MM=[(EM=t).get_face_center,EM.get_edge_midpoint,EM.get_vertex_position],AM=[EM.get_face_normal,EM.get_edge_normal,EM.get_vertex_normal],TM=[EM.face_count,EM.edge_count,EM.vertex_count]}));var LM=new Be,RM=new Be,OM=new he,IM=new he,NM=new he,zM=new he,FM=new he,UM=new he,BM=new xM,VM=class extends(Qb(dr)){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(null===this.parent)this.updateState(this.parameters,t);else for(let t of this.children)t instanceof ey&&t.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse((e=>{e instanceof ey&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)}))}onObjUpdateMatrix(){"toObject"!==this.parameters.type&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(e=void 0!==t?t:"grid"===this.parameters.type?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,"toObject"===this.parameters.type&&!this.parameters.toObject.object&&(e=0),"toObject"===this.parameters.type&&this.objectForSample){for(let t=0,e=this.children.length;t<e;++t)this.remove(this.children[0]);let t=this.children;if(t.length===e)return;if(t.length<e)for(let r=0,n=e-t.length;r<n;++r){let t=new ey(this.object);t.expand(),this.add(t)}else for(let r=0,n=t.length-e;r<n;++r)this.remove(t[r])}else{if(this.children.length===e)return;if(this.children.length<e)for(let t=0,r=e-this.children.length;t<r;++t){let t=new ey(this.object);t.expand(),this.add(t)}else for(let t=0,r=this.children.length-e;t<r;++t)this.remove(this.children[0])}}_updateRadial(t){let e,r=t.radial,n=r.start*Rt.DEG2RAD,i=n-r.end*Rt.DEG2RAD,a=new Ze(r.rotation[0],r.rotation[1],r.rotation[2]);switch(r.axis){case"z":e=new he(0,0,1);break;case"y":e=new he(0,1,0);break;default:e=new he(1,0,0)}let o=t.randomnessObject??Yg.defaultData([1,1,1]).randomnessObject,s="perlin"===o.noiseType;BM.noiseSeed(o.seed);let l=Gb((0,Nb.default)(o.seed)),c=lM(o.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(o.freqScale/10)+o.movement,u=s?BM.noise(p):l(p,p),m=h+1;d.scale.x=r.scale[0]+c(m,cM(u,o.scale[0]))||CM,d.scale.y=r.scale[1]+c(m,cM(u,o.scale[1]))||CM,d.scale.z=r.scale[2]+c(m,cM(u,o.scale[2]))||CM,d.position.setScalar(0);let f=i/t.count*h-n;switch(r.axis){case"x":d.rotation.set(0,f,0);break;case"y":d.rotation.set(0,0,f);break;case"z":d.rotation.set(f,0,0)}d.translateOnAxis(e,r.radius),d.position.x+=r.position[0]+c(m,cM(u,o.position[0])),d.position.y+=r.position[1]+c(m,cM(u,o.position[1])),d.position.z+=r.position[2]+c(m,cM(u,o.position[2]));let g=c(m,cM(u,o.rotation[0])),v=c(m,cM(u,o.rotation[1])),b=c(m,cM(u,o.rotation[2]));!0===r.alignment?(d.rotation.x+=a.x+g,d.rotation.y+=a.y+v,d.rotation.z+=a.z+b):d.rotation.set(a.x+g,a.y+v,a.z+b)}}_updateLinear(t){if("linear"!==t.type)throw new Error;let e=t.linear,r=new Ze(e.rotation[0],e.rotation[1],e.rotation[2]),n=t.randomnessObject??Yg.defaultData([1,1,1]).randomnessObject,i="perlin"===n.noiseType;BM.noiseSeed(n.seed);let a=Gb((0,Nb.default)(n.seed)),o=lM(n.strength,this.parameters.randomness);for(let[t,s]of this.children.entries()){let l=t*(n.freqScale/10)+n.movement,c=i?BM.noise(l):a(l,l),h=t+1,d=o(h,cM(c,n.rotation[0])),p=o(h,cM(c,n.rotation[1])),u=o(h,cM(c,n.rotation[2]));s.scale.x=1+(e.scale[0]-1)*t+o(h,cM(c,n.scale[0]))||CM,s.scale.y=1+(e.scale[1]-1)*t+o(h,cM(c,n.scale[1]))||CM,s.scale.z=1+(e.scale[2]-1)*t+o(h,cM(c,n.scale[2]))||CM,s.rotation.x=r.x*t+d,s.rotation.y=r.y*t+p,s.rotation.z=r.z*t+u,s.position.x=e.position[0]*t+o(h,cM(c,n.position[0])),s.position.y=e.position[1]*t+o(h,cM(c,n.position[1])),s.position.z=e.position[2]*t+o(h,cM(c,n.position[2]))}}_updateGrid(t){let e=0,r=t.grid,n=t.randomnessObject??Yg.defaultData([1,1,1]).randomnessObject,i=lM(n.strength,this.parameters.randomness),a="perlin"===n.noiseType;BM.noiseSeed(n.seed);let o=function(t=Math.random){let e=Hb(t),r=new Float64Array(e).map((t=>jb[t%12*3])),n=new Float64Array(e).map((t=>jb[t%12*3+1])),i=new Float64Array(e).map((t=>jb[t%12*3+2]));return function(t,a,o){let s,l,c,h,d,p,u,m,f,g,v=.3333333333333333*(t+a+o),b=Bb(t+v),y=Bb(a+v),x=Bb(o+v),_=(b+y+x)*Ub,w=t-(b-_),S=a-(y-_),E=o-(x-_);w>=S?S>=E?(d=1,p=0,u=0,m=1,f=1,g=0):w>=E?(d=1,p=0,u=0,m=1,f=0,g=1):(d=0,p=0,u=1,m=1,f=0,g=1):S<E?(d=0,p=0,u=1,m=0,f=1,g=1):w<E?(d=0,p=1,u=0,m=0,f=1,g=1):(d=0,p=1,u=0,m=1,f=1,g=0);let M=w-d+Ub,A=S-p+Ub,T=E-u+Ub,P=w-m+2*Ub,C=S-f+2*Ub,k=E-g+2*Ub,D=w-1+.5,L=S-1+.5,R=E-1+.5,O=255&b,I=255&y,N=255&x,z=.6-w*w-S*S-E*E;if(z<0)s=0;else{let t=O+e[I+e[N]];z*=z,s=z*z*(r[t]*w+n[t]*S+i[t]*E)}let F=.6-M*M-A*A-T*T;if(F<0)l=0;else{let t=O+d+e[I+p+e[N+u]];F*=F,l=F*F*(r[t]*M+n[t]*A+i[t]*T)}let U=.6-P*P-C*C-k*k;if(U<0)c=0;else{let t=O+m+e[I+f+e[N+g]];U*=U,c=U*U*(r[t]*P+n[t]*C+i[t]*k)}let B=.6-D*D-L*L-R*R;if(B<0)h=0;else{let t=O+1+e[I+1+e[N+1]];B*=B,h=B*B*(r[t]*D+n[t]*L+i[t]*R)}return 32*(s+l+c+h)}}((0,Nb.default)(n.seed));if(!0===r.useCenter){let t={x:r.count[0]%2==0?2:1,y:r.count[1]%2==0?2:1,z:r.count[2]%2==0?2:1},s=new he(r.size[0]*(r.count[0]-t.x)*.5,r.size[1]*(r.count[1]-t.y)*.5,r.size[2]*(r.count[2]-t.z)*.5);for(let t=0;t<r.count[0];t++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let h=[(t+1)*(n.freqScale/10)+n.movement,(l+1)*(n.freqScale/10)+n.movement,(c+1)*(n.freqScale/10)+n.movement],d=a?BM.noise(...h):o(...h),p=this.children[e++];p.scale.x=1+i(e,cM(d,n.scale[0]))||CM,p.scale.y=1+i(e,cM(d,n.scale[1]))||CM,p.scale.z=1+i(e,cM(d,n.scale[2]))||CM;let u=i(e,cM(d,n.rotation[0])),m=i(e,cM(d,n.rotation[1])),f=i(e,cM(d,n.rotation[2]));p.rotation.set(u,m,f),p.position.x=r.size[0]*t-s.x+i(e,cM(d,n.position[0])),p.position.y=r.size[1]*l-s.y+i(e,cM(d,n.position[1])),p.position.z=r.size[2]*c-s.z+i(e,cM(d,n.position[2]))}}else for(let t=0;t<r.count[0];t++)for(let s=0;s<r.count[1];s++)for(let l=0;l<r.count[2];l++){let c=[(t+1)*(n.freqScale/10)+n.movement,(s+1)*(n.freqScale/10)+n.movement,(l+1)*(n.freqScale/10)+n.movement],h=a?BM.noise(...c):o(...c),d=this.children[e++];d.scale.x=1+i(e,cM(h,n.scale[0]))||CM,d.scale.y=1+i(e,cM(h,n.scale[1]))||CM,d.scale.z=1+i(e,cM(h,n.scale[2]))||CM;let p=i(e,cM(h,n.rotation[0])),u=i(e,cM(h,n.rotation[1])),m=i(e,cM(h,n.rotation[2]));d.rotation.set(p,u,m),d.position.x=r.size[0]*t+i(e,cM(h,n.position[0])),d.position.y=-r.size[1]*s+i(e,cM(h,n.position[1])),d.position.z=-r.size[2]*l+i(e,cM(h,n.position[2]))}}_updateToObject(t){if("toObject"!==t.type)throw new Error;let{toObject:e}=t,r=new Ze(e.rotation[0],e.rotation[1],e.rotation[2]),n=t.randomnessObject??Yg.defaultData([1,1,1]).randomnessObject,i="perlin"===n.noiseType;BM.noiseSeed(n.seed);let a=Gb((0,Nb.default)(n.seed)),o=lM(n.strength,this.parameters.randomness);if(!e.object){for(let[,t]of this.children.entries())t.position.set(0,0,0),t.scale.setScalar(1),t.rotation.set(0,0,0);return void(this.objectForSample=void 0)}if(!this.objectForSample)return;if(this.objectForSample instanceof PM){if(!this.objectForSample.font?.isLoaded||void 0===this.objectForSample.geometry.attributes.position)return void(this._pendingMediaLoad=!0);this._pendingMediaLoad=!1}if(void 0===this.objectForSample.geometry&&this.objectForSample.isAncestorOf(this.object.uuid))return void console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);let s=this.getSubdivData(),l=[],c=t=>{let e=t.length;return[t.map((t=>t[0])).reduce(((t,e)=>t+e),0)/e,t.map((t=>t[1])).reduce(((t,e)=>t+e),0)/e,t.map((t=>t[2])).reduce(((t,e)=>t+e),0)/e]},h=t=>Math.round(1e6*t)/1e6;s.forEach((t=>{let e=s.filter((e=>h(t.pos[0])===h(e.pos[0])&&h(t.pos[1])===h(e.pos[1])&&h(t.pos[2])===h(e.pos[2])));e.length>1?l.push({pos:t.pos,norm:c(e.map((t=>t.norm)))}):l.push(t)}));let d=function(t){let e=[],r={};for(var n=0,i=t.length;n<i;n++){var a=JSON.stringify(t[n].pos.map((t=>Math.round(1e4*t)/1e4)));r[a]||(e.push(t[n]),r[a]=!0)}return e}(l);if(d.length>0){let t=Math.round(d.length*e.count/100);this._updateCount(t)}else{let t=this.objectForSample.geometry.getAttribute("position");if(!t||isNaN(t.count)||0===t.count)return void console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`)}this.objectForSample.updateMatrixWorld();let p=new $b(this.objectForSample).build(),u=oM[e.axis],m=this.children;p.setRandomGenerator((0,Nb.default)(this.object.uuid+e.seed));for(let[t,s]of m.entries()){let l=t*(n.freqScale/10)+n.movement,c=i?BM.noise(l):a(l,l),h=t+1,m=o(h,cM(c,n.rotation[0])),f=o(h,cM(c,n.rotation[1])),g=o(h,cM(c,n.rotation[2]));"random"===e.spreadType?p.sample(NM,zM):(d.length&&(NM.fromArray(d[t].pos),zM.fromArray(d[t].norm)),this.objectForSample instanceof aM&&NM.applyMatrix4(LM.copy(this.objectForSample.matrixWorld).invert())),NM.applyMatrix4(this.object.hiddenMatrix.clone().invert()),s.position.copy(NM),OM.fromArray(u);let v="normal"===e.align?zM:this.object.getWorldDirection(UM),b=IM.fromArray(e.position);IM.x+=IM.x+o(h,cM(c,n.position[0])),IM.y+=IM.y+o(h,cM(c,n.position[1])),IM.z+=IM.z+o(h,cM(c,n.position[2]));let y=Math.acos(v.dot(OM)),x=FM.crossVectors(OM,v).normalize(),_=RM.makeRotationAxis(x,y),w=v.clone().cross(this.object.up).normalize(),S=w.clone().cross(v).normalize(),E=(new Be).makeBasis(w,v,S),M=new he(OM.y,OM.z,OM.x).normalize(),A=M.clone().cross(OM).normalize(),T=(new Be).makeBasis(M,OM,A).invert(),P=(new Be).multiplyMatrices(E,T);s.rotation.setFromRotationMatrix(P),b.applyMatrix4(_),s.position.add(b),s.rotation.x=s.rotation.x+r.x+m,s.rotation.y=s.rotation.y+r.y+f,s.rotation.z=s.rotation.z+r.z+g,s.scale.setScalar(1),s.scale.x=s.scale.x+e.scale[0]+o(h,cM(c,n.scale[0]))||CM,s.scale.y=s.scale.y+e.scale[1]+o(h,cM(c,n.scale[1]))||CM,s.scale.z=s.scale.z+e.scale[2]+o(h,cM(c,n.scale[2]))||CM,s.scale.multiply(this.object.scale),s.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if("random"===t)return[];if(this.objectForSample instanceof aM){let e=this.objectForSample,r=sM[t],n=TM[r],i=MM[r],a=AM[r],o=[],s=n(e.subdivPointerNew);for(let t=0;t<=s-1;t++){let r=i(e.subdivPointerNew,t),n=a(e.subdivPointerNew,t);kM.fromArray(r).applyMatrix4(e.matrixWorld),DM.fromArray(n),o.push({pos:kM.toArray(),norm:DM.toArray()})}return o}return(this.objectForSample.geometry.index?function(t){let e=[];for(let r=0;r<=t.index.count;r++)if(gM.fromArray(t.index.array,3*r),fM.setFromAttributeAndIndices(t.attributes.position,gM.x,gM.y,gM.z),fM.getNormal(vM),fM.getMidpoint(bM),!(isNaN(bM.x)||isNaN(bM.y)||isNaN(bM.z))){let{a:t,b:r,c:n}=fM,i=t.toArray(),a=r.toArray(),o=n.toArray(),s=t.distanceTo(r),l=r.distanceTo(n),c=n.distanceTo(t),h=mM(i,a),d=mM(a,o),p=mM(o,i),u=[s,l,c],m=Math.max(...u),f=u.filter((t=>Math.round(t)===Math.round(m))).length>1,g=[],v=fM.getMidpoint(bM).toArray();m===s&&!f&&(g=[d,p,p],v=h),m===l&&!f&&(g=[h,p,p],v=d),m===c&&!f&&(g=[h,d,d],v=p),f&&(g=[h,d,p]),e.push({vertices:[i,a,o],faceCenters:g,midpoint:v,norm:fM.getNormal(vM).toArray()})}return e}(this.objectForSample.geometry):function(t){let e=[],{position:r}=t.attributes;for(let t=0;t<r.count;t++){fM.setFromAttributeAndIndices(r,3*t,3*t+1,3*t+2),fM.getNormal(vM),fM.getMidpoint(bM);let n=fM.a.toArray(),i=fM.b.toArray(),a=fM.c.toArray();e.push({vertices:[n,i,a],faceCenters:[mM(n,i),mM(i,a),mM(a,n)],midpoint:bM.toArray(),norm:vM.toArray()})}return e}(this.objectForSample.geometry)).map(((e,r)=>"polygon_center"===t?{pos:e.midpoint,norm:e.norm}:"vertex"===t?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:"edge"===t?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[])).flat()}updateState(t,e){if(this.parameters=ku(t),"toObject"!==this.parameters.type)(null===this.parent||this.parent!==this.object)&&(this.removeFromParent(),this.object.parent?.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(null===this.parent||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let t=e.find(this.parameters.toObject.object);this.objectForSample=t instanceof vw?t:void 0,this.matrix=new Be,this.hiddenMatrix=new Be,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,t&&t.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},jM=t=>{var e;return(e=class extends t{}).geometryHelper=new un(30,30,30),e},GM=new Ue,HM=new De,WM=new Be,qM=(t,e,r,n,i=!1)=>{let a=e,o=t.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),HM.copy(a.boundingSphere),HM.applyMatrix4(o),!1===r.ray.intersectsSphere(HM)||(WM.copy(o).invert(),GM.copy(r.ray).applyMatrix4(WM),null!==a.boundingBox&&!1===GM.intersectsBox(a.boundingBox)))return;let s,l,c,h,d,p,u=a.index,m=a.attributes.position,f=a.drawRange;if(!1===i){for(d=Math.max(0,f.start),p=Math.min(u.count,f.start+f.count);d<p;d+=3)if(l=u.getX(d),c=u.getX(d+1),h=u.getX(d+2),s=g(t,r,GM,m,l,c,h),s)return s.faceIndex=Math.floor(d/3),void n.push(s)}else{let e=a.attributes.position,i=new he,o=new he,s=new he,l=new he,c=2,h=1/((t.scale.x+t.scale.y+t.scale.z)/3),d=h*h;for(let a=Math.max(0,f.start),h=Math.min(e.count,f.start+f.count)-1;a<h;a+=c){if(i.fromBufferAttribute(e,a),o.fromBufferAttribute(e,a+1),GM.distanceSqToSegment(i,o,l,s)>d)continue;l.applyMatrix4(t.matrixWorld);let c=r.ray.origin.distanceTo(l);c<r.near||c>r.far||n.push({distance:c,point:s.clone().applyMatrix4(t.matrixWorld),object:t})}}function g(t,e,r,n,i,a,o){let s=new he,l=new he,c=new he,h=new he,d=new he;if(s.fromBufferAttribute(n,i),l.fromBufferAttribute(n,a),c.fromBufferAttribute(n,o),null===r.intersectTriangle(s,l,c,!1,h))return null;d.copy(h),d.applyMatrix4(t.matrixWorld);let p=e.ray.origin.distanceTo(d);return p<e.near||p>e.far?null:{faceIndex:1,distance:p,point:d.clone(),object:t}}},$M=new he,XM=new yn,YM=class extends zo{constructor(t){let e=new qr,r=new Po({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],a={},o=new Pr(15711266),s=new Pr(15711266),l=new Pr(2857471);function c(t,e,r){h(t,r),h(e,r)}function h(t,e){n.push(0,0,0),i.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",s),c("p","n2",s),c("p","n3",s),c("p","n4",s),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l),e.setAttribute("position",new Fr(n,3)),e.setAttribute("color",new Fr(i,3)),super(e,r),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let t=this.geometry,e=this.pointMap;XM.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=.8;ZM("n1",e,t,XM,-1,-1,r),ZM("n2",e,t,XM,1,-1,r),ZM("n3",e,t,XM,-1,1,r),ZM("n4",e,t,XM,1,1,r);let n=r;ZM("f1",e,t,XM,-1,-1,n),ZM("f2",e,t,XM,1,-1,n),ZM("f3",e,t,XM,-1,1,n),ZM("f4",e,t,XM,1,1,n);ZM("u1",e,t,XM,.35,1.1,.8),ZM("u2",e,t,XM,-.35,1.1,.8),ZM("u3",e,t,XM,0,1.55,.8),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ZM(t,e,r,n,i,a,o){$M.set(i,a,o).unproject(n);let s=e[t];if(void 0!==s){let t=r.getAttribute("position");for(let e=0,r=s.length;e<r;e++)t.setXYZ(s[e],$M.x,$M.y,$M.z)}}var KM,JM=class extends(jM(YM)){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){qM(this.object,this.geometry,t,e,!0)}};(t=>{t.is=t=>"objectHelper"in t})(KM||(KM={}));var QM,tA=(t,e)=>class extends(_y(t)){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(t,e){this.objectHelper.raycast(t,e)}showGizmos(){for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Kl&&(e.visible=!0)}}updateEntityBoxSize(t,e){this.objectHelper.visible&&this.geometryHelper instanceof un?(t.setScalar(0),e.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(t,e)}hideGizmos(){for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Kl&&(e.visible=!1)}}},eA=new he,rA=new he,nA=new ce,iA=new he,aA=new he,oA=new he,sA=class extends(tA(yn,JM)){constructor(t="",e={...jv.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Xg.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.previousProjectionMatrix=new Be,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,n=this.height;this.orthoCamera=new Wn(-.5*r,.5*r,.5*n,-.5*n,-5e4,1e4),this.perspCamera=new xn(45,r/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return"PerspectiveCamera"===this.cameraType}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){"PerspectiveCamera"===t?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&("PerspectiveCamera"===t?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){"PerspectiveCamera"===t?this.toPerspective():"OrthographicCamera"===t&&this.toOrthographic()}get near(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near}set near(t){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,r){"number"==typeof t&&(t=new he(t,e,r)),super.lookAt(t),this.getWorldPosition(eA),this.targetOffset=eA.distanceTo(t)}getTarget(t=new he){return this.getWorldDirection(rA),this.getWorldPosition(eA),rA.multiplyScalar(this.targetOffset),t.copy(eA).add(rA),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(eA),eA.distanceTo(t)}updateUp(){this.getWorldQuaternion(nA),iA.set(0,0,1).applyQuaternion(nA),aA.copy(dr.DEFAULT_UP),this.isUpVectorFlipped&&aA.negate(),aA.applyQuaternion(nA),oA.copy(dr.DEFAULT_UP).projectOnPlane(iA),this.angleOffsetFromUp=oA.angleTo(aA),this.angleOffsetFromUp*=oA.cross(aA).dot(iA)>=0?1:-1}updateTransformState(t,e){let r=super.updateTransformState(t,e);return void 0!==t.isUpVectorFlipped&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(t){let e=t.getWorldPosition(new he),r=t.getWorldDirection(new he).multiplyScalar(this.targetOffset);return{position:e.clone().add(r),target:e}}getViewToTarget(t){let e=this.getWorldDirection(new he).multiplyScalar(this.targetOffset);return{position:t.clone().sub(e),target:t}}getViewToObject(t){let e=new he;t.getWorldPosition(e);return this.getViewToTarget(e)}setViewplaneSize(t,e,r=!1){if(this.aspect=t/e,r){let r=t>e?this.aspect:1,n=t>e?1:this.aspect;this.left=-395*r,this.right=395*r,this.top=1/n*395,this.bottom=1/n*-395}else this.left=.5*-t,this.right=.5*t,this.top=.5*e,this.bottom=.5*-e;this.updateProjectionMatrix()}copyViewPlaneSize(t){this.aspect=t.aspect,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,r,n,i,a){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(t,e,r,n,i,a):this.orthoCamera.setViewOffset(t,e,r,n,i,a)}clearViewOffset(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){"PerspectiveCamera"===this._cameraType?this.toPerspective():"OrthographicCamera"===this._cameraType&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=null===t.view?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return om(e,t)}updateCameraSubtype(t,e){let r="perspective"===t?"PerspectiveCamera":"OrthographicCamera";void 0!==e.zoom&&this.setZoom(r,e.zoom),void 0!==e.near&&this.setNear(r,e.near),void 0!==e.fov&&"PerspectiveCamera"===r&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),void 0!==t.far&&(this.far=t.far),void 0!==t.orthographic&&this.updateCameraSubtype("orthographic",t.orthographic),void 0!==t.perspective&&this.updateCameraSubtype("perspective",t.perspective),void 0!==t.type&&(this.cameraType=t.type),void 0!==t.up&&this.up.fromArray(t.up),void 0!==t.targetOffset&&(this.targetOffset=t.targetOffset),void 0!==t.isUpVectorFlipped&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,r){super.updateByPatchedOp(t,e,r),1===t.path.length&&0===t.type&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},lA=new Be,cA=new Be,hA=new Be,dA=new he,pA=new he,uA=class extends XE{constructor(t,e,r){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new qr,this.onAfterRender=(t,e,r,n,i,a)=>{super.onAfterRender(t,e,r,n,i,a),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,r){super.updateByPatchedOp(t,e,r),1===t.path.length&&"geometry"===t.path[0]&&0===t.type&&void 0!==t.props.operation&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){if(-1!==this.booleanMeshSetAddress&&!t)return;for(let r=0;r<this.children.length;r++){let n=this.children[r];n instanceof uA&&!0===n.dataPatched.visible&&n.recomputeBoolean(!0===t,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let n=this.children[r];if(n instanceof vw&&!0===n.dataPatched.visible&&n.geometry.attributes.position?.count>0&&n.geometry.drawRange.count>0){if(lA.multiplyMatrices(n.hiddenMatrix,n.matrix),-1===n.booleanMeshSetAddress){if((n.geometry.index??n.geometry.getAttribute("position")).count/3<15e5&&(n.booleanMeshSetAddress=K_.getMeshSet(n.geometry,!0===t,e)),-1===n.booleanMeshSetAddress)return;K_.transformMeshSet(n.booleanMeshSetAddress,lA),n.booleanMatrixInvOld.copy(lA).invert(),n.booleanWasTransformed=!1}else n instanceof uA&&!0===n.needsTransformForDownstream?(K_.transformMeshSet(n.booleanMeshSetAddress,lA),n.needsTransformForDownstream=!1):!0===n.booleanWasTransformed&&(K_.transformMeshSet(n.booleanMeshSetAddress,cA.multiplyMatrices(lA,n.booleanMatrixInvOld)),n.booleanMatrixInvOld.copy(lA).invert(),n.booleanWasTransformed=!1);!1===K_.hasOpenEdges(n.booleanMeshSetAddress)||r===this.children.length-1&&2===this.booleanOp?(this.meshSetAddresses.push(n.booleanMeshSetAddress),n.geometry.userData.wasFilteredFromBoolean=!1):n.geometry.userData.wasFilteredFromBoolean=!0}}if(0===this.meshSetAddresses.length)return this.geometry.setAttribute("position",new Fr([],0)),void this.geometry.setDrawRange(0,0);if(!0===t)return K_.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new qr,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=K_.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(t){this.booleanMeshSetAddress=0,console.error(t)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,eM(this),rM(this)}dispose(){super.dispose(),this.geometry.dispose()}get recursiveBBox(){let t=super.recursiveBBox;return-1===this.geometry.boundingSphere?.radius&&(t.getCenter(this.geometry.boundingSphere.center),hA.copy(this.matrixWorld).invert(),this.geometry.boundingSphere.center.applyMatrix4(hA),dA.copy(t.max).applyMatrix4(hA),pA.copy(t.min).applyMatrix4(hA),this.geometry.boundingSphere.radius=dA.distanceTo(pA)/2),t}};(t=>{t.is=function(t){return Jb.is(t)&&t instanceof cl}})(QM||(QM={}));var mA=(t,e)=>class extends(tA(t,e)){updateState_Light(t,e){this.updateState_Entity(t,e),void 0!==t.color&&(this.color=e.shared.color(t.color)),void 0!==t.intensity&&(this.intensity=t.intensity),void 0!==t.depth&&(this.shadow.camera.far=t.depth,this.shadow.needsUpdate=!0),void 0!==t.shadows&&(this.castShadow=t.shadows)}},fA=t=>t instanceof vw,gA=t=>KM.is(t),vA=class extends(jM(Jl)){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(t,e){qM(this.object,vA.geometryHelper,t,e)}update(){}},bA=class extends(tA(co,vA)){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e),"buffer"in t&&1===Object.keys(t).length&&e.scene.reloadSplats()}},yA=In.lights_fragment_begin,xA=In.shadowmask_pars_fragment,_A=null,wA=class extends(jM(ql)){constructor(t,e=15,r=10066329){super(t,e,r),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){qM(this.object,wA.geometryHelper,t,e)}},SA=class extends(jM(jl)){constructor(t,e=15,r=6710886){super(t,e,r),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){qM(this.object,SA.geometryHelper,t,e)}},EA=class extends(jM(Vl)){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){qM(this.object,EA.geometryHelper,t,e)}update(){if(void 0!==this.object){let t=EA._vector,e=this.object.distance?this.object.distance:1e3,r=e*Math.tan(this.object.angle);this.cone.scale.set(r,r,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let n=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(let t=0,e=this.cone.material.length;t<e;t++)this.cone.material[t].color.set(n);else this.cone.material.color.set(n)}}},MA=EA;MA._vector=new he;var AA=class extends(mA(Sl,wA)){constructor(t,e,r){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let i=new Yl(this.shadow.camera);i.visible=!1,this.gizmos.shadowmap=i}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Yl&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let r=void 0!==t.depth&&t.depth!==this.shadow.camera.far||void 0!==t.size&&t.size/2!==this.shadow.camera.right;void 0!==t.size&&function(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}(this,t.size),void 0!==t.shadowRadius&&(this.shadow.radius=t.shadowRadius),void 0!==t.shadowResolution&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),void 0!==t.penumbraSize&&e.scene.markPenumbraSizeDirty(),r&&this.update()}},TA=new he,PA=new he,CA=new ce,kA=class extends(mA(gl,MA)){constructor(t,e,r){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=2*Rt.RAD2DEG*this.angle,n.aspect=1,n.near=100,n.far=2500;let i=new Yl(this.shadow.camera);i.visible=!1,this.gizmos.shadowmap=i,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof Yl&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),PA.setFromMatrixPosition(this.matrixWorld),CA.setFromRotationMatrix(this.matrixWorld),TA.copy(this.up).applyQuaternion(CA).negate().multiplyScalar(this.distance),this.target.position.copy(PA).add(TA),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),void 0!==t.distance&&(this.distance=t.distance),void 0!==t.decay&&(this.decay=t.decay),void 0!==t.angle&&(this.angle=t.angle),void 0!==t.penumbra&&(this.penumbra=t.penumbra),void 0!==t.shadowRadius&&(this.shadow.radius=t.shadowRadius),void 0!==t.penumbraSize&&e.scene.markPenumbraSizeDirty(),void 0!==t.shadowResolution&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},DA=class extends(_y(bo)){constructor(t,e){super(),this.data=e,this.bgColor=new Mw(1,1,1,1),this.fog=null,this.backupFog=new vo(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Pr,this.penumbraSizeArrayCache=null,this.super_Entity(t,e),this.personalCamera=new sA(Kg,{...jv.defaultData,...e.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new hl(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(t){this.bgColor=t,!0===this.fogUseBGColor&&(this.backupFog.color=t)}updateAmbientLight(t,e){void 0!==t.color&&(this.ambientLight.color=pE(t.color,e)),void 0!==t.intensity&&(this.ambientLight.intensity=t.intensity),void 0!==t.enabled&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity((t=>{if(t instanceof XE)if(Array.isArray(t.material))for(let e of t.material)e.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()}))}updateShadow(t){void 0!==t.softShadowQuality&&this.isActive&&((t="medium")=>{if(_A===t)return!1;_A=t;let e=(t=>{switch(t){case"low":return 8;case"medium":default:return 16;case"high":return 32}})(t);In.shadowmap_pars_fragment=(t=>`\n\n// PCSS implementation based on:\n// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/\n// NOTE: This number affects how big the shadow blur can\n// possibly get. Bigger number == bigger blur, but less precise results\n\nconst float  gPenumbraFilterSize = 80.0;\nconst int   gPenumbraSamples = ${t};\nconst int gShadowSamples = ${t};\nconst float gShadowSamplesRpc = 1.0f / float(gShadowSamples);\n\n#ifdef USE_SHADOWMAP\n    #if NUM_DIR_LIGHT_SHADOWS > 0\n\n        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n        struct DirectionalLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_SPOT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n        struct SpotLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_POINT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n        struct PointLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n        };\n\n        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n    #endif\n\n    /*\n    #if NUM_RECT_AREA_LIGHTS > 0\n\n        // TODO (abelnation): create uniforms for area light shadows\n\n    #endif\n    */\n\nfloat computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)\n{\n    float penumbra = 1.0;\n    float blockerDepthAvg = 0.0;\n    float blockerCount = 0.0;\n\n    #pragma unroll_loop_start\n    for(int i = 0; i < gPenumbraSamples; i ++)\n    {\n        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;\n        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );\n\n        if(depth < compare + 0.0001)\n        {\n            blockerDepthAvg += depth;\n            blockerCount++;\n        }\n    }\n    #pragma unroll_loop_end\n\n    if (blockerCount > 0.0)\n    {\n        blockerDepthAvg /= blockerCount;\n\n        // Compute penumbra\n        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);\n        penumbra *= penumbra;\n        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows\n\n        return clamp(penumbra, 0.00, 1.0);\n    }\n    return 0.0;\n}\n\nfloat vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)\n{\n    float shadow         = 0.0f;\n\n    // NOTE: When using TAA, we should use screen space interleaved gradient noise\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);\n    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);\n    if (penumbra == -1.0) {\n        return 1.0;\n    }\n\n    #pragma unroll_loop_start\n    for (int i = 0; i < gShadowSamples; i++)\n    {\n        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n        // Overall blurring offset\n        vec2 offset = vogelSample * (shadowRadius * 2.);\n\n        // Penumbra offset\n        offset += vogelSample * (penumbra * texelScalar);\n\n        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    }\n    #pragma unroll_loop_end\n\n    return shadow * gShadowSamplesRpc;\n}\n\n\n    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n    }\n\n    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n        return unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n    }\n\n    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n        float occlusion = 1.0;\n\n        vec2 distribution = texture2DDistribution( shadow, uv );\n\n        float hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n        if (hard_shadow != 1.0 ) {\n\n            float distance = compare - distribution.x ;\n            float variance = max( 0.00000, distribution.y * distribution.y );\n            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n        }\n        return occlusion;\n\n    }\n\n    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n        float shadow = 1.0;\n\n        shadowCoord.xyz /= shadowCoord.w;\n        shadowCoord.z += shadowBias;\n\n        // if ( something && something ) breaks ATI OpenGL shader compiler\n        // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n        #if defined( SHADOWMAP_TYPE_PCF )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            float dx = texelSize.x;\n            float dy = texelSize.y;\n\n            vec2 uv = shadowCoord.xy;\n            vec2 f = fract( uv * shadowMapSize + 0.5 );\n            uv -= f * texelSize;\n\n            shadow = (\n                texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n                          f.x ),\n                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n                          f.x ),\n                     f.y )\n            ) * ( 1.0 / 9.0 );\n\n        #elif defined( SHADOWMAP_TYPE_VSM )\n\n            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #else // no percentage-closer filtering:\n\n            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #endif\n\n        }\n\n        return shadow;\n\n    }\n\n    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n    // vector suitable for 2D texture mapping. This code uses the following layout for the\n    // 2D texture:\n    //\n    // xzXZ\n    //  y Y\n    //\n    // Y - Positive y direction\n    // y - Negative y direction\n    // X - Positive x direction\n    // x - Negative x direction\n    // Z - Positive z direction\n    // z - Negative z direction\n    //\n    // Source and test bed:\n    // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n    vec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n        // Number of texels to avoid at the edge of each square\n\n        vec3 absV = abs( v );\n\n        // Intersect unit cube\n\n        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n        absV *= scaleToCube;\n\n        // Apply scale to avoid seams\n\n        // two texels less per square (one texel will do for NEAREST)\n        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n        // Unwrap\n\n        // space: -1 ... 1 range for each square\n        //\n        // #X##         dim    := ( 4 , 2 )\n        //  # #         center := ( 1 , 1 )\n\n        vec2 planar = v.xy;\n\n        float almostATexel = 1.5 * texelSizeY;\n        float almostOne = 1.0 - almostATexel;\n\n        if ( absV.z >= almostOne ) {\n\n            if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n\n        } else if ( absV.x >= almostOne ) {\n\n            float signX = sign( v.x );\n            planar.x = v.z * signX + 2.0 * signX;\n\n        } else if ( absV.y >= almostOne ) {\n\n            float signY = sign( v.y );\n            planar.x = v.x + 2.0 * signY + 2.0;\n            planar.y = v.z * signY - 2.0;\n\n        }\n\n        // Transform to UV space\n\n        // scale := 0.5 / dim\n        // translate := ( center + 0.5 ) / dim\n        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n    }\n\n    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n        float shadow = 1.0;\n        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n        // for point lights, the uniform @vShadowCoord is re-purposed to hold\n        // the vector from the light to the world-space position of the fragment.\n        vec3 lightToPosition = shadowCoord.xyz;\n\n        // dp = normalized distance from light to fragment position\n        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n        compare += shadowBias;\n\n        // bd3D = base direction 3D\n        vec3 bd3D = normalize( lightToPosition );\n\n        vec2 halton = haltonSequence[frameIndex];\n        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n        float temporalAngle  = temporalOffset * PI2;\n\n        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )\n            for (int i = 0; i < gShadowSamples; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                // NOTE: Removed for now\n                // Penumbra offset\n                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * gShadowSamplesRpc;\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n            for (int i = 0; i < 16; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * (1.0 / 16.0);\n        #else // no percentage-closer filtering\n\n            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );\n\n        #endif\n\n    }\n\n#endif\n`)(e);let r=yA.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),In.lights_fragment_begin=r;let n=xA.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),In.shadowmask_pars_fragment=n,!0})(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,e){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){this.scene.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=pE(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,e){void 0!==t.aoColor&&(this.aoColor=pE(t.aoColor,e))}updateByOp(t,e,r,n){super.updateByOp(t,e,r,n);let i=e;rf(t.path,["fog"])?this.updateFog(i.fog,r.shared):rf(t.path,["ao"])?this.updateAo(i.ao,r.shared):rf(t.path,["ambient"])?this.updateAmbientLight(i.ambient,r.shared):rf(t.path,["shadow"])&&this.updateShadow(i.shadow)}updateState(t,e){this.updateState_Entity(t,e),void 0!==t.backgroundColor&&this.setBackgroundColor(pE(t.backgroundColor,e.shared)),void 0!==t.fog&&this.updateFog(t.fog,e.shared),void 0!==t.ambient&&this.updateAmbientLight(t.ambient,e.shared),void 0!==t.ao&&this.updateAo(t.ao,e.shared),void 0!==t.shadow&&this.updateShadow(t.shadow)}raycast(t,e){super.raycast(t,e)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){return this.scene?.find(this.data.publish.playCamera)??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return null===this.penumbraSizeArrayCache&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,e=0;this.traverseEntity((r=>{if(!r.visible)return!0;r instanceof AA&&r.visible&&t<3&&(this.penumbraSizeArrayCache[t]=r.data.penumbraSize,t+=1),r instanceof kA&&r.visible&&t<2&&(this.penumbraSizeArrayCache[3+e]=r.data.penumbraSize,e+=1)}))}raycastWithClones(t){let e=[],r=n=>{for(let i of n.children){let n=i.cloner;Jb.is(i)&&(i.visible||n?.object.data.visible)&&((fA(i)||gA(i)&&this.scene.enableHelpers&&i.objectHelper.visible)&&(t.intersectObject(i,!1,e),HA(i,t,e,!0)),r(i))}};return r(this),e}},LA=class extends(mA(_l,SA)){constructor(t,e,r){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let i=new he(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),a=new he(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new ue(i,a),s=new Kl(o,new Pr(16755200));s.visible=!1,this.gizmos.shadowmap=s,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof Kl){let t=this.shadow.camera,r=new he(-t.far+this.position.x,-t.far+this.position.y,-t.far+this.position.z),n=new he(t.far+this.position.x,t.far+this.position.y,t.far+this.position.z);e.box.set(r,n),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),void 0!==t.distance&&(this.distance=t.distance),void 0!==t.decay&&(this.decay=t.decay),void 0!==t.shadowRadius&&(this.shadow.radius=t.shadowRadius),void 0!==t.shadowResolution&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},RA=class extends tM{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let r=this.geometry.getAttribute("position");void 0!==r?mw(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,t,e):super.updateEntityBoxSize(t,e)}},OA=class extends tM{constructor(t,e,r){super(t,e,r),this._shapeId=null,this._context=r}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){let t,e={...this.data.geometry.extrusion.shape};for(let t in e)"string"==typeof e[t]&&(e[t]=this._context.shared.getVariable(e[t],[this.uuid,"geometry","extrusion","shape",t]));if("Custom"===e.type){let r=e.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let e=this._context.scene.find(r);e?.data&&(e.attachedPaths.add(this),t=e.geometry.userData?.shape),t||this._context.scene.addPendingCommand((()=>this.updateShape()))}}else{let r;switch(e.type){case"Rectangle":r=E_;break;case"Ellipse":r=Gx;break;case"Polygon":r=y_;break;case"Star":r=A_;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=r.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach((t=>t.update())))}detachShape(){null!==this._shapeId&&this._context.scene.find(this._shapeId)?.attachedPaths.delete(this)}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t,e){return super.updateTransformState(t,e)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let r=this.geometry.getAttribute("position");void 0!==r?mw(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,t,e):super.updateEntityBoxSize(t,e)}},IA=class extends(tA(co,vA)){constructor(t,e,r){super(),"Instance"===e.type&&"string"==typeof t&&(e=this.transformAssignData(e,r)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return"Component"===this.data.type&&"string"==typeof this.identity}get isInstanceRoot(){return"Instance"===this.data.type&&"string"==typeof this.identity}transformAssignData(t,e){let r=Db.getComponentData({scene:e.scene.data,shared:e.shared.data},t.component);if(r){let e,n;for(let i of Wv.rootOverrideProps)void 0===t[i]?(void 0===e&&(e={...t}),e[i]=r.data[i]):(void 0===n&&(n={}),n[i]=t[i],void 0===e&&(e={...t}),e[i]=Em.apply(r.data[i],t[i]));return this.overrideData=n,e}return{...Fv.defaultData,...t,...dm(Fv.defaultData,Wv.rootOverrideProps)}}updateByOp(t,e,r,n){let i;if(this.isInstanceRoot&&!n)if(e=this.transformAssignData(e,r),0===t.type&&0===t.path.length&&this.component)for(let e of Wv.rootOverrideProps)e in t.props&&void 0===t.props[e]&&(void 0===i&&(i={...t,props:{...t.props}}),i.props[e]=this.component.data[e]);else if(0===t.type&&t.path.length>0&&Wv.rootOverrideProps.includes(t.path[0])){let r=t.path[0];void 0===i&&(i={...t,path:[],props:{[r]:e[r]}})}super.updateByOp(i??t,e,r,n)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(void 0===this.component){let r=t.scene.find(e.component)??null,n=!1;if(r!==this.oldComponent){if(this.oldComponent){let e=0;for(let r of this.children){if(!Jb.is(r))break;t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),NA(r),e+=1}this.children.splice(0,e)}n=!0}if(r){let i={};FA(t,[this.uuid],e.overrides,this,r,r,0,n,i);for(let e of this.children)if(Jb.is(e)){let r=e.data;"Empty"===r.type&&r.animations&&e.traverseEntity((e=>{if(e instanceof tM&&e.isSkinnedMesh){let r=e.dataPatched;if(r.bones&&r.boneInverses){let n=r.bones.map((e=>t.scene.find(i[e]))),a=r.boneInverses.map((t=>(new Be).fromArray(t))),o=new Ao(n,a);e.bind(o,e.bindMatrix)}}else e.matrixAutoUpdate=!0}))}}this.oldComponent=this.component}}};function NA(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let e of t.children)Jb.is(e)&&NA(e)}}function zA(t,e,r,n){return t.component===e&&rm(t.identity,n)?t.overrideData===r?2:1:0}function FA(t,e,r,n,i,a,o,s,l){if(o>50)return!1;if(n.component!==i){if(n.component){let t=n.component.instances.indexOf(n);t>=0&&n.component.instances.splice(t,1)}i.instances.push(n),n.component=i}i instanceof IA&&i.isInstanceRoot&&i.expandInstanceChildren(t);let c=0;for(let h of i.children)if(Jb.is(h)){let i=[...e,..."string"==typeof h.identity?[h.identity]:h.identity],d=Hv.resolve(r,i,1);null==d||d instanceof Cm||(Object.setPrototypeOf(d,Cm.prototype),console.error("wrong prototype"));let p,u=null;if(!s){let e=n.children[c];if(u=Jb.is(e)?e:null,null!==u){let t=zA(u,h,d,i);p=t>=1?u.stateSelection:void 0,2!==t&&(u=null)}if(null===u&&(u=t.scene.findInstance(i)??null,null!==u)){let e=zA(u,h,d,i);if(p=e>=1?u.stateSelection:void 0,2!==e)u=null;else{let e=u.parent.children.indexOf(u);u.parent.children.splice(e,1),n.children.splice(c,0,u),u.parent===n?e<=c&&console.error("not possible"):(u.parent=n,u.matrixWorldNeedsUpdate=!0,u.resetBBoxNeedsUpdate(),u.updateVisible(),t.pendingDeletes.delete(u))}}}if(null===u){let e=d?Em.apply(h.data,d):h.data;$g.is(e.type)&&(e={...e,type:"Empty"}),u=hy.createEntity(i,e,t),u.overrideData=d,n.add(u),n.children.splice(n.children.length-1,1),n.children.splice(c,0,u),u.updateState(u.data,t),p&&u.changeSelectedState(p,t),t.scene.registerInstanceAndSetUuid(u)}if(u.isBone){l[u.identity[u.identity.length-1]]=u.uuid}c+=1,FA(t,e,r,u,h,a,o+1,s,l)}if(!s){let e=c;for(;;){let e=n.children[c];if(!Jb.is(e))break;t.pendingDeletes.add(e),c+=1}n.children.splice(e,c-e)}return!0}var UA=class extends(tA(wo,vA)){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(t,e){this.updateState_Entity(t,e)}};function BA(t,e,r){return"Mesh"===e.type?function(t,e,r){let n;return"TextGeometry"===e.geometry.type?new PM(t,e,r):(n="SubdivGeometry"===e.geometry.type?new aM(t,e,r):"PathGeometry"===e.geometry.type?new OA(t,e,r):"VectorGeometry"===e.geometry.type?new RA(t,e,r):"BooleanGeometry"===e.geometry.type?new uA(t,e,r):new tM(t,e,r),n)}(t,e,r):"Empty"===e.type||"Splat"===e.type?new bA(t,e):"Bone"===e.type?new UA(t,e):"Page"===e.type?new DA(t,e):"PointLight"===e.type?new LA(t,e,r):"SpotLight"===e.type?new kA(t,e,r):"DirectionalLight"===e.type?new AA(t,e,r):"Component"===e.type||"Instance"===e.type?new IA(t,e,r):$g.is(e.type)?new sA(t,e):(console.error(e),new bA(t,e))}hy.createEntity=BA,hy.changeEntityProptotype=function(t,e,r){let n=BA(t.identity,e,r),i=t.children,a=t.attachedPaths,o=t.parent,s=t.component,l=t.instances,c=t.overrideData,h=t.uuid,d=t.stateSelection;t.dispose();for(let e of Object.keys(t))delete t[e];Object.setPrototypeOf(t,Object.getPrototypeOf(n));for(let e of Object.keys(n))t[e]=n[e];t.children=[...t.children,...i],t.attachedPaths=a,t.parent=o,t.component=s,t.instances=l,t.uuid=h,t.overrideData=c,t.updateState(t.data,r),d&&t.changeSelectedState(d,r),t.resetBBoxNeedsUpdate()},hy.Cloner=VM;var VA=new class{constructor(t,e,r=0,n=1/0){this.ray=new Ue(t,e),this.near=r,this.far=n,this.camera=null,this.layers=new Ke,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,r=[]){return Ol(t,this,r,e),r.sort(Rl),r}intersectObjects(t,e=!0,r=[]){for(let n=0,i=t.length;n<i;n++)Ol(t[n],this,r,e);return r.sort(Rl),r}},jA=new Be,GA=new Ue;function HA(t,e,r,n=!1){let i=t.cloner;if(i)for(let a of i.children){let i=jA.copy(a.matrixWorld).invert(),o=GA.copy(e.ray).applyMatrix4(i),s=t.matrixWorld;o.applyMatrix4(s);let l=VA;l.set(o.origin,o.direction),l.near=e.near,l.far=e.far;let c=l.intersectObject(t,!1);c.length>0&&r.push({...c[0],object:n?a:t})}}lc(vc()),lc(wc()),lc(vc()),lc(wc()),lc(vc()),lc(wc()),lc(vc()),lc(wc());lc(vc()),lc(wc());var WA=class{};cc(WA,"DepthMapRange",65536),cc(WA,"MemoryPageSize",65536),cc(WA,"BytesPerFloat",4),cc(WA,"BytesPerInt",4);(function(){let t=new Float32Array(1),e=new Int32Array(t.buffer)})(),new Ot;(new Lr).wireframe=!0;new he;lc(Sc(),1);var qA="top",$A="bottom",XA="right",YA="left",ZA="auto",KA=[qA,$A,XA,YA],JA="start",QA="end",tT="clippingParents",eT="viewport",rT="popper",nT="reference",iT=KA.reduce((function(t,e){return t.concat([e+"-"+JA,e+"-"+QA])}),[]),aT=[].concat(KA,[ZA]).reduce((function(t,e){return t.concat([e,e+"-"+JA,e+"-"+QA])}),[]),oT="beforeRead",sT="read",lT="afterRead",cT="beforeMain",hT="main",dT="afterMain",pT="beforeWrite",uT="write",mT="afterWrite",fT=[oT,sT,lT,cT,hT,dT,pT,uT,mT];function gT(t){return t?(t.nodeName||"").toLowerCase():null}function vT(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function bT(t){return t instanceof vT(t).Element||t instanceof Element}function yT(t){return t instanceof vT(t).HTMLElement||t instanceof HTMLElement}function xT(t){return"undefined"!=typeof ShadowRoot&&(t instanceof vT(t).ShadowRoot||t instanceof ShadowRoot)}const _T={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var r=e.styles[t]||{},n=e.attributes[t]||{},i=e.elements[t];yT(i)&&gT(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(t){var e=n[t];!1===e?i.removeAttribute(t):i.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],i=e.attributes[t]||{},a=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:r[t]).reduce((function(t,e){return t[e]="",t}),{});yT(n)&&gT(n)&&(Object.assign(n.style,a),Object.keys(i).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};function wT(t){return t.split("-")[0]}var ST=Math.max,ET=Math.min,MT=Math.round;function AT(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function TT(){return!/^((?!chrome|android).)*safari/i.test(AT())}function PT(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&yT(t)&&(i=t.offsetWidth>0&&MT(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&MT(n.height)/t.offsetHeight||1);var o=(bT(t)?vT(t):window).visualViewport,s=!TT()&&r,l=(n.left+(s&&o?o.offsetLeft:0))/i,c=(n.top+(s&&o?o.offsetTop:0))/a,h=n.width/i,d=n.height/a;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function CT(t){var e=PT(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function kT(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&xT(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function DT(t){return vT(t).getComputedStyle(t)}function LT(t){return["table","td","th"].indexOf(gT(t))>=0}function RT(t){return((bT(t)?t.ownerDocument:t.document)||window.document).documentElement}function OT(t){return"html"===gT(t)?t:t.assignedSlot||t.parentNode||(xT(t)?t.host:null)||RT(t)}function IT(t){return yT(t)&&"fixed"!==DT(t).position?t.offsetParent:null}function NT(t){for(var e=vT(t),r=IT(t);r&&LT(r)&&"static"===DT(r).position;)r=IT(r);return r&&("html"===gT(r)||"body"===gT(r)&&"static"===DT(r).position)?e:r||function(t){var e=/firefox/i.test(AT());if(/Trident/i.test(AT())&&yT(t)&&"fixed"===DT(t).position)return null;var r=OT(t);for(xT(r)&&(r=r.host);yT(r)&&["html","body"].indexOf(gT(r))<0;){var n=DT(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(t)||e}function zT(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function FT(t,e,r){return ST(t,ET(e,r))}function UT(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function BT(t,e){return e.reduce((function(e,r){return e[r]=t,e}),{})}const VT={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,o=r.modifiersData.popperOffsets,s=wT(r.placement),l=zT(s),c=[YA,XA].indexOf(s)>=0?"height":"width";if(a&&o){var h=function(t,e){return UT("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:BT(t,KA))}(i.padding,r),d=CT(a),p="y"===l?qA:YA,u="y"===l?$A:XA,m=r.rects.reference[c]+r.rects.reference[l]-o[l]-r.rects.popper[c],f=o[l]-r.rects.reference[l],g=NT(a),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=m/2-f/2,y=h[p],x=v-d[c]-h[u],_=v/2-d[c]/2+b,w=FT(y,_,x),S=l;r.modifiersData[n]=((e={})[S]=w,e.centerOffset=w-_,e)}},effect:function(t){var e=t.state,r=t.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&kT(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function jT(t){return t.split("-")[1]}var GT={top:"auto",right:"auto",bottom:"auto",left:"auto"};function HT(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,o=t.offsets,s=t.position,l=t.gpuAcceleration,c=t.adaptive,h=t.roundOffsets,d=t.isFixed,p=o.x,u=void 0===p?0:p,m=o.y,f=void 0===m?0:m,g="function"==typeof h?h({x:u,y:f}):{x:u,y:f};u=g.x,f=g.y;var v=o.hasOwnProperty("x"),b=o.hasOwnProperty("y"),y=YA,x=qA,_=window;if(c){var w=NT(r),S="clientHeight",E="clientWidth";if(w===vT(r)&&"static"!==DT(w=RT(r)).position&&"absolute"===s&&(S="scrollHeight",E="scrollWidth"),i===qA||(i===YA||i===XA)&&a===QA)x=$A,f-=(d&&w===_&&_.visualViewport?_.visualViewport.height:w[S])-n.height,f*=l?1:-1;if(i===YA||(i===qA||i===$A)&&a===QA)y=XA,u-=(d&&w===_&&_.visualViewport?_.visualViewport.width:w[E])-n.width,u*=l?1:-1}var M,A=Object.assign({position:s},c&&GT),T=!0===h?function(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:MT(r*i)/i||0,y:MT(n*i)/i||0}}({x:u,y:f},vT(r)):{x:u,y:f};return u=T.x,f=T.y,l?Object.assign({},A,((M={})[x]=b?"0":"",M[y]=v?"0":"",M.transform=(_.devicePixelRatio||1)<=1?"translate("+u+"px, "+f+"px)":"translate3d("+u+"px, "+f+"px, 0)",M)):Object.assign({},A,((e={})[x]=b?f+"px":"",e[y]=v?u+"px":"",e.transform="",e))}const WT={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=void 0===n||n,a=r.adaptive,o=void 0===a||a,s=r.roundOffsets,l=void 0===s||s,c={placement:wT(e.placement),variation:jT(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,HT(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,HT(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var qT={passive:!0};const $T={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=void 0===i||i,o=n.resize,s=void 0===o||o,l=vT(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&c.forEach((function(t){t.addEventListener("scroll",r.update,qT)})),s&&l.addEventListener("resize",r.update,qT),function(){a&&c.forEach((function(t){t.removeEventListener("scroll",r.update,qT)})),s&&l.removeEventListener("resize",r.update,qT)}},data:{}};var XT={left:"right",right:"left",bottom:"top",top:"bottom"};function YT(t){return t.replace(/left|right|bottom|top/g,(function(t){return XT[t]}))}var ZT={start:"end",end:"start"};function KT(t){return t.replace(/start|end/g,(function(t){return ZT[t]}))}function JT(t){var e=vT(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function QT(t){return PT(RT(t)).left+JT(t).scrollLeft}function tP(t){var e=DT(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function eP(t){return["html","body","#document"].indexOf(gT(t))>=0?t.ownerDocument.body:yT(t)&&tP(t)?t:eP(OT(t))}function rP(t,e){var r;void 0===e&&(e=[]);var n=eP(t),i=n===(null==(r=t.ownerDocument)?void 0:r.body),a=vT(n),o=i?[a].concat(a.visualViewport||[],tP(n)?n:[]):n,s=e.concat(o);return i?s:s.concat(rP(OT(o)))}function nP(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function iP(t,e,r){return e===eT?nP(function(t,e){var r=vT(t),n=RT(t),i=r.visualViewport,a=n.clientWidth,o=n.clientHeight,s=0,l=0;if(i){a=i.width,o=i.height;var c=TT();(c||!c&&"fixed"===e)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:a,height:o,x:s+QT(t),y:l}}(t,r)):bT(e)?function(t,e){var r=PT(t,!1,"fixed"===e);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}(e,r):nP(function(t){var e,r=RT(t),n=JT(t),i=null==(e=t.ownerDocument)?void 0:e.body,a=ST(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=ST(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-n.scrollLeft+QT(t),l=-n.scrollTop;return"rtl"===DT(i||r).direction&&(s+=ST(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:o,x:s,y:l}}(RT(t)))}function aP(t,e,r,n){var i="clippingParents"===e?function(t){var e=rP(OT(t)),r=["absolute","fixed"].indexOf(DT(t).position)>=0&&yT(t)?NT(t):t;return bT(r)?e.filter((function(t){return bT(t)&&kT(t,r)&&"body"!==gT(t)})):[]}(t):[].concat(e),a=[].concat(i,[r]),o=a[0],s=a.reduce((function(e,r){var i=iP(t,r,n);return e.top=ST(i.top,e.top),e.right=ET(i.right,e.right),e.bottom=ET(i.bottom,e.bottom),e.left=ST(i.left,e.left),e}),iP(t,o,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function oP(t){var e,r=t.reference,n=t.element,i=t.placement,a=i?wT(i):null,o=i?jT(i):null,s=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(a){case qA:e={x:s,y:r.y-n.height};break;case $A:e={x:s,y:r.y+r.height};break;case XA:e={x:r.x+r.width,y:l};break;case YA:e={x:r.x-n.width,y:l};break;default:e={x:r.x,y:r.y}}var c=a?zT(a):null;if(null!=c){var h="y"===c?"height":"width";switch(o){case JA:e[c]=e[c]-(r[h]/2-n[h]/2);break;case QA:e[c]=e[c]+(r[h]/2-n[h]/2)}}return e}function sP(t,e){void 0===e&&(e={});var r=e,n=r.placement,i=void 0===n?t.placement:n,a=r.strategy,o=void 0===a?t.strategy:a,s=r.boundary,l=void 0===s?tT:s,c=r.rootBoundary,h=void 0===c?eT:c,d=r.elementContext,p=void 0===d?rT:d,u=r.altBoundary,m=void 0!==u&&u,f=r.padding,g=void 0===f?0:f,v=UT("number"!=typeof g?g:BT(g,KA)),b=p===rT?nT:rT,y=t.rects.popper,x=t.elements[m?b:p],_=aP(bT(x)?x:x.contextElement||RT(t.elements.popper),l,h,o),w=PT(t.elements.reference),S=oP({reference:w,element:y,strategy:"absolute",placement:i}),E=nP(Object.assign({},y,S)),M=p===rT?E:w,A={top:_.top-M.top+v.top,bottom:M.bottom-_.bottom+v.bottom,left:_.left-M.left+v.left,right:M.right-_.right+v.right},T=t.modifiersData.offset;if(p===rT&&T){var P=T[i];Object.keys(A).forEach((function(t){var e=[XA,$A].indexOf(t)>=0?1:-1,r=[qA,$A].indexOf(t)>=0?"y":"x";A[t]+=P[r]*e}))}return A}const lP={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0===o||o,l=r.fallbackPlacements,c=r.padding,h=r.boundary,d=r.rootBoundary,p=r.altBoundary,u=r.flipVariations,m=void 0===u||u,f=r.allowedAutoPlacements,g=e.options.placement,v=wT(g),b=l||(v===g||!m?[YT(g)]:function(t){if(wT(t)===ZA)return[];var e=YT(t);return[KT(t),e,KT(e)]}(g)),y=[g].concat(b).reduce((function(t,r){return t.concat(wT(r)===ZA?function(t,e){void 0===e&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,o=r.padding,s=r.flipVariations,l=r.allowedAutoPlacements,c=void 0===l?aT:l,h=jT(n),d=h?s?iT:iT.filter((function(t){return jT(t)===h})):KA,p=d.filter((function(t){return c.indexOf(t)>=0}));0===p.length&&(p=d);var u=p.reduce((function(e,r){return e[r]=sP(t,{placement:r,boundary:i,rootBoundary:a,padding:o})[wT(r)],e}),{});return Object.keys(u).sort((function(t,e){return u[t]-u[e]}))}(e,{placement:r,boundary:h,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:f}):r)}),[]),x=e.rects.reference,_=e.rects.popper,w=new Map,S=!0,E=y[0],M=0;M<y.length;M++){var A=y[M],T=wT(A),P=jT(A)===JA,C=[qA,$A].indexOf(T)>=0,k=C?"width":"height",D=sP(e,{placement:A,boundary:h,rootBoundary:d,altBoundary:p,padding:c}),L=C?P?XA:YA:P?$A:qA;x[k]>_[k]&&(L=YT(L));var R=YT(L),O=[];if(a&&O.push(D[T]<=0),s&&O.push(D[L]<=0,D[R]<=0),O.every((function(t){return t}))){E=A,S=!1;break}w.set(A,O)}if(S)for(var I=function(t){var e=y.find((function(e){var r=w.get(e);if(r)return r.slice(0,t).every((function(t){return t}))}));if(e)return E=e,"break"},N=m?3:1;N>0;N--){if("break"===I(N))break}e.placement!==E&&(e.modifiersData[n]._skip=!0,e.placement=E,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function cP(t,e,r){return void 0===r&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function hP(t){return[qA,XA,$A,YA].some((function(e){return t[e]>=0}))}const dP={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,o=sP(e,{elementContext:"reference"}),s=sP(e,{altBoundary:!0}),l=cP(o,n),c=cP(s,i,a),h=hP(l),d=hP(c);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}};const pP={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=void 0===i?[0,0]:i,o=aT.reduce((function(t,r){return t[r]=function(t,e,r){var n=wT(t),i=[YA,qA].indexOf(n)>=0?-1:1,a="function"==typeof r?r(Object.assign({},e,{placement:t})):r,o=a[0],s=a[1];return o=o||0,s=(s||0)*i,[YA,XA].indexOf(n)>=0?{x:s,y:o}:{x:o,y:s}}(r,e.rects,a),t}),{}),s=o[e.placement],l=s.x,c=s.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=o}};const uP={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,r=t.name;e.modifiersData[r]=oP({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}};const mP={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=void 0===i||i,o=r.altAxis,s=void 0!==o&&o,l=r.boundary,c=r.rootBoundary,h=r.altBoundary,d=r.padding,p=r.tether,u=void 0===p||p,m=r.tetherOffset,f=void 0===m?0:m,g=sP(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),v=wT(e.placement),b=jT(e.placement),y=!b,x=zT(v),_="x"===x?"y":"x",w=e.modifiersData.popperOffsets,S=e.rects.reference,E=e.rects.popper,M="function"==typeof f?f(Object.assign({},e.rects,{placement:e.placement})):f,A="number"==typeof M?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),T=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(w){if(a){var C,k="y"===x?qA:YA,D="y"===x?$A:XA,L="y"===x?"height":"width",R=w[x],O=R+g[k],I=R-g[D],N=u?-E[L]/2:0,z=b===JA?S[L]:E[L],F=b===JA?-E[L]:-S[L],U=e.elements.arrow,B=u&&U?CT(U):{width:0,height:0},V=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},j=V[k],G=V[D],H=FT(0,S[L],B[L]),W=y?S[L]/2-N-H-j-A.mainAxis:z-H-j-A.mainAxis,q=y?-S[L]/2+N+H+G+A.mainAxis:F+H+G+A.mainAxis,$=e.elements.arrow&&NT(e.elements.arrow),X=$?"y"===x?$.clientTop||0:$.clientLeft||0:0,Y=null!=(C=null==T?void 0:T[x])?C:0,Z=R+q-Y,K=FT(u?ET(O,R+W-Y-X):O,R,u?ST(I,Z):I);w[x]=K,P[x]=K-R}if(s){var J,Q="x"===x?qA:YA,tt="x"===x?$A:XA,et=w[_],rt="y"===_?"height":"width",nt=et+g[Q],it=et-g[tt],at=-1!==[qA,YA].indexOf(v),ot=null!=(J=null==T?void 0:T[_])?J:0,st=at?nt:et-S[rt]-E[rt]-ot+A.altAxis,lt=at?et+S[rt]+E[rt]-ot-A.altAxis:it,ct=u&&at?function(t,e,r){var n=FT(t,e,r);return n>r?r:n}(st,et,lt):FT(u?st:nt,et,u?lt:it);w[_]=ct,P[_]=ct-et}e.modifiersData[n]=P}},requiresIfExists:["offset"]};function fP(t,e,r){void 0===r&&(r=!1);var n,i,a=yT(e),o=yT(e)&&function(t){var e=t.getBoundingClientRect(),r=MT(e.width)/t.offsetWidth||1,n=MT(e.height)/t.offsetHeight||1;return 1!==r||1!==n}(e),s=RT(e),l=PT(t,o,r),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(a||!a&&!r)&&(("body"!==gT(e)||tP(s))&&(c=(n=e)!==vT(n)&&yT(n)?{scrollLeft:(i=n).scrollLeft,scrollTop:i.scrollTop}:JT(n)),yT(e)?((h=PT(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):s&&(h.x=QT(s))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function gP(t){var e=new Map,r=new Set,n=[];function i(t){r.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!r.has(t)){var n=e.get(t);n&&i(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){r.has(t.name)||i(t)})),n}function vP(t){var e;return function(){return e||(e=new Promise((function(r){Promise.resolve().then((function(){e=void 0,r(t())}))}))),e}}var bP={placement:"bottom",modifiers:[],strategy:"absolute"};function yP(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function xP(t){void 0===t&&(t={});var e=t,r=e.defaultModifiers,n=void 0===r?[]:r,i=e.defaultOptions,a=void 0===i?bP:i;return function(t,e,r){void 0===r&&(r=a);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},bP,a),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},o=[],s=!1,l={state:i,setOptions:function(r){var s="function"==typeof r?r(i.options):r;c(),i.options=Object.assign({},a,i.options,s),i.scrollParents={reference:bT(t)?rP(t):t.contextElement?rP(t.contextElement):[],popper:rP(e)};var h,d,p=function(t){var e=gP(t);return fT.reduce((function(t,r){return t.concat(e.filter((function(t){return t.phase===r})))}),[])}((h=[].concat(n,i.options.modifiers),d=h.reduce((function(t,e){var r=t[e.name];return t[e.name]=r?Object.assign({},r,e,{options:Object.assign({},r.options,e.options),data:Object.assign({},r.data,e.data)}):e,t}),{}),Object.keys(d).map((function(t){return d[t]}))));return i.orderedModifiers=p.filter((function(t){return t.enabled})),i.orderedModifiers.forEach((function(t){var e=t.name,r=t.options,n=void 0===r?{}:r,a=t.effect;if("function"==typeof a){var s=a({state:i,name:e,instance:l,options:n}),c=function(){};o.push(s||c)}})),l.update()},forceUpdate:function(){if(!s){var t=i.elements,e=t.reference,r=t.popper;if(yP(e,r)){i.rects={reference:fP(e,NT(r),"fixed"===i.options.strategy),popper:CT(r)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(t){return i.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<i.orderedModifiers.length;n++)if(!0!==i.reset){var a=i.orderedModifiers[n],o=a.fn,c=a.options,h=void 0===c?{}:c,d=a.name;"function"==typeof o&&(i=o({state:i,options:h,name:d,instance:l})||i)}else i.reset=!1,n=-1}}},update:vP((function(){return new Promise((function(t){l.forceUpdate(),t(i)}))})),destroy:function(){c(),s=!0}};if(!yP(t,e))return l;function c(){o.forEach((function(t){return t()})),o=[]}return l.setOptions(r).then((function(t){!s&&r.onFirstUpdate&&r.onFirstUpdate(t)})),l}}var _P=xP(),wP=xP({defaultModifiers:[$T,uP,WT,_T,pP,lP,mP,VT,dP]}),SP=xP({defaultModifiers:[$T,uP,WT,_T]});const EP=new Map,MP={set(t,e,r){EP.has(t)||EP.set(t,new Map);const n=EP.get(t);n.has(e)||0===n.size?n.set(e,r):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(t,e)=>EP.has(t)&&EP.get(t).get(e)||null,remove(t,e){if(!EP.has(t))return;const r=EP.get(t);r.delete(e),0===r.size&&EP.delete(t)}},AP="transitionend",TP=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),PP=t=>{t.dispatchEvent(new Event(AP))},CP=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),kP=t=>CP(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(TP(t)):null,DP=t=>{if(!CP(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),r=t.closest("details:not([open])");if(!r)return e;if(r!==t){const e=t.closest("summary");if(e&&e.parentNode!==r)return!1;if(null===e)return!1}return e},LP=t=>!t||t.nodeType!==Node.ELEMENT_NODE||(!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled"))),RP=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?RP(t.parentNode):null},OP=()=>{},IP=t=>{t.offsetHeight},NP=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,zP=[],FP=()=>"rtl"===document.documentElement.dir,UP=t=>{var e;e=()=>{const e=NP();if(e){const r=t.NAME,n=e.fn[r];e.fn[r]=t.jQueryInterface,e.fn[r].Constructor=t,e.fn[r].noConflict=()=>(e.fn[r]=n,t.jQueryInterface)}},"loading"===document.readyState?(zP.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of zP)t()})),zP.push(e)):e()},BP=(t,e=[],r=t)=>"function"==typeof t?t(...e):r,VP=(t,e,r=!0)=>{if(!r)return void BP(t);const n=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:r}=window.getComputedStyle(t);const n=Number.parseFloat(e),i=Number.parseFloat(r);return n||i?(e=e.split(",")[0],r=r.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(r))):0})(e)+5;let i=!1;const a=({target:r})=>{r===e&&(i=!0,e.removeEventListener(AP,a),BP(t))};e.addEventListener(AP,a),setTimeout((()=>{i||PP(e)}),n)},jP=(t,e,r,n)=>{const i=t.length;let a=t.indexOf(e);return-1===a?!r&&n?t[i-1]:t[0]:(a+=r?1:-1,n&&(a=(a+i)%i),t[Math.max(0,Math.min(a,i-1))])},GP=/[^.]*(?=\..*)\.|.*/,HP=/\..*/,WP=/::\d+$/,qP={};let $P=1;const XP={mouseenter:"mouseover",mouseleave:"mouseout"},YP=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ZP(t,e){return e&&`${e}::${$P++}`||t.uidEvent||$P++}function KP(t){const e=ZP(t);return t.uidEvent=e,qP[e]=qP[e]||{},qP[e]}function JP(t,e,r=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===r))}function QP(t,e,r){const n="string"==typeof e,i=n?r:e||r;let a=nC(t);return YP.has(a)||(a=t),[n,i,a]}function tC(t,e,r,n,i){if("string"!=typeof e||!t)return;let[a,o,s]=QP(e,r,n);if(e in XP){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};o=t(o)}const l=KP(t),c=l[s]||(l[s]={}),h=JP(c,o,a?r:null);if(h)return void(h.oneOff=h.oneOff&&i);const d=ZP(o,e.replace(GP,"")),p=a?function(t,e,r){return function n(i){const a=t.querySelectorAll(e);for(let{target:o}=i;o&&o!==this;o=o.parentNode)for(const s of a)if(s===o)return aC(i,{delegateTarget:o}),n.oneOff&&iC.off(t,i.type,e,r),r.apply(o,[i])}}(t,r,o):function(t,e){return function r(n){return aC(n,{delegateTarget:t}),r.oneOff&&iC.off(t,n.type,e),e.apply(t,[n])}}(t,o);p.delegationSelector=a?r:null,p.callable=o,p.oneOff=i,p.uidEvent=d,c[d]=p,t.addEventListener(s,p,a)}function eC(t,e,r,n,i){const a=JP(e[r],n,i);a&&(t.removeEventListener(r,a,Boolean(i)),delete e[r][a.uidEvent])}function rC(t,e,r,n){const i=e[r]||{};for(const[a,o]of Object.entries(i))a.includes(n)&&eC(t,e,r,o.callable,o.delegationSelector)}function nC(t){return t=t.replace(HP,""),XP[t]||t}const iC={on(t,e,r,n){tC(t,e,r,n,!1)},one(t,e,r,n){tC(t,e,r,n,!0)},off(t,e,r,n){if("string"!=typeof e||!t)return;const[i,a,o]=QP(e,r,n),s=o!==e,l=KP(t),c=l[o]||{},h=e.startsWith(".");if(void 0===a){if(h)for(const r of Object.keys(l))rC(t,l,r,e.slice(1));for(const[r,n]of Object.entries(c)){const i=r.replace(WP,"");s&&!e.includes(i)||eC(t,l,o,n.callable,n.delegationSelector)}}else{if(!Object.keys(c).length)return;eC(t,l,o,a,i?r:null)}},trigger(t,e,r){if("string"!=typeof e||!t)return null;const n=NP();let i=null,a=!0,o=!0,s=!1;e!==nC(e)&&n&&(i=n.Event(e,r),n(t).trigger(i),a=!i.isPropagationStopped(),o=!i.isImmediatePropagationStopped(),s=i.isDefaultPrevented());const l=aC(new Event(e,{bubbles:a,cancelable:!0}),r);return s&&l.preventDefault(),o&&t.dispatchEvent(l),l.defaultPrevented&&i&&i.preventDefault(),l}};function aC(t,e={}){for(const[r,n]of Object.entries(e))try{t[r]=n}catch(e){Object.defineProperty(t,r,{configurable:!0,get:()=>n})}return t}function oC(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function sC(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const lC={setDataAttribute(t,e,r){t.setAttribute(`data-bs-${sC(e)}`,r)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${sC(e)}`)},getDataAttributes(t){if(!t)return{};const e={},r=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const n of r){let r=n.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1,r.length),e[r]=oC(t.dataset[n])}return e},getDataAttribute:(t,e)=>oC(t.getAttribute(`data-bs-${sC(e)}`))};class cC{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const r=CP(e)?lC.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof r?r:{},...CP(e)?lC.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[n,i]of Object.entries(e)){const e=t[n],a=CP(e)?"element":null==(r=e)?`${r}`:Object.prototype.toString.call(r).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(i).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${a}" but expected type "${i}".`)}var r}}class hC extends cC{constructor(t,e){super(),(t=kP(t))&&(this._element=t,this._config=this._getConfig(e),MP.set(this._element,this.constructor.DATA_KEY,this))}dispose(){MP.remove(this._element,this.constructor.DATA_KEY),iC.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,r=!0){VP(t,e,r)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return MP.get(kP(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.2"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const dC=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let r=t.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`),e=r&&"#"!==r?TP(r.trim()):null}return e},pC={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const r=[];let n=t.parentNode.closest(e);for(;n;)r.push(n),n=n.parentNode.closest(e);return r},prev(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return[r];r=r.previousElementSibling}return[]},next(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return[r];r=r.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!LP(t)&&DP(t)))},getSelectorFromElement(t){const e=dC(t);return e&&pC.findOne(e)?e:null},getElementFromSelector(t){const e=dC(t);return e?pC.findOne(e):null},getMultipleElementsFromSelector(t){const e=dC(t);return e?pC.find(e):[]}},uC=(t,e="hide")=>{const r=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;iC.on(document,r,`[data-bs-dismiss="${n}"]`,(function(r){if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),LP(this))return;const i=pC.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(i)[e]()}))},mC=".bs.alert",fC=`close${mC}`,gC=`closed${mC}`;class vC extends hC{static get NAME(){return"alert"}close(){if(iC.trigger(this._element,fC).defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),iC.trigger(this._element,gC),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=vC.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}uC(vC,"close"),UP(vC);const bC='[data-bs-toggle="button"]';class yC extends hC{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=yC.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}iC.on(document,"click.bs.button.data-api",bC,(t=>{t.preventDefault();const e=t.target.closest(bC);yC.getOrCreateInstance(e).toggle()})),UP(yC);const xC=".bs.swipe",_C=`touchstart${xC}`,wC=`touchmove${xC}`,SC=`touchend${xC}`,EC=`pointerdown${xC}`,MC=`pointerup${xC}`,AC={endCallback:null,leftCallback:null,rightCallback:null},TC={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class PC extends cC{constructor(t,e){super(),this._element=t,t&&PC.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return AC}static get DefaultType(){return TC}static get NAME(){return"swipe"}dispose(){iC.off(this._element,xC)}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),BP(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&BP(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(iC.on(this._element,EC,(t=>this._start(t))),iC.on(this._element,MC,(t=>this._end(t))),this._element.classList.add("pointer-event")):(iC.on(this._element,_C,(t=>this._start(t))),iC.on(this._element,wC,(t=>this._move(t))),iC.on(this._element,SC,(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const CC=".bs.carousel",kC=".data-api",DC="next",LC="prev",RC="left",OC="right",IC=`slide${CC}`,NC=`slid${CC}`,zC=`keydown${CC}`,FC=`mouseenter${CC}`,UC=`mouseleave${CC}`,BC=`dragstart${CC}`,VC=`load${CC}${kC}`,jC=`click${CC}${kC}`,GC="carousel",HC="active",WC=".active",qC=".carousel-item",$C=WC+qC,XC={ArrowLeft:OC,ArrowRight:RC},YC={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},ZC={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class KC extends hC{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=pC.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===GC&&this.cycle()}static get Default(){return YC}static get DefaultType(){return ZC}static get NAME(){return"carousel"}next(){this._slide(DC)}nextWhenVisible(){!document.hidden&&DP(this._element)&&this.next()}prev(){this._slide(LC)}pause(){this._isSliding&&PP(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?iC.one(this._element,NC,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void iC.one(this._element,NC,(()=>this.to(t)));const r=this._getItemIndex(this._getActive());if(r===t)return;const n=t>r?DC:LC;this._slide(n,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&iC.on(this._element,zC,(t=>this._keydown(t))),"hover"===this._config.pause&&(iC.on(this._element,FC,(()=>this.pause())),iC.on(this._element,UC,(()=>this._maybeEnableCycle()))),this._config.touch&&PC.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of pC.find(".carousel-item img",this._element))iC.on(t,BC,(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(RC)),rightCallback:()=>this._slide(this._directionToOrder(OC)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new PC(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=XC[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=pC.findOne(WC,this._indicatorsElement);e.classList.remove(HC),e.removeAttribute("aria-current");const r=pC.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);r&&(r.classList.add(HC),r.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const r=this._getActive(),n=t===DC,i=e||jP(this._getItems(),r,n,this._config.wrap);if(i===r)return;const a=this._getItemIndex(i),o=e=>iC.trigger(this._element,e,{relatedTarget:i,direction:this._orderToDirection(t),from:this._getItemIndex(r),to:a});if(o(IC).defaultPrevented)return;if(!r||!i)return;const s=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(a),this._activeElement=i;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";i.classList.add(c),IP(i),r.classList.add(l),i.classList.add(l);this._queueCallback((()=>{i.classList.remove(l,c),i.classList.add(HC),r.classList.remove(HC,c,l),this._isSliding=!1,o(NC)}),r,this._isAnimated()),s&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return pC.findOne($C,this._element)}_getItems(){return pC.find(qC,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return FP()?t===RC?LC:DC:t===RC?DC:LC}_orderToDirection(t){return FP()?t===LC?RC:OC:t===LC?OC:RC}static jQueryInterface(t){return this.each((function(){const e=KC.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}iC.on(document,jC,"[data-bs-slide], [data-bs-slide-to]",(function(t){const e=pC.getElementFromSelector(this);if(!e||!e.classList.contains(GC))return;t.preventDefault();const r=KC.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");return n?(r.to(n),void r._maybeEnableCycle()):"next"===lC.getDataAttribute(this,"slide")?(r.next(),void r._maybeEnableCycle()):(r.prev(),void r._maybeEnableCycle())})),iC.on(window,VC,(()=>{const t=pC.find('[data-bs-ride="carousel"]');for(const e of t)KC.getOrCreateInstance(e)})),UP(KC);const JC=".bs.collapse",QC=`show${JC}`,tk=`shown${JC}`,ek=`hide${JC}`,rk=`hidden${JC}`,nk=`click${JC}.data-api`,ik="show",ak="collapse",ok="collapsing",sk=`:scope .${ak} .${ak}`,lk='[data-bs-toggle="collapse"]',ck={parent:null,toggle:!0},hk={parent:"(null|element)",toggle:"boolean"};class dk extends hC{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const r=pC.find(lk);for(const t of r){const e=pC.getSelectorFromElement(t),r=pC.find(e).filter((t=>t===this._element));null!==e&&r.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ck}static get DefaultType(){return hk}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>dk.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(iC.trigger(this._element,QC).defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(ak),this._element.classList.add(ok),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const r=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ok),this._element.classList.add(ak,ik),this._element.style[e]="",iC.trigger(this._element,tk)}),this._element,!0),this._element.style[e]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(iC.trigger(this._element,ek).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,IP(this._element),this._element.classList.add(ok),this._element.classList.remove(ak,ik);for(const t of this._triggerArray){const e=pC.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0;this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ok),this._element.classList.add(ak),iC.trigger(this._element,rk)}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(ik)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=kP(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(lk);for(const e of t){const t=pC.getElementFromSelector(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=pC.find(sk,this._config.parent);return pC.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const r of t)r.classList.toggle("collapsed",!e),r.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const r=dk.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===r[t])throw new TypeError(`No method named "${t}"`);r[t]()}}))}}iC.on(document,nk,lk,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();for(const t of pC.getMultipleElementsFromSelector(this))dk.getOrCreateInstance(t,{toggle:!1}).toggle()})),UP(dk);const pk="dropdown",uk=".bs.dropdown",mk=".data-api",fk="ArrowUp",gk="ArrowDown",vk=`hide${uk}`,bk=`hidden${uk}`,yk=`show${uk}`,xk=`shown${uk}`,_k=`click${uk}${mk}`,wk=`keydown${uk}${mk}`,Sk=`keyup${uk}${mk}`,Ek="show",Mk='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ak=`${Mk}.${Ek}`,Tk=".dropdown-menu",Pk=FP()?"top-end":"top-start",Ck=FP()?"top-start":"top-end",kk=FP()?"bottom-end":"bottom-start",Dk=FP()?"bottom-start":"bottom-end",Lk=FP()?"left-start":"right-start",Rk=FP()?"right-start":"left-start",Ok={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ik={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Nk extends hC{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=pC.next(this._element,Tk)[0]||pC.prev(this._element,Tk)[0]||pC.findOne(Tk,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ok}static get DefaultType(){return Ik}static get NAME(){return pk}toggle(){return this._isShown()?this.hide():this.show()}show(){if(LP(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!iC.trigger(this._element,yk,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))iC.on(t,"mouseover",OP);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ek),this._element.classList.add(Ek),iC.trigger(this._element,xk,t)}}hide(){if(LP(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!iC.trigger(this._element,vk,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))iC.off(t,"mouseover",OP);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ek),this._element.classList.remove(Ek),this._element.setAttribute("aria-expanded","false"),lC.removeDataAttribute(this._menu,"popper"),iC.trigger(this._element,bk,t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!CP(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${pk.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===t)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;"parent"===this._config.reference?e=this._parent:CP(this._config.reference)?e=kP(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const r=this._getPopperConfig();this._popper=wP(e,this._menu,r)}_isShown(){return this._menu.classList.contains(Ek)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return Lk;if(t.classList.contains("dropstart"))return Rk;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?Ck:Pk:e?Dk:kk}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(lC.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...BP(this._config.popperConfig,[t])}}_selectMenuItem({key:t,target:e}){const r=pC.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>DP(t)));r.length&&jP(r,e,t===gk,!r.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=Nk.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=pC.find(Ak);for(const r of e){const e=Nk.getInstance(r);if(!e||!1===e._config.autoClose)continue;const n=t.composedPath(),i=n.includes(e._menu);if(n.includes(e._element)||"inside"===e._config.autoClose&&!i||"outside"===e._config.autoClose&&i)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const a={relatedTarget:e._element};"click"===t.type&&(a.clickEvent=t),e._completeHide(a)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),r="Escape"===t.key,n=[fk,gk].includes(t.key);if(!n&&!r)return;if(e&&!r)return;t.preventDefault();const i=this.matches(Mk)?this:pC.prev(this,Mk)[0]||pC.next(this,Mk)[0]||pC.findOne(Mk,t.delegateTarget.parentNode),a=Nk.getOrCreateInstance(i);if(n)return t.stopPropagation(),a.show(),void a._selectMenuItem(t);a._isShown()&&(t.stopPropagation(),a.hide(),i.focus())}}iC.on(document,wk,Mk,Nk.dataApiKeydownHandler),iC.on(document,wk,Tk,Nk.dataApiKeydownHandler),iC.on(document,_k,Nk.clearMenus),iC.on(document,Sk,Nk.clearMenus),iC.on(document,_k,Mk,(function(t){t.preventDefault(),Nk.getOrCreateInstance(this).toggle()})),UP(Nk);const zk="backdrop",Fk="show",Uk=`mousedown.bs.${zk}`,Bk={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Vk={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class jk extends cC{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return Bk}static get DefaultType(){return Vk}static get NAME(){return zk}show(t){if(!this._config.isVisible)return void BP(t);this._append();const e=this._getElement();this._config.isAnimated&&IP(e),e.classList.add(Fk),this._emulateAnimation((()=>{BP(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(Fk),this._emulateAnimation((()=>{this.dispose(),BP(t)}))):BP(t)}dispose(){this._isAppended&&(iC.off(this._element,Uk),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=kP(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),iC.on(t,Uk,(()=>{BP(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){VP(t,this._getElement(),this._config.isAnimated)}}const Gk=".bs.focustrap",Hk=`focusin${Gk}`,Wk=`keydown.tab${Gk}`,qk="backward",$k={autofocus:!0,trapElement:null},Xk={autofocus:"boolean",trapElement:"element"};class Yk extends cC{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return $k}static get DefaultType(){return Xk}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),iC.off(document,Gk),iC.on(document,Hk,(t=>this._handleFocusin(t))),iC.on(document,Wk,(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,iC.off(document,Gk))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const r=pC.focusableChildren(e);0===r.length?e.focus():this._lastTabNavDirection===qk?r[r.length-1].focus():r[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?qk:"forward")}}const Zk=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Kk=".sticky-top",Jk="padding-right",Qk="margin-right";class tD{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Jk,(e=>e+t)),this._setElementAttributes(Zk,Jk,(e=>e+t)),this._setElementAttributes(Kk,Qk,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Jk),this._resetElementAttributes(Zk,Jk),this._resetElementAttributes(Kk,Qk)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,r){const n=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+n)return;this._saveInitialAttribute(t,e);const i=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${r(Number.parseFloat(i))}px`)}))}_saveInitialAttribute(t,e){const r=t.style.getPropertyValue(e);r&&lC.setDataAttribute(t,e,r)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const r=lC.getDataAttribute(t,e);null!==r?(lC.removeDataAttribute(t,e),t.style.setProperty(e,r)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(CP(t))e(t);else for(const r of pC.find(t,this._element))e(r)}}const eD=".bs.modal",rD=`hide${eD}`,nD=`hidePrevented${eD}`,iD=`hidden${eD}`,aD=`show${eD}`,oD=`shown${eD}`,sD=`resize${eD}`,lD=`click.dismiss${eD}`,cD=`mousedown.dismiss${eD}`,hD=`keydown.dismiss${eD}`,dD=`click${eD}.data-api`,pD="modal-open",uD="show",mD="modal-static",fD={backdrop:!0,focus:!0,keyboard:!0},gD={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vD extends hC{constructor(t,e){super(t,e),this._dialog=pC.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new tD,this._addEventListeners()}static get Default(){return fD}static get DefaultType(){return gD}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||this._isTransitioning)return;iC.trigger(this._element,aD,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(pD),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){if(!this._isShown||this._isTransitioning)return;iC.trigger(this._element,rD).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(uD),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated()))}dispose(){iC.off(window,eD),iC.off(this._dialog,eD),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new jk({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Yk({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=pC.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),IP(this._element),this._element.classList.add(uD);this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,iC.trigger(this._element,oD,{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){iC.on(this._element,hD,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),iC.on(window,sD,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),iC.on(this._element,cD,(t=>{iC.one(this._element,lD,(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(pD),this._resetAdjustments(),this._scrollBar.reset(),iC.trigger(this._element,iD)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(iC.trigger(this._element,nD).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(mD)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(mD),this._queueCallback((()=>{this._element.classList.remove(mD),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),r=e>0;if(r&&!t){const t=FP()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!r&&t){const t=FP()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const r=vD.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===r[t])throw new TypeError(`No method named "${t}"`);r[t](e)}}))}}iC.on(document,dD,'[data-bs-toggle="modal"]',(function(t){const e=pC.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),iC.one(e,aD,(t=>{t.defaultPrevented||iC.one(e,iD,(()=>{DP(this)&&this.focus()}))}));const r=pC.findOne(".modal.show");r&&vD.getInstance(r).hide();vD.getOrCreateInstance(e).toggle(this)})),uC(vD),UP(vD);const bD=".bs.offcanvas",yD=".data-api",xD=`load${bD}${yD}`,_D="show",wD="showing",SD="hiding",ED=".offcanvas.show",MD=`show${bD}`,AD=`shown${bD}`,TD=`hide${bD}`,PD=`hidePrevented${bD}`,CD=`hidden${bD}`,kD=`resize${bD}`,DD=`click${bD}${yD}`,LD=`keydown.dismiss${bD}`,RD={backdrop:!0,keyboard:!0,scroll:!1},OD={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ID extends hC{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return RD}static get DefaultType(){return OD}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown)return;if(iC.trigger(this._element,MD,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||(new tD).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(wD);this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(_D),this._element.classList.remove(wD),iC.trigger(this._element,AD,{relatedTarget:t})}),this._element,!0)}hide(){if(!this._isShown)return;if(iC.trigger(this._element,TD).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(SD),this._backdrop.hide();this._queueCallback((()=>{this._element.classList.remove(_D,SD),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new tD).reset(),iC.trigger(this._element,CD)}),this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new jk({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():iC.trigger(this._element,PD)}:null})}_initializeFocusTrap(){return new Yk({trapElement:this._element})}_addEventListeners(){iC.on(this._element,LD,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():iC.trigger(this._element,PD))}))}static jQueryInterface(t){return this.each((function(){const e=ID.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}iC.on(document,DD,'[data-bs-toggle="offcanvas"]',(function(t){const e=pC.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),LP(this))return;iC.one(e,CD,(()=>{DP(this)&&this.focus()}));const r=pC.findOne(ED);r&&r!==e&&ID.getInstance(r).hide();ID.getOrCreateInstance(e).toggle(this)})),iC.on(window,xD,(()=>{for(const t of pC.find(ED))ID.getOrCreateInstance(t).show()})),iC.on(window,kD,(()=>{for(const t of pC.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&ID.getOrCreateInstance(t).hide()})),uC(ID),UP(ID);const ND={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},zD=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),FD=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,UD=(t,e)=>{const r=t.nodeName.toLowerCase();return e.includes(r)?!zD.has(r)||Boolean(FD.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(r)))};const BD={allowList:ND,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},VD={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},jD={entry:"(string|element|function|null)",selector:"(string|element)"};class GD extends cC{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return BD}static get DefaultType(){return VD}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,r]of Object.entries(this._config.content))this._setContent(t,r,e);const e=t.children[0],r=this._resolvePossibleFunction(this._config.extraClass);return r&&e.classList.add(...r.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,r]of Object.entries(t))super._typeCheckConfig({selector:e,entry:r},jD)}_setContent(t,e,r){const n=pC.findOne(r,t);n&&((e=this._resolvePossibleFunction(e))?CP(e)?this._putElementInTemplate(kP(e),n):this._config.html?n.innerHTML=this._maybeSanitize(e):n.textContent=e:n.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,r){if(!t.length)return t;if(r&&"function"==typeof r)return r(t);const n=(new window.DOMParser).parseFromString(t,"text/html"),i=[].concat(...n.body.querySelectorAll("*"));for(const t of i){const r=t.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){t.remove();continue}const n=[].concat(...t.attributes),i=[].concat(e["*"]||[],e[r]||[]);for(const e of n)UD(e,i)||t.removeAttribute(e.nodeName)}return n.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return BP(t,[this])}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const HD=new Set(["sanitize","allowList","sanitizeFn"]),WD="fade",qD="show",$D=".modal",XD="hide.bs.modal",YD="hover",ZD="focus",KD={AUTO:"auto",TOP:"top",RIGHT:FP()?"left":"right",BOTTOM:"bottom",LEFT:FP()?"right":"left"},JD={allowList:ND,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},QD={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class tL extends hC{constructor(e,r){if(void 0===t)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,r),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return JD}static get DefaultType(){return QD}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),iC.off(this._element.closest($D),XD,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=iC.trigger(this._element,this.constructor.eventName("show")),e=(RP(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(r),iC.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(r),r.classList.add(qD),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))iC.on(t,"mouseover",OP);this._queueCallback((()=>{iC.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(!this._isShown())return;if(iC.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented)return;if(this._getTipElement().classList.remove(qD),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))iC.off(t,"mouseover",OP);this._activeTrigger.click=!1,this._activeTrigger[ZD]=!1,this._activeTrigger[YD]=!1,this._isHovered=null;this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),iC.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(WD,qD),e.classList.add(`bs-${this.constructor.NAME}-auto`);const r=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",r),this._isAnimated()&&e.classList.add(WD),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new GD({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(WD)}_isShown(){return this.tip&&this.tip.classList.contains(qD)}_createPopper(t){const e=BP(this._config.placement,[this,t,this._element]),r=KD[e.toUpperCase()];return wP(this._element,t,this._getPopperConfig(r))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return BP(t,[this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,...BP(this._config.popperConfig,[e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)iC.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===YD?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),r=e===YD?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");iC.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?ZD:YD]=!0,e._enter()})),iC.on(this._element,r,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?ZD:YD]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},iC.on(this._element.closest($D),XD,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=lC.getDataAttributes(this._element);for(const t of Object.keys(e))HD.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:kP(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,r]of Object.entries(this._config))this.constructor.Default[e]!==r&&(t[e]=r);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=tL.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}UP(tL);const eL={...tL.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},rL={...tL.DefaultType,content:"(null|string|element|function)"};class nL extends tL{static get Default(){return eL}static get DefaultType(){return rL}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=nL.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}UP(nL);const iL=".bs.scrollspy",aL=`activate${iL}`,oL=`click${iL}`,sL=`load${iL}.data-api`,lL="active",cL="[href]",hL=".nav-link",dL=`${hL}, .nav-item > ${hL}, .list-group-item`,pL={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},uL={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class mL extends hC{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return pL}static get DefaultType(){return uL}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=kP(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(iC.off(this._config.target,oL),iC.on(this._config.target,oL,cL,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const r=this._rootElement||window,n=e.offsetTop-this._element.offsetTop;if(r.scrollTo)return void r.scrollTo({top:n,behavior:"smooth"});r.scrollTop=n}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),r=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},n=(this._rootElement||document.documentElement).scrollTop,i=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const a of t){if(!a.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(a));continue}const t=a.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(i&&t){if(r(a),!n)return}else i||t||r(a)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=pC.find(cL,this._config.target);for(const e of t){if(!e.hash||LP(e))continue;const t=pC.findOne(decodeURI(e.hash),this._element);DP(t)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(lL),this._activateParents(t),iC.trigger(this._element,aL,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))pC.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(lL);else for(const e of pC.parents(t,".nav, .list-group"))for(const t of pC.prev(e,dL))t.classList.add(lL)}_clearActiveClass(t){t.classList.remove(lL);const e=pC.find(`${cL}.${lL}`,t);for(const t of e)t.classList.remove(lL)}static jQueryInterface(t){return this.each((function(){const e=mL.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}iC.on(window,sL,(()=>{for(const t of pC.find('[data-bs-spy="scroll"]'))mL.getOrCreateInstance(t)})),UP(mL);const fL=".bs.tab",gL=`hide${fL}`,vL=`hidden${fL}`,bL=`show${fL}`,yL=`shown${fL}`,xL=`click${fL}`,_L=`keydown${fL}`,wL=`load${fL}`,SL="ArrowLeft",EL="ArrowRight",ML="ArrowUp",AL="ArrowDown",TL="Home",PL="End",CL="active",kL="fade",DL="show",LL=".dropdown-toggle",RL=`:not(${LL})`,OL='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',IL=`${`.nav-link${RL}, .list-group-item${RL}, [role="tab"]${RL}`}, ${OL}`,NL=`.${CL}[data-bs-toggle="tab"], .${CL}[data-bs-toggle="pill"], .${CL}[data-bs-toggle="list"]`;class zL extends hC{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),iC.on(this._element,_L,(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),r=e?iC.trigger(e,gL,{relatedTarget:t}):null;iC.trigger(t,bL,{relatedTarget:e}).defaultPrevented||r&&r.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(CL),this._activate(pC.getElementFromSelector(t));this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),iC.trigger(t,yL,{relatedTarget:e})):t.classList.add(DL)}),t,t.classList.contains(kL))}_deactivate(t,e){if(!t)return;t.classList.remove(CL),t.blur(),this._deactivate(pC.getElementFromSelector(t));this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),iC.trigger(t,vL,{relatedTarget:e})):t.classList.remove(DL)}),t,t.classList.contains(kL))}_keydown(t){if(![SL,EL,ML,AL,TL,PL].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter((t=>!LP(t)));let r;if([TL,PL].includes(t.key))r=e[t.key===TL?0:e.length-1];else{const n=[EL,AL].includes(t.key);r=jP(e,t.target,n,!0)}r&&(r.focus({preventScroll:!0}),zL.getOrCreateInstance(r).show())}_getChildren(){return pC.find(IL,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),r=this._getOuterElement(t);t.setAttribute("aria-selected",e),r!==t&&this._setAttributeIfNotExists(r,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=pC.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const r=this._getOuterElement(t);if(!r.classList.contains("dropdown"))return;const n=(t,n)=>{const i=pC.findOne(t,r);i&&i.classList.toggle(n,e)};n(LL,CL),n(".dropdown-menu",DL),r.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,r){t.hasAttribute(e)||t.setAttribute(e,r)}_elemIsActive(t){return t.classList.contains(CL)}_getInnerElement(t){return t.matches(IL)?t:pC.findOne(IL,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=zL.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}iC.on(document,xL,OL,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),LP(this)||zL.getOrCreateInstance(this).show()})),iC.on(window,wL,(()=>{for(const t of pC.find(NL))zL.getOrCreateInstance(t)})),UP(zL);const FL=".bs.toast",UL=`mouseover${FL}`,BL=`mouseout${FL}`,VL=`focusin${FL}`,jL=`focusout${FL}`,GL=`hide${FL}`,HL=`hidden${FL}`,WL=`show${FL}`,qL=`shown${FL}`,$L="hide",XL="show",YL="showing",ZL={animation:"boolean",autohide:"boolean",delay:"number"},KL={animation:!0,autohide:!0,delay:5e3};class JL extends hC{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return KL}static get DefaultType(){return ZL}static get NAME(){return"toast"}show(){if(iC.trigger(this._element,WL).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");this._element.classList.remove($L),IP(this._element),this._element.classList.add(XL,YL),this._queueCallback((()=>{this._element.classList.remove(YL),iC.trigger(this._element,qL),this._maybeScheduleHide()}),this._element,this._config.animation)}hide(){if(!this.isShown())return;if(iC.trigger(this._element,GL).defaultPrevented)return;this._element.classList.add(YL),this._queueCallback((()=>{this._element.classList.add($L),this._element.classList.remove(YL,XL),iC.trigger(this._element,HL)}),this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(XL),super.dispose()}isShown(){return this._element.classList.contains(XL)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const r=t.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){iC.on(this._element,UL,(t=>this._onInteraction(t,!0))),iC.on(this._element,BL,(t=>this._onInteraction(t,!1))),iC.on(this._element,VL,(t=>this._onInteraction(t,!0))),iC.on(this._element,jL,(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=JL.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}uC(JL),UP(JL);const QL=__webpack_require__.p+"b28d24e5590d4d4f0482.jpg";var tR="email",eR=t=>{var e=JSON.stringify(t);localStorage.setItem(tR,e),t};const rR=()=>{var t=document.querySelector("#navbarWrapper"),e='\n\n  <div id="headerLogo" >\n  <nav class="navbar navbar-expand-lg style="background-color: #e3f2fd;"">\n  <div class="container-fluid">\n  \n  <img src="'.concat(QL,'" alt="Logo" width="170" height="85" class="d-inline-block align-text-top " id="imgHeader">\n\n    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">\n      <span class="navbar-toggler-icon"></span>\n    </button>\n    \n    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">\n      <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">\n        <button id="connexion" href="#" data-uri="/connexion"> Se connecter</button> \n        <button id="inscription" href="#" data-uri="/inscription">S\'inscrire</button>\n      </div>\n      </div>\n    </div>\n  </div>\n</nav>\n  \n    </div>\n\n  <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #343A40;">\n        <div class="container-fluid">\n          <div class="navbar-nav" >\n            <a class="nav-item nav-link mx-3" aria-current="page" href="#" data-uri="/">Accueil</a>\n            <a class="nav-item nav-link mx-3" href="#" data-uri="/menu">Menu</a>\n            <a class="nav-item nav-link mx-3" href="#" ></a>\n            <a class="nav-item nav-link mx-3" href="#"></a>\n          </div>\n        </div>\n    </nav>\n  '),r='\n\n  <div id="headerLogo" >\n  <nav class="navbar navbar-expand-lg style="background-color: #e3f2fd;"">\n  <div class="container-fluid">\n  \n  <img src="'.concat(QL,'" alt="Logo" width="170" height="85" class="d-inline-block align-text-top " id="imgHeader">\n\n    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">\n      <span class="navbar-toggler-icon"></span>\n    </button>\n    \n    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">\n      <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">\n        <button id="connexion" href="#" data-uri="/logout"> Se deconnecter</button> \n      \n      </div>\n      </div>\n    </div>\n  </div>\n</nav>\n  \n    </div>\n\n  <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #343A40;">\n        <div class="container-fluid">\n          \n        <div class="navbar-nav ">\n        <a class="nav-item nav-link mx-3" aria-current="page" href="#" data-uri="/">Accueil</a>\n        <a class="nav-item nav-link mx-3" href="#" data-uri="/menu">Menu</a>\n        <a class="nav-item nav-link mx-3" href="#" data-uri="/profil" > Mon profil</a>\n        <a class="nav-item nav-link mx-3" href="#"> </a>\n      </div>\n        </div>\n      </nav>\n  ');t.innerHTML=localStorage.getItem(tR)?r:e};var nR=t=>{var e="/";return e.length>1?("/"===e.at(-1)&&(e=e.slice(0,-1)),e+t):t},iR=t=>{var e="/";return e.length>1?("/"===e.at(-1)&&(e=e.slice(0,-1)),t.replace(e,"")):t};const aR=__webpack_require__.p+"978fac6a0df7b8a22a3c.png",oR=__webpack_require__.p+"0230914d246d816b9b05.png",sR=(__webpack_require__.p,__webpack_require__.p,__webpack_require__.p+"8f03a56a0d2a45b61180.jpg"),lR=__webpack_require__.p+"2d472cbacc5a14f58c8d.png";const cR=()=>{var t=document.querySelector("main"),e='\n  <div id="bloc1">\n    <img id="" src="'.concat(aR,'" alt="" style="width:100%; height:auto"></a>\n  </div>\n  \n\n  <div class="canva">\n  \n  </div>\n   '),r='\n  <div id="bloc2">\n  <div class="slider">\n    <div class="title">\n    <h2 >NOTRE MENU</h2>\n        \n    </div>\n    <div class="images">\n        <div class="item active" >\n            <img class="itemImg" src="'.concat(oR,'">\n        </div>\n\n    </div>\n    <div class="content">\n        <div class="item active">\n            <h1>DES MAKIS</h1>\n           \n            <button>VOIR PLUS</button>\n        </div>\n        <div class="item">\n            <h1>DES CALIFORNIAS ROLLS</h1>\n         \n            <button>See more</button>\n        </div>\n        <div class="item">\n            <h1>DES SAUMONS ROLLS</h1>\n           \n            <button>VOIR PLUS</button>\n        </div>\n        <div class="item">\n            <h1>PRODUCT NAME 4</h1>\n          \n            <button>See more</button>\n        </div>\n        <div class="item">\n            <h1>PRODUCT NAME 5</h1>\n           \n            <button>See more</button>\n        </div>\n        <div class="item">\n            <h1>PRODUCT NAME 6</h1>\n           \n            <button>See more</button>\n        </div>\n    </div>\n  <button id="prev"><</button>\n  <button id="next">></button>\n</div>\n\n  </div>\n  \n \n  '),n='\n  <div id="bloc3">\n    <div class="title3">\n    <h2>VOTRE BOX</h2>\n    </div>\n\n    <div id="cardBox">\n      <div class="card mb-3" style="max-width: 1200px; ">\n        <div class="row g-0">\n          <div class="col-md-4">\n            <img src="'.concat(sR,'" class="img-fluid rounded-start" alt="...">\n          </div>\n          <div class="col-md-8">\n            <div class="card-body">\n              <p id="cardBoxContent">Vous souhaitez personnaliser votre box en choisissant vos propres sushis ? \n              Cest possible chez nous. Composez votre dlicieux repas </p>\n              \n            </div>\n            <button id="buttonBox" href="#" data-uri="/creationBox" >Je cre ma box</button>\n          </div>\n       </div>\n    </div>\n  </div>\n  '),i='\n  <div id="bloc4">\n  <div class="title4">\n  <h2 class="hr-lines"> PROPOS DE NOUS</h2>\n  </div>\n  \n<div class="bg-grey py-5">\n<div class="container py-5">\n  <div class="row align-items-center mb-5">\n    <div class="col-lg-6 order-2 order-lg-1"><i class="fa fa-bar-chart fa-2x mb-3 text-primary"></i>\n      <h2 class="font-weight-light">Vous tes entre de bonnes mains.</h2>\n      <p class="font-italic text-muted ">Notre professionalisme et notre exprience acquis \n      fait de nous une entreprise hors du commun. \n      Notre objectif est d\'aider le client en lui offrant \n      des services de qualits tout en gardant notre touche d\'originalit.</p>\n      <a href="#" class="btn btn-dark px-5 rounded-pill shadow-sm">Dcouvrez les boxs confectionns par notre quipe</a>\n    </div>\n    <div class="col-lg-6 px-5 mx-auto order-1 order-lg-2"><img src="'.concat(lR,'" alt="" class="img-fluid mb-lg-0" style=" border-radius: 40px 0px 40px 0px;"></div>\n  </div>\n</div>\n</div>\n\n        \n    </div>\n  </div>\n  ');t.innerHTML=e+r+n;document.getElementById("next");t.innerHTML=e+r+n+i};const hR=()=>{document.querySelector("main").innerHTML='\n    <div class="menu">\n      <div class="filter">\n        <div class="filter-card">\n          <a href=# >MAKI</a>\n        </div>  \n\n        <div class="filter-card">\n         <a href=# >CALIFORNIA ROLL</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >SAUMON ROLL</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >CRUSTY</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >NIGIRI</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >NOS BOXES</a>\n        </div> \n       \n      </div>\n\n    </div>\n    '},dR=__webpack_require__.p+"b594126119c97eb202a5.png";const pR=()=>{var t=document.querySelector("main"),e='\n    <div class="menu">\n      <div class="filter">\n        <div class="filter-card">\n          <a href=# >MAKI</a>\n        </div>  \n\n        <div class="filter-card">\n         <a href=# >CALIFORNIA ROLL</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >SAUMON ROLL</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >CRUSTY</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >NIGIRI</a>\n        </div> \n\n        <div class="filter-card">\n          <a href=# >NOS BOXES</a>\n        </div> \n       \n      </div>\n\n    </div>\n\n    <div id="cardBox2">\n      <div class="card mb-3" style="max-width: 1200px; ">\n        <div class="row g-0">\n          <div class="col-md-3">\n            <img src="'.concat(dR,'" class="img-fluid rounded-start" alt="...">\n          </div>\n          <div class="col-md-6">\n            <div class="card-body">\n              <p id="cardBoxContent">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam </p>\n              \n            </div>\n            <button id="buttonBox2" href="#" data-uri="/creationBox" >Ajouter au panier</button>\n            <button id="buttonBox3" href="#" data-uri="/creationBox" >Annuler</button>\n          </div>\n       </div>\n    </div>\n    ');t.innerHTML=e},uR=__webpack_require__.p+"c088bea472513f19656c.png";const mR=()=>{var t=document.querySelector("main"),e=' \n    \n    <div class="profil">\n        <div class="row m-l-0 m-r-0">\n            <div class="col-sm-4 bg-c-lite-green user-profile ">\n                <div class="profilAvatar">\n                  <div class="card-block text-center">\n                      <div class="m-b-25">\n                          <img src="'.concat(uR,'" class="img-radius" alt="User-Profile-Image">\n                      </div>\n\n                      <div class="infos">\n                          <p class="">Prnom</p>\n                          <h6 class="text-muted f-w-400">Email: rntng@gmail.com</h6>   \n                      </div>\n                      <button id="logOut" href="#" data-uri="/connexion">Se connecter</button>\n                  </div> \n                </div>\n            </div>\n            \n            <div class="col-sm-4">\n                <div class="lastCommandes">\n                    <h6 class="">ANCIENNES COMMANDES</h6>\n                </div>\n            </div>\n        </div>\n\n        \n\n      \n        \n    </div>\n\n    ');t.innerHTML=e},fR=__webpack_require__.p+"795334a38adb6fb17dab.png",gR=__webpack_require__.p+"2a4da798b9ba1fd09e9d.png",vR=__webpack_require__.p+"5007d8b087ad389dfd30.png";const bR=t=>{if(window.location.pathname!==t){window.history.pushState({},"",nR(t));var e=new PopStateEvent("popstate",{state:{}});dispatchEvent(e)}};function yR(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}var xR=function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){yR(a,n,i,o,s,"next",t)}function s(t){yR(a,n,i,o,s,"throw",t)}o(void 0)}))}}((function*(t){t.preventDefault();var e=document.getElementById("prenom").value,r=document.getElementById("nom").value,n=document.getElementById("adresse").value,i=document.getElementById("email").value,a=document.getElementById("mdp").value;if(r&&e&&n&&i&&a){var o={prenom:e,nom:r,adresse:n,email:i,mdp:a},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},l=yield fetch("http://localhost:3000/users/add",s),c=document.getElementById("success-message"),h=document.getElementById("error-message");if(l.ok){var d=yield l.json();eR(d),rR(),bR("/"),c.style.display="block",h.style.display="none"}else{var p=yield l.json();h.innerHTML=p.message,h.style.display="block",c.style.display="none"}}else document.getElementById("inscriptionForm").querySelectorAll("input").forEach((t=>{t.value?t.classList.remove("is-invalid"):t.classList.add("is-invalid")}))}));return function(e){return t.apply(this,arguments)}}();const _R=()=>{var t=document.querySelector("main"),e='\n    \x3c!-- Section: Design Block --\x3e\n   \n  \n  <section class="text-center">\n  <div class="formInscriptionConnexion">\n  <h2 class="titleInscriptionConnexionPage">S\'inscrire <img src="'.concat(fR,'" alt="" style="width:10%; height:auto"></h2>\n  <img id="baguette" src="').concat(gR,'" alt="" style="width:30%; height:auto">\n\n\n    <form id="inscriptionForm">\n            \x3c!-- 2 column grid layout with text inputs for the first and last names --\x3e\n\n            \x3c!--  afficher le message de succs --\x3e\n            <div id="success-message" class="alert alert-success" role="alert" style="display: none;"></div>\n\n            \x3c!--  afficher le message d\'erreur --\x3e\n            <div id="error-message" class="alert alert-danger" role="alert" style="display: none;"></div>\n\n            <div class="row">\n              <div class="col-md-6 mb-4">\n                <div class="form-outline">\n                  <input type="text" id="prenom" class="form-control" />\n                  <label class="form-label" for="prenom">Prnom</label>\n                </div>\n              </div>\n              <div class="col-md-6 mb-4">\n                <div class="form-outline">\n                  <input type="text" id="nom" class="form-control" />\n                  <label class="form-label" for="nom">Nom</label>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Adresse input --\x3e\n            <div class="form-outline mb-4">\n              <input type="text" id="adresse" class="form-control" />\n              <label class="form-label" for="adresse">Adresse</label>\n            </div>\n\n            \x3c!-- Email input --\x3e\n            <div class="form-outline mb-4">\n              <input type="email" id="email" class="form-control" />\n              <label class="form-label" for="email">Email</label>\n            </div>\n\n            \x3c!-- Password input --\x3e\n            <div class="form-outline mb-4">\n              <input type="password" id="mdp" class="form-control" />\n              <label class="form-label" for="mdp">Mot de passe</label>\n            </div>\n\n            \x3c!-- Submit button --\x3e\n            <button type="submit" class="goldButton">\n              Inscription\n            </button>\n\n            </div>\n            </section>\n          </form>\n\n          <img id="someSushis" src="').concat(vR,'" alt="" style="width:15%; height:auto">\n    ');t.innerHTML=e,document.getElementById("inscriptionForm").addEventListener("submit",xR)};function wR(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}var SR=function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){wR(a,n,i,o,s,"next",t)}function s(t){wR(a,n,i,o,s,"throw",t)}o(void 0)}))}}((function*(t){t.preventDefault();var e=document.getElementById("email").value,r=document.getElementById("mdp").value;if(e&&r){var n={email:e,mdp:r},i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},a=yield fetch("http://localhost:3000/auths/login",i),o=document.getElementById("error-message");if(a.ok){var s=yield a.json();eR(s),rR(),bR("/")}else{var l=yield a.json();o.innerHTML=l.message,o.style.display="block"}}else document.getElementById("connexionForm").querySelectorAll("input").forEach((t=>{t.value?t.classList.remove("is-invalid"):t.classList.add("is-invalid")}))}));return function(e){return t.apply(this,arguments)}}();const ER=()=>{var t=document.querySelector("main"),e='\n    \x3c!-- Section: Design Block --\x3e\n   \n  \n    <section class="text-center">\n    <div class="formInscriptionConnexion">\n    <h2 class="titleInscriptionConnexionPage">Se connecter <img src="'.concat(fR,'" alt="" style="width:10%; height:auto"></h2>\n    \n    <img id="baguette" src="').concat(gR,'" alt="" style="width:30%; height:auto">\n\n      <form id="connexionForm">\n              \x3c!-- 2 column grid layout with text inputs for the first and last names --\x3e\n              <div id="error-message" class="alert alert-danger" role="alert" style="display: none;"></div>\n  \n              \x3c!-- Email input --\x3e\n              <div class="form-outline mb-4">\n                <input type="email" id="email" class="form-control" />\n                <label class="form-label" for="email">Email</label>\n              </div>\n  \n              \x3c!-- Password input --\x3e\n              <div class="form-outline mb-4">\n                <input type="password" id="mdp" class="form-control" />\n                <label class="form-label" for="mdp">Mot de passe</label>\n              </div>\n  \n              \x3c!-- Submit button --\x3e\n              <button type="submit" class="goldButton">\n                Connexion\n              </button>\n\n              <p> Pas encore membre? Inscrivez vous <a href="">ici</a></p>\n\n  \n              </div>\n              </section>\n            </form>\n        <img id="someSushis" src="').concat(vR,'" alt="" style="width:15%; height:auto">\n    ');t.innerHTML=e,document.getElementById("connexionForm").addEventListener("submit",SR)};const MR=()=>{var t=document.querySelector("main"),e='\n   \n        <form action="http://localhost:3000/payement/checkout" method="post">\n              \n              \x3c!-- Submit button --\x3e\n              <button type="submit">\n                Checkout\n              </button>\n\n        </form>\n\n\n\n        <section class="h-100 h-custom" style="background-color: #eee;">\n  <div class="container py-5 h-100">\n    <div class="row d-flex justify-content-center align-items-center h-100">\n      <div class="col">\n        <div class="card">\n          <div class="card-body p-4">\n\n            <div class="row">\n\n              <div class="col-lg-7">\n                <h5 class="mb-3"><a href="#!" class="text-body"><i\n                      class="fas fa-long-arrow-alt-left me-2"></i>Recapitulatif de la commande</a></h5>\n                <hr>\n\n\n                <div class="card mb-3">\n                  <div class="card-body">\n                    <div class="d-flex justify-content-between">\n                      <div class="d-flex flex-row align-items-center">\n                        <div>\n                          <img\n                          src="'.concat(dR,'"\n                            class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">\n                        </div>\n                        <div class="ms-3">\n                          <h5>Box personnalis</h5>\n                        </div>\n                      </div>\n                      <div class="d-flex flex-row align-items-center">\n                        <div style="width: 50px;">\n                          <h5 class="fw-normal mb-0">1</h5>\n                        </div>\n                        <div style="width: 80px;">\n                          <h5 class="mb-0">25</h5>\n                        </div>\n                        <a href="#!" style="color: #cecece;"><i class="fas fa-trash-alt"></i></a>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div class="card mb-3">\n                  <div class="card-body">\n                    <div class="d-flex justify-content-between">\n                      <div class="d-flex flex-row align-items-center">\n                        <div>\n                          <img\n                          src="').concat(dR,'"\n                            class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">\n                        </div>\n                        <div class="ms-3">\n                          <h5>Box personnalis</h5>\n                        </div>\n                      </div>\n                      <div class="d-flex flex-row align-items-center">\n                        <div style="width: 50px;">\n                          <h5 class="fw-normal mb-0">1</h5>\n                        </div>\n                        <div style="width: 80px;">\n                          <h5 class="mb-0">25</h5>\n                        </div>\n                        <a href="#!" style="color: #cecece;"><i class="fas fa-trash-alt"></i></a>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class="card mb-3">\n                  <div class="card-body">\n                    <div class="d-flex justify-content-between">\n                      <div class="d-flex flex-row align-items-center">\n                        <div>\n                          <img\n                          src="').concat(dR,'"\n                            class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">\n                        </div>\n                        <div class="ms-3">\n                          <h5>Box personnalis</h5>\n                        </div>\n                      </div>\n                      <div class="d-flex flex-row align-items-center">\n                        <div style="width: 50px;">\n                          <h5 class="fw-normal mb-0">1</h5>\n                        </div>\n                        <div style="width: 80px;">\n                          <h5 class="mb-0">25</h5>\n                        </div>\n                        <a href="#!" style="color: #cecece;"><i class="fas fa-trash-alt"></i></a>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                </div>\n            \n              <div class="col-lg-5">\n\n                <div class="card bg-dark text-white rounded-3">\n                  <div class="card-body">\n                    <div class="d-flex justify-content-between align-items-center mb-4">\n                      <h5 class="mb-0">Paiement par carte</h5>\n                      </div>\n\n                    <form class="mt-4">\n                      <div class="form-outline form-white mb-4">\n                        <input type="text" id="typeName" class="form-control form-control-lg" siez="17"\n                          placeholder="Nom du propritaire de la carte" />\n                        <label class="form-label" for="typeName"></label>\n                      </div>\n\n                      <div class="form-outline form-white mb-4">\n                        <input type="text" id="typeText" class="form-control form-control-lg" siez="17"\n                          placeholder="1234 5678 9012 3457" minlength="19" maxlength="19" />\n                        <label class="form-label" for="typeText">Numro de carte</label>\n                      </div>\n\n                      <div class="row mb-4">\n                        <div class="col-md-6">\n                          <div class="form-outline form-white">\n                            <input type="text" id="typeExp" class="form-control form-control-lg"\n                              placeholder="MM/YYYY" size="7" id="exp" minlength="7" maxlength="7" />\n                            <label class="form-label" for="typeExp">Expiration</label>\n                          </div>\n                        </div>\n                        <div class="col-md-6">\n                          <div class="form-outline form-white">\n                            <input type="password" id="typeText" class="form-control form-control-lg"\n                              placeholder="&#9679;&#9679;&#9679;" size="1" minlength="3" maxlength="3" />\n                            <label class="form-label" for="typeText">Cvv</label>\n                          </div>\n                        </div>\n                      </div>\n\n                    </form>\n\n                    <hr class="my-4">\n\n\n                    <div class="d-flex justify-content-between mb-4">\n                      <p class="mb-2">Total</p>\n                      <p class="mb-2">75</p>\n                    </div>\n\n                    <button type="button" class="btn btn-light btn-block btn-lg">\n                      <div class="d-flex justify-content-between">\n                        \n                        <span>Checkout <i class="fas fa-long-arrow-alt-right ms-2"></i></span>\n                      </div>\n                    </button>\n\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>\n        \n    ');t.innerHTML=e};const AR=()=>{var t=document.querySelector("main"),e='\n    <section class="h-100" style="background-color: #eee;">\n  <div class="container h-100 py-5">\n    <div class="row d-flex justify-content-center align-items-center h-100">\n      <div class="col-10">\n\n        <div class="d-flex justify-content-center align-items-center mb-4">\n          <h3 class="fw-normal mb-0 text-black">MON PANIER</h3>\n        </div>\n\n        <div class="card rounded-3 mb-4">\n          <div class="card-body p-4">\n            <div class="row d-flex justify-content-between align-items-center">\n              <div class="col-md-2 col-lg-2 col-xl-2">\n                <img\n                  src="'.concat(dR,'"\n                  class="img-fluid rounded-3" alt="Box">\n              </div>\n              <div class="col-md-3 col-lg-3 col-xl-3">\n                <p class="lead fw-normal mb-2">Box de sushi personnalis</p>\n               \n              </div>\n              <div class="col-md-3 col-lg-3 col-xl-2 d-flex">\n                <button class="btn btn-link px-2"\n                  onclick="this.parentNode.querySelector(\'input[type=number]\').stepDown()">\n                  <i class="fas fa-minus"></i>\n                </button>\n\n                <input id="form1" min="0" name="quantity" value="2" type="number"\n                  class="form-control form-control-sm" />\n\n                <button class="btn btn-link px-2"\n                  onclick="this.parentNode.querySelector(\'input[type=number]\').stepUp()">\n                  <i class="fas fa-plus"></i>\n                </button>\n              </div>\n              <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">\n                <h5 class="mb-0">25</h5>\n              </div>\n              <div class="col-md-1 col-lg-1 col-xl-1 text-end">\n                <a href="#!" class="text-danger"><i class="fas fa-trash fa-lg"></i></a>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="card rounded-3 mb-4">\n        <div class="card-body p-4">\n          <div class="row d-flex justify-content-between align-items-center">\n            <div class="col-md-2 col-lg-2 col-xl-2">\n              <img\n                src="').concat(dR,'"\n                class="img-fluid rounded-3" alt="Box">\n            </div>\n            <div class="col-md-3 col-lg-3 col-xl-3">\n              <p class="lead fw-normal mb-2">Box de sushi personnalis</p>\n             \n            </div>\n            <div class="col-md-3 col-lg-3 col-xl-2 d-flex">\n              <button class="btn btn-link px-2"\n                onclick="this.parentNode.querySelector(\'input[type=number]\').stepDown()">\n                <i class="fas fa-minus"></i>\n              </button>\n\n              <input id="form1" min="0" name="quantity" value="2" type="number"\n                class="form-control form-control-sm" />\n\n              <button class="btn btn-link px-2"\n                onclick="this.parentNode.querySelector(\'input[type=number]\').stepUp()">\n                <i class="fas fa-plus"></i>\n              </button>\n            </div>\n            <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">\n              <h5 class="mb-0">25</h5>\n            </div>\n            <div class="col-md-1 col-lg-1 col-xl-1 text-end">\n              <a href="#!" class="text-danger"><i class="fas fa-trash fa-lg"></i></a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n\n        <div class="card">\n            \n          <div class="card-body d-flex justify-content-end align-items-end">\n            <p class="lead fw-normal">Total:25 </p>\n            <button type="button" class="btn btn-dark btn-block btn-lg "> Procder au paiement</button>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n</section>\n        \n    ');t.innerHTML=e};const TR={"/":cR,"/connexion":ER,"/inscription":_R,"/menu":hR,"/creationBox":pR,"/profil":mR,"/users":()=>{document.querySelector("main").innerHTML=' \n    <div class="retour">\n    <a href="#">\n        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="black" class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16">\n        <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"/>\n        </svg>\n    </a>\n    </div>\n\n    <h1 class="titleUsers">\n        Liste des utilisateurs \n        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">\n            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>\n        </svg>\n    </h1>\n    <div class="tab">\n   \n            <table class="table align-middle mb-0 table-bordered ">\n                <thead class="bg-dark">\n                <tr class="table-dark">\n                    <th>Id</th>\n                    <th>Nom</th>\n                    <th>Prenom</th>\n                    <th>Email</th>\n                    <th>isAdmin</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline">Admin</span>\n                        </td>\n                    </tr>\n                    \n\n                    \n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline"></span>\n                        </td>\n                    </tr>\n\n                    \n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline"></span>\n                        </td>\n                    </tr>\n\n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline"></span>\n                        </td>\n                    </tr>\n\n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline"></span>\n                        </td>\n                    </tr>\n\n                    <tr class="table-secondary">\n                        <td>\n                            <p class="fw-normal mb-1">1</p>\n                        </td>\n\n                        <td>\n                            <p class="fw-normal mb-1">Nkolongo</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">Bellerose</p>\n                        </td>\n                        <td>\n                            <p class="fw-normal mb-1">bellerose@student.vinci.be</p>\n                        </td>\n                        <td>\n                            <span class="badge badge-success rounded-pill d-inline"></span>\n                        </td>\n                    </tr>\n                   \n                </tbody>\n                </table>\n        </div>\n    '},"/paiement":MR,"/card":AR,"/logout":()=>{localStorage.removeItem(tR),void 0,rR(),bR("/")}};const PR=()=>{window.addEventListener("load",(()=>{var t=iR(window.location.pathname),e=TR[t];if(!e)throw Error("The ".concat(t," ressource does not exist."));e()})),document.querySelector("#navbarWrapper").addEventListener("click",(t=>{var e;t.preventDefault();var r=t.target,n=null==r||null===(e=r.dataset)||void 0===e?void 0:e.uri;if(n){var i=TR[n];if(!i)throw Error("The ".concat(n," ressource does not exist."));i(),window.history.pushState({},"",nR(n))}})),window.addEventListener("popstate",(()=>{var t=iR(window.location.pathname);(0,TR[t])()}))},CR=__webpack_require__.p+"7e872e0dce6277a0bfa8.png";const kR=()=>{var t=document.querySelector("#footerWrapper"),e='\n    <div class="footer">\n          <footer class="text-center text-lg-start border border-white mt-xl-5 pt-4">\n          \x3c!-- Grid container --\x3e\n          <div class="container p-4">\n            \x3c!--Grid row--\x3e\n            <div class="row">\n              \x3c!--Grid column--\x3e\n              <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">\n               \n\n                <ul class="list-unstyled mb-4">\n                  <li>\n                    <a href="#!" class="text-white">SUSHIROYAL</a>\n                  </li>\n                  <br>\n                  <li>\n                  <img id="" src="'.concat(CR,'" alt="" style="width:40%; height:auto">\n                </li>\n                </ul>\n              </div>\n      \n              <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">\n                <ul class="list-unstyled">\n                  <li>\n                    <a href="#!" class="text-white">sushiroyal@gmail.com</a>\n                  </li>\n                  <br>\n                  <li>\n                  <a href="#!" class="text-white">Rue du soja 3, 1234 Core du Sud</a>\n                  </li>\n                  <br>\n                  <li>\n                    <a href="#!" class="text-white">+32433333333</a>\n                  </li>\n                </ul>\n              </div>\n              \x3c!--Grid column--\x3e\n\n              <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">\n              <ul class="list-unstyled">\n                <li>\n                  <a href="#!" class="text-white">Nos rseaux:</a>\n                </li>\n                <br>\n                <li>\n                <a href="#!" class="text-white">Facebook : sushiroyal</a>\n                </li>\n                <br>\n                <li>\n                <a href="#!" class="text-white">Instagram : sushiroyal</a>\n                </li>\n                <br>\n         \n              </ul>\n            </div>\n            \x3c!--Grid column--\x3e\n\n              \x3c!--Grid column--\x3e\n              <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">\n                <h5 class="text-uppercase mb-4">Sign up to our newsletter</h5>\n\n                <div class="form-outline form-white mb-4">\n                  <input type="email" id="form5Example2" class="form-control" />\n                  <label class="form-label" for="form5Example2">Email address</label>\n                </div>\n\n                <button type="submit" class="footerButton">Subscribe</button>\n              </div>\n              \x3c!--Grid column--\x3e\n            </div>\n            \x3c!--Grid row--\x3e\n          </div>\n          \x3c!-- Grid container --\x3e\n\n          \x3c!-- Copyright --\x3e\n          <div class="text-center p-3 border-top border-white">\n             2020 Copyright:\n            <a class="text-white" href="https://mdbootstrap.com/">MDBootstrap.com</a>\n          </div>\n          \x3c!-- Copyright --\x3e\n        </footer>\n        </div>\n    ');t.innerHTML=e};rR(),PR(),kR()})()})();